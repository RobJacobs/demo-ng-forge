import{a as U}from"./chunk-TCLIZBJE.js";import{a as J}from"./chunk-WTEGRGZ6.js";import{Ab as f,Bc as F,Cc as z,Cd as V,Db as w,Dd as L,Hd as q,Id as Z,Jc as B,Jd as j,Kc as K,Lb as G,Lc as N,Mb as T,Mc as D,Pb as I,cc as R,dc as O,f as x,i as S,rb as P,tb as g,vb as M,wb as A,yb as E}from"./chunk-WGIND62E.js";import{Ab as b,Eb as l,Fb as t,Gb as e,Hb as s,N as p,Rb as m,Va as a,ca as d,dc as i,ec as u,lb as y,oa as v,sc as _,tc as k,zb as C}from"./chunk-UXY6XTJ4.js";import"./chunk-NCBA65HR.js";function Q(r,H){r&1&&s(0,"forge-linear-progress",20)}function W(r,H){r&1&&s(0,"forge-divider")}var ce=(()=>{class r{constructor(){this.ngZone=d(v),this.reCatpchaService=d(U),this.toastService=d(q),this.isBusy=!1,this.isInitialized=!1,this.formGroup=new E({recaptchaAction:new f("TEST",{validators:[g.required]}),recaptchaSiteKey:new f(null,{validators:[g.required]}),googleAPIKey:new f(null,{validators:[g.required]})})}onInitialize(){this.formGroup.controls.recaptchaSiteKey.disable(),this.isBusy=!0,this.reCatpchaService.initialize(this.formGroup.getRawValue().recaptchaSiteKey).pipe(p(()=>this.isBusy=!1)).subscribe({next:()=>{this.ngZone.run(()=>{this.isInitialized=!0}),this.toastService.show("Re-Captcha initialized.")},error:o=>{this.toastService.show("An error occurred initializing Re-Captcha, see console for details.")}})}onExecute(){this.token=void 0,this.assessment=void 0,this.isBusy=!0,this.reCatpchaService.executeChallenge(this.formGroup.value.recaptchaAction).pipe(p(()=>{this.isBusy=!1})).subscribe({next:o=>{this.token=o},error:o=>{console.log(o),this.toastService.show("An error occurred, see console for details.")}})}onAssess(){this.assessment=void 0,this.isBusy=!0,this.reCatpchaService.assessToken(this.formGroup.value.googleAPIKey,this.token,this.formGroup.value.recaptchaAction).pipe(p(()=>this.isBusy=!1)).subscribe({next:o=>{this.assessment={event:{expectedAction:o.event.expectedAction},riskAnalysis:{challenge:o.riskAnalysis.challenge,score:o.riskAnalysis.score},tokenProperties:{action:o.tokenProperties.action,createTime:J.formatDate(o.tokenProperties.createTime,"MM/dd/yyyy hh:mm"),invalidReason:o.tokenProperties.invalidReason,valid:o.tokenProperties.valid}},console.log(o)},error:o=>{console.log(o),this.toastService.show("An error occurred, see console for details.")}})}static{this.\u0275fac=function(c){return new(c||r)}}static{this.\u0275cmp=y({type:r,selectors:[["app-re-captcha"]],decls:57,vars:9,consts:[[1,"header"],["slot","start",1,"forge-typography--subheading4"],[1,"body"],["novalidate","","autocomplete","off",1,"form-grid",3,"formGroup"],[1,"form-grid--col-span","form-grid__resources"],["slot","label"],["slot","value",1,"form-grid__resources--stacked"],["href","https://cloud.google.com/recaptcha/docs/setup-overview-web","target","_blank"],["href","https://cloud.google.com/recaptcha/docs/apis","target","_blank"],["slot","label","for","re-captcha--action"],["type","text","id","re-captcha--action","formControlName","recaptchaAction"],[1,"form-grid--col-span2"],["slot","label","for","re-captcha--site-key"],["type","text","id","re-captcha--site-key","formControlName","recaptchaSiteKey"],["slot","helper-text",1,"forge-typography--label2"],["slot","label","for","re-captcha--google-api-key"],["type","text","id","re-captcha--google-api-key","formControlName","googleAPIKey"],[1,"form-grid--col-span2","form-grid__actions"],["variant","outlined",3,"click","disabled"],["variant","outlined",1,"form-grid--row-break",3,"click","disabled"],[1,"form-grid--col-span"],["slot","value",2,"margin","0"],["slot","value"]],template:function(c,n){c&1&&(t(0,"forge-toolbar",0)(1,"h2",1),i(2,"Google reCaptcha"),e()(),t(3,"div",2)(4,"form",3)(5,"div",4)(6,"forge-label-value")(7,"span",5),i(8,"Resources"),e(),t(9,"div",6)(10,"a",7),i(11,"reCaptcha website setup"),e(),t(12,"a",8),i(13,"reCaptcha API reference"),e()()()(),t(14,"forge-text-field")(15,"label",9),i(16,"Action"),e(),s(17,"input",10),e(),t(18,"forge-text-field",11)(19,"label",12),i(20,"Site key"),e(),s(21,"input",13),t(22,"span",14),i(23,"Site key can only be set once, refresh the page to change site key."),e(),t(24,"span",14),i(25,"reCaptcha must be Intialized after setting site key."),e(),t(26,"span",14),i(27,"Execute will generate a new token."),e()(),t(28,"forge-text-field",11)(29,"label",15),i(30,"Google API key"),e(),s(31,"input",16),t(32,"span",14),i(33,"Google API key is required to Assess a token."),e(),t(34,"span",14),i(35,"Token may only be assessed once, then it will become invalid."),e()(),t(36,"div",17)(37,"forge-button",18),m("click",function(){return n.onInitialize()}),i(38,"Initialize"),e(),t(39,"forge-button",19),m("click",function(){return n.onExecute()}),i(40," Execute "),e(),t(41,"forge-button",18),m("click",function(){return n.onAssess()}),i(42,"Assess"),e()(),t(43,"div",20),C(44,Q,1,0,"forge-linear-progress",20)(45,W,1,0,"forge-divider"),e(),t(46,"forge-label-value",20)(47,"span",5),i(48,"Assessment"),e(),t(49,"pre",21),i(50),_(51,"json"),e()(),t(52,"forge-label-value",20)(53,"span",5),i(54,"Token"),e(),t(55,"span",22),i(56),e()()()()),c&2&&(a(4),l("formGroup",n.formGroup),a(33),l("disabled",n.formGroup.controls.recaptchaSiteKey.invalid||n.isInitialized),a(2),l("disabled",n.formGroup.controls.recaptchaAction.invalid||n.formGroup.controls.recaptchaSiteKey.invalid||!n.isInitialized||n.isBusy),a(2),l("disabled",!(n.token!=null&&n.token.length)||n.formGroup.invalid||n.isBusy),a(3),b(n.isBusy?44:45),a(6),u(k(51,7,n.assessment)),a(6),u(n.token))},dependencies:[S,I,w,P,M,A,T,G,O,R,z,F,K,B,D,N,L,V,j,Z,x],styles:[`[_nghost-%COMP%]{display:grid;grid-template-rows:auto 1fr;overflow:hidden;height:100%}.body[_ngcontent-%COMP%]{overflow:auto;padding:24px;display:flex;align-items:flex-start;justify-content:center}.form-grid[_ngcontent-%COMP%]{background-color:var(--forge-theme-surface);border-radius:var(--forge-shape-medium);border:1px solid var(--forge-theme-outline);padding:16px;display:grid;grid-template-columns:repeat(auto-fill,320px);gap:16px}.form-grid--row-break[_ngcontent-%COMP%]{grid-column-start:1}.form-grid--col-span[_ngcontent-%COMP%]{grid-column:1/-1}.form-grid--col-span.form-grid--col-span[_ngcontent-%COMP%]{width:auto}.form-grid--col-span2[_ngcontent-%COMP%]{grid-column:span 2}.form-grid--col-span2.form-grid--col-span2[_ngcontent-%COMP%]{width:656px}.form-grid--col-span3[_ngcontent-%COMP%]{grid-column:span 3}.form-grid--col-span3.form-grid--col-span3[_ngcontent-%COMP%]{width:992px}.form-grid[_ngcontent-%COMP%]   [slot=value][_ngcontent-%COMP%]:empty:before{content:"n/a";color:var(--forge-theme-text-medium);font-style:italic}.form-grid__resources--stacked[_ngcontent-%COMP%]{font-size:.85rem;display:flex;flex-direction:column;row-gap:4px}.form-grid__actions[_ngcontent-%COMP%]{display:flex;column-gap:8px}






/*# sourceMappingURL=re-captcha.component-OZ7PUJ24.css.map */`]})}}return r})();export{ce as ReCaptchaComponent};
//# sourceMappingURL=chunk-IRKTJ4AZ.js.map
