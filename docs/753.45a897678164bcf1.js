"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[753],{23373:(Yt,ae,O)=>{O.d(ae,{EN:()=>Z,H9:()=>_,eS:()=>Y,f:()=>M});var M,N,Q=O(43918);(N=M||(M={})).InvalidFunctionParameters="InvalidFunctionParameters",N.UnsupportedSqlFunction="UnsupportedSqlFunction",N.UnsupportedOperator="UnsupportedOperator",N.UnsupportedSyntax="UnsupportedSyntax",N.UnsupportedIsRhs="UnsupportedIsRhs",N.UnsupportedIsLhs="UnsupportedIsLhs",N.InvalidDataType="InvalidDataType",N.CannotCastValue="CannotCastValue",N.MissingStatisticParameters="MissingStatisticParameters";const ye={[M.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[M.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[M.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[M.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[M.UnsupportedOperator]:"Unsupported operator - {operator}",[M.UnsupportedSyntax]:"Unsupported syntax - {node}",[M.UnsupportedSqlFunction]:"Sql function not found = {function}",[M.InvalidDataType]:"Invalid sql data type",[M.CannotCastValue]:"Cannot cast value to the required data type"};class Y extends Error{constructor(z,X){super((0,Q.Hy)(ye[z],X)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,Y)}}var _;!function(N){N.NeverReach="NeverReach",N.NotImplemented="NotImplemented",N.Cancelled="Cancelled",N.InvalidStatResponse="InvalidStatResponse",N.InvalidRequest="InvalidRequest",N.RequestFailed="RequestFailed",N.MissingFeatures="MissingFeatures",N.AggregationFieldNotFound="AggregationFieldNotFound",N.DataElementsNotFound="DataElementsNotFound"}(_||(_={}));const we={[_.Cancelled]:"Cancelled",[_.InvalidStatResponse]:"Invalid statistics response from service",[_.InvalidRequest]:"Invalid request",[_.RequestFailed]:"Request failed - {reason}",[_.MissingFeatures]:"Missing features",[_.AggregationFieldNotFound]:"Aggregation field not found",[_.DataElementsNotFound]:"Data elements not found on service",[_.NeverReach]:"Encountered unreachable logic",[_.NotImplemented]:"Not implemented"};class Z extends Error{constructor(z,X){super((0,Q.Hy)(we[z],X)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,Z)}}},30753:(Yt,ae,O)=>{O.r(ae),O.d(ae,{WhereClause:()=>be,defaultAttributeAdapter:()=>B});var Q=O(67087);const Y={min:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.min.apply(Math,l[0])},max:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.max.apply(Math,l[0])},avg:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:_(l[0])},sum:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:function we(l){let s=0;for(let o=0;o<l.length;o++)s+=l[o];return s}(l[0])},stddev:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.sqrt(Z(l[0]))},count:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].length},var:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Z(l[0])}};function _(l){let s=0;for(let o=0;o<l.length;o++)s+=l[o];return s/l.length}function Z(l){const s=_(l),o=l.length;let f=0;for(const i of l)f+=(i-s)**2;return o>1?f/(o-1):0}var N=O(23373),z=O(3758),X=O(64626);class C{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(s){if(null!==s.precision||null!==s.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static _parseSecondsComponent(s,o){if(o.includes(".")){const f=o.split(".");s.second=parseFloat(f[0]),s.millis=parseInt(f[1],10)}else s.second=parseFloat(o)}static createFromMilliseconds(s){const o=new C;return o.second=s/1e3,o}static createFromValueAndQualifer(s,o,f){let i=null;const v=new C;if(v.op="-"===f?"-":"+","interval-period"===o.type){C._fixDefaults(o);const m=new RegExp("^[0-9]{1,}$");if("year"===o.period||"month"===o.period)throw new Error("Year-Month Intervals not supported");if("second"===o.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(s))throw new Error("Illegal Interval");C._parseSecondsComponent(v,s)}else{if(!m.test(s))throw new Error("Illegal Interval");v[o.period]=parseFloat(s)}}else{if(C._fixDefaults(o.start),C._fixDefaults(o.end),"year"===o.start.period||"month"===o.start.period)throw new Error("Year-Month Intervals not supported");if("year"===o.end.period||"month"===o.end.period)throw new Error("Year-Month Intervals not supported");switch(o.start.period){case"day":switch(o.end.period){case"hour":if(i=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!i.test(s))throw new Error("Illegal Interval");v[o.start.period]=parseFloat(s.split(" ")[0]),v[o.end.period]=parseFloat(s.split(" ")[1]);break;case"minute":if(i=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!i.test(s))throw new Error("Illegal Interval");{v[o.start.period]=parseFloat(s.split(" ")[0]);const m=s.split(" ")[1].split(":");v.hour=parseFloat(m[0]),v.minute=parseFloat(m[1])}break;case"second":if(i=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!i.test(s))throw new Error("Illegal Interval");{v[o.start.period]=parseFloat(s.split(" ")[0]);const m=s.split(" ")[1].split(":");v.hour=parseFloat(m[0]),v.minute=parseFloat(m[1]),C._parseSecondsComponent(v,m[2])}break;default:throw new Error("Invalid Interval.")}break;case"hour":switch(o.end.period){case"minute":if(i=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!i.test(s))throw new Error("Illegal Interval");v.hour=parseFloat(s.split(":")[0]),v.minute=parseFloat(s.split(":")[1]);break;case"second":if(i=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!i.test(s))throw new Error("Illegal Interval");{const m=s.split(":");v.hour=parseFloat(m[0]),v.minute=parseFloat(m[1]),C._parseSecondsComponent(v,m[2])}break;default:throw new Error("Invalid Interval.")}break;case"minute":if("second"!==o.end.period)throw new Error("Invalid Interval.");if(i=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!i.test(s))throw new Error("Illegal Interval");{const m=s.split(":");v.minute=parseFloat(m[0]),C._parseSecondsComponent(v,m[1])}break;default:throw new Error("Invalid Interval.")}}return v}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function Ne(l,s){const o=qe[l.toLowerCase()];if(null==o)throw new Error("Function Not Recognised");if(s.length<o.minParams||s.length>o.maxParams)throw new Error(`Invalid Parameter count for call to ${l.toUpperCase()}`);return o.evaluate(s)}function He(l){const s=new Date(l.getTime());return s.setHours(0,0,0,0),s}function Ve(l,s){if(function Qt(l){return l instanceof Date}(l))return s?He(l):l;if(function Kt(l){return"string"==typeof l||l instanceof String}(l)){const o=X.ou.fromSQL(l);if(o.isValid)return s?He(o.toJSDate()):o.toJSDate()}throw new N.eS(N.f.CannotCastValue)}const qe={extract:{minParams:2,maxParams:2,evaluate:([l,s])=>{if(null==s)return null;if(s instanceof Date)switch(l.toUpperCase()){case"SECOND":return s.getSeconds();case"MINUTE":return s.getMinutes();case"HOUR":return s.getHours();case"DAY":return s.getDate();case"MONTH":return s.getMonth()+1;case"YEAR":return s.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:l=>{if(2===l.length){const[s,o]=l;return null==s||null==o?null:s.toString().substring(o-1)}if(3===l.length){const[s,o,f]=l;return null==s||null==o||null==f?null:f<=0?"":s.toString().substring(o-1,o+f-1)}}},position:{minParams:2,maxParams:2,evaluate:([l,s])=>null==l||null==s?null:s.indexOf(l)+1},trim:{minParams:2,maxParams:3,evaluate:l=>{const s=3===l.length,o=s?l[1]:" ",f=s?l[2]:l[1];if(null==o||null==f)return null;const i=`(${(0,z.Qs)(o)})`;switch(l[0]){case"BOTH":return f.replace(new RegExp(`^${i}*|${i}*$`,"g"),"");case"LEADING":return f.replace(new RegExp(`^${i}*`,"g"),"");case"TRAILING":return f.replace(new RegExp(`${i}*$`,"g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.abs(l[0])},ceiling:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.ceil(l[0])},floor:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.floor(l[0])},log:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.log(l[0])},log10:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.log(l[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.sin(l[0])},cos:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.cos(l[0])},tan:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.tan(l[0])},asin:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.asin(l[0])},acos:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.acos(l[0])},atan:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.atan(l[0])},sign:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0]>0?1:l[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:l=>null==l[0]||null==l[1]?null:l[0]**l[1]},mod:{minParams:2,maxParams:2,evaluate:l=>null==l[0]||null==l[1]?null:l[0]%l[1]},round:{minParams:1,maxParams:2,evaluate:l=>{const s=l[0],o=2===l.length?10**l[1]:1;return null==s?null:Math.round(s*o)/o}},truncate:{minParams:1,maxParams:2,evaluate:l=>null==l[0]?null:1===l.length?parseInt(l[0].toFixed(0),10):parseFloat(l[0].toFixed(l[1]))},char_length:{minParams:1,maxParams:1,evaluate:l=>"string"==typeof l[0]||l[0]instanceof String?l[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:l=>{let s="";for(let o=0;o<l.length;o++){if(null==l[o])return null;s+=l[o].toString()}return s}},lower:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:l=>{for(const s of l)if(null!==s)return s;return null}},cosh:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.cosh(l[0])},sinh:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.sinh(l[0])},tanh:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.tanh(l[0])},nullif:{minParams:2,maxParams:2,evaluate:l=>{const s=l[0],o=l[1];return(s instanceof Date?s.valueOf():s)===(o instanceof Date?o.valueOf():o)?null:s}},cast:{minParams:2,maxParams:2,evaluate:l=>{const s=l[0],o=l[1];if(null===s)return null;switch(o.type){case"integer":{const f=parseInt(s,10);if(isNaN(f))throw new N.eS(N.f.CannotCastValue);return f}case"smallint":{const f=parseInt(s,10);if(isNaN(f))throw new N.eS(N.f.CannotCastValue);if(f>32767||f<-32767)throw new N.eS(N.f.CannotCastValue);return f}case"float":case"real":{const f=parseFloat(s);if(isNaN(f))throw new N.eS(N.f.CannotCastValue);return f}case"date":return Ve(s,!0);case"timestamp":return Ve(s,!1);case"varchar":{const f=s.toString();if(f.length>o.size)throw new N.eS(N.f.CannotCastValue);return f}default:throw new N.eS(N.f.InvalidDataType)}}}};O(80422);var We,Ie={};(We={get exports(){return Ie},set exports(l){Ie=l}}).exports&&(We.exports=function(){function s(i,v,m,t){var I=Error.call(this,i);return Object.setPrototypeOf&&Object.setPrototypeOf(I,s.prototype),I.expected=v,I.found=m,I.location=t,I.name="SyntaxError",I}function o(i,v,m){return m=m||" ",i.length>v?i:i+(m+=m.repeat(v-=i.length)).slice(0,v)}return function l(i,v){function m(){this.constructor=i}m.prototype=v.prototype,i.prototype=new m}(s,Error),s.prototype.format=function(i){var v="Error: "+this.message;if(this.location){var m,t=null;for(m=0;m<i.length;m++)if(i[m].source===this.location.source){t=i[m].text.split(/\r\n|\n|\r/g);break}var I=this.location.start,x=this.location.source+":"+I.line+":"+I.column;if(t){var R=this.location.end,V=o("",I.line.toString().length," "),k=t[I.line-1],T=(I.line===R.line?R.column:k.length+1)-I.column||1;v+="\n --\x3e "+x+"\n"+V+" |\n"+I.line+" | "+k+"\n"+V+" | "+o("",I.column-1," ")+o("",T,"^")}else v+="\n at "+x}return v},s.buildMessage=function(i,v){var m={literal:function(T){return'"'+I(T.text)+'"'},class:function(T){var S=T.parts.map(function(D){return Array.isArray(D)?x(D[0])+"-"+x(D[1]):x(D)});return"["+(T.inverted?"^":"")+S.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(T){return T.description}};function t(T){return T.charCodeAt(0).toString(16).toUpperCase()}function I(T){return T.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(S){return"\\x0"+t(S)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(S){return"\\x"+t(S)})}function x(T){return T.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(S){return"\\x0"+t(S)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(S){return"\\x"+t(S)})}function R(T){return m[T.type](T)}return"Expected "+function V(T){var S,D,P=T.map(R);if(P.sort(),P.length>0){for(S=1,D=1;S<P.length;S++)P[S-1]!==P[S]&&(P[D]=P[S],D++);P.length=D}switch(P.length){case 1:return P[0];case 2:return P[0]+" or "+P[1];default:return P.slice(0,-1).join(", ")+", or "+P[P.length-1]}}(i)+" but "+function k(T){return T?'"'+I(T)+'"':"end of input"}(v)+" found."},{SyntaxError:s,parse:function f(i,v){var m,t={},I=(v=void 0!==v?v:{}).grammarSource,x={start:gt},R=gt,V="!",k="=",T=">=",S=">",D="<=",P="<>",on="<",tt="!=",Ce="+",Se="-",nt="||",ln="*",cn="/",fn="@",rt="'",at="N'",ue="''",pn=".",vn="null",dn="true",hn="false",mn="in",gn="is",yn="like",wn="escape",Nn="not",In="and",bn="or",Tn="between",xn="from",An="for",En="substring",Cn="extract",Sn="trim",Pn="position",Fn="timestamp",Ln="date",_n="leading",Mn="trailing",Rn="both",Dn="cast",On="as",Jn="integer",Un="smallint",kn="float",$n="real",Hn="varchar",Vn="to",qn="interval",Wn="year",Bn="month",Gn="day",jn="hour",Yn="minute",Zn="second",Kn="case",Qn="end",zn="when",Xn="then",er="else",tr=",",nr="(",rr=")",st="`",ar=/^[A-Za-z_\x80-\uFFFF]/,sr=/^[A-Za-z0-9_]/,ur=/^[A-Za-z0-9_.\x80-\uFFFF]/,ut=/^[^']/,or=/^[0-9]/,ir=/^[eE]/,lr=/^[+\-]/,cr=/^[ \t\n\r]/,ot=/^[^`]/,fr=g("!",!1),it=g("=",!1),pr=g(">=",!1),vr=g(">",!1),dr=g("<=",!1),hr=g("<>",!1),mr=g("<",!1),gr=g("!=",!1),Pe=g("+",!1),Fe=g("-",!1),yr=g("||",!1),wr=g("*",!1),Nr=g("/",!1),Ir=$([["A","Z"],["a","z"],"_",["\x80","\uffff"]],!1,!1),br=$([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Tr=$([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","\uffff"]],!1,!1),xr=g("@",!1),lt=g("'",!1),Ar=g("N'",!1),ct=g("''",!1),ft=$(["'"],!0,!1),Er=g(".",!1),Cr=$([["0","9"]],!1,!1),Sr=$(["e","E"],!1,!1),Pr=$(["+","-"],!1,!1),Fr=g("NULL",!0),Lr=g("TRUE",!0),_r=g("FALSE",!0),Mr=g("IN",!0),Rr=g("IS",!0),Dr=g("LIKE",!0),Or=g("ESCAPE",!0),Jr=g("NOT",!0),Ur=g("AND",!0),kr=g("OR",!0),$r=g("BETWEEN",!0),Hr=g("FROM",!0),Vr=g("FOR",!0),qr=g("SUBSTRING",!0),Wr=g("EXTRACT",!0),Br=g("TRIM",!0),Gr=g("POSITION",!0),jr=g("TIMESTAMP",!0),Yr=g("DATE",!0),Zr=g("LEADING",!0),Kr=g("TRAILING",!0),Qr=g("BOTH",!0),zr=g("CAST",!0),Xr=g("AS",!0),ea=g("INTEGER",!0),ta=g("SMALLINT",!0),na=g("FLOAT",!0),ra=g("REAL",!0),aa=g("VARCHAR",!0),sa=g("TO",!0),ua=g("INTERVAL",!0),oa=g("YEAR",!0),ia=g("MONTH",!0),la=g("DAY",!0),ca=g("HOUR",!0),fa=g("MINUTE",!0),pa=g("SECOND",!0),va=g("CASE",!0),da=g("END",!0),ha=g("WHEN",!0),ma=g("THEN",!0),ga=g("ELSE",!0),ya=g(",",!1),wa=g("(",!1),Na=g(")",!1),Ia=$([" ","\t","\n","\r"],!1,!1),pt=g("`",!1),vt=$(["`"],!0,!1),ba=function(e){return e},Ta=function(e,r){var a={type:"expression-list"},u=function Wo(e,r,a){return function qo(e,r){for(var a=[e],u=0;u<r.length;u++)a.push(r[u][3]);return a}(e,r)}(e,r);return a.value=u,a},xa=function(e,r){return re(e,r)},Aa=function(e,r){return re(e,r)},Ea=function(e){return function Vo(e,r){return{type:"unary-expression",operator:e,expr:r}}("NOT",e)},Ca=function(e,r){return""==r||null==r||null==r?e:"arithmetic"==r.type?re(e,r.tail):jt(r.op,e,r.right,r.escape)},Sa=function(e){return{type:"arithmetic",tail:e}},Pa=function(e,r){return{op:e+"NOT",right:r}},Fa=function(e,r){return{op:e,right:r}},La=function(e,r,a){return{op:"NOT"+e,right:{type:"expression-list",value:[r,a]}}},_a=function(e,r,a){return{op:e,right:{type:"expression-list",value:[r,a]}}},Ma=function(e){return e[0]+" "+e[2]},Ra=function(e){return e[0]+" "+e[2]},Da=function(e,r,a){return{op:e,right:r,escape:a.value}},Oa=function(e,r){return{op:e,right:r,escape:""}},Ja=function(e,r){return{op:e,right:r}},Ua=function(e){return{op:e,right:{type:"expression-list",value:[]}}},ka=function(e,r){return{op:e,right:r}},$a=function(e,r){return re(e,r)},Ha=function(e,r){return re(e,r)},Va=function(e){return e.paren=!0,e},qa=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:e}},Wa=function(e){return e},Ba=function(e,r){return e+r.join("")},Ga=function(e,r){return e+r.join("")},ja=function(e){return{type:"parameter",value:e[1]}},Ya=function(e,r){return{type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:e},r]}}},Za=function(e,r,a){return{type:"function",name:"substring",args:{type:"expression-list",value:a?[e,r,a[2]]:[e,r]}}},Ka=function(e,r){return{type:"function",name:"cast",args:{type:"expression-list",value:[e,r]}}},Qa=function(){return{type:"data-type",value:{type:"integer"}}},za=function(){return{type:"data-type",value:{type:"smallint"}}},Xa=function(){return{type:"data-type",value:{type:"float"}}},es=function(){return{type:"data-type",value:{type:"real"}}},ts=function(){return{type:"data-type",value:{type:"date"}}},ns=function(){return{type:"data-type",value:{type:"timestamp"}}},rs=function(e){return{type:"data-type",value:{type:"varchar",size:parseInt(e)}}},as=function(e,r,a){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:e??"BOTH"},r,a]}}},ss=function(e,r){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:e??"BOTH"},r]}}},us=function(e,r){return{type:"function",name:"position",args:{type:"expression-list",value:[e,r]}}},os=function(e,r){return{type:"function",name:e,args:r||{type:"expression-list",value:[]}}},is=function(e){return{type:"timestamp",value:e.value}},ls=function(e,r,a){return{type:"interval",value:r,qualifier:a,op:e}},cs=function(e,r){return{type:"interval",value:e,qualifier:r,op:""}},fs=function(e,r){return{type:"interval-qualifier",start:e,end:r}},ps=function(e,r){return{type:"interval-period",period:e.value,precision:r,secondary:null}},vs=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},ds=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},hs=function(e,r){return{type:"interval-period",period:"second",precision:e,secondary:r}},ms=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},gs=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},ys=function(e,r){return{type:"interval-period",period:e.value,precision:r,secondary:null}},ws=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Ns=function(e,r){return{type:"interval-period",period:"second",precision:e,secondary:r}},Is=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},bs=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Ts=function(){return{type:"string",value:"day"}},xs=function(){return{type:"string",value:"hour"}},As=function(){return{type:"string",value:"minute"}},Es=function(){return{type:"string",value:"month"}},Cs=function(){return{type:"string",value:"year"}},Ss=function(e){return parseFloat(e)},Ps=function(e){return parseFloat(e)},Fs=function(e){return{type:"date",value:e.value}},Ls=function(){return{type:"null",value:null}},_s=function(){return{type:"boolean",value:!0}},Ms=function(){return{type:"boolean",value:!1}},dt=function(){return"'"},Rs=function(e){return{type:"string",value:e.join("")}},Ds=function(e,r){return{type:"case-expression",format:"simple",operand:e,clauses:r,else:null}},Os=function(e,r,a){return{type:"case-expression",format:"simple",operand:e,clauses:r,else:a.value}},Js=function(e){return{type:"case-expression",format:"searched",clauses:e,else:null}},Us=function(e,r){return{type:"case-expression",format:"searched",clauses:e,else:r.value}},ks=function(e,r){return{type:"when-clause",operand:e,value:r}},$s=function(e,r){return{type:"when-clause",operand:e,value:r}},Hs=function(e){return{type:"else-clause",value:e}},Vs=function(e){return{type:"number",value:e}},qs=function(e,r,a){return parseFloat(e+r+a)},Ws=function(e,r){return parseFloat(e+r)},Bs=function(e,r){return parseFloat(e+r)},Gs=function(e){return parseFloat(e)},js=function(e,r){return e[0]+r},Ys=function(e){return"."+(e??"")},Zs=function(e,r){return e+r},Ks=function(e){return e.join("")},Qs=function(e,r){return"e"+(null===r?"":r)},zs=function(){return"IN"},Xs=function(){return"IS"},eu=function(){return"LIKE"},tu=function(){return"ESCAPE"},nu=function(){return"NOT"},ru=function(){return"AND"},au=function(){return"OR"},su=function(){return"BETWEEN"},uu=function(){return"FROM"},ou=function(){return"FOR"},iu=function(){return"SUBSTRING"},lu=function(){return"EXTRACT"},cu=function(){return"TRIM"},fu=function(){return"POSITION"},pu=function(){return"TIMESTAMP"},vu=function(){return"DATE"},du=function(){return"LEADING"},hu=function(){return"TRAILING"},mu=function(){return"BOTH"},gu=function(){return"CAST"},yu=function(){return"AS"},wu=function(){return"INTEGER"},Nu=function(){return"SMALLINT"},Iu=function(){return"FLOAT"},bu=function(){return"REAL"},Tu=function(){return"VARCHAR"},xu=function(){return"TO"},Au=function(){return"INTERVAL"},Eu=function(){return"YEAR"},Cu=function(){return"MONTH"},Su=function(){return"DAY"},Pu=function(){return"HOUR"},Fu=function(){return"MINUTE"},Lu=function(){return"SECOND"},_u=function(){return"CASE"},Mu=function(){return"END"},Ru=function(){return"WHEN"},Du=function(){return"THEN"},Ou=function(){return"ELSE"},Ju=function(e){return e},Uu=function(e){return e.join("")},n=0,oe=[{line:1,column:1}],J=0,Le=[],c=0;if("startRule"in v){if(!(v.startRule in x))throw new Error("Can't start parsing from rule \""+v.startRule+'".');R=x[v.startRule]}function g(e,r){return{type:"literal",text:e,ignoreCase:r}}function $(e,r,a){return{type:"class",parts:e,inverted:r,ignoreCase:a}}function ht(e){var r,a=oe[e];if(a)return a;for(r=e-1;!oe[r];)r--;for(a={line:(a=oe[r]).line,column:a.column};r<e;)10===i.charCodeAt(r)?(a.line++,a.column=1):a.column++,r++;return oe[e]=a,a}function d(e){n<J||(n>J&&(J=n,Le=[]),Le.push(e))}function gt(){var e,r;return e=n,p(),(r=E())!==t?(p(),e=ba(r)):(n=e,e=t),e}function yt(){var e,r,a,u,h,w,b,A;if(e=n,(r=E())!==t){for(a=[],u=n,h=p(),(w=ge())!==t?(b=p(),(A=E())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);u!==t;)a.push(u),u=n,h=p(),(w=ge())!==t?(b=p(),(A=E())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);e=Ta(r,a)}else n=e,e=t;return e}function E(){var e,r,a,u,h,w,b,A;if(e=n,(r=_e())!==t){for(a=[],u=n,h=p(),(w=Mt())!==t?(b=p(),(A=_e())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);u!==t;)a.push(u),u=n,h=p(),(w=Mt())!==t?(b=p(),(A=_e())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);e=xa(r,a)}else n=e,e=t;return e}function _e(){var e,r,a,u,h,w,b,A;if(e=n,(r=ie())!==t){for(a=[],u=n,h=p(),(w=de())!==t?(b=p(),(A=ie())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);u!==t;)a.push(u),u=n,h=p(),(w=de())!==t?(b=p(),(A=ie())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);e=Aa(r,a)}else n=e,e=t;return e}function ie(){var e,r,a,u,h;return e=n,(r=ne())===t&&(r=n,33===i.charCodeAt(n)?(a=V,n++):(a=t,0===c&&d(fr)),a!==t?(u=n,c++,61===i.charCodeAt(n)?(h=k,n++):(h=t,0===c&&d(it)),c--,h===t?u=void 0:(n=u,u=t),u!==t?r=a=[a,u]:(n=r,r=t)):(n=r,r=t)),r!==t?(a=p(),(u=ie())!==t?e=Ea(u):(n=e,e=t)):(n=e,e=t),e===t&&(e=function Hu(){var e,r,a;return e=n,(r=H())!==t?(p(),(a=function Vu(){var e;return(e=function qu(){var e,r,a,u,h,w;if(e=[],r=n,a=p(),(u=wt())!==t?(h=p(),(w=H())!==t?r=a=[a,u,h,w]:(n=r,r=t)):(n=r,r=t),r!==t)for(;r!==t;)e.push(r),r=n,a=p(),(u=wt())!==t?(h=p(),(w=H())!==t?r=a=[a,u,h,w]:(n=r,r=t)):(n=r,r=t);else e=t;return e!==t&&(e=Sa(e)),e}())===t&&(e=function ju(){var e,r,a,u;return e=n,(r=Me())!==t?(p(),(a=F())!==t?(p(),(u=yt())!==t?(p(),L()!==t?e=Ja(r,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t?(p(),(a=F())!==t?(p(),(u=L())!==t?e=Ua(r):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Me())!==t?(p(),(a=Je())!==t?e=ka(r,a):(n=e,e=t)):(n=e,e=t))),e}())===t&&(e=function Bu(){var e,r,a,u,h,w;return e=n,(r=ne())!==t?(p(),(a=Rt())!==t?(p(),(u=H())!==t?(p(),(h=de())!==t?(p(),(w=H())!==t?e=La(a,u,w):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Rt())!==t?(p(),(a=H())!==t?(p(),(u=de())!==t?(p(),(h=H())!==t?e=_a(r,a,h):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}())===t&&(e=function Wu(){var e,r,a,u;return e=n,(r=Lt())!==t?(p(),(a=ne())!==t?(p(),(u=H())!==t?e=Pa(r,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Lt())!==t?(p(),(a=H())!==t?e=Fa(r,a):(n=e,e=t)):(n=e,e=t)),e}())===t&&(e=function Gu(){var e,r,a,u;return e=n,(r=Nt())!==t?(p(),(a=K())!==t?(p(),function xo(){var e,r,a,u;return e=n,i.substr(n,6).toLowerCase()===wn?(r=i.substr(n,6),n+=6):(r=t,0===c&&d(Or)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=tu():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),(u=Ue())!==t?e=Da(r,a,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Nt())!==t?(p(),(a=K())!==t?e=Oa(r,a):(n=e,e=t)):(n=e,e=t)),e}()),e}())===t&&(a=null),e=Ca(r,a)):(n=e,e=t),e}()),e}function wt(){var e;return i.substr(n,2)===T?(e=T,n+=2):(e=t,0===c&&d(pr)),e===t&&(62===i.charCodeAt(n)?(e=S,n++):(e=t,0===c&&d(vr)),e===t&&(i.substr(n,2)===D?(e=D,n+=2):(e=t,0===c&&d(dr)),e===t&&(i.substr(n,2)===P?(e=P,n+=2):(e=t,0===c&&d(hr)),e===t&&(60===i.charCodeAt(n)?(e=on,n++):(e=t,0===c&&d(mr)),e===t&&(61===i.charCodeAt(n)?(e=k,n++):(e=t,0===c&&d(it)),e===t&&(i.substr(n,2)===tt?(e=tt,n+=2):(e=t,0===c&&d(gr)))))))),e}function Nt(){var e,r,a,u,h;return e=n,r=n,(a=ne())!==t?(u=p(),(h=_t())!==t?r=a=[a,u,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(r=Ma(r)),(e=r)===t&&(e=_t()),e}function Me(){var e,r,a,u,h;return e=n,r=n,(a=ne())!==t?(u=p(),(h=ke())!==t?r=a=[a,u,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(r=Ra(r)),(e=r)===t&&(e=ke()),e}function H(){var e,r,a,u,h,w,b,A;if(e=n,(r=Re())!==t){for(a=[],u=n,h=p(),(w=It())!==t?(b=p(),(A=Re())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);u!==t;)a.push(u),u=n,h=p(),(w=It())!==t?(b=p(),(A=Re())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);e=$a(r,a)}else n=e,e=t;return e}function It(){var e;return 43===i.charCodeAt(n)?(e=Ce,n++):(e=t,0===c&&d(Pe)),e===t&&(45===i.charCodeAt(n)?(e=Se,n++):(e=t,0===c&&d(Fe)),e===t&&(i.substr(n,2)===nt?(e=nt,n+=2):(e=t,0===c&&d(yr)))),e}function Re(){var e,r,a,u,h,w,b,A;if(e=n,(r=De())!==t){for(a=[],u=n,h=p(),(w=bt())!==t?(b=p(),(A=De())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);u!==t;)a.push(u),u=n,h=p(),(w=bt())!==t?(b=p(),(A=De())!==t?u=h=[h,w,b,A]:(n=u,u=t)):(n=u,u=t);e=Ha(r,a)}else n=e,e=t;return e}function bt(){var e;return 42===i.charCodeAt(n)?(e=ln,n++):(e=t,0===c&&d(wr)),e===t&&(47===i.charCodeAt(n)?(e=cn,n++):(e=t,0===c&&d(Nr))),e}function De(){var e,r;return(e=function so(){var e;return(e=Ue())===t&&(e=function yo(){var e,r,a,u;return e=n,(r=function wo(){var e,r,a,u;return e=n,(r=ve())!==t&&(a=St())!==t&&(u=Pt())!==t?e=qs(r,a,u):(n=e,e=t),e===t&&(e=n,(r=ve())!==t&&(a=St())!==t?e=Ws(r,a):(n=e,e=t),e===t&&(e=n,(r=ve())!==t&&(a=Pt())!==t?e=Bs(r,a):(n=e,e=t),e===t&&(e=n,(r=ve())!==t&&(r=Gs(r)),e=r))),e}())!==t?(a=n,c++,u=Oe(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Vs(r):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function vo(){var e,r;return e=n,(r=function bo(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===dn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(Lr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=r=[r,a]:(n=e,e=t)):(n=e,e=t),e}())!==t&&(r=_s()),(e=r)===t&&(e=n,(r=function To(){var e,r,a,u;return e=n,i.substr(n,5).toLowerCase()===hn?(r=i.substr(n,5),n+=5):(r=t,0===c&&d(_r)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=r=[r,a]:(n=e,e=t)):(n=e,e=t),e}())!==t&&(r=Ms()),e=r),e}())===t&&(e=function po(){var e;return(e=function Io(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===vn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(Fr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=r=[r,a]:(n=e,e=t)):(n=e,e=t),e}())!==t&&(e=Ls()),e}())===t&&(e=function fo(){var e,r;return e=n,Jt()!==t?(p(),(r=K())!==t?e=Fs(r):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function uo(){var e,r;return e=n,Ot()!==t?(p(),(r=K())!==t?e=is(r):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function oo(){var e,r,a,u;return e=n,Ut()!==t?(p(),45===i.charCodeAt(n)?(r=Se,n++):(r=t,0===c&&d(Fe)),r===t&&(43===i.charCodeAt(n)?(r=Ce,n++):(r=t,0===c&&d(Pe))),r!==t?(p(),(a=K())!==t?(p(),(u=Et())!==t?e=ls(r,a,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Ut()!==t?(p(),(r=K())!==t?(p(),(a=Et())!==t?e=cs(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}()),e}())===t&&(e=function Qu(){var e,r,a;return e=n,function Co(){var e,r,a,u;return e=n,i.substr(n,7).toLowerCase()===Cn?(r=i.substr(n,7),n+=7):(r=t,0===c&&d(Wr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=lu():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),F()!==t?(p(),(r=function ao(){var e;return(e=kt())===t&&(e=$t())===t&&(e=Ht())===t&&(e=Vt())===t&&(e=qt())===t&&(e=j()),e}())!==t?(p(),$e()!==t?(p(),(a=E())!==t?(p(),L()!==t?e=Ya(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function zu(){var e,r,a,u,h,w,b;return e=n,function Eo(){var e,r,a,u;return e=n,i.substr(n,9).toLowerCase()===En?(r=i.substr(n,9),n+=9):(r=t,0===c&&d(qr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=iu():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),F()!==t?(p(),(r=E())!==t?(p(),$e()!==t?(p(),(a=E())!==t?(p(),u=n,(h=function Ao(){var e,r,a,u;return e=n,i.substr(n,3).toLowerCase()===An?(r=i.substr(n,3),n+=3):(r=t,0===c&&d(Vr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=ou():(n=e,e=t)):(n=e,e=t),e}())!==t?(w=p(),(b=E())!==t?u=h=[h,w,b,p()]:(n=u,u=t)):(n=u,u=t),u===t&&(u=null),(h=L())!==t?e=Za(r,a,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function to(){var e,r,a,u;return e=n,Dt()!==t?(p(),F()!==t?(p(),(r=At())===t&&(r=null),p(),(a=E())!==t?(p(),$e()!==t?(p(),(u=E())!==t?(p(),L()!==t?e=as(r,a,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Dt()!==t?(p(),F()!==t?(p(),(r=At())===t&&(r=null),p(),(a=E())!==t?(p(),L()!==t?e=ss(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}())===t&&(e=function no(){var e,r,a;return e=n,function So(){var e,r,a,u;return e=n,i.substr(n,8).toLowerCase()===Pn?(r=i.substr(n,8),n+=8):(r=t,0===c&&d(Gr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=fu():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),F()!==t?(p(),(r=E())!==t?(p(),ke()!==t?(p(),(a=E())!==t?(p(),L()!==t?e=us(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function Xu(){var e,r,a;return e=n,function _o(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===Dn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(zr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=gu():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),F()!==t?(p(),(r=E())!==t?(p(),function Mo(){var e,r,a,u;return e=n,i.substr(n,2).toLowerCase()===On?(r=i.substr(n,2),n+=2):(r=t,0===c&&d(Xr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=yu():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),(a=function eo(){var e,r,a;return e=n,(r=function Ro(){var e,r,a,u;return e=n,i.substr(n,7).toLowerCase()===Jn?(r=i.substr(n,7),n+=7):(r=t,0===c&&d(ea)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=wu():(n=e,e=t)):(n=e,e=t),e}())!==t&&(r=Qa()),(e=r)===t&&(e=n,(r=function Do(){var e,r,a,u;return e=n,i.substr(n,8).toLowerCase()===Un?(r=i.substr(n,8),n+=8):(r=t,0===c&&d(ta)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Nu():(n=e,e=t)):(n=e,e=t),e}())!==t&&(r=za()),(e=r)===t&&(e=n,(r=function Oo(){var e,r,a,u;return e=n,i.substr(n,5).toLowerCase()===kn?(r=i.substr(n,5),n+=5):(r=t,0===c&&d(na)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Iu():(n=e,e=t)):(n=e,e=t),e}())!==t&&(r=Xa()),(e=r)===t&&(e=n,(r=function Jo(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===$n?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(ra)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=bu():(n=e,e=t)):(n=e,e=t),e}())!==t&&(r=es()),(e=r)===t&&(e=n,(r=Jt())!==t&&(r=ts()),(e=r)===t&&(e=n,(r=Ot())!==t&&(r=ns()),(e=r)===t&&(e=n,(r=function Uo(){var e,r,a,u;return e=n,i.substr(n,7).toLowerCase()===Hn?(r=i.substr(n,7),n+=7):(r=t,0===c&&d(aa)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Tu():(n=e,e=t)):(n=e,e=t),e}())!==t?(p(),F()!==t?(p(),(a=G())!==t?(p(),L()!==t?e=rs(a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t))))))),e}())!==t?(p(),L()!==t?e=Ka(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function ro(){var e,r,a;return e=n,(r=function Ho(){var e,r,a,u;if(e=n,(r=Tt())!==t&&(r=Ju(r)),(e=r)===t)if(e=n,96===i.charCodeAt(n)?(r=st,n++):(r=t,0===c&&d(pt)),r!==t){if(a=[],ot.test(i.charAt(n))?(u=i.charAt(n),n++):(u=t,0===c&&d(vt)),u!==t)for(;u!==t;)a.push(u),ot.test(i.charAt(n))?(u=i.charAt(n),n++):(u=t,0===c&&d(vt));else a=t;a!==t?(96===i.charCodeAt(n)?(u=st,n++):(u=t,0===c&&d(pt)),u!==t?e=Uu(a):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}())!==t?(p(),F()!==t?(p(),(a=yt())===t&&(a=null),p(),L()!==t?e=os(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function ho(){var e;return(e=function mo(){var e,r,a,u,h;if(e=n,he()!==t)if(p(),(r=E())!==t){for(p(),a=[],u=pe();u!==t;)a.push(u),u=pe();u=p(),(h=me())!==t?e=Ds(r,a):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,he()!==t)if(p(),(r=E())!==t){for(p(),a=[],u=pe();u!==t;)a.push(u),u=pe();u=p(),(h=Ct())!==t?(p(),me()!==t?e=Os(r,a,h):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}())===t&&(e=function go(){var e,r,a,u;if(e=n,he()!==t){for(p(),r=[],a=fe();a!==t;)r.push(a),a=fe();a=p(),(u=me())!==t?e=Js(r):(n=e,e=t)}else n=e,e=t;if(e===t)if(e=n,he()!==t){for(p(),r=[],a=fe();a!==t;)r.push(a),a=fe();a=p(),(u=Ct())!==t?(p(),me()!==t?e=Us(r,u):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}()),e}())===t&&(e=function Yu(){var e;return(e=function Zu(){var e;return(e=function Ku(){var e,r,a,u;if(e=n,(r=Oe())!==t){for(a=[],u=xt();u!==t;)a.push(u),u=xt();e=Ba(r,a)}else n=e,e=t;return e}())!==t&&(e=Wa(e)),e}())!==t&&(e=qa(e)),e}())===t&&(e=Je())===t&&(e=n,F()!==t?(p(),(r=E())!==t?(p(),L()!==t?e=Va(r):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Tt(){var e,r,a,u;if(e=n,(r=Oe())!==t){for(a=[],u=y();u!==t;)a.push(u),u=y();e=Ga(r,a)}else n=e,e=t;return e}function Oe(){var e;return ar.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&d(Ir)),e}function y(){var e;return sr.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&d(br)),e}function xt(){var e;return ur.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&d(Tr)),e}function Je(){var e,r,a;return e=n,64===i.charCodeAt(n)?(r=fn,n++):(r=t,0===c&&d(xr)),r!==t&&(a=Tt())!==t?e=r=[r,a]:(n=e,e=t),e!==t&&(e=ja(e)),e}function At(){var e;return(e=function Po(){var e,r,a,u;return e=n,i.substr(n,7).toLowerCase()===_n?(r=i.substr(n,7),n+=7):(r=t,0===c&&d(Zr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=du():(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function Fo(){var e,r,a,u;return e=n,i.substr(n,8).toLowerCase()===Mn?(r=i.substr(n,8),n+=8):(r=t,0===c&&d(Kr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=hu():(n=e,e=t)):(n=e,e=t),e}())===t&&(e=function Lo(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===Rn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(Qr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=mu():(n=e,e=t)):(n=e,e=t),e}()),e}function Et(){var e,r,a;return e=n,(r=function io(){var e,r,a;return e=n,(r=te())!==t?(p(),F()!==t?(p(),(a=ce())!==t?(p(),L()!==t?e=ps(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=te())!==t&&(r=vs(r)),e=r),e}())!==t?(p(),function ko(){var e,r,a,u;return e=n,i.substr(n,2).toLowerCase()===Vn?(r=i.substr(n,2),n+=2):(r=t,0===c&&d(sa)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=xu():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),(a=function lo(){var e,r,a,u;return e=n,(r=te())!==t&&(r=ds(r)),(e=r)===t&&(e=n,(r=j())!==t?(p(),F()!==t?(p(),(a=ce())!==t?(p(),ge()!==t?(p(),(u=le())!==t?(p(),L()!==t?e=hs(a,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=j())!==t?(p(),F()!==t?(p(),(a=ce())!==t?(p(),L()!==t?e=ms(a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=j())!==t&&(r=gs()),e=r))),e}())!==t?e=fs(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=function co(){var e,r,a,u;return e=n,(r=te())!==t?(p(),F()!==t?(p(),(a=le())!==t?(p(),L()!==t?e=ys(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=te())!==t&&(r=ws(r)),(e=r)===t&&(e=n,(r=j())!==t?(p(),F()!==t?(p(),(a=ce())!==t?(p(),ge()!==t?(p(),(u=le())!==t?(p(),L()!==t?e=Ns(a,u):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=j())!==t?(p(),F()!==t?(p(),(a=le())!==t?(p(),L()!==t?e=Is(a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=j())!==t&&(r=bs()),e=r)))),e}()),e}function te(){var e,r;return e=n,(r=Ht())!==t&&(r=Ts()),(e=r)===t&&(e=n,(r=Vt())!==t&&(r=xs()),(e=r)===t&&(e=n,(r=qt())!==t&&(r=As()),(e=r)===t&&(e=n,(r=$t())!==t&&(r=Es()),(e=r)===t&&(e=n,(r=kt())!==t&&(r=Cs()),e=r)))),e}function le(){var e;return(e=G())!==t&&(e=Ss(e)),e}function ce(){var e;return(e=G())!==t&&(e=Ps(e)),e}function K(){var e;return(e=Ue())===t&&(e=Je()),e}function Ue(){var e,r,a,u,h;if(e=n,39===i.charCodeAt(n)?(r=rt,n++):(r=t,0===c&&d(lt)),r===t&&(i.substr(n,2)===at?(r=at,n+=2):(r=t,0===c&&d(Ar))),r!==t){for(a=[],u=n,i.substr(n,2)===ue?(h=ue,n+=2):(h=t,0===c&&d(ct)),h!==t&&(h=dt()),(u=h)===t&&(ut.test(i.charAt(n))?(u=i.charAt(n),n++):(u=t,0===c&&d(ft)));u!==t;)a.push(u),u=n,i.substr(n,2)===ue?(h=ue,n+=2):(h=t,0===c&&d(ct)),h!==t&&(h=dt()),(u=h)===t&&(ut.test(i.charAt(n))?(u=i.charAt(n),n++):(u=t,0===c&&d(ft)));39===i.charCodeAt(n)?(u=rt,n++):(u=t,0===c&&d(lt)),u!==t?e=Rs(a):(n=e,e=t)}else n=e,e=t;return e}function fe(){var e,r,a;return e=n,Wt()!==t?(p(),(r=E())!==t?(p(),Bt()!==t?(p(),(a=E())!==t?e=ks(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function pe(){var e,r,a;return e=n,Wt()!==t?(p(),(r=E())!==t?(p(),Bt()!==t?(p(),(a=E())!==t?e=$s(r,a):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Ct(){var e,r;return e=n,function $o(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===er?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(ga)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Ou():(n=e,e=t)):(n=e,e=t),e}()!==t?(p(),(r=E())!==t?e=Hs(r):(n=e,e=t)):(n=e,e=t),e}function ve(){var e,r,a;return(e=G())===t&&(e=n,45===i.charCodeAt(n)?(r=Se,n++):(r=t,0===c&&d(Fe)),r===t&&(43===i.charCodeAt(n)?(r=Ce,n++):(r=t,0===c&&d(Pe))),r!==t&&(a=G())!==t?e=js(r,a):(n=e,e=t)),e}function St(){var e,r,a;return e=n,46===i.charCodeAt(n)?(r=pn,n++):(r=t,0===c&&d(Er)),r!==t?((a=G())===t&&(a=null),e=Ys(a)):(n=e,e=t),e}function Pt(){var e,r,a;return e=n,(r=function No(){var e,r,a;return e=n,ir.test(i.charAt(n))?(r=i.charAt(n),n++):(r=t,0===c&&d(Sr)),r!==t?(lr.test(i.charAt(n))?(a=i.charAt(n),n++):(a=t,0===c&&d(Pr)),a===t&&(a=null),e=Qs(r,a)):(n=e,e=t),e}())!==t&&(a=G())!==t?e=Zs(r,a):(n=e,e=t),e}function G(){var e,r;if(e=[],(r=Ft())!==t)for(;r!==t;)e.push(r),r=Ft();else e=t;return e!==t&&(e=Ks(e)),e}function Ft(){var e;return or.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&d(Cr)),e}function ke(){var e,r,a,u;return e=n,i.substr(n,2).toLowerCase()===mn?(r=i.substr(n,2),n+=2):(r=t,0===c&&d(Mr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=zs():(n=e,e=t)):(n=e,e=t),e}function Lt(){var e,r,a,u;return e=n,i.substr(n,2).toLowerCase()===gn?(r=i.substr(n,2),n+=2):(r=t,0===c&&d(Rr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Xs():(n=e,e=t)):(n=e,e=t),e}function _t(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===yn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(Dr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=eu():(n=e,e=t)):(n=e,e=t),e}function ne(){var e,r,a,u;return e=n,i.substr(n,3).toLowerCase()===Nn?(r=i.substr(n,3),n+=3):(r=t,0===c&&d(Jr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=nu():(n=e,e=t)):(n=e,e=t),e}function de(){var e,r,a,u;return e=n,i.substr(n,3).toLowerCase()===In?(r=i.substr(n,3),n+=3):(r=t,0===c&&d(Ur)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=ru():(n=e,e=t)):(n=e,e=t),e}function Mt(){var e,r,a,u;return e=n,i.substr(n,2).toLowerCase()===bn?(r=i.substr(n,2),n+=2):(r=t,0===c&&d(kr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=au():(n=e,e=t)):(n=e,e=t),e}function Rt(){var e,r,a,u;return e=n,i.substr(n,7).toLowerCase()===Tn?(r=i.substr(n,7),n+=7):(r=t,0===c&&d($r)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=su():(n=e,e=t)):(n=e,e=t),e}function $e(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===xn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(Hr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=uu():(n=e,e=t)):(n=e,e=t),e}function Dt(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===Sn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(Br)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=cu():(n=e,e=t)):(n=e,e=t),e}function Ot(){var e,r,a,u;return e=n,i.substr(n,9).toLowerCase()===Fn?(r=i.substr(n,9),n+=9):(r=t,0===c&&d(jr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=pu():(n=e,e=t)):(n=e,e=t),e}function Jt(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===Ln?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(Yr)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=vu():(n=e,e=t)):(n=e,e=t),e}function Ut(){var e,r,a,u;return e=n,i.substr(n,8).toLowerCase()===qn?(r=i.substr(n,8),n+=8):(r=t,0===c&&d(ua)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Au():(n=e,e=t)):(n=e,e=t),e}function kt(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===Wn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(oa)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Eu():(n=e,e=t)):(n=e,e=t),e}function $t(){var e,r,a,u;return e=n,i.substr(n,5).toLowerCase()===Bn?(r=i.substr(n,5),n+=5):(r=t,0===c&&d(ia)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Cu():(n=e,e=t)):(n=e,e=t),e}function Ht(){var e,r,a,u;return e=n,i.substr(n,3).toLowerCase()===Gn?(r=i.substr(n,3),n+=3):(r=t,0===c&&d(la)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Su():(n=e,e=t)):(n=e,e=t),e}function Vt(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===jn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(ca)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Pu():(n=e,e=t)):(n=e,e=t),e}function qt(){var e,r,a,u;return e=n,i.substr(n,6).toLowerCase()===Yn?(r=i.substr(n,6),n+=6):(r=t,0===c&&d(fa)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Fu():(n=e,e=t)):(n=e,e=t),e}function j(){var e,r,a,u;return e=n,i.substr(n,6).toLowerCase()===Zn?(r=i.substr(n,6),n+=6):(r=t,0===c&&d(pa)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Lu():(n=e,e=t)):(n=e,e=t),e}function he(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===Kn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(va)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=_u():(n=e,e=t)):(n=e,e=t),e}function me(){var e,r,a,u;return e=n,i.substr(n,3).toLowerCase()===Qn?(r=i.substr(n,3),n+=3):(r=t,0===c&&d(da)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Mu():(n=e,e=t)):(n=e,e=t),e}function Wt(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===zn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(ha)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Ru():(n=e,e=t)):(n=e,e=t),e}function Bt(){var e,r,a,u;return e=n,i.substr(n,4).toLowerCase()===Xn?(r=i.substr(n,4),n+=4):(r=t,0===c&&d(ma)),r!==t?(a=n,c++,u=y(),c--,u===t?a=void 0:(n=a,a=t),a!==t?e=Du():(n=e,e=t)):(n=e,e=t),e}function ge(){var e;return 44===i.charCodeAt(n)?(e=tr,n++):(e=t,0===c&&d(ya)),e}function F(){var e;return 40===i.charCodeAt(n)?(e=nr,n++):(e=t,0===c&&d(wa)),e}function L(){var e;return 41===i.charCodeAt(n)?(e=rr,n++):(e=t,0===c&&d(Na)),e}function p(){var e,r;for(e=[],r=Gt();r!==t;)e.push(r),r=Gt();return e}function Gt(){var e;return cr.test(i.charAt(n))?(e=i.charAt(n),n++):(e=t,0===c&&d(Ia)),e}function jt(e,r,a,u){var h={type:"binary-expression",operator:e,left:r,right:a};return void 0!==u&&(h.escape=u),h}function re(e,r){for(var a=e,u=0;u<r.length;u++)a=jt(r[u][1],a,r[u][3]);return a}if((m=R())!==t&&n===i.length)return m;throw m!==t&&n<i.length&&d({type:"end"}),function $u(e,r,a){return new s(s.buildMessage(e,r),e,r,a)}(Le,J<i.length?i.charAt(J):null,function mt(e,r){var a=ht(e),u=ht(r);return{source:I,start:{offset:e,line:a.line,column:a.column},end:{offset:r,line:u.line,column:u.column}}}(J,J<i.length?J+1:J))}}}());class zt{static parse(s){return Ie.parse(s)}}const Ge=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,Xt=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,en=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,tn=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,nn=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,rn=new Set(["current_timestamp","current_date","current_time"]);function q(l,s){return(l+="").length>=s?l:new Array(s-l.length+1).join("0")+l}function ee(l,s,o="0",f="0",i="0",v="0",m="",t="0",I="0"){if("+"===m||"-"===m){const x=`${q(parseInt(l,10),4)}-${q(parseInt(s,10),2)}-${q(parseInt(o,10),2)}`;let R="";parseFloat(v)<10&&(R="0");const V=`${q(parseInt(f,10),2)}:${q(parseInt(i,10),2)}:${R+parseFloat(v).toString()}`,k=`${m}${q(parseInt(t,10),2)}:${q(parseInt(I,10),2)}`;return new Date(x+"T"+V+k)}return new Date(parseInt(l,10),parseInt(s,10)-1,parseInt(o,10),parseInt(f,10),parseInt(i,10),parseFloat(v))}class an{static makeBool(s){return Ye(s)}static featureValue(s,o,f,i){return et(s,o,f,i)}static equalsNull(s){return null===s}static applyLike(s,o,f){return Ee(s,o,f)}static ensureArray(s){return xe(s)}static applyIn(s,o){return Ae(s,o)}static currentDate(){const s=new Date;return s.setHours(0,0,0,0),s}static makeSqlInterval(s,o,f){return C.createFromValueAndQualifer(s,o,f)}static convertInterval(s){return s instanceof C?s.valueInMilliseconds():s}static currentTimestamp(){return new Date}static compare(s,o,f){return ze(s,o,f)}static calculate(s,o,f){return Xe(s,o,f)}static makeComparable(s){return U(s)}static evaluateFunction(s,o){return Ne(s,o)}static lookup(s,o){const f=o[s];return void 0===f?null:f}static between(s,o){return null==s||null==o[0]||null==o[1]?null:s>=o[0]&&s<=o[1]}static notbetween(s,o){return null==s||null==o[0]||null==o[1]?null:s<o[0]||s>o[1]}static ternaryNot(s){return se(s)}static ternaryAnd(s,o){return Ze(s,o)}static ternaryOr(s,o){return Ke(s,o)}}class be{constructor(s,o){this.fieldsIndex=o,this._datefields={},this.parameters={},this._hasDateFunctions=void 0,this.parseTree=zt.parse(s);const{isStandardized:f,isAggregate:i,referencedFieldNames:v}=this._extractExpressionInfo(o);this._referencedFieldNames=v,this.isStandardized=f,this.isAggregate=i}static create(s,o){return new be(s,o)}get fieldNames(){return this._referencedFieldNames}testSet(s,o=B){const f={};for(const i of this.fieldNames)f[i]=s.map(v=>o.getAttribute(v,i));return!!this._evaluateNode(this.parseTree,{attributes:f},B)}calculateValue(s,o=B){const f=this._evaluateNode(this.parseTree,s,o);return f instanceof C?f.valueInMilliseconds()/864e5:f}calculateValueCompiled(s,o=B){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(s,this.parameters,o,this._datefields):(0,Q.Z)("esri-csp-restrictions")?this.calculateValue(s,o):(this._compileMe(),this.parseTree._compiledVersion(s,this.parameters,o,this._datefields))}testFeature(s,o=B){return!!this._evaluateNode(this.parseTree,s,o)}testFeatureCompiled(s,o=B){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(s,this.parameters,o,this._datefields):(0,Q.Z)("esri-csp-restrictions")?this.testFeature(s,o):(this._compileMe(),!!this.parseTree._compiledVersion(s,this.parameters,o,this._datefields))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,this._visitAll(this.parseTree,s=>{"current-time"===s.type?this._hasDateFunctions=!0:"function"===s.type&&(this._hasDateFunctions=this._hasDateFunctions||rn.has(s.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const s=new Set;return this._visitAll(this.parseTree,o=>{"function"===o.type&&s.add(o.name.toLowerCase())}),Array.from(s)}getExpressions(){const s=new Map;return this._visitAll(this.parseTree,o=>{if("function"===o.type){const f=o.name.toLowerCase(),i=o.args.value[0];if("column-reference"===i.type){const v=i.column,m=`${f}-${v}`;s.has(m)||s.set(m,{aggregateType:f,field:v})}}}),[...s.values()]}getVariables(){const s=new Set;return this._visitAll(this.parseTree,o=>{"parameter"===o.type&&s.add(o.value.toLowerCase())}),Array.from(s)}_compileMe(){const s="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",s).bind(an)}_extractExpressionInfo(s){const o=[],f=new Set;let i=!0,v=!0;return this._visitAll(this.parseTree,m=>{switch(m.type){case"column-reference":{const t=s?.get(m.column);let I,x;t?I=x=t.name??"":(x=m.column,I=x.toLowerCase()),t&&t.name&&("date"===t.type||"esriFieldTypeDate"===t.type)&&(this._datefields[t.name]=1),f.has(I)||(f.add(I),o.push(x)),m.column=x;break}case"function":{const{name:t,args:I}=m,x=I.value.length;i&&(i=function Zt(l,s){const o=qe[l.toLowerCase()];return null!=o&&s>=o.minParams&&s<=o.maxParams}(t,x)),v&&(v=function ye(l,s){const o=Y[l.toLowerCase()];return null!=o&&s>=o.minParams&&s<=o.maxParams}(t,x));break}}}),{referencedFieldNames:Array.from(o),isStandardized:i,isAggregate:v}}_visitAll(s,o){if(null!=s)switch(o(s),s.type){case"when-clause":this._visitAll(s.operand,o),this._visitAll(s.value,o);break;case"case-expression":for(const f of s.clauses)this._visitAll(f,o);"simple"===s.format&&this._visitAll(s.operand,o),null!==s.else&&this._visitAll(s.else,o);break;case"expression-list":for(const f of s.value)this._visitAll(f,o);break;case"unary-expression":this._visitAll(s.expr,o);break;case"binary-expression":this._visitAll(s.left,o),this._visitAll(s.right,o);break;case"function":this._visitAll(s.args,o)}}evaluateNodeToJavaScript(s){switch(s.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(s.value)+", "+JSON.stringify(s.qualifier)+","+JSON.stringify(s.op)+")";case"case-expression":{let o="";if("simple"===s.format){const f="this.makeComparable("+this.evaluateNodeToJavaScript(s.operand)+")";o="( ";for(let i=0;i<s.clauses.length;i++)o+=" ("+f+" === this.makeComparable("+this.evaluateNodeToJavaScript(s.clauses[i].operand)+")) ? ("+this.evaluateNodeToJavaScript(s.clauses[i].value)+") : ";o+=null!==s.else?this.evaluateNodeToJavaScript(s.else):"null",o+=" )"}else{o="( ";for(let f=0;f<s.clauses.length;f++)o+=" this.makeBool("+this.evaluateNodeToJavaScript(s.clauses[f].operand)+")===true ? ("+this.evaluateNodeToJavaScript(s.clauses[f].value)+") : ";o+=null!==s.else?this.evaluateNodeToJavaScript(s.else):"null",o+=" )"}return o}case"parameter":return"this.lookup("+JSON.stringify(s.value.toLowerCase())+",lookups)";case"expression-list":{let o="[";for(const f of s.value)"["!==o&&(o+=","),o+=this.evaluateNodeToJavaScript(f);return o+="]",o}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(s.expr)+")";case"binary-expression":switch(s.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+" )";case"IS":if("null"!==s.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(s.left)+")";case"ISNOT":if("null"!==s.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(s.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(s.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(s.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(s.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(s.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+","+JSON.stringify(s.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+","+JSON.stringify(s.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(s.operator)+","+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+")";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(s.operator)+","+this.evaluateNodeToJavaScript(s.left)+","+this.evaluateNodeToJavaScript(s.right)+")"}throw new Error("Not Supported Operator "+s.operator);case"null":case"boolean":case"string":case"number":return JSON.stringify(s.value);case"date":return"(new Date("+je(s.value).getTime().toString()+"))";case"timestamp":return"(new Date("+Te(s.value).getTime().toString()+"))";case"current-time":return"date"===s.mode?"this.currentDate()":"this.currentTimestamp()";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(s.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(s.name)+","+this.evaluateNodeToJavaScript(s.args)+")"}throw new Error("Unsupported sql syntax "+s.type)}_evaluateNode(s,o,f){switch(s.type){case"interval":{const i=this._evaluateNode(s.value,o,f);return C.createFromValueAndQualifer(i,s.qualifier,s.op)}case"case-expression":if("simple"===s.format){const i=U(this._evaluateNode(s.operand,o,f));for(let v=0;v<s.clauses.length;v++)if(i===U(this._evaluateNode(s.clauses[v].operand,o,f)))return this._evaluateNode(s.clauses[v].value,o,f);if(null!==s.else)return this._evaluateNode(s.else,o,f)}else{for(let i=0;i<s.clauses.length;i++)if(Ye(this._evaluateNode(s.clauses[i].operand,o,f)))return this._evaluateNode(s.clauses[i].value,o,f);if(null!==s.else)return this._evaluateNode(s.else,o,f)}return null;case"parameter":return this.parameters[s.value.toLowerCase()];case"expression-list":{const i=[];for(const v of s.value)i.push(this._evaluateNode(v,o,f));return i}case"unary-expression":return se(this._evaluateNode(s.expr,o,f));case"binary-expression":switch(s.operator){case"AND":return Ze(this._evaluateNode(s.left,o,f),this._evaluateNode(s.right,o,f));case"OR":return Ke(this._evaluateNode(s.left,o,f),this._evaluateNode(s.right,o,f));case"IS":if("null"!==s.right.type)throw new Error("Unsupported RHS for IS");return null===this._evaluateNode(s.left,o,f);case"ISNOT":if("null"!==s.right.type)throw new Error("Unsupported RHS for IS");return null!==this._evaluateNode(s.left,o,f);case"IN":{const i=xe(this._evaluateNode(s.right,o,f));return Ae(this._evaluateNode(s.left,o,f),i)}case"NOT IN":{const i=xe(this._evaluateNode(s.right,o,f));return se(Ae(this._evaluateNode(s.left,o,f),i))}case"BETWEEN":{const i=this._evaluateNode(s.left,o,f),v=this._evaluateNode(s.right,o,f);return null==i||null==v[0]||null==v[1]?null:i>=U(v[0])&&i<=U(v[1])}case"NOTBETWEEN":{const i=this._evaluateNode(s.left,o,f),v=this._evaluateNode(s.right,o,f);return null==i||null==v[0]||null==v[1]?null:i<U(v[0])||i>U(v[1])}case"LIKE":return Ee(this._evaluateNode(s.left,o,f),this._evaluateNode(s.right,o,f),s.escape);case"NOT LIKE":return se(Ee(this._evaluateNode(s.left,o,f),this._evaluateNode(s.right,o,f),s.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return ze(s.operator,this._evaluateNode(s.left,o,f),this._evaluateNode(s.right,o,f));case"-":case"+":case"*":case"/":case"||":return Xe(s.operator,this._evaluateNode(s.left,o,f),this._evaluateNode(s.right,o,f))}case"null":case"boolean":case"string":case"number":return s.value;case"date":return je(s.value);case"timestamp":return Te(s.value);case"current-time":{const i=new Date;return"date"===s.mode&&i.setHours(0,0,0,0),i}case"column-reference":return et(o,s.column,this._datefields,f);case"data-type":return s.value;case"function":{const i=this._evaluateNode(s.args,o,f);return this.isAggregate?function M(l,s){const o=Y[l.toLowerCase()];if(null==o)throw new Error("Function Not Recognised");if(s.length<o.minParams||s.length>o.maxParams)throw new Error(`Invalid Parameter count for call to ${l.toUpperCase()}`);return o.evaluate(s)}(s.name,i):Ne(s.name,i)}}throw new Error("Unsupported sql syntax "+s.type)}}function Te(l){let s=Xt.exec(l);if(null!==s){const[,o,f,i,v,m,t]=s;return ee(o,f,i,v,m,t)}if(s=en.exec(l),null!==s){const[,o,f,i,v,m,t,I,x,R]=s;return ee(o,f,i,v,m,t,I,x,R)}if(s=tn.exec(l),null!==s){const[,o,f,i,v,m,t,I,x]=s;return ee(o,f,i,v,m,"0",t,I,x)}if(s=nn.exec(l),null!==s){const[,o,f,i,v,m]=s;return ee(o,f,i,v,m)}if(s=Ge.exec(l),null!==s){const[,o,f,i]=s;return ee(o,f,i)}throw new Error("SQL Invalid Timestamp")}function je(l){const s=Ge.exec(l);if(null===s)try{return Te(l)}catch{throw new Error("SQL Invalid Date")}const[,o,f,i]=s;return new Date(parseInt(o,10),parseInt(f,10)-1,parseInt(i,10))}function Ye(l){return!0===l}function xe(l){return Array.isArray(l)?l:[l]}function se(l){return null!==l?!0!==l:null}function Ze(l,s){return null!=l&&null!=s?!0===l&&!0===s:!1!==l&&!1!==s&&null}function Ke(l,s){return null!=l&&null!=s?!0===l||!0===s:!0===l||!0===s||null}function Ae(l,s){if(null==l)return null;let o=!1;for(const f of s)if(null==f)o=null;else if(l===f){o=!0;break}return o}const Qe="-[]/{}()*+?.\\^$|";var W,l;function Ee(l,s,o){return null==l?null:function sn(l,s){const o=s;let f="",i=W.Normal;for(let v=0;v<l.length;v++){const m=l.charAt(v);switch(i){case W.Normal:m===o?i=W.Escaped:Qe.includes(m)?f+="\\"+m:f+="%"===m?".*":"_"===m?".":m;break;case W.Escaped:Qe.includes(m)?f+="\\"+m:f+=m,i=W.Normal}}return new RegExp("^"+f+"$","m")}(s,o).test(l)}function U(l){return l instanceof Date?l.valueOf():l}function ze(l,s,o){if(null==s||null==o)return null;const f=U(s),i=U(o);switch(l){case"<>":return f!==i;case"=":return f===i;case">":return f>i;case"<":return f<i;case">=":return f>=i;case"<=":return f<=i}}function Xe(l,s,o){if("||"===l)return Ne("concat",[s,o]);if(s instanceof C)if(o instanceof Date)switch(l){case"+":return new Date(s.valueInMilliseconds()+o.getTime());case"-":return s.valueInMilliseconds()-o.getTime();case"*":return s.valueInMilliseconds()*o.getTime();case"/":return s.valueInMilliseconds()/o.getTime()}else if(o instanceof C)switch(l){case"+":return C.createFromMilliseconds(s.valueInMilliseconds()+o.valueInMilliseconds());case"-":return C.createFromMilliseconds(s.valueInMilliseconds()-o.valueInMilliseconds());case"*":return s.valueInMilliseconds()*o.valueInMilliseconds();case"/":return s.valueInMilliseconds()/o.valueInMilliseconds()}else s=s.valueInMilliseconds();else if(o instanceof C)if(s instanceof Date)switch(l){case"+":return new Date(o.valueInMilliseconds()+s.getTime());case"-":return new Date(s.getTime()-o.valueInMilliseconds());case"*":return s.getTime()*o.valueInMilliseconds();case"/":return s.getTime()/o.valueInMilliseconds()}else o=o.valueInMilliseconds();else if(s instanceof Date&&"number"==typeof o)switch(o=24*o*60*60*1e3,s=s.getTime(),l){case"+":return new Date(s+o);case"-":return new Date(s-o);case"*":return new Date(s*o);case"/":return new Date(s/o)}else if(o instanceof Date&&"number"==typeof s)switch(s=24*s*60*60*1e3,o=o.getTime(),l){case"+":return new Date(s+o);case"-":return new Date(s-o);case"*":return new Date(s*o);case"/":return new Date(s/o)}switch(l){case"+":return s+o;case"-":return s-o;case"*":return s*o;case"/":return s/o}}function et(l,s,o,f){const i=f.getAttribute(l,s);return null!=i&&1===o[s]?new Date(i):i}(l=W||(W={}))[l.Normal=0]="Normal",l[l.Escaped=1]="Escaped";const B={getAttribute:(l,s)=>(function un(l){return l&&"object"==typeof l.attributes}(l)?l.attributes:l)[s]}}}]);
//# sourceMappingURL=753.45a897678164bcf1.js.map