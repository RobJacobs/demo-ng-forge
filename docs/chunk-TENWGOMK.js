import{a as Je}from"./chunk-AS3IUQRI.js";import{a as Xe}from"./chunk-AQM4HU7X.js";import{a as Ye}from"./chunk-7OND2EID.js";import"./chunk-T7MAX6OV.js";import{a as Qe}from"./chunk-JMGMC3YK.js";import"./chunk-Q65ABCTW.js";import"./chunk-JWSBDH3Q.js";import{Ab as B,E as M,Hb as xe,Ib as Pe,Jb as we,Kc as He,Lc as $e,Ob as q,Pb as H,Ub as $,Vb as ye,Wb as Oe,Xb as Me,cc as Ee,d as ge,dc as Fe,eb as ve,ec as Te,fc as ke,g as _e,gb as N,gc as De,i as Ce,ib as Se,ic as Ve,jc as Ne,k as V,kb as G,kc as Ge,kd as j,lb as I,ld as Q,nb as b,nc as Ie,ob as f,oc as U,pc as Re,pd as Ue,qb as R,qc as K,qd as Ke,rd as je,tb as A,ub as be,vc as Ae,wb as L,wc as Le,xc as Be,yc as qe}from"./chunk-TDRYUBHM.js";import{$a as c,$b as de,Ab as x,Bb as P,Cb as F,Db as w,Gb as p,Ha as ne,Hb as _,Mb as se,Nb as ce,Ob as me,Pb as y,Qb as s,Rb as O,Yb as pe,Zb as T,_ as oe,_b as k,bc as he,cc as fe,fa as C,fb as ie,gc as D,jb as ae,ka as E,m as W,ma as re,mb as S,pb as d,q as ee,s as te,tb as X,ub as le,uc as ue,va as u,vb as Y,wa as g,wb as Z,xb as i,yb as a,zb as m}from"./chunk-UO34YWUS.js";import{a as J}from"./chunk-NCBA65HR.js";var We={provide:ve,useExisting:oe(()=>z),multi:!0},z=(()=>{class n{constructor(){this.renderer=C(ie),this.elementRef=C(ne),this.threeStateEnabled=!1,this.onChange=e=>{},this.onTouched=()=>{}}hostChange(e){this.threeStateEnabled?(this.value=this.value===!0?!1:this.value===!1?null:!0,this.setCheckboxState()):this.value=this.elementRef.nativeElement.checked,this.onChange(this.value),this.onTouched()}hostBlur(){this.onTouched()}set threeState(e){this.threeStateEnabled!==e&&(this.threeStateEnabled=e,!this.threeStateEnabled&&this.elementRef.nativeElement.indeterminate&&(this.renderer.setProperty(this.elementRef.nativeElement,"indeterminate",!1),this.value=!1),this.setCheckboxState())}writeValue(e){this.value!==e&&(this.value=e,this.setCheckboxState())}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.renderer.setProperty(this.elementRef.nativeElement,"disabled",e)}setCheckboxState(){this.threeStateEnabled?this.value===!0?(this.renderer.setProperty(this.elementRef.nativeElement,"indeterminate",!1),requestAnimationFrame(()=>{this.renderer.setProperty(this.elementRef.nativeElement,"checked",!0)})):this.value===!1?(this.renderer.setProperty(this.elementRef.nativeElement,"indeterminate",!1),requestAnimationFrame(()=>{this.renderer.setProperty(this.elementRef.nativeElement,"checked",!1)})):(this.renderer.setProperty(this.elementRef.nativeElement,"checked",!1),requestAnimationFrame(()=>{this.renderer.setProperty(this.elementRef.nativeElement,"indeterminate",!0)})):this.renderer.setProperty(this.elementRef.nativeElement,"checked",!!this.value)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=re({type:n,selectors:[["forge-checkbox","formControlName",""],["forge-checkbox","formControl",""],["forge-checkbox","ngModel",""]],hostBindings:function(r,o){r&1&&p("change",function(l){return o.hostChange(l)})("blur",function(){return o.hostBlur()})},inputs:{threeState:[2,"threeState","threeState",ue]},standalone:!0,features:[pe([We]),ae]})}}return n})();var ze=(()=>{class n{constructor(){this.dialogConfig=C(ke),this.dialogRef=C(De),this.formGroup=new b({name:new f(null,{validators:[Se.required]}),description:new f,isDefault:new f,isPublic:new f}),this.record=this.dialogConfig,this.formGroup.patchValue(this.record)}onSave(){this.dialogRef.close(J(J({},this.record),this.formGroup.getRawValue()))}onCancel(){this.formGroup.markAsPristine(),this.dialogRef.close(!1)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-search-save"]],standalone:!0,features:[T],decls:22,vars:3,consts:[["dialogTitle","Save search"],["novalidate","","autocomplete","off",1,"form-grid",3,"formGroup"],["required","",3,"appFormControlInvalid"],["type","text","id","search-save--name","formControlName","name","autofocus",""],["for","search-save--name","slot","label"],["slot","support-text",1,"app-form-control-invalid"],["type","text","id","search-save--description","formControlName","description"],["for","search-save--description","slot","label"],["formControlName","isDefault"],["formControlName","isPublic"],["app-dialog-footer",""],["slot","end","variant","outlined",3,"click"],["slot","end","variant","raised",3,"click","disabled"]],template:function(r,o){r&1&&(i(0,"app-dialog",0)(1,"form",1)(2,"forge-text-field",2),m(3,"input",3),i(4,"label",4),s(5,"Name"),a(),i(6,"span",5),s(7,"A name is required"),a()(),i(8,"forge-text-field"),m(9,"input",6),i(10,"label",7),s(11,"Description"),a()(),i(12,"div")(13,"forge-checkbox",8),s(14," Make this your default search "),a(),i(15,"forge-checkbox",9),s(16," Make this search public "),a()()(),x(17,10),i(18,"forge-button",11),p("click",function(){return o.onCancel()}),s(19," Cancel "),a(),i(20,"forge-button",12),p("click",function(){return o.onSave()}),s(21," Save "),a(),P(),a()),r&2&&(c(),d("formGroup",o.formGroup),c(),d("appFormControlInvalid",o.formGroup.controls.name),c(18),d("disabled",o.formGroup.invalid||!o.formGroup.dirty))},dependencies:[V,B,R,N,G,I,A,L,H,q,Me,Oe,$,K,U,Q,j,Xe,Je],styles:[`[_nghost-%COMP%]{display:contents}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,320px);gap:16px}.form-grid--row-break[_ngcontent-%COMP%]{grid-column-start:1}.form-grid--col-span[_ngcontent-%COMP%]{grid-column:1/-1}.form-grid--col-span.form-grid--col-span[_ngcontent-%COMP%]{width:auto}.form-grid--col-span2[_ngcontent-%COMP%]{grid-column:span 2}.form-grid--col-span2.form-grid--col-span2[_ngcontent-%COMP%]{width:656px}.form-grid--col-span3[_ngcontent-%COMP%]{grid-column:span 3}.form-grid--col-span3.form-grid--col-span3[_ngcontent-%COMP%]{width:992px}.form-grid[_ngcontent-%COMP%]   [slot=value][_ngcontent-%COMP%]:empty:before{content:"n/a";color:var(--forge-theme-text-medium);font-style:italic}.app-form-control-invalid[_ngcontent-%COMP%]{display:none}.app-form-control-invalid[invalid][_ngcontent-%COMP%], .app-form-control-invalid[invalid][_ngcontent-%COMP%]   .app-form-control-invalid[_ngcontent-%COMP%]{display:block}






/*# sourceMappingURL=search-save.component-YT7EA6HI.css.map */`]})}}return n})();var ot=["searchesPopover"],rt=(n,h)=>h.id,nt=()=>({name:"name"}),it=()=>({name:"dateOfBirth"}),at=()=>({name:"address"}),lt=n=>({"operator__addon--selected":n});function st(n,h){if(n&1&&(m(0,"forge-divider",30),i(1,"span",31),s(2),a(),i(3,"span",32),s(4),a()),n&2){let e=_();c(2),O(e.searchName),c(2),O(e.searchDescription)}}function ct(n,h){if(n&1){let e=w();i(0,"forge-list-item",35)(1,"button",34),s(2),a(),i(3,"div",8)(4,"forge-icon-button",36),p("mousedown",function(o){let t=u(e).$implicit,l=_(2);return g(l.onSearchAction(o,"edit",t.id))}),m(5,"forge-icon",37),a(),i(6,"forge-icon-button",38),p("mousedown",function(o){let t=u(e).$implicit,l=_(2);return g(l.onSearchAction(o,"delete",t.id))}),m(7,"forge-icon",39),a()()()}if(n&2){let e=h.$implicit;d("value",e.id),c(2),O(e.name)}}function mt(n,h){if(n&1){let e=w();i(0,"forge-list",33),p("forge-list-item-select",function(o){u(e);let t=_();return g(t.onSearchAction(o,"search",o.detail.value))}),i(1,"forge-list-item")(2,"button",34),s(3,"Add new search"),a()(),m(4,"forge-divider"),Y(5,ct,8,2,"forge-list-item",35,rt),a()}if(n&2){let e=_();c(5),Z(e.searchCache.searches)}}function pt(n,h){n&1&&F(0)}function dt(n,h){n&1&&F(0)}function ht(n,h){n&1&&F(0)}function ft(n,h){if(n&1){let e=w();i(0,"forge-icon-button",40,4),p("click",function(o){let t=u(e).name,l=y(1),v=_();return g(v.onOperatorPopoverOpen(o,l,t))}),m(2,"forge-icon",41),a()}if(n&2){let e,r=h.name,o=_(),t=y(51);d("ngClass",de(2,lt,(e=o.formGroup.get(r))==null?null:e.value.operator))("forgePopover",t)}}function ut(n,h){n&1&&m(0,"forge-icon",44)}function gt(n,h){if(n&1&&(i(0,"forge-list-item",43)(1,"button",34),s(2),a(),S(3,ut,1,0,"forge-icon",44),a()),n&2){let e=h.$implicit,r=_(2);d("value",e.value)("selected",(r.operatorPopoverFormGroup==null?null:r.operatorPopoverFormGroup.value.operator)===e.value),c(2),O(e.label),c(),X((r.operatorPopoverFormGroup==null?null:r.operatorPopoverFormGroup.value.operator)===e.value?3:-1)}}function _t(n,h){if(n&1){let e=w();i(0,"forge-list",42),p("forge-list-item-select",function(o){u(e);let t=_();return g(t.onOperatorSelected(o.detail.value))}),Y(1,gt,4,4,"forge-list-item",43,le),a()}if(n&2){let e=_();c(),Z(e.operatorOptions)}}var Xt=(()=>{class n{constructor(){this.dialogService=C(Ve),this.toastService=C(Ue),this.dataService=C(Qe),this.storageKey="search-searches",this.searchCache={activeSearchId:void 0,searches:[]},this.formGroup=new b({name:new b({value:new f,operator:new f}),dateOfBirth:new b({value:new f,operator:new f}),address:new b({value:new f,operator:new f}),include:new f,facet:new f}),this.facetOptions=[],this.operatorOptions=[{value:null,label:"None"},{value:0,label:"Equal"},{value:1,label:"Not equal"},{value:2,label:"Greater than"},{value:3,label:"Less than"},{value:4,label:"Greater than equal to"},{value:5,label:"Less than equal to"},{value:6,label:"Range"},{value:7,label:"Contains"},{value:8,label:"Not contains"},{value:9,label:"Empty"}],this.nameFilter=e=>ee(this.dataService.getPeople().pipe(te(r=>r.data.filter(o=>o.firstName.toLocaleLowerCase().includes(e.toLocaleLowerCase())||o.lastName.toLocaleLowerCase().includes(e.toLocaleLowerCase())).map(o=>({label:`${o.firstName} ${o.lastName}`,value:o.id}))))),this.facetFilter=e=>W(this.facetOptions)}ngOnInit(){this.dataService.getSearches(this.storageKey).subscribe(e=>{this.searchCache.searches=e||[];let r=this.searchCache.searches.find(o=>o.id===this.searchCache.activeSearchId);M(r)&&(this.searchName=r?.name,this.searchDescription=r?.description,this.formGroup.patchValue(r?.filters))});for(let e=0;e<20;e++)this.facetOptions.push({value:e,label:`Facet Option ${e}`})}onSearch(){}onSaveSearch(e){let r=M(e)?e:this.searchCache.searches.find(t=>t.id===this.searchCache.activeSearchId),o={id:r?.id,name:r?.name,description:r?.description,isDefault:r?.isDefault,isPublic:r?.isPublic,filters:this.formGroup.value};this.dialogService.open(ze,{data:o,options:{persistent:!0}}).afterClosed.subscribe(t=>{if(t){if(M(t.id)){let l=this.searchCache.searches.findIndex(v=>v.id===t.id);l!==-1&&(this.searchCache.searches[l]=t)}else t.id=this.searchCache.searches.length?Math.max(...this.searchCache.searches.map(l=>l.id))+1:1,this.searchCache.searches.push(t);this.dataService.saveSearches(this.storageKey,this.searchCache.searches).subscribe({next:()=>{this.searchCache.activeSearchId=t.id,this.searchName=t.name,this.searchDescription=t.description,this.toastService.show({message:"Search saved"})},error:()=>this.toastService.show({message:"Search save failed"})})}})}onClearSearch(){this.formGroup.controls.include.setValue(null),this.formGroup.reset()}onSearchAction(e,r,o){if(e.stopPropagation(),this.searchesPopover?.close(),!M(o))this.searchCache.activeSearchId=void 0,this.searchName="",this.searchDescription="",this.formGroup.reset();else{let t=this.searchCache.searches.find(l=>l.id===o);if(M(t))switch(r){case"search":this.searchCache.activeSearchId=t?.id,this.searchName=t?.name,this.searchDescription=t?.description,this.formGroup.patchValue(t?.filters),this.onSearch();break;case"edit":this.searchCache.activeSearchId=t?.id,this.searchName=t?.name,this.searchDescription=t?.description,this.formGroup.patchValue(t?.filters);break;case"copy":{let l=JSON.parse(JSON.stringify(t));l.id=void 0,l.name=`${l.name} copy`,l.isDefault=!1,this.onSaveSearch(l);break}case"delete":{let l=this.searchCache.searches.findIndex(v=>v.id===t?.id);l!==-1&&(this.searchCache.searches.splice(l,1),this.dataService.saveSearches(this.storageKey,this.searchCache.searches).subscribe(v=>{})),this.searchCache.activeSearchId===t?.id&&(this.searchCache.activeSearchId=void 0,this.searchName="",this.searchDescription="");break}}}}onOperatorPopoverOpen(e,r,o){e.stopPropagation(),this.operatorPopoverFormGroup=this.formGroup.get(o),this.operatorPopover=r,this.operatorPopover.open()}onOperatorSelected(e){e=parseInt(e,10),this.operatorPopoverFormGroup?.get("operator")?.setValue(e),this.operatorPopover?.close()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-search"]],viewQuery:function(r,o){if(r&1&&se(ot,5),r&2){let t;ce(t=me())&&(o.searchesPopover=t.first)}},standalone:!0,features:[T],decls:52,vars:18,consts:[["searchesPopover","forgePopover"],["searchesPopoverTemplate",""],["opertatorAddonTemplate",""],["operatorPopoverTemplate",""],["operatorPopover","forgePopover"],[1,"header"],["slot","start"],[1,"forge-typography--subheading4"],["slot","end"],["variant","outlined",3,"click"],["variant","outlined",3,"click","forgePopover","forgePopoverPlacement"],["name","arrow_drop_down"],["variant","raised",3,"click"],[1,"body"],["novalidate","","autocomplete","off",1,"form",3,"ngSubmit","formGroup"],["formGroupName","name"],["multiple","true","formControlName","value","allow-unmatched","true",3,"filter"],["type","text","id","search--name"],["for","search--name"],["slot","end","name","arrow_drop_down",1,"forge-dropdown-icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formGroupName","dateOfBirth"],["formControlName","value"],["type","text","id","search--date-of-birth"],["for","search--date-of-birth"],["formGroupName","address"],["type","text","id","search--address","formControlName","value"],["for","search--address","slot","label"],["formControlName","facet","label","Facet",3,"optionFilter"],["threeState","true","formControlName","include",2,"align-self","flex-end"],["vertical",""],[1,"forge-typography--heading2"],[1,"forge-typography--subheading1"],[1,"searches-popover",3,"forge-list-item-select"],["type","button"],[3,"value"],["aria-label","Edit",3,"mousedown"],["name","edit"],["aria-label","Delete",3,"mousedown"],["name","delete"],["slot","addon-end","aria-label","Filter operator",1,"operator__addon",3,"click","ngClass","forgePopover"],["name","bolt"],[1,"operator-popover",3,"forge-list-item-select"],[3,"value","selected"],["name","check","slot","end"]],template:function(r,o){if(r&1){let t=w();i(0,"forge-toolbar",5)(1,"div",6)(2,"h2",7),s(3,"Search"),a(),S(4,st,5,2),a(),i(5,"div",8)(6,"forge-button",9),p("click",function(){return u(t),g(o.onSaveSearch())}),s(7," Save search "),a(),i(8,"forge-button",10,0),p("click",function(){u(t);let v=y(9);return g(v.open())}),i(10,"span"),s(11,"Saved searches"),a(),m(12,"forge-icon",11),a(),i(13,"forge-button",9),p("click",function(){return u(t),g(o.onClearSearch())}),s(14," Clear all "),a(),i(15,"forge-button",12),p("click",function(){return u(t),g(o.onSearch())}),s(16," Search "),a()()(),S(17,mt,7,0,"ng-template",null,1,D),i(19,"div",13)(20,"form",14),p("ngSubmit",function(){return u(t),g(o.onSearch())}),x(21,15),i(22,"forge-autocomplete",16)(23,"forge-text-field"),m(24,"input",17),i(25,"label",18),s(26,"Name"),a(),m(27,"forge-icon",19),S(28,pt,1,0,"ng-container",20),a()(),P(),x(29,21),i(30,"forge-date-picker",22)(31,"forge-text-field"),m(32,"input",23),i(33,"label",24),s(34,"Date"),a(),S(35,dt,1,0,"ng-container",20),a()(),P(),x(36,25),i(37,"forge-text-field"),m(38,"input",26),i(39,"label",27),s(40,"Address"),a(),S(41,ht,1,0,"ng-container",20),a(),P(),m(42,"app-autocomplete-range",28),i(43,"forge-checkbox",29),s(44,"Include"),a()(),i(45,"p"),s(46),he(47,"json"),a()(),S(48,ft,3,4,"ng-template",null,2,D)(50,_t,3,0,"ng-template",null,3,D)}if(r&2){let t=y(18),l=y(49);c(4),X(o.searchCache.activeSearchId?4:-1),c(4),d("forgePopover",t)("forgePopoverPlacement","bottom-start"),c(12),d("formGroup",o.formGroup),c(2),d("filter",o.nameFilter),c(6),d("ngTemplateOutlet",l)("ngTemplateOutletContext",k(15,nt)),c(7),d("ngTemplateOutlet",l)("ngTemplateOutletContext",k(16,it)),c(6),d("ngTemplateOutlet",l)("ngTemplateOutletContext",k(17,at)),c(),d("optionFilter",o.facetFilter),c(4),O(fe(47,13,o.formGroup.getRawValue()))}},dependencies:[V,ge,_e,Ce,B,R,N,G,I,A,L,be,we,Pe,xe,H,q,ye,$,Te,Fe,Ee,Ge,Ne,K,Re,Ie,U,Be,Le,qe,Ae,$e,He,Q,j,je,Ke,Ye,z],styles:[`[_nghost-%COMP%]{display:grid;grid-template-rows:auto 1fr;overflow:hidden}  .searches-popover{min-width:280px}  .searches-popover *[slot=trailing]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;margin-right:-16px}  .operator-popover{min-width:200px}  .operator-popover forge-list-item{cursor:pointer}.header[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap}.header[_ngcontent-%COMP%]   forge-button[_ngcontent-%COMP%]{margin-left:16px}.header[_ngcontent-%COMP%]   [slot=start][_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center}.header[_ngcontent-%COMP%]   [slot=start][_ngcontent-%COMP%]   forge-divider[_ngcontent-%COMP%]{margin:0 16px;height:32px}.header[_ngcontent-%COMP%]   [slot=start][_ngcontent-%COMP%]   span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:16px}.body[_ngcontent-%COMP%]{overflow:auto;padding:24px}.body[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{background-color:var(--forge-theme-surface);border-radius:var(--forge-shape-medium);border-color:var(--forge-theme-outline);box-shadow:var(--forge-elevation-1);padding:16px;display:grid;grid-template-columns:repeat(auto-fill,320px);gap:16px}.body[_ngcontent-%COMP%]   .form--row-break[_ngcontent-%COMP%]{grid-column-start:1}.body[_ngcontent-%COMP%]   .form--col-span[_ngcontent-%COMP%]{grid-column:1/-1}.body[_ngcontent-%COMP%]   .form--col-span.body[_ngcontent-%COMP%]   .form--col-span[_ngcontent-%COMP%]{width:auto}.body[_ngcontent-%COMP%]   .form--col-span2[_ngcontent-%COMP%]{grid-column:span 2}.body[_ngcontent-%COMP%]   .form--col-span2.body[_ngcontent-%COMP%]   .form--col-span2[_ngcontent-%COMP%]{width:656px}.body[_ngcontent-%COMP%]   .form--col-span3[_ngcontent-%COMP%]{grid-column:span 3}.body[_ngcontent-%COMP%]   .form--col-span3.body[_ngcontent-%COMP%]   .form--col-span3[_ngcontent-%COMP%]{width:992px}.body[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   [slot=value][_ngcontent-%COMP%]:empty:before{content:"n/a";color:var(--forge-theme-text-medium);font-style:italic}.operator__addon--selected[_ngcontent-%COMP%]{color:var(--forge-theme-info)}






/*# sourceMappingURL=search.component-PUZRFU2M.css.map */`]})}}return n})();export{Xt as SearchComponent};
//# sourceMappingURL=chunk-TENWGOMK.js.map
