import{a as J}from"./chunk-HJLWUUW5.js";import{a as X}from"./chunk-VO334JJQ.js";import{Ad as Z,Bd as j,Cb as T,Cc as K,Cd as U,Dc as N,Ec as D,Fb as I,Fc as V,Kb as O,Yb as F,Zb as R,f as x,h as P,nb as M,pb as f,rb as A,sb as w,ub as E,uc as z,vc as B,vd as L,wb as u,wd as q,zb as G}from"./chunk-WNYBMKHL.js";import{Db as b,Eb as _,Ib as c,Jb as e,Kb as t,Lb as s,R as d,Vb as g,Xa as a,hc as i,ia as m,ic as h,kb as y,tb as C,tc as S,uc as k}from"./chunk-LKW6WE5H.js";import"./chunk-OY7QI42D.js";function H(l,r){l&1&&s(0,"forge-linear-progress",20)}function Q(l,r){l&1&&s(0,"forge-divider")}var ce=(()=>{let r=class r{constructor(){this.ngZone=m(C),this.reCatpchaService=m(J),this.toastService=m(Z),this.isBusy=!1,this.isInitialized=!1,this.formGroup=new E({recaptchaAction:new u("TEST",{validators:[f.required]}),recaptchaSiteKey:new u(null,{validators:[f.required]}),googleAPIKey:new u(null,{validators:[f.required]})})}onInitialize(){this.formGroup.controls.recaptchaSiteKey.disable(),this.isBusy=!0,this.reCatpchaService.initialize(this.formGroup.getRawValue().recaptchaSiteKey).pipe(d(()=>this.isBusy=!1)).subscribe({next:()=>{this.ngZone.run(()=>{this.isInitialized=!0}),this.toastService.show("Re-Captcha initialized.")},error:o=>{this.toastService.show("An error occurred initializing Re-Captcha, see console for details.")}})}onExecute(){this.token=void 0,this.assessment=void 0,this.isBusy=!0,this.reCatpchaService.executeChallenge(this.formGroup.value.recaptchaAction).pipe(d(()=>{this.isBusy=!1})).subscribe({next:o=>{this.token=o},error:o=>{console.log(o),this.toastService.show("An error occurred, see console for details.")}})}onAssess(){this.assessment=void 0,this.isBusy=!0,this.reCatpchaService.assessToken(this.formGroup.value.googleAPIKey,this.token,this.formGroup.value.recaptchaAction).pipe(d(()=>this.isBusy=!1)).subscribe({next:o=>{this.assessment={event:{expectedAction:o.event.expectedAction},riskAnalysis:{challenge:o.riskAnalysis.challenge,score:o.riskAnalysis.score},tokenProperties:{action:o.tokenProperties.action,createTime:X.formatDate(o.tokenProperties.createTime,"MM/dd/yyyy hh:mm"),invalidReason:o.tokenProperties.invalidReason,valid:o.tokenProperties.valid}},console.log(o)},error:o=>{console.log(o),this.toastService.show("An error occurred, see console for details.")}})}};r.\u0275fac=function(p){return new(p||r)},r.\u0275cmp=y({type:r,selectors:[["app-re-captcha"]],decls:57,vars:9,consts:[[1,"header"],["slot","start",1,"forge-typography--subheading4"],[1,"body"],["novalidate","","autocomplete","off",1,"form-grid",3,"formGroup"],[1,"form-grid--col-span","form-grid__resources"],["slot","label"],["slot","value",1,"form-grid__resources--stacked"],["href","https://cloud.google.com/recaptcha/docs/setup-overview-web","target","_blank"],["href","https://cloud.google.com/recaptcha/docs/apis","target","_blank"],["type","text","id","re-captcha--action","formControlName","recaptchaAction"],["for","re-captcha--action","slot","label"],[1,"form-grid--col-span2"],["type","text","id","re-captcha--site-key","formControlName","recaptchaSiteKey"],["for","re-captcha--site-key","slot","label"],["slot","helper-text",1,"forge-typography--label2"],["type","text","id","re-captcha--google-api-key","formControlName","googleAPIKey"],["for","re-captcha--google-api-key","slot","label"],[1,"form-grid--col-span2","form-grid__actions"],["variant","outlined",3,"click","disabled"],["variant","outlined",1,"form-grid--row-break",3,"click","disabled"],[1,"form-grid--col-span"],["slot","value",2,"margin","0"],["slot","value"]],template:function(p,n){p&1&&(e(0,"forge-toolbar",0)(1,"h2",1),i(2,"Google reCaptcha"),t()(),e(3,"div",2)(4,"form",3)(5,"div",4)(6,"forge-label-value")(7,"span",5),i(8,"Resources"),t(),e(9,"div",6)(10,"a",7),i(11,"reCaptcha website setup"),t(),e(12,"a",8),i(13,"reCaptcha API reference"),t()()()(),e(14,"forge-text-field"),s(15,"input",9),e(16,"label",10),i(17,"Action"),t()(),e(18,"forge-text-field",11),s(19,"input",12),e(20,"label",13),i(21,"Site key"),t(),e(22,"span",14),i(23,"Site key can only be set once, refresh the page to change site key."),t(),e(24,"span",14),i(25,"reCaptcha must be Intialized after setting site key."),t(),e(26,"span",14),i(27,"Execute will generate a new token."),t()(),e(28,"forge-text-field",11),s(29,"input",15),e(30,"label",16),i(31,"Google API key"),t(),e(32,"span",14),i(33,"Google API key is required to Assess a token."),t(),e(34,"span",14),i(35,"Token may only be assessed once, then it will become invalid."),t()(),e(36,"div",17)(37,"forge-button",18),g("click",function(){return n.onInitialize()}),i(38,"Initialize"),t(),e(39,"forge-button",19),g("click",function(){return n.onExecute()}),i(40," Execute "),t(),e(41,"forge-button",18),g("click",function(){return n.onAssess()}),i(42,"Assess"),t()(),e(43,"div",20),b(44,H,1,0,"forge-linear-progress",20)(45,Q,1,0,"forge-divider"),t(),e(46,"forge-label-value",20)(47,"span",5),i(48,"Assessment"),t(),e(49,"pre",21),i(50),S(51,"json"),t()(),e(52,"forge-label-value",20)(53,"span",5),i(54,"Token"),t(),e(55,"span",22),i(56),t()()()()),p&2&&(a(4),c("formGroup",n.formGroup),a(33),c("disabled",n.formGroup.controls.recaptchaSiteKey.invalid||n.isInitialized),a(2),c("disabled",n.formGroup.controls.recaptchaAction.invalid||n.formGroup.controls.recaptchaSiteKey.invalid||!n.isInitialized||n.isBusy),a(2),c("disabled",!(n.token!=null&&n.token.length)||n.formGroup.invalid||n.isBusy),a(3),_(n.isBusy?44:45),a(6),h(k(51,7,n.assessment)),a(6),h(n.token))},dependencies:[P,O,G,M,A,w,T,I,R,F,B,z,N,K,V,D,q,L,U,j,x],styles:[`[_nghost-%COMP%]{display:grid;grid-template-rows:auto 1fr;overflow:hidden;height:100%}.body[_ngcontent-%COMP%]{overflow:auto;padding:24px;display:flex;align-items:flex-start;justify-content:center}.form-grid[_ngcontent-%COMP%]{background-color:var(--forge-theme-surface);border-radius:var(--forge-shape-medium);border:1px solid var(--forge-theme-outline);padding:16px;display:grid;grid-template-columns:repeat(auto-fill,320px);gap:16px}.form-grid--row-break[_ngcontent-%COMP%]{grid-column-start:1}.form-grid--col-span[_ngcontent-%COMP%]{grid-column:1/-1}.form-grid--col-span.form-grid--col-span[_ngcontent-%COMP%]{width:auto}.form-grid--col-span2[_ngcontent-%COMP%]{grid-column:span 2}.form-grid--col-span2.form-grid--col-span2[_ngcontent-%COMP%]{width:656px}.form-grid--col-span3[_ngcontent-%COMP%]{grid-column:span 3}.form-grid--col-span3.form-grid--col-span3[_ngcontent-%COMP%]{width:992px}.form-grid[_ngcontent-%COMP%]   [slot=value][_ngcontent-%COMP%]:empty:before{content:"n/a";color:var(--forge-theme-text-medium);font-style:italic}.form-grid__resources--stacked[_ngcontent-%COMP%]{font-size:.85rem;display:flex;flex-direction:column;row-gap:4px}.form-grid__actions[_ngcontent-%COMP%]{display:flex;column-gap:8px}






/*# sourceMappingURL=re-captcha.component-P3ZGXOIS.css.map */`]});let l=r;return l})();export{ce as ReCaptchaComponent};
//# sourceMappingURL=chunk-O4RBJWQY.js.map
