"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[8592],{9219:(k,V,r)=>{r.d(V,{A:()=>A});var m=r(86477),x=r(86839);const b=[[["","app-card-header",""]],"*",[["","app-card-footer",""]]],M=["[app-card-header]","*","[app-card-footer]"];let A=(()=>{class T{get raisedClass(){return"raised"===this.border}get outlinedClass(){return"outlined"===this.border}constructor(){this.border="raised"}}return T.\u0275fac=function(G){return new(G||T)},T.\u0275cmp=x.Xpm({type:T,selectors:[["app-card"]],hostVars:4,hostBindings:function(G,w){2&G&&x.ekj("app-card--raised",w.raisedClass)("app-card--outlined",w.outlinedClass)},inputs:{border:"border"},standalone:!0,features:[x.jDz],ngContentSelectors:M,decls:6,vars:0,consts:[["slot","header",1,"header"],[1,"body"],["slot","footer","inverted","true",1,"footer"]],template:function(G,w){1&G&&(x.F$t(b),x.TgZ(0,"forge-toolbar",0),x.Hsn(1),x.qZA(),x.TgZ(2,"div",1),x.Hsn(3,1),x.qZA(),x.TgZ(4,"forge-toolbar",2),x.Hsn(5,2),x.qZA())},dependencies:[m.ez],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.app-card--raised[_nghost-%COMP%]{background-color:#fff;background-color:var(--mdc-theme-surface, #ffffff);border-radius:4px;border-radius:var(--mdc-shape-medium, 4px);box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}.app-card--outlined[_nghost-%COMP%]{background-color:#fff;background-color:var(--mdc-theme-surface, #ffffff);border-radius:4px;border-radius:var(--mdc-shape-medium, 4px);border:1px solid #e0e0e0}.header[_ngcontent-%COMP%]     [slot=end] forge-icon-button:last-child{margin-right:-8px}.header[_ngcontent-%COMP%]:empty{display:none}.body[_ngcontent-%COMP%]{padding:16px;overflow:auto;flex-grow:1}.footer[_ngcontent-%COMP%]     [slot=start] forge-button+forge-button{margin-right:16px}.footer[_ngcontent-%COMP%]     [slot=end] forge-button+forge-button{margin-left:16px}.footer[_ngcontent-%COMP%]:empty{display:none}"]}),T})()},85674:(k,V,r)=>{r.d(V,{h:()=>x});var m=r(86839);let x=(()=>{class b{constructor(A){this.element=A}ngAfterViewInit(){window.requestAnimationFrame(()=>{this.element.nativeElement.focus()})}}return b.\u0275fac=function(A){return new(A||b)(m.Y36(m.SBq))},b.\u0275dir=m.lG2({type:b,selectors:[["","appAutoFocus",""]],standalone:!0}),b})()},47864:(k,V,r)=>{r.d(V,{$:()=>x});var m=r(86839);let x=(()=>{class b{transform(A,...T){return console.log(A),!A.some(B=>!1===B)}}return b.\u0275fac=function(A){return new(A||b)},b.\u0275pipe=m.Yjl({name:"appFormControlInvalid",type:b,pure:!0,standalone:!0}),b})()},98943:(k,V,r)=>{r.d(V,{a:()=>b});var m=r(89202),x=r(51941);class b extends m.k{constructor(A){super(A)}_build(){var A,T;const B=document.createElement(x.f.elementName);return this._inputElement=this._buildInputElement(B),!(null===(A=this._config.options)||void 0===A)&&A.leadingElement&&(this._config.options.leadingElement.slot="leading",B.appendChild(this._config.options.leadingElement)),!(null===(T=this._config.options)||void 0===T)&&T.trailingElement&&(this._config.options.trailingElement.slot="trailing",B.appendChild(this._config.options.trailingElement)),B.appendChild(this._inputElement),B}_configure(){var A,T;!(null===(A=this._config.options)||void 0===A)&&A.helperText&&this.setHelperText(this._config.options.helperText),"string"==typeof(null===(T=this._config.options)||void 0===T?void 0:T.label)&&this._createLabel(this._config.options.label)}get value(){return this._inputElement.value}set value(A){this._inputElement.value=A}get disabled(){return this._inputElement.disabled}set disabled(A){this._inputElement.disabled=A}get invalid(){return this._element.invalid||!1}set invalid(A){this._element.invalid=A}get inputElement(){return this._inputElement}get labelElement(){return this._labelElement}onChange(A){this._inputElement.addEventListener("input",T=>A(T.target.value))}onFocus(A){this._inputElement.addEventListener("focus",T=>A(T))}onBlur(A){this._inputElement.addEventListener("blur",T=>A(T))}setLabel(A){A?this._labelElement?this._labelElement.textContent=A:this._createLabel(A):this._labelElement&&(this._element.removeChild(this._labelElement),this._labelElement=void 0)}setHelperText(A){A?(this._helperTextElement||(this._helperTextElement=document.createElement("span"),this._helperTextElement.slot="helper-text",this._element.appendChild(this._helperTextElement)),this._helperTextElement.textContent=A):this._helperTextElement&&(this._element.removeChild(this._helperTextElement),this._helperTextElement=void 0)}floatLabel(A){this._element.floatLabel(A)}_createLabel(A){var T;this._labelElement=document.createElement("label"),this._labelElement.textContent=A,!(null===(T=this._config.options)||void 0===T)&&T.id&&this._labelElement.setAttribute("for",this._config.options.id),this._element.appendChild(this._labelElement)}_buildInputElement(A){var T,B,G,w,W;const K=document.createElement("input");return K.type=(null===(T=this._config.options)||void 0===T?void 0:T.type)||"text",void 0!==(null===(B=this._config.options)||void 0===B?void 0:B.value)&&(K.value=this._config.options.value),!(null===(G=this._config.options)||void 0===G)&&G.id&&(K.id=this._config.options.id),"string"==typeof(null===(w=this._config.options)||void 0===w?void 0:w.placeholder)&&(K.placeholder=null===(W=this._config.options)||void 0===W?void 0:W.placeholder),A.appendChild(K),K}}},78611:(k,V,r)=>{r.d(V,{n:()=>x});var m=r(14423);function x(b,M){const A="object"==typeof M;return new Promise((T,B)=>{let w,G=!1;b.subscribe({next:W=>{w=W,G=!0},error:B,complete:()=>{G?T(w):A?T(M.defaultValue):B(new m.K)}})})}},5403:(k,V,r)=>{r.d(V,{Z:()=>U});var m=r(18100),x=r(6365),b=r(94904),M=r(20711),A=r(44480),T=r(53661),B=r(9497),W=(r(83382),r(19420),r(20891));let K=0,Z=class extends((0,A.eC)((0,b.J)((0,M.IG)(x.Z)))){constructor(S){super(S),this.id=`${Date.now().toString(16)}-analysis-${K++}`,this.title=null}get parent(){return this._get("parent")}set parent(S){const D=this.parent;if((0,T.pC)(D))switch(D.type){case"line-of-sight":case"dimension":D.releaseAnalysis(this);break;case"2d":case"3d":D.analyses.includes(this)&&D.analyses.remove(this)}this._set("parent",S)}get isEditable(){return this.requiredPropertiesForEditing.every(T.pC)}};(0,m._)([(0,B.Cb)({type:String,constructOnly:!0,clonable:!1})],Z.prototype,"id",void 0),(0,m._)([(0,B.Cb)({type:String})],Z.prototype,"title",void 0),(0,m._)([(0,B.Cb)({constructOnly:!0})],Z.prototype,"type",void 0),(0,m._)([(0,B.Cb)({clonable:!1,value:null})],Z.prototype,"parent",null),(0,m._)([(0,B.Cb)({readOnly:!0})],Z.prototype,"isEditable",null),(0,m._)([(0,B.Cb)({readOnly:!0})],Z.prototype,"requiredPropertiesForEditing",void 0),Z=(0,m._)([(0,W.j)("esri.analysis.Analysis")],Z);const U=Z},23818:(k,V,r)=>{function m(x){throw new Error('Could not dynamically require "'+x+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}r.d(V,{c:()=>m})},58222:(k,V,r)=>{r.d(V,{A:()=>E,B:()=>_,C:()=>L,D:()=>s,E:()=>v,F:()=>C,G:()=>j,H:()=>F,I:()=>z,J:()=>X,K:()=>$,L:()=>Q,M:()=>ee,N:()=>q,a:()=>A,b:()=>T,c:()=>M,d:()=>B,e:()=>b,f:()=>G,g:()=>ne,h:()=>w,i:()=>W,j:()=>U,k:()=>y,l:()=>l,m:()=>h,n:()=>p,o:()=>S,p:()=>I,q:()=>P,r:()=>D,s:()=>O,t:()=>K,u:()=>g,v:()=>R,w:()=>Z,x:()=>N,y:()=>d,z:()=>a});var m=r(77640),x=r(17409);function b(Y){return m.G.extendedSpatialReferenceInfo(Y)}function M(Y,J,H){return m.G.clip(x.N,Y,J,H)}function A(Y,J,H){return m.G.cut(x.N,Y,J,H)}function T(Y,J,H){return m.G.contains(x.N,Y,J,H)}function B(Y,J,H){return m.G.crosses(x.N,Y,J,H)}function G(Y,J,H,te){return m.G.distance(x.N,Y,J,H,te)}function w(Y,J,H){return m.G.equals(x.N,Y,J,H)}function W(Y,J,H){return m.G.intersects(x.N,Y,J,H)}function K(Y,J,H){return m.G.touches(x.N,Y,J,H)}function Z(Y,J,H){return m.G.within(x.N,Y,J,H)}function U(Y,J,H){return m.G.disjoint(x.N,Y,J,H)}function S(Y,J,H){return m.G.overlaps(x.N,Y,J,H)}function D(Y,J,H,te){return m.G.relate(x.N,Y,J,H,te)}function y(Y,J){return m.G.isSimple(x.N,Y,J)}function O(Y,J){return m.G.simplify(x.N,Y,J)}function l(Y,J,H=!1){return m.G.convexHull(x.N,Y,J,H)}function h(Y,J,H){return m.G.difference(x.N,Y,J,H)}function p(Y,J,H){return m.G.symmetricDifference(x.N,Y,J,H)}function I(Y,J,H){return m.G.intersect(x.N,Y,J,H)}function g(Y,J,H=null){return m.G.union(x.N,Y,J,H)}function P(Y,J,H,te,re,se,oe){return m.G.offset(x.N,Y,J,H,te,re,se,oe)}function R(Y,J,H,te,re=!1){return m.G.buffer(x.N,Y,J,H,te,re)}function N(Y,J,H,te,re,se,oe){return m.G.geodesicBuffer(x.N,Y,J,H,te,re,se,oe)}function d(Y,J,H,te=!0){return m.G.nearestCoordinate(x.N,Y,J,H,te)}function a(Y,J,H){return m.G.nearestVertex(x.N,Y,J,H)}function E(Y,J,H,te,re){return m.G.nearestVertices(x.N,Y,J,H,te,re)}function _(Y,J,H,te){if(null==J||null==te)throw new Error("Illegal Argument Exception");const re=m.G.rotate(J,H,te);return re.spatialReference=Y,re}function L(Y,J,H){if(null==J||null==H)throw new Error("Illegal Argument Exception");const te=m.G.flipHorizontal(J,H);return te.spatialReference=Y,te}function s(Y,J,H){if(null==J||null==H)throw new Error("Illegal Argument Exception");const te=m.G.flipVertical(J,H);return te.spatialReference=Y,te}function v(Y,J,H,te,re){return m.G.generalize(x.N,Y,J,H,te,re)}function C(Y,J,H,te){return m.G.densify(x.N,Y,J,H,te)}function j(Y,J,H,te,re=0){return m.G.geodesicDensify(x.N,Y,J,H,te,re)}function F(Y,J,H){return m.G.planarArea(x.N,Y,J,H)}function z(Y,J,H){return m.G.planarLength(x.N,Y,J,H)}function X(Y,J,H,te){return m.G.geodesicArea(x.N,Y,J,H,te)}function $(Y,J,H,te){return m.G.geodesicLength(x.N,Y,J,H,te)}function Q(Y,J,H){return null==J||null==H?[]:m.G.intersectLinesToPoints(x.N,Y,J,H)}function ee(Y,J){m.G.changeDefaultSpatialReferenceTolerance(Y,J)}function q(Y){m.G.clearDefaultSpatialReferenceTolerance(Y)}const ne=Object.freeze(Object.defineProperty({__proto__:null,buffer:R,changeDefaultSpatialReferenceTolerance:ee,clearDefaultSpatialReferenceTolerance:q,clip:M,contains:T,convexHull:l,crosses:B,cut:A,densify:C,difference:h,disjoint:U,distance:G,equals:w,extendedSpatialReferenceInfo:b,flipHorizontal:L,flipVertical:s,generalize:v,geodesicArea:X,geodesicBuffer:N,geodesicDensify:j,geodesicLength:$,intersect:I,intersectLinesToPoints:Q,intersects:W,isSimple:y,nearestCoordinate:d,nearestVertex:a,nearestVertices:E,offset:P,overlaps:S,planarArea:F,planarLength:z,relate:D,rotate:_,simplify:O,symmetricDifference:p,touches:K,union:g,within:Z},Symbol.toStringTag,{value:"Module"}))},2153:(k,V,r)=>{r.d(V,{B:()=>W});var m=r(71670),x=r(65341),b=r(55050),M=r(28772),A=r(69778),T=r(61434),B=r(9497),G=r(87640),w=r(29184);function W(g){const P=g?.origins??[void 0];return(R,N)=>{const d=function K(g,P,R){if("resource"===g?.type)return function Z(g,P,R){const N=(0,A.Oe)(P,R);return{type:String,read:(d,a,E)=>{const _=(0,w.r)(d,a,E);return N.type===String?_:"function"==typeof N.type?new N.type({url:_}):void 0},write:{writer(d,a,E,_){if(!_||!_.resources)return"string"==typeof d?void(a[E]=(0,w.t)(d,_)):void(a[E]=d.write({},_));const L=function p(g){return null==g?null:"string"==typeof g?g:g.url}(d),s=(0,w.t)(L,{..._,verifyItemRelativeUrls:_&&_.verifyItemRelativeUrls?{writtenUrls:_.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},w.M.NO),v=N.type!==String&&(!(0,x.l)(this)||_&&_.origin&&this.originIdOf(R)>(0,T.M9)(_.origin)),C={object:this,propertyName:R,value:d,targetUrl:s,dest:a,targetPropertyName:E,context:_,params:g};_&&_.portalItem&&s&&!(0,b.YP)(s)?v?function S(g){const{context:P,targetUrl:R,params:N,value:d,dest:a,targetPropertyName:E}=g;if(!P.portalItem)return;const _=P.portalItem.resourceFromPath(R),L=O(d,R,P),s=(0,G.B)(L),v=(0,b.Ml)(_.path),C=N?.compress??!1;s===v?(P.resources&&y({...g,resource:_,content:L,compress:C,updates:P.resources.toUpdate}),a[E]=R):U(g)}(C):function D({context:g,targetUrl:P,dest:R,targetPropertyName:N}){g.portalItem&&g.resources&&(g.resources.toKeep.push({resource:g.portalItem.resourceFromPath(P),compress:!1}),R[N]=P)}(C):_&&_.portalItem&&(null==s||null!=(0,w.i)(s)||(0,b.jc)(s)||v)?U(C):a[E]=s}}}}(g,P,R);switch(g?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:N,write:d}=w.a;return{read:N,write:d}}}}(g,R,N);for(const a of P){const E=(0,B.CJ)(R,a,N);for(const _ in d)E[_]=d[_]}}}function U(g){const{targetUrl:P,params:R,value:N,context:d,dest:a,targetPropertyName:E}=g;if(!d.portalItem)return;const _=(0,w.p)(P),L=_?.filename??(0,M.D)(),s=R?.prefix??_?.prefix,v=O(N,P,d),C=(0,b.v_)(s,L),j=`${C}.${(0,G.B)(v)}`,F=d.portalItem.resourceFromPath(j);(0,b.jc)(P)&&d.resources&&d.resources.pendingOperations.push(function l(g){return h.apply(this,arguments)}(P).then(X=>{F.path=`${C}.${(0,G.B)(X)}`,a[E]=F.itemRelativeUrl}).catch(()=>{}));const z=R?.compress??!1;d.resources&&y({...g,resource:F,content:v,compress:z,updates:d.resources.toAdd}),a[E]=F.itemRelativeUrl}function y({object:g,propertyName:P,updates:R,resource:N,content:d,compress:a}){R.push({resource:N,content:d,compress:a,finish:E=>{!function I(g,P,R){"string"==typeof g[P]?g[P]=R.url:g[P].url=R.url}(g,P,E)}})}function O(g,P,R){return"string"==typeof g?{url:P}:new Blob([JSON.stringify(g.toJSON(R))],{type:"application/json"})}function h(){return(h=(0,m.Z)(function*(g){const P=(yield Promise.resolve().then(r.bind(r,1897))).default,{data:R}=yield P(g,{responseType:"blob"});return R})).apply(this,arguments)}},70527:(k,V,r)=>{r.d(V,{J:()=>M,r:()=>b});let m=null,x=!0;function b(B,G,w){if(!B||!G)throw new Error("Cannot construct image data without dimensions");if(x)try{return new ImageData(B,G)}catch{x=!1}return T(B,G,w)}function M(B,G,w,W){if(!G||!w)throw new Error("Cannot construct image data without dimensions");if(x)try{return new ImageData(B,G,w)}catch{x=!1}const K=T(G,w,W);return K.data.set(B,0),K}function T(B,G,w){return w||(w=function A(){return m||(m=document.createElement("canvas"),m.width=1,m.height=1),m}()),w.getContext("2d").createImageData(B,G)}},52674:(k,V,r)=>{r.d(V,{Q:()=>A});var m=r(19420),x=r(53661),b=r(22286),M=r(49846);class A{constructor(a=9,E){this._compareMinX=w,this._compareMinY=W,this._toBBox=_=>_,this._maxEntries=Math.max(4,a||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),E&&("function"==typeof E?this._toBBox=E:this._initFormat(E)),this.clear()}destroy(){this.clear(),l.prune(),h.prune(),p.prune(),I.prune()}all(a){this._all(this._data,a)}search(a,E){let _=this._data;const L=this._toBBox;if(y(a,_))for(l.clear();_;){for(let s=0,v=_.children.length;s<v;s++){const C=_.children[s],j=_.leaf?L(C):C;y(a,j)&&(_.leaf?E(C):D(a,j)?this._all(C,E):l.push(C))}_=l.pop()}}collides(a){let E=this._data;const _=this._toBBox;if(!y(a,E))return!1;for(l.clear();E;){for(let L=0,s=E.children.length;L<s;L++){const v=E.children[L],C=E.leaf?_(v):v;if(y(a,C)){if(E.leaf||D(a,C))return!0;l.push(v)}}E=l.pop()}return!1}load(a){if(!a.length)return this;if(a.length<this._minEntries){for(let _=0,L=a.length;_<L;_++)this.insert(a[_]);return this}let E=this._build(a.slice(0,a.length),0,a.length-1,0);if(this._data.children.length)if(this._data.height===E.height)this._splitRoot(this._data,E);else{if(this._data.height<E.height){const _=this._data;this._data=E,E=_}this._insert(E,this._data.height-E.height-1,!0)}else this._data=E;return this}insert(a){return a&&this._insert(a,this._data.height-1),this}clear(){return this._data=new R([]),this}remove(a){if(!a)return this;let E,_=this._data,L=null,s=0,v=!1;const C=this._toBBox(a);for(p.clear(),I.clear();_||p.length>0;){if(_||(_=(0,x.j0)(p.pop()),L=p.data[p.length-1],s=I.pop()??0,v=!0),_.leaf&&(E=(0,m.cq)(_.children,a,_.children.length,_.indexHint),-1!==E))return _.children.splice(E,1),p.push(_),this._condense(p),this;v||_.leaf||!D(_,C)?L?(s++,_=L.children[s],v=!1):_=null:(p.push(_),I.push(s),s=0,L=_,_=_.children[0])}return this}toJSON(){return this._data}fromJSON(a){return this._data=a,this}_all(a,E){let _=a;for(h.clear();_;){if(!0===_.leaf)for(const L of _.children)E(L);else h.pushArray(_.children);_=h.pop()??null}}_build(a,E,_,L){const s=_-E+1;let v=this._maxEntries;if(s<=v){const z=new R(a.slice(E,_+1));return T(z,this._toBBox),z}L||(L=Math.ceil(Math.log(s)/Math.log(v)),v=Math.ceil(s/v**(L-1)));const C=new N([]);C.height=L;const j=Math.ceil(s/v),F=j*Math.ceil(Math.sqrt(v));O(a,E,_,F,this._compareMinX);for(let z=E;z<=_;z+=F){const X=Math.min(z+F-1,_);O(a,z,X,j,this._compareMinY);for(let $=z;$<=X;$+=j){const Q=Math.min($+j-1,X);C.children.push(this._build(a,$,Q,L-1))}}return T(C,this._toBBox),C}_chooseSubtree(a,E,_,L){for(;L.push(E),!0!==E.leaf&&L.length-1!==_;){let s,v=1/0,C=1/0;for(let j=0,F=E.children.length;j<F;j++){const z=E.children[j],X=K(z),$=U(a,z)-X;$<C?(C=$,v=X<v?X:v,s=z):$===C&&X<v&&(v=X,s=z)}E=s||E.children[0]}return E}_insert(a,E,_){const s=_?a:(0,this._toBBox)(a);p.clear();const v=this._chooseSubtree(s,this._data,E,p);for(v.children.push(a),G(v,s);E>=0&&p.data[E].children.length>this._maxEntries;)this._split(p,E),E--;this._adjustParentBBoxes(s,p,E)}_split(a,E){const _=a.data[E],L=_.children.length,s=this._minEntries;this._chooseSplitAxis(_,s,L);const v=this._chooseSplitIndex(_,s,L);if(!v)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const C=_.children.splice(v,_.children.length-v),j=_.leaf?new R(C):new N(C);j.height=_.height,T(_,this._toBBox),T(j,this._toBBox),E?a.data[E-1].children.push(j):this._splitRoot(_,j)}_splitRoot(a,E){this._data=new N([a,E]),this._data.height=a.height+1,T(this._data,this._toBBox)}_chooseSplitIndex(a,E,_){let L,s,v;L=s=1/0;for(let C=E;C<=_-E;C++){const j=B(a,0,C,this._toBBox),F=B(a,C,_,this._toBBox),z=S(j,F),X=K(j)+K(F);z<L?(L=z,v=C,s=X<s?X:s):z===L&&X<s&&(s=X,v=C)}return v}_chooseSplitAxis(a,E,_){const L=a.leaf?this._compareMinX:w,s=a.leaf?this._compareMinY:W;this._allDistMargin(a,E,_,L)<this._allDistMargin(a,E,_,s)&&a.children.sort(L)}_allDistMargin(a,E,_,L){a.children.sort(L);const s=this._toBBox,v=B(a,0,E,s),C=B(a,_-E,_,s);let j=Z(v)+Z(C);for(let F=E;F<_-E;F++){const z=a.children[F];G(v,a.leaf?s(z):z),j+=Z(v)}for(let F=_-E-1;F>=E;F--){const z=a.children[F];G(C,a.leaf?s(z):z),j+=Z(C)}return j}_adjustParentBBoxes(a,E,_){for(let L=_;L>=0;L--)G(E.data[L],a)}_condense(a){for(let E=a.length-1;E>=0;E--){const _=a.data[E];if(0===_.children.length)if(E>0){const L=a.data[E-1],s=L.children;s.splice((0,m.cq)(s,_,s.length,L.indexHint),1)}else this.clear();else T(_,this._toBBox)}}_initFormat(a){const E=["return a"," - b",";"];this._compareMinX=new Function("a","b",E.join(a[0])),this._compareMinY=new Function("a","b",E.join(a[1])),this._toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}}function T(d,a){B(d,0,d.children.length,a,d)}function B(d,a,E,_,L){L||(L=new R([])),L.minX=1/0,L.minY=1/0,L.maxX=-1/0,L.maxY=-1/0;for(let s,v=a;v<E;v++)s=d.children[v],G(L,d.leaf?_(s):s);return L}function G(d,a){d.minX=Math.min(d.minX,a.minX),d.minY=Math.min(d.minY,a.minY),d.maxX=Math.max(d.maxX,a.maxX),d.maxY=Math.max(d.maxY,a.maxY)}function w(d,a){return d.minX-a.minX}function W(d,a){return d.minY-a.minY}function K(d){return(d.maxX-d.minX)*(d.maxY-d.minY)}function Z(d){return d.maxX-d.minX+(d.maxY-d.minY)}function U(d,a){return(Math.max(a.maxX,d.maxX)-Math.min(a.minX,d.minX))*(Math.max(a.maxY,d.maxY)-Math.min(a.minY,d.minY))}function S(d,a){const E=Math.max(d.minX,a.minX),_=Math.max(d.minY,a.minY),L=Math.min(d.maxX,a.maxX),s=Math.min(d.maxY,a.maxY);return Math.max(0,L-E)*Math.max(0,s-_)}function D(d,a){return d.minX<=a.minX&&d.minY<=a.minY&&a.maxX<=d.maxX&&a.maxY<=d.maxY}function y(d,a){return a.minX<=d.maxX&&a.minY<=d.maxY&&a.maxX>=d.minX&&a.maxY>=d.minY}function O(d,a,E,_,L){const s=[a,E];for(;s.length;){const v=(0,x.j0)(s.pop()),C=(0,x.j0)(s.pop());if(v-C<=_)continue;const j=C+Math.ceil((v-C)/_/2)*_;(0,M.q)(d,j,C,v,L),s.push(C,j,j,v)}}const l=new b.Z,h=new b.Z,p=new b.Z,I=new b.Z({deallocator:void 0});class g{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class P extends g{constructor(){super(...arguments),this.height=1,this.indexHint=new m.SO}}class R extends P{constructor(a){super(),this.children=a,this.leaf=!0}}class N extends P{constructor(a){super(),this.children=a,this.leaf=!1}}},49389:(k,V,r)=>{r.d(V,{Qc:()=>K,WU:()=>A,lt:()=>W});var m=r(3758),x=r(92051);const b={ar:[".",","],bg:[",","\xa0"],bs:[",","."],ca:[",","."],cs:[",","\xa0"],da:[",","."],de:[",","."],"de-ch":[".","\u2019"],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[",","\xa0"],fi:[",","\xa0"],fr:[",","\u202f"],"fr-ch":[",","\u202f"],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[",","\xa0"],id:[",","."],it:[",","."],"it-ch":[".","\u2019"],ja:[".",","],ko:[".",","],lt:[",","\xa0"],lv:[",","\xa0"],mk:[",","."],nb:[",","\xa0"],nl:[",","."],pl:[",","\xa0"],pt:[",","."],"pt-pt":[",","\xa0"],ro:[",","."],ru:[",","\xa0"],sk:[",","\xa0"],sl:[",","."],sr:[",","."],sv:[",","\xa0"],th:[".",","],tr:[",","."],uk:[",","\xa0"],vi:[",","."],zh:[".",","]};function M(y=(0,x.Kd)()){let O=(y=y.toLowerCase())in b;if(!O){const I=y.split("-");I.length>1&&I[0]in b&&(y=I[0],O=!0),O||(y="en")}const[l,h,p="#,##0.###"]=b[y];return{decimal:l,group:h,pattern:p}}function A(y,O){const l=M((O={...O}).locale);O.customs=l;const h=O.pattern||l.pattern;return isNaN(y)||Math.abs(y)===1/0?null:function B(y,O,l){const h=(l=l||{}).customs.group,p=l.customs.decimal,I=O.split(";"),g=I[0];if((O=I[y<0?1:0]||"-"+g).includes("%"))y*=100;else if(O.includes("\u2030"))y*=1e3;else{if(O.includes("\xa4"))throw new Error("currency notation not supported");if(O.includes("E"))throw new Error("exponential notation not supported")}const P=T,R=g.match(P);if(!R)throw new Error("unable to find a number expression in pattern: "+O);return!1===l.fractional&&(l.places=0),O.replace(P,function G(y,O,l){!0===(l=l||{}).places&&(l.places=0),l.places===1/0&&(l.places=6);const h=O.split("."),p="string"==typeof l.places&&l.places.indexOf(",");let I=l.places;p?I=l.places.substring(p+1):I>=0||(I=(h[1]||[]).length),l.round<0||(y=Number(y.toFixed(Number(I))));const g=String(Math.abs(y)).split("."),P=g[1]||"";if(h[1]||l.places){p&&(l.places=l.places.substring(0,p));const L=void 0!==l.places?l.places:h[1]&&h[1].lastIndexOf("0")+1;L>P.length&&(g[1]=P.padEnd(Number(L),"0")),I<P.length&&(g[1]=P.substr(0,Number(I)))}else g[1]&&g.pop();const R=h[0].replace(",","");let N=R.indexOf("0");-1!==N&&(N=R.length-N,N>g[0].length&&(g[0]=g[0].padStart(N,"0")),R.includes("#")||(g[0]=g[0].substr(g[0].length-N)));let d,a,E=h[0].lastIndexOf(",");if(-1!==E){d=h[0].length-E-1;const L=h[0].substr(0,E);E=L.lastIndexOf(","),-1!==E&&(a=L.length-E-1)}const _=[];for(let L=g[0];L;){const s=L.length-d;_.push(s>0?L.substr(s):L),L=s>0?L.slice(0,s):"",a&&(d=a,a=void 0)}return g[0]=_.reverse().join(l.group||","),g.join(l.decimal||".")}(y,R[0],{decimal:p,group:h,places:l.places,round:l.round}))}(y,h,O)}const T=/[#0,]*[#0](?:\.0*#*)?/;function W(y){const O=M((y=y||{}).locale),l=y.pattern||O.pattern,h=O.group,p=O.decimal;let I=1;if(l.includes("%"))I/=100;else if(l.includes("\u2030"))I/=1e3;else if(l.includes("\xa4"))throw new Error("currency notation not supported");const g=l.split(";");return 1===g.length&&g.push("-"+g[0]),{regexp:S(g,R=>(R="(?:"+(0,m.Qs)(R,".")+")").replace(T,N=>{const d={signed:!1,separator:y.strict?h:[h,""],fractional:y.fractional,decimal:p,exponent:!1},a=N.split(".");let E=y.places;1===a.length&&1!==I&&(a[1]="###"),1===a.length||0===E?d.fractional=!1:(void 0===E&&(E=y.pattern?a[1].lastIndexOf("0")+1:1/0),E&&null==y.fractional&&(d.fractional=!0),!y.places&&E<a[1].length&&(E+=","+a[1].length),d.places=E);const _=a[0].split(",");return _.length>1&&(d.groupSize=_.pop().length,_.length>1&&(d.groupSize2=_.pop().length)),"("+function Z(y){"places"in(y=y||{})||(y.places=1/0),"string"!=typeof y.decimal&&(y.decimal="."),"fractional"in y&&!/^0/.test(String(y.places))||(y.fractional=[!0,!1]),"exponent"in y||(y.exponent=[!0,!1]),"eSigned"in y||(y.eSigned=[!0,!1]);const O=U(y),l=S(y.fractional,p=>{let I="";return p&&0!==y.places&&(I="\\"+y.decimal,y.places===1/0?I="(?:"+I+"\\d+)?":I+="\\d{"+y.places+"}"),I},!0);let h=O+l;return l&&(h="(?:(?:"+h+")|(?:"+l+"))"),h+S(y.exponent,p=>p?"([eE]"+U({signed:y.eSigned})+")":"")}(d)+")"}),!0).replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:h,decimal:p,factor:I}}function K(y,O){const l=W(O),h=new RegExp("^"+l.regexp+"$").exec(y);if(!h)return NaN;let p=h[1];if(!h[1]){if(!h[2])return NaN;p=h[2],l.factor*=-1}return p=p.replace(new RegExp("["+l.group+"\\s\\xa0]","g"),"").replace(l.decimal,"."),Number(p)*l.factor}function U(y){return"signed"in(y=y||{})||(y.signed=[!0,!1]),"separator"in y?"groupSize"in y||(y.groupSize=3):y.separator="",S(y.signed,O=>O?"[-+]":"",!0)+S(y.separator,O=>{if(!O)return"(?:\\d+)";" "===(O=(0,m.Qs)(O))?O="\\s":"\xa0"===O&&(O="\\s\\xa0");const l=y.groupSize,h=y.groupSize2;if(h){const p="(?:0|[1-9]\\d{0,"+(h-1)+"}(?:["+O+"]\\d{"+h+"})*["+O+"]\\d{"+l+"})";return l-h>0?"(?:"+p+"|(?:0|[1-9]\\d{0,"+(l-1)+"}))":p}return"(?:0|[1-9]\\d{0,"+(l-1)+"}(?:["+O+"]\\d{"+l+"})*)"},!0)}const S=(y,O,l)=>{if(!(y instanceof Array))return O(y);const h=[];for(let p=0;p<y.length;p++)h.push(O(y[p]));return D(h.join("|"),!!l)},D=(y,O)=>"("+(O?"?:":"")+y+")"},69851:(k,V,r)=>{r.d(V,{E:()=>K,H:()=>W});var m=r(38974),x=r(53251),b=r(80775),M=r(92950);const T=(0,r(77765).c)(),B=(0,x.c)(),G=(0,x.c)(),w=(0,x.c)();function W(U,S,D){return(0,M.s)(T,S[0],S[1],1),(0,M.t)(T,T,(0,m.t)(B,D)),0===T[2]?(0,b.s)(U,T[0],T[1]):(0,b.s)(U,T[0]/T[2],T[1]/T[2])}function K(U,S,D){return Z(G,S[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7]),Z(w,D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7]),(0,m.m)(U,(0,m.a)(G,G),w),0!==U[8]&&(U[0]/=U[8],U[1]/=U[8],U[2]/=U[8],U[3]/=U[8],U[4]/=U[8],U[5]/=U[8],U[6]/=U[8],U[7]/=U[8],U[8]/=U[8]),U}function Z(U,S,D,y,O,l,h,p,I){(0,m.s)(U,S,y,l,D,O,h,1,1,1),(0,M.s)(T,p,I,1),(0,m.a)(B,U);const[g,P,R]=(0,M.t)(T,T,(0,m.t)(B,B));return(0,m.s)(B,g,0,0,0,P,0,0,0,R),(0,m.m)(U,B,U)}},45774:(k,V,r)=>{r.r(V),r.d(V,{hydratedAdapter:()=>T});var m=r(10465),x=r(23675),b=r(35787),M=r(55733),A=r(7913);const T={convertToGEGeometry:function B(U,S){if(null==S)return null;let D="cache"in S?S.cache._geVersion:void 0;return null==D&&(D=U.convertJSONToGeometry(S),"cache"in S&&(S.cache._geVersion=D)),D},exportPoint:function G(U,S,D){const y=U.hasZ(S),O=U.hasM(S),l=new b.Z({x:U.getPointX(S),y:U.getPointY(S),spatialReference:D});return y&&(l.z=U.getPointZ(S)),O&&(l.m=U.getPointM(S)),l.cache._geVersion=S,l},exportPolygon:function w(U,S,D){const y=new M.Z({rings:U.exportPaths(S),hasZ:U.hasZ(S),hasM:U.hasM(S),spatialReference:D});return y.cache._geVersion=S,y},exportPolyline:function W(U,S,D){const y=new A.Z({paths:U.exportPaths(S),hasZ:U.hasZ(S),hasM:U.hasM(S),spatialReference:D});return y.cache._geVersion=S,y},exportMultipoint:function K(U,S,D){const y=new x.Z({hasZ:U.hasZ(S),hasM:U.hasM(S),points:U.exportPoints(S),spatialReference:D});return y.cache._geVersion=S,y},exportExtent:function Z(U,S,D){const y=U.hasZ(S),O=U.hasM(S),l=new m.Z({xmin:U.getXMin(S),ymin:U.getYMin(S),xmax:U.getXMax(S),ymax:U.getYMax(S),spatialReference:D});if(y){const h=U.getZExtent(S);l.zmin=h.vmin,l.zmax=h.vmax}if(O){const h=U.getMExtent(S);l.mmin=h.vmin,l.mmax=h.vmax}return l.cache._geVersion=S,l}}},15390:(k,V,r)=>{r.r(V),r.d(V,{buffer:()=>b.v,changeDefaultSpatialReferenceTolerance:()=>b.M,clearDefaultSpatialReferenceTolerance:()=>b.N,clip:()=>b.c,contains:()=>b.b,convexHull:()=>b.l,crosses:()=>b.d,cut:()=>b.a,densify:()=>b.F,difference:()=>b.m,disjoint:()=>b.j,distance:()=>b.f,equals:()=>b.h,extendedSpatialReferenceInfo:()=>b.e,flipHorizontal:()=>b.C,flipVertical:()=>b.D,generalize:()=>b.E,geodesicArea:()=>b.J,geodesicBuffer:()=>b.x,geodesicDensify:()=>b.G,geodesicLength:()=>b.K,intersect:()=>b.p,intersectLinesToPoints:()=>b.L,intersects:()=>b.i,isSimple:()=>b.k,nearestCoordinate:()=>b.y,nearestVertex:()=>b.z,nearestVertices:()=>b.A,offset:()=>b.q,overlaps:()=>b.o,planarArea:()=>b.H,planarLength:()=>b.I,relate:()=>b.r,rotate:()=>b.B,simplify:()=>b.s,symmetricDifference:()=>b.n,touches:()=>b.t,union:()=>b.u,within:()=>b.w}),r(77640),r(17409);var b=r(58222)},19511:(k,V,r)=>{r.d(V,{Ue:()=>T,nF:()=>U,zk:()=>W});var m=r(93142),x=r(93668),b=r(92950),M=r(77765),A=r(82309);function T(g){return g?{origin:(0,M.a)(g.origin),vector:(0,M.a)(g.vector)}:{origin:(0,M.c)(),vector:(0,M.c)()}}function W(g,P,R=T()){return(0,b.c)(R.origin,g),(0,b.b)(R.vector,P,g),R}function U(g,P,R){return function D(g,P,R,N,d){const{vector:a,origin:E}=g,_=(0,b.b)(A.WM.get(),P,E),L=(0,b.e)(a,_)/(0,b.p)(a);return(0,b.g)(d,a,(0,m.uZ)(L,R,N)),(0,b.a)(d,d,g.origin)}(g,P,0,1,R)}(0,M.c)(),(0,M.c)(),new x.x(()=>T())},71815:(k,V,r)=>{r.r(V),r.d(V,{default:()=>L});var E,m=r(71670),x=r(18100),M=(r(6010),r(1897)),A=r(32995),T=r(90642),B=r(3758),G=r(55050),w=r(9497),Z=(r(83382),r(19420),r(66508)),U=r(20891),S=r(70425),D=r(22735),y=r(29812),O=r(33829),l=r(16617),h=r(17085),p=r(72450),I=r(57062),g=r(2547),P=r(51015),R=r(97326),N=r(10465),d=r(68230),a=r(35787);let _=E=class extends((0,y.h)((0,h.Q)((0,p.M)((0,O.q)((0,l.I)((0,T.R)(D.Z))))))){constructor(...s){super(...s),this.copyright="",this.fullExtent=new N.Z(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,d.Z.WebMercator),this.legendEnabled=!1,this.isReference=null,this.popupEnabled=!1,this.spatialReference=d.Z.WebMercator,this.subDomains=null,this.tileInfo=new P.Z({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new a.Z({x:-20037508.342787,y:20037508.342787,spatialReference:d.Z.WebMercator}),spatialReference:d.Z.WebMercator,lods:[new g.Z({level:0,scale:591657527.591555,resolution:156543.033928}),new g.Z({level:1,scale:295828763.795777,resolution:78271.5169639999}),new g.Z({level:2,scale:147914381.897889,resolution:39135.7584820001}),new g.Z({level:3,scale:73957190.948944,resolution:19567.8792409999}),new g.Z({level:4,scale:36978595.474472,resolution:9783.93962049996}),new g.Z({level:5,scale:18489297.737236,resolution:4891.96981024998}),new g.Z({level:6,scale:9244648.868618,resolution:2445.98490512499}),new g.Z({level:7,scale:4622324.434309,resolution:1222.99245256249}),new g.Z({level:8,scale:2311162.217155,resolution:611.49622628138}),new g.Z({level:9,scale:1155581.108577,resolution:305.748113140558}),new g.Z({level:10,scale:577790.554289,resolution:152.874056570411}),new g.Z({level:11,scale:288895.277144,resolution:76.4370282850732}),new g.Z({level:12,scale:144447.638572,resolution:38.2185141425366}),new g.Z({level:13,scale:72223.819286,resolution:19.1092570712683}),new g.Z({level:14,scale:36111.909643,resolution:9.55462853563415}),new g.Z({level:15,scale:18055.954822,resolution:4.77731426794937}),new g.Z({level:16,scale:9027.977411,resolution:2.38865713397468}),new g.Z({level:17,scale:4513.988705,resolution:1.19432856685505}),new g.Z({level:18,scale:2256.994353,resolution:.597164283559817}),new g.Z({level:19,scale:1128.497176,resolution:.298582141647617}),new g.Z({level:20,scale:564.248588,resolution:.14929107082380833}),new g.Z({level:21,scale:282.124294,resolution:.07464553541190416}),new g.Z({level:22,scale:141.062147,resolution:.03732276770595208}),new g.Z({level:23,scale:70.5310735,resolution:.01866138385297604})]}),this.type="web-tile",this.urlTemplate=null,this.wmtsInfo=null}normalizeCtorArgs(s,v){return"string"==typeof s?{urlTemplate:s,...v}:s}load(s){const v=this.loadFromPortal({supportedTypes:["WMTS"]},s).then(()=>{let C="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const j=new G.R9(this.urlTemplate);!(this.subDomains&&this.subDomains.length>0)&&j.authority?.includes("{subDomain}")&&(C="is missing 'subDomains' property")}else C="spatialReference must match tileInfo.spatialReference";else C="is missing the required 'urlTemplate' property value";if(C)throw new A.Z("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${C}`)});return this.addResolvingPromise(v),Promise.resolve(this)}get levelValues(){const s=[];if(!this.tileInfo)return null;for(const v of this.tileInfo.lods)s[v.level]=v.levelValue||v.level;return s}readSpatialReference(s,v){return s||v.fullExtent&&v.fullExtent.spatialReference&&d.Z.fromJSON(v.fullExtent.spatialReference)}get tileServers(){if(!this.urlTemplate)return null;const s=[],{urlTemplate:v,subDomains:C}=this,j=new G.R9(v),F=j.scheme?j.scheme+"://":"//",z=F+j.authority+"/",X=j.authority;if(X?.includes("{subDomain}")){if(C&&C.length>0&&X.split(".").length>1)for(const $ of C)s.push(F+X.replace(/\{subDomain\}/gi,$)+"/")}else s.push(z);return s.map($=>("/"!==$.charAt($.length-1)&&($+="/"),$))}get urlPath(){if(!this.urlTemplate)return null;const s=this.urlTemplate,v=new G.R9(s);return s.substring(((v.scheme?v.scheme+"://":"//")+v.authority+"/").length)}readUrlTemplate(s,v){return s||v.templateUrl}writeUrlTemplate(s,v){s&&(0,G.oC)(s)&&(s="https:"+s),s&&(s=s.replace(/\{z\}/gi,"{level}").replace(/\{x\}/gi,"{col}").replace(/\{y\}/gi,"{row}"),s=(0,G.Fv)(s)),v.templateUrl=s}fetchTile(s,v,C,j={}){const{signal:F}=j,z=this.getTileUrl(s,v,C),X={responseType:"image",signal:F,query:{...this.refreshParameters}};return(0,M.default)(z,X).then($=>$.data)}fetchImageBitmapTile(s,v,C,j={}){var F=this;return(0,m.Z)(function*(){const{signal:z}=j;if(F.fetchTile!==E.prototype.fetchTile){const ee=yield F.fetchTile(s,v,C,j);try{return createImageBitmap(ee)}catch(q){throw new A.Z("request:server",`Unable to load tile ${s}/${v}/${C}`,{error:q,level:s,row:v,col:C})}}const X=F.getTileUrl(s,v,C),$={responseType:"blob",signal:z,query:{...F.refreshParameters}},{data:Q}=yield(0,M.default)(X,$);return(0,I.g)(Q,X)})()}getTileUrl(s,v,C){const{levelValues:j,tileServers:F,urlPath:z}=this;if(!j||!F||!z)return"";const X=j[s];return F[v%F.length]+(0,B.gx)(z,{level:X,z:X,col:C,x:C,row:v,y:v})}};(0,x._)([(0,w.Cb)({type:String,value:"",json:{write:!0}})],_.prototype,"copyright",void 0),(0,x._)([(0,w.Cb)({type:N.Z,json:{write:!0},nonNullable:!0})],_.prototype,"fullExtent",void 0),(0,x._)([(0,w.Cb)({readOnly:!0,json:{read:!1,write:!1}})],_.prototype,"legendEnabled",void 0),(0,x._)([(0,w.Cb)({type:["show","hide"]})],_.prototype,"listMode",void 0),(0,x._)([(0,w.Cb)({json:{read:!0,write:!0}})],_.prototype,"blendMode",void 0),(0,x._)([(0,w.Cb)()],_.prototype,"levelValues",null),(0,x._)([(0,w.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],_.prototype,"isReference",void 0),(0,x._)([(0,w.Cb)({type:["WebTiledLayer"],value:"WebTiledLayer"})],_.prototype,"operationalLayerType",void 0),(0,x._)([(0,w.Cb)({readOnly:!0,json:{read:!1,write:!1}})],_.prototype,"popupEnabled",void 0),(0,x._)([(0,w.Cb)({type:d.Z})],_.prototype,"spatialReference",void 0),(0,x._)([(0,Z.r)("spatialReference",["spatialReference","fullExtent.spatialReference"])],_.prototype,"readSpatialReference",null),(0,x._)([(0,w.Cb)({type:[String],json:{write:!0}})],_.prototype,"subDomains",void 0),(0,x._)([(0,w.Cb)({type:P.Z,json:{write:!0}})],_.prototype,"tileInfo",void 0),(0,x._)([(0,w.Cb)({readOnly:!0})],_.prototype,"tileServers",null),(0,x._)([(0,w.Cb)({json:{read:!1}})],_.prototype,"type",void 0),(0,x._)([(0,w.Cb)()],_.prototype,"urlPath",null),(0,x._)([(0,w.Cb)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],_.prototype,"urlTemplate",void 0),(0,x._)([(0,Z.r)("urlTemplate",["urlTemplate","templateUrl"])],_.prototype,"readUrlTemplate",null),(0,x._)([(0,S.c)("urlTemplate",{templateUrl:{type:String}})],_.prototype,"writeUrlTemplate",null),(0,x._)([(0,w.Cb)({type:R.B,json:{write:!0}})],_.prototype,"wmtsInfo",void 0),_=E=(0,x._)([(0,U.j)("esri.layers.WebTileLayer")],_);const L=_},15794:(k,V,r)=>{var m,x;r.d(V,{i:()=>m}),(x=m||(m={}))[x.PROJECT_VERTICES=1]="PROJECT_VERTICES"},97135:(k,V,r)=>{r.d(V,{H:()=>G});var m=r(67087),x=r(52674),b=r(6848);const A={minX:0,minY:0,maxX:0,maxY:0};class G{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new x.Q(9,(0,m.Z)("esri-csp-restrictions")?W=>({minX:W[0],minY:W[1],maxX:W[2],maxY:W[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const W=new Array(this._idByBounds.size);let K=0;this._idByBounds.forEach((Z,U)=>{W[K++]=U}),this._indexInvalid=!1,this._index.clear(),this._index.load(W)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(W=>this._idByBounds.has(W))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const W=(0,b.cS)();for(const K of this._boundsById.values())K&&(W[0]=Math.min(K[0],W[0]),W[1]=Math.min(K[1],W[1]),W[2]=Math.max(K[2],W[2]),W[3]=Math.max(K[3],W[3]));return W}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(W){const K=this._boundsById.get(W);this._boundsById.delete(W),K&&(this._idByBounds.delete(K),this._indexInvalid||this._index.remove(K))}forEachInBounds(W,K){this._loadIndex(),function B(w,W,K){(function T(w){A.minX=w[0],A.minY=w[1],A.maxX=w[2],A.maxY=w[3]})(W),w.search(A,K)}(this._index,W,Z=>K(this._idByBounds.get(Z)))}get(W){return this._boundsById.get(W)}has(W){return this._boundsById.has(W)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(W,K){if(!this._indexInvalid){const Z=this._boundsById.get(W);Z&&(this._index.remove(Z),this._idByBounds.delete(Z))}this._boundsById.set(W,K),K&&(this._idByBounds.set(K,W),this._indexInvalid||(this._boundsToLoad.push(K),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},63689:(k,V,r)=>{r.d(V,{Z:()=>D});var m=r(32995),x=r(95442),b=r(28191),M=r(53661),A=r(73327),T=r(6848),B=r(50805),G=r(97135),w=r(74486),W=r(33510),K=r(93846);const Z={getObjectId:y=>y.objectId,getAttributes:y=>y.attributes,getAttribute:(y,O)=>y.attributes[O],cloneWithGeometry:(y,O)=>new W.u_(O,y.attributes,null,y.objectId),getGeometry:y=>y.geometry,getCentroid:(y,O)=>((0,M.Wi)(y.centroid)&&(y.centroid=(0,w.Y)(new K.Z,y.geometry,O.hasZ,O.hasM)),y.centroid)};var U=r(21272);const S=(0,A.Ue)();class D{constructor(O){this.geometryInfo=O,this._boundsStore=new G.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new x.Z,this.featureAdapter=Z}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let O=0;return this._featuresById.forEach(l=>{(0,M.pC)(l.geometry)&&l.geometry.coords&&(O+=l.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:O/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(O){if((0,M.Wi)(this.fullBounds))return null;const[l,h,p,I]=this.fullBounds;return{xmin:l,ymin:h,xmax:p,ymax:I,spatialReference:(0,U.S2)(O)}}add(O){this._add(O),this._emitChanged()}addMany(O){for(const l of O)this._add(l);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(O){const l=this._featuresById.get(O);return l?(this._remove(l),this._emitChanged(),l):null}removeManyById(O){this._boundsStore.invalidateIndex();for(const l of O){const h=this._featuresById.get(l);h&&this._remove(h)}this._emitChanged()}forEachBounds(O,l){for(const h of O){const p=this._boundsStore.get(h.objectId);p&&l((0,A.JR)(S,p))}}getFeature(O){return this._featuresById.get(O)}has(O){return this._featuresById.has(O)}forEach(O){this._featuresById.forEach(l=>O(l))}forEachInBounds(O,l){this._boundsStore.forEachInBounds(O,h=>{l(this._featuresById.get(h))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let O=!1;this._featuresById.forEach((l,h)=>{this._markedIds.has(h)||(O=!0,this._remove(l))}),this._markedIds.clear(),O&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(O){if(!O)return;const l=O.objectId;if(null==l)return void b.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new m.Z("featurestore:invalid-feature","feature id is missing",{feature:O}));const h=this._featuresById.get(l);let p;if(this._markedIds.add(l),h?(O.displayId=h.displayId,p=this._boundsStore.get(l),this._boundsStore.delete(l)):(0,M.pC)(this.onFeatureAdd)&&this.onFeatureAdd(O),(0,M.Wi)(O.geometry)||!O.geometry.coords||!O.geometry.coords.length)return this._boundsStore.set(l,null),void this._featuresById.set(l,O);p=(0,B.$)((0,M.pC)(p)?p:(0,T.Ue)(),O.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,M.pC)(p)&&this._boundsStore.set(l,p),this._featuresById.set(l,O)}_remove(O){(0,M.pC)(this.onFeatureRemove)&&this.onFeatureRemove(O);const l=O.objectId;return this._markedIds.delete(l),this._boundsStore.delete(l),this._featuresById.delete(l),O}}},26793:(k,V,r)=>{r.d(V,{S:()=>x,X:()=>m});const m=1;function x(b,M){let A=0;for(const T of M){const B=T.attributes?.[b];"number"==typeof B&&isFinite(B)&&(A=Math.max(A,B))}return A}},81665:(k,V,r)=>{r.r(V),r.d(V,{createConnection:()=>L});var m=r(71670),x=r(18100),M=(r(6010),r(1897)),A=r(32995),T=r(28191),B=r(53661),G=r(30801),w=r(55050),U=(r(83382),r(19420),r(67087),r(20891)),S=r(9497),D=r(83970),y=r(95442);let O=class extends y.Z.EventedAccessor{destroy(){this.emit("destroy")}get connectionError(){return this.errorString?new A.Z("stream-connection",this.errorString):null}onFeature(s){this.emit("data-received",s)}onMessage(s){this.emit("message-received",s)}};(0,x._)([(0,S.Cb)({readOnly:!0})],O.prototype,"connectionError",null),O=(0,x._)([(0,U.j)("esri.layers.support.StreamConnection")],O);const l=O;var h,s;(s=h||(h={}))[s.CONNECTING=0]="CONNECTING",s[s.OPEN=1]="OPEN",s[s.CLOSING=2]="CLOSING",s[s.CLOSED=3]="CLOSED";let p=class extends l{constructor(s){super(),this._outstandingMessages=[],this.errorString=null;const{geometryType:v,spatialReference:C,sourceSpatialReference:j}=s;this._config=s,this._featureZScaler=(0,D.k)(v,j,C),this._open()}_open(){var s=this;return(0,m.Z)(function*(){yield s._tryCreateWebSocket(),s.destroyed||(yield s._handshake())})()}destroy(){super.destroy(),(0,B.pC)(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if((0,B.Wi)(this._websocket))return"disconnected";switch(this._websocket.readyState){case h.CONNECTING:case h.OPEN:return"connected";case h.CLOSING:case h.CLOSED:return"disconnected"}}sendMessageToSocket(s){(0,B.Wi)(this._websocket)?this._outstandingMessages.push(s):this._websocket.send(JSON.stringify(s))}sendMessageToClient(s){this._onMessage(s)}updateCustomParameters(s){this._config.customParameters=s,(0,B.pC)(this._websocket)&&this._websocket.close()}_tryCreateWebSocket(s=this._config.source.path,v=1e3,C=0){var j=this;return(0,m.Z)(function*(){try{if(j.destroyed)return;const F=(0,w.fl)(s,j._config.customParameters??{});j._websocket=yield j._createWebSocket(F),j.notifyChange("connectionStatus")}catch(F){const z=v/1e3;return j._config.maxReconnectionAttempts&&C>=j._config.maxReconnectionAttempts?(T.Z.getLogger(j.declaredClass).error(new A.Z("websocket-connection","Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),void j.destroy()):(T.Z.getLogger(j.declaredClass).error(new A.Z("websocket-connection",`Failed to connect. Attempting to reconnect in ${z}s`,F)),yield(0,G.e4)(v),j._tryCreateWebSocket(s,Math.min(1.5*v,1e3*j._config.maxReconnectionInterval),C+1))}})()}_setWebSocketJSONParseHandler(s){s.onmessage=v=>{try{const C=JSON.parse(v.data);this._onMessage(C)}catch(C){return void T.Z.getLogger(this.declaredClass).error(new A.Z("websocket-connection","Failed to parse message, invalid JSON",{error:C}))}}}_createWebSocket(s){return new Promise((v,C)=>{const j=new WebSocket(s);j.onopen=()=>{if(j.onopen=null,this.destroyed)return j.onclose=null,void j.close();j.onclose=F=>this._onClose(F),j.onerror=F=>this._onError(F),this._setWebSocketJSONParseHandler(j),v(j)},j.onclose=F=>{j.onopen=j.onclose=null,C(F)}})}_handshake(s=1e4){var v=this;return(0,m.Z)(function*(){const C=v._websocket;if((0,B.Wi)(C))return;const j=(0,G.hh)(),F=C.onmessage,{filter:z,outFields:X,spatialReference:$}=v._config;return j.timeout(s),C.onmessage=Q=>{let ee=null;try{ee=JSON.parse(Q.data)}catch{}ee&&"object"==typeof ee||(T.Z.getLogger(v.declaredClass).error(new A.Z("websocket-connection","Protocol violation. Handshake failed - malformed message",Q.data)),j.reject(),v.destroy()),ee.spatialReference?.wkid!==$?.wkid&&(T.Z.getLogger(v.declaredClass).error(new A.Z("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${$.wkid}`,Q.data)),j.reject(),v.destroy()),"json"!==ee.format&&(T.Z.getLogger(v.declaredClass).error(new A.Z("websocket-connection","Protocol violation. Handshake failed - format is not set",Q.data)),j.reject(),v.destroy()),z&&ee.filter!==z&&T.Z.getLogger(v.declaredClass).error(new A.Z("websocket-connection","Tried to set filter, but server doesn't support it")),X&&ee.outFields!==X&&T.Z.getLogger(v.declaredClass).error(new A.Z("websocket-connection","Tried to set outFields, but server doesn't support it")),C.onmessage=F;for(const q of v._outstandingMessages)C.send(JSON.stringify(q));v._outstandingMessages=[],j.resolve()},C.send(JSON.stringify({filter:z,outFields:X,format:"json",spatialReference:{wkid:$.wkid}})),j.promise})()}_onMessage(s){if(this.onMessage(s),"type"in s)switch(s.type){case"features":case"featureResult":for(const v of s.features)(0,B.pC)(this._featureZScaler)&&this._featureZScaler(v.geometry),this.onFeature(v)}}_onError(s){const v="Encountered an error over WebSocket connection";this._set("errorString",v),T.Z.getLogger(this.declaredClass).error("websocket-connection",v)}_onClose(s){this._websocket=null,this.notifyChange("connectionStatus"),1e3!==s.code&&T.Z.getLogger(this.declaredClass).error("websocket-connection",`WebSocket closed unexpectedly with error code ${s.code}`),this.destroyed||this._open()}};(0,x._)([(0,S.Cb)()],p.prototype,"connectionStatus",null),(0,x._)([(0,S.Cb)()],p.prototype,"errorString",void 0),p=(0,x._)([(0,U.j)("esri.layers.graphics.sources.connections.WebSocketConnection")],p);var I=r(78170),g=r(28665),P=r(71182),R=r(68230);const d={maxQueryDepth:5,maxRecordCountFactor:3};let a=class extends p{constructor(s){super({...d,...s}),this._buddyServicesQuery=null,this._relatedFeatures=null}_open(){var s=this;return(0,m.Z)(function*(){const v=yield s._fetchServiceDefinition(s._config.source);v.timeInfo.trackIdField||T.Z.getLogger(s.declaredClass).warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");const C=s._fetchWebSocketUrl(v.streamUrls,s._config.spatialReference);s._buddyServicesQuery||(s._buddyServicesQuery=s._queryBuddyServices()),yield s._buddyServicesQuery,yield s._tryCreateWebSocket(C);const{filter:j,outFields:F}=s._config;s.destroyed||s._setFilter(j,F)})()}_onMessage(s){if("attributes"in s){let v;try{v=this._enrich(s),(0,B.pC)(this._featureZScaler)&&this._featureZScaler(v.geometry)}catch(C){return void T.Z.getLogger(this.declaredClass).error(new A.Z("geoevent-connection","Failed to parse message",C))}this.onFeature(v)}else this.onMessage(s)}_fetchServiceDefinition(s){var v=this;return(0,m.Z)(function*(){const C={f:"json",...v._config.customParameters},j=(0,M.default)(s.path,{query:C,responseType:"json"}),F=(yield j).data;return v._serviceDefinition=F,F})()}_fetchWebSocketUrl(s,v){const C=s[0],{urls:j,token:F}=C,z=this._inferWebSocketBaseUrl(j);return(0,w.fl)(`${z}/subscribe`,{outSR:""+v.wkid,token:F})}_inferWebSocketBaseUrl(s){if(1===s.length)return s[0];for(const v of s)if(v.includes("wss"))return v;return T.Z.getLogger(this.declaredClass).error(new A.Z("geoevent-connection","Unable to infer WebSocket url",s)),null}_setFilter(s,v){var C=this;return(0,m.Z)(function*(){const j=C._websocket;if((0,B.Wi)(j)||(0,B.Wi)(s)&&(0,B.Wi)(v))return;const F=JSON.stringify({filter:C._serializeFilter(s,v)});let z=!1;const X=(0,G.hh)();return j.onmessage=ee=>{const q=JSON.parse(ee.data);q.filter&&(q.error&&(T.Z.getLogger(C.declaredClass).error(new A.Z("geoevent-connection","Failed to set service filter",q.error)),C._set("errorString",`Could not set service filter - ${q.error}`),X.reject(q.error)),C._setWebSocketJSONParseHandler(j),z=!0,X.resolve())},j.send(F),setTimeout(()=>{z||(C.destroyed||C._websocket!==j||T.Z.getLogger(C.declaredClass).error(new A.Z("geoevent-connection","Server timed out when setting filter")),X.reject())},1e4),X.promise})()}_serializeFilter(s,v){const C={};if((0,B.Wi)(s)&&(0,B.Wi)(v))return C;if((0,B.pC)(s)&&s.geometry)try{const j=(0,P.im)(s.geometry);if("extent"!==j.type)throw new A.Z(`Expected extent but found type ${j.type}`);C.geometry=JSON.stringify(j.shiftCentralMeridian())}catch(j){T.Z.getLogger(this.declaredClass).error(new A.Z("geoevent-connection","Encountered an error when setting connection geometryDefinition",j))}return(0,B.pC)(s)&&s.where&&"1 = 1"!==s.where&&"1=1"!==s.where&&(C.where=s.where),(0,B.pC)(v)&&(C.outFields=v.join(",")),C}_enrich(s){if(!this._relatedFeatures)return s;const j=this._relatedFeatures.get(s.attributes[this._serviceDefinition.relatedFeatures.joinField]);if(!j)return T.Z.getLogger(this.declaredClass).warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",s),s;const{attributes:F,geometry:z}=j;for(const X in F)s.attributes[X]=F[X];return z&&(s.geometry=z),s.geometry||s.centroid||T.Z.getLogger(this.declaredClass).error(new A.Z("geoevent-connection","Found malformed feature - no geometry found",s)),s}_queryBuddyServices(){var s=this;return(0,m.Z)(function*(){try{const{relatedFeatures:v,keepLatestArchive:C}=s._serviceDefinition,j=s._queryRelatedFeatures(v),F=s._queryArchive(C);yield j;const z=yield F;if(!z)return;for(const X of z.features)s.onFeature(s._enrich(X))}catch(v){T.Z.getLogger(s.declaredClass).error(new A.Z("geoevent-connection","Encountered an error when querying buddy services",{error:v}))}})()}_queryRelatedFeatures(s){var v=this;return(0,m.Z)(function*(){if(!s)return;const C=yield v._queryBuddy(s.featuresUrl);v._addRelatedFeatures(C)})()}_queryArchive(s){var v=this;return(0,m.Z)(function*(){if(s)return v._queryBuddy(s.featuresUrl)})()}_queryBuddy(s){var v=this;return(0,m.Z)(function*(){const C=new((yield Promise.resolve().then(r.bind(r,36102))).default)({url:s}),{capabilities:j}=yield C.load(),F=j.query.supportsMaxRecordCountFactor,z=j.query.supportsPagination,X=j.query.supportsCentroid,$=v._config.maxRecordCountFactor,Q=C.capabilities.query.maxRecordCount,ee=F?Q*$:Q,q=new g.Z;if(q.outFields=(0,B.Pt)(v._config.outFields,["*"]),q.where=(0,B.Pt)((0,B.U2)(v._config.filter,"where"),"1=1"),q.returnGeometry=!0,q.returnExceededLimitFeatures=!0,q.outSpatialReference=R.Z.fromJSON(v._config.spatialReference),X&&(q.returnCentroid=!0),F&&(q.maxRecordCountFactor=$),z)return q.num=ee,C.destroy(),v._queryPages(s,q);const ne=yield(0,I.JT)(s,q,v._config.sourceSpatialReference);return C.destroy(),ne.data})()}_queryPages(s,v,C=[],j=0){var F=this;return(0,m.Z)(function*(){v.start=(0,B.pC)(v.num)?j*v.num:null;const{data:z}=yield(0,I.JT)(s,v,F._config.sourceSpatialReference);return z.exceededTransferLimit&&j<(F._config.maxQueryDepth??0)?(z.features.forEach(X=>C.push(X)),F._queryPages(s,v,C,j+1)):(C.forEach(X=>z.features.push(X)),z)})()}_addRelatedFeatures(s){const v=new Map,C=s.features,j=this._serviceDefinition.relatedFeatures.joinField;for(const F of C)v.set(F.attributes[j],F);this._relatedFeatures=v}};a=(0,x._)([(0,U.j)("esri.layers.graphics.sources.connections.GeoEventConnection")],a);const E=a;let _=class extends l{constructor(s){super(),this.connectionStatus="connected",this.errorString=null;const{geometryType:v,spatialReference:C,sourceSpatialReference:j}=s;this._featureZScaler=(0,D.k)(v,j,C)}updateCustomParameters(s){}sendMessageToSocket(s){}sendMessageToClient(s){if("type"in s)switch(s.type){case"features":case"featureResult":for(const v of s.features)(0,B.pC)(this._featureZScaler)&&this._featureZScaler(v.geometry),this.onFeature(v)}this.onMessage(s)}};function L(s,v,C,j,F,z,X,$){const Q={source:s,sourceSpatialReference:v,spatialReference:C,geometryType:j,filter:F,maxReconnectionAttempts:z,maxReconnectionInterval:X,customParameters:$};return s?s.path.startsWith("wss://")||s.path.startsWith("ws://")?new p(Q):new E(Q):new _(Q)}(0,x._)([(0,S.Cb)()],_.prototype,"connectionStatus",void 0),(0,x._)([(0,S.Cb)()],_.prototype,"errorString",void 0),_=(0,x._)([(0,U.j)("esri.layers.support.ClientSideConnection")],_)},65210:(k,V,r)=>{r.d(V,{O0:()=>K,av:()=>B,b:()=>O,d1:()=>w,og:()=>S});var m=r(71670),x=r(53661),b=r(53492),M=r(21230);class A{constructor(){this.code=null,this.description=null}}class T{constructor(p){this.error=new A,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=p}}function B(h){return new T(h)}class G{constructor(p){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=p}}function w(h){return new G(h)}const W=new Set;function K(h,p,I,g=!1,P){W.clear();for(const R in I){const N=h.get(R);if(!N)continue;const d=I[R],a=Z(N,d);if(a!==d&&P&&P.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:N,originalValue:d,sanitizedValue:a}}),W.add(N.name),N&&(g||N.editable)){const E=(0,M.Qc)(N,a);if(E)return B((0,M.vP)(E,N,a));p[N.name]=a}}for(const R of h?.requiredFields??[])if(!W.has(R.name))return B(`missing required field "${R.name}"`);return null}function Z(h,p){let I=p;return"string"==typeof p&&(0,M.H7)(h)?I=parseFloat(p):null!=p&&(0,M.qN)(h)&&"string"!=typeof p&&(I=String(p)),(0,M.Pz)(I)}let U;function S(h,p){if(!h||!(0,b.JY)(p))return h;if("rings"in h||"paths"in h){if((0,x.Wi)(U))throw new TypeError("geometry engine not loaded");return U.simplify(p,h)}return h}function y(){return(y=(0,m.Z)(function*(){return(0,x.Wi)(U)&&(U=yield Promise.all([r.e(7640),r.e(8592)]).then(r.bind(r,15390))),U})).apply(this,arguments)}function O(h,p){return l.apply(this,arguments)}function l(){return l=(0,m.Z)(function*(h,p){!(0,b.JY)(h)||"esriGeometryPolygon"!==p&&"esriGeometryPolyline"!==p||(yield function D(){return y.apply(this,arguments)}())}),l.apply(this,arguments)}},61223:(k,V,r)=>{r.d(V,{Z:()=>K});var m=r(18100),b=(r(6010),r(9497)),T=(r(83382),r(19420),r(66508)),B=r(20891),G=r(32651),w=r(88411),W=r(68230);const K=Z=>{let U=class extends Z{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(S,D){return null!=D.minLOD&&null!=D.maxLOD?S:0}readMaxScale(S,D){return null!=D.minLOD&&null!=D.maxLOD?S:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(S,D){return D.capabilities&&D.capabilities.includes("Tilemap")?new w.y({layer:this}):null}};return(0,m._)([(0,b.Cb)({json:{read:{source:"copyrightText"}}})],U.prototype,"copyright",void 0),(0,m._)([(0,b.Cb)()],U.prototype,"minScale",void 0),(0,m._)([(0,T.r)("service","minScale")],U.prototype,"readMinScale",null),(0,m._)([(0,b.Cb)()],U.prototype,"maxScale",void 0),(0,m._)([(0,T.r)("service","maxScale")],U.prototype,"readMaxScale",null),(0,m._)([(0,b.Cb)({type:W.Z})],U.prototype,"spatialReference",void 0),(0,m._)([(0,b.Cb)({readOnly:!0})],U.prototype,"supportsBlankTile",null),(0,m._)([(0,b.Cb)(G.h)],U.prototype,"tileInfo",void 0),(0,m._)([(0,b.Cb)()],U.prototype,"tilemapCache",void 0),(0,m._)([(0,T.r)("service","tilemapCache",["capabilities"])],U.prototype,"readTilemapCache",null),(0,m._)([(0,b.Cb)()],U.prototype,"version",void 0),U=(0,m._)([(0,B.j)("esri.layers.mixins.ArcGISCachedService")],U),U}},5436:(k,V,r)=>{r.d(V,{A:()=>x});const m=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function x(b){return null!=b&&m.some(([M,A])=>b>=M&&b<=A)}},67652:(k,V,r)=>{r.d(V,{R:()=>S});var m=r(18100),x=r(6365),b=r(31882),M=r(53661),A=r(96204),T=r(9497),w=(r(83382),r(19420),r(20891)),W=r(51299),K=r(1167),Z=r(48878);const U={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let S=class extends((0,b.p)(x.Z)){constructor(D){super(D),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const D=this.visibleSublayers.map(y=>{const O=(0,K.f)(this.floors,y);return y.toExportImageJSON(O)});return D.length?JSON.stringify(D):null}get hasDynamicLayers(){return this.layer&&(0,Z.FN)(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(D){this._get("layer")!==D&&(this._set("layer",D),this.handles.remove("layer"),D&&this.handles.add([D.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),D.on("sublayer-update",y=>this.notifyChange(U[y.propertyName]))],"layer"))}get layers(){const D=this.visibleSublayers;return D?D.length?"show:"+D.map(y=>y.id).join(","):"show:-1":null}get layerDefs(){const D=!!this.floors?.length,y=this.visibleSublayers.filter(O=>null!=O.definitionExpression||D&&null!=O.floorInfo);return y.length?JSON.stringify(y.reduce((O,l)=>{const h=(0,K.f)(this.floors,l),p=(0,A._)(h,l.definitionExpression);return(0,M.pC)(p)&&(O[l.id]=p),O},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const D=this.layer;return D&&(D.commitProperty("dpi"),D.commitProperty("imageFormat"),D.commitProperty("imageTransparency"),D.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const D=[];if(!this.layer)return D;const y=this.layer.sublayers,O=h=>{const p=this.scale;h.visible&&(0===p||(0===h.minScale||p<=h.minScale)&&(0===h.maxScale||p>=h.maxScale))&&(h.sublayers?h.sublayers.forEach(O):D.unshift(h))};y&&y.forEach(O);const l=this._get("visibleSublayers");return!l||l.length!==D.length||l.some((h,p)=>D[p]!==h)?D:l}toJSON(){const D=this.layer;let y={dpi:D.dpi,format:D.imageFormat,transparent:D.imageTransparency,gdbVersion:D.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?y.dynamicLayers=this.dynamicLayers:y={...y,layers:this.layers,layerDefs:this.layerDefs},y}};(0,m._)([(0,T.Cb)({readOnly:!0})],S.prototype,"dynamicLayers",null),(0,m._)([(0,T.Cb)()],S.prototype,"floors",void 0),(0,m._)([(0,T.Cb)({readOnly:!0})],S.prototype,"hasDynamicLayers",null),(0,m._)([(0,T.Cb)()],S.prototype,"layer",null),(0,m._)([(0,T.Cb)({readOnly:!0})],S.prototype,"layers",null),(0,m._)([(0,T.Cb)({readOnly:!0})],S.prototype,"layerDefs",null),(0,m._)([(0,T.Cb)({type:Number})],S.prototype,"scale",void 0),(0,m._)([(0,T.Cb)(W.qG)],S.prototype,"timeExtent",void 0),(0,m._)([(0,T.Cb)({readOnly:!0})],S.prototype,"version",null),(0,m._)([(0,T.Cb)({readOnly:!0})],S.prototype,"visibleSublayers",null),S=(0,m._)([(0,w.j)("esri.layers.mixins.ExportImageParameters")],S)},80892:(k,V,r)=>{r.d(V,{j:()=>w});var m=r(18100),x=r(6365),b=r(31882),M=r(9497),B=(r(83382),r(19420),r(20891));const G={visible:"visibleSublayers"};let w=class extends((0,b.p)(x.Z)){constructor(W){super(W),this.scale=0}set layer(W){this._get("layer")!==W&&(this._set("layer",W),this.handles.remove("layer"),W&&this.handles.add([W.sublayers.on("change",()=>this.notifyChange("visibleSublayers")),W.on("wms-sublayer-update",K=>this.notifyChange(G[K.propertyName]))],"layer"))}get layers(){return this.visibleSublayers.filter(({name:W})=>W).map(({name:W})=>W).join()}get version(){this.commitProperty("layers");const W=this.layer;return W&&W.commitProperty("imageTransparency"),(this._get("version")||0)+1}get visibleSublayers(){const{layer:W,scale:K}=this,Z=W?.sublayers,U=[],S=D=>{const{minScale:y,maxScale:O,sublayers:l,visible:h}=D;h&&(0===K||(0===y||K<=y)&&(0===O||K>=O))&&(l?l.forEach(S):U.push(D))};return Z?.forEach(S),U}toJSON(){const{layer:W,layers:K}=this,{imageFormat:Z,imageTransparency:U,version:S}=W;return{format:Z,request:"GetMap",service:"WMS",styles:"",transparent:U?"TRUE":"FALSE",version:S,layers:K}}};(0,m._)([(0,M.Cb)()],w.prototype,"layer",null),(0,m._)([(0,M.Cb)({readOnly:!0})],w.prototype,"layers",null),(0,m._)([(0,M.Cb)({type:Number})],w.prototype,"scale",void 0),(0,m._)([(0,M.Cb)({readOnly:!0})],w.prototype,"version",null),(0,m._)([(0,M.Cb)({readOnly:!0})],w.prototype,"visibleSublayers",null),w=(0,m._)([(0,B.j)("esri.layers.support.ExportWMSImageParameters")],w)},6264:(k,V,r)=>{r.d(V,{L:()=>Z});var m=r(18100),x=r(6365),b=r(53661),M=r(9497),B=(r(83382),r(19420),r(20891)),G=r(55733),w=r(21789),W=r(6848),K=r(18661);let Z=class extends x.Z{constructor(U){super(U)}get bounds(){const U=this.coords;return(0,b.Wi)(U)||(0,b.Wi)(U.extent)?null:(0,W.oJ)(U.extent)}get coords(){const U=(0,b.Wg)(this.element.georeference)?.coords;return(0,w.dz)(U,this.spatialReference).geometry}get normalizedCoords(){return G.Z.fromJSON((0,K.Ui)(this.coords))}get normalizedBounds(){const U=(0,b.pC)(this.normalizedCoords)?this.normalizedCoords.extent:null;return(0,b.pC)(U)?(0,W.oJ)(U):null}};(0,m._)([(0,M.Cb)()],Z.prototype,"spatialReference",void 0),(0,m._)([(0,M.Cb)()],Z.prototype,"element",void 0),(0,m._)([(0,M.Cb)()],Z.prototype,"bounds",null),(0,m._)([(0,M.Cb)()],Z.prototype,"coords",null),(0,m._)([(0,M.Cb)()],Z.prototype,"normalizedCoords",null),(0,m._)([(0,M.Cb)()],Z.prototype,"normalizedBounds",null),Z=(0,m._)([(0,B.j)("esri.layers.support.MediaElementView")],Z)},88411:(k,V,r)=>{r.d(V,{y:()=>N});var R,m=r(71670),x=r(18100),b=r(1897),M=r(6365),A=r(84625),T=r(32995),B=r(31882),G=r(28191),w=r(61101),W=r(22286),K=r(30801),Z=r(7521),U=r(91409),S=r(55050),D=r(9497),y=r(36734),O=r(19420),l=r(20891),h=r(45933),p=r(88684);class I{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}getAvailability(a,E){if("unknown"!==this._allAvailability)return this._allAvailability;const _=(a-this.location.top)*this.location.width+(E-this.location.left),s=_>>3,v=this._tileAvailabilityBitSet;return s<0||s>v.length?"unknown":v[s]&1<<_%8?"available":"unavailable"}_updateFromData(a){let L=!0,s=!0;const v=Math.ceil(this.location.width*this.location.height/8),C=new Uint8Array(v);let j=0;for(let F=0;F<a.length;F++){const z=F%8;a[F]?(s=!1,C[j]|=1<<z):L=!1,7===z&&++j}s?this._allAvailability="unavailable":L?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=C,this.byteSize+=C.length)}static fromDefinition(a,E){const _=a.service.request||b.default,{row:L,col:s,width:v,height:C}=a,j={query:{f:"json"}};return E=E?{...j,...E}:j,_(function P(d){let a;if("vector-tile"===d.service.type)a=`${d.service.url}/tilemap/${d.level}/${d.row}/${d.col}/${d.width}/${d.height}`;else{const _=d.service.tileServers;a=`${_&&_.length?_[d.row%_.length]:d.service.url}/tilemap/${d.level}/${d.row}/${d.col}/${d.width}/${d.height}`}const E=d.service.query;return E&&(a=`${a}?${E}`),a}(a),E).then(F=>F.data).catch(F=>{if(F&&F.details&&422===F.details.httpStatus)return{location:{top:L,left:s,width:v,height:C},valid:!0,data:(0,O.a9)(v*C,0)};throw F}).then(F=>{if(F.location&&(F.location.top!==L||F.location.left!==s||F.location.width!==v||F.location.height!==C))throw new T.Z("tilemap:location-mismatch","Tilemap response for different location than requested",{response:F,definition:{top:L,left:s,width:v,height:C}});return I.fromJSON(F)})}static fromJSON(a){I._validateJSON(a);const E=new I;return E.location=Object.freeze((0,p.d9)(a.location)),E._updateFromData(a.data),Object.freeze(E)}static _validateJSON(a){if(!a||!a.location)throw new T.Z("tilemap:missing-location","Location missing from tilemap response");if(!1===a.valid)throw new T.Z("tilemap:invalid","Tilemap response was marked as invalid");if(!a.data)throw new T.Z("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(a.data))throw new T.Z("tilemap:data-mismatch","Data must be an array of numbers");if(a.data.length!==a.location.width*a.location.height)throw new T.Z("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}function g(d){return`${d.level}/${d.row}/${d.col}/${d.width}/${d.height}`}let N=R=class extends((0,B.p)(M.Z)){constructor(d){super(d),this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2*A.Y8.MEGABYTES,this.request=b.default,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new w.Z(this.cacheByteSize),this.addHandles([(0,Z.YP)(()=>{const{layer:d}=this;return[d?.parsedUrl,d?.tileServers,d?.apiKey,d?.customParameters]},()=>this._initializeTilemapDefinition()),(0,Z.YP)(()=>this.layer?.tileInfo?.lods,d=>this._initializeAvailableLevels(d),Z.tX)]),this._initializeTilemapDefinition()}castLevels(d){return d<=2?(G.Z.getLogger(this.declaredClass).error("Minimum levels for Tilemap is 3, but got ",d),3):d}get size(){return 1<<this.levels}fetchTilemap(d,a,E,_){if(!this._availableLevels[d])return Promise.reject(new T.Z("tilemap-cache:level-unavailable",`Level ${d} is unavailable in the service`));const L=this._tmpTilemapDefinition,s=this._tilemapFromCache(d,a,E,L);if(s)return Promise.resolve(s);const v=_&&_.signal;return _={..._,signal:null},new Promise((C,j)=>{(0,K.fu)(v,()=>j((0,K.zE)()));const F=g(L);let z=this._pendingTilemapRequests[F];if(!z){z=I.fromDefinition(L,_).then($=>(this._tilemapCache.put(F,$,$.byteSize),$));const X=()=>delete this._pendingTilemapRequests[F];this._pendingTilemapRequests[F]=z,z.then(X,X)}z.then(C,j)})}getAvailability(d,a,E){if(!this._availableLevels[d])return"unavailable";const _=this._tilemapFromCache(d,a,E,this._tmpTilemapDefinition);return _?_.getAvailability(a,E):"unknown"}fetchAvailability(d,a,E,_){return this._availableLevels[d]?this.fetchTilemap(d,a,E,_).catch(L=>L).then(L=>{if(L instanceof I){const s=L.getAvailability(a,E);if("unavailable"===s)throw new T.Z("tile-map:tile-unavailable","Tile is not available",{level:d,row:a,col:E});return s}if((0,K.D_)(L))throw L;return"unknown"}):Promise.reject(new T.Z("tilemap-cache:level-unavailable",`Level ${d} is unavailable in the service`))}fetchAvailabilityUpsample(d,a,E,_,L){_.level=d,_.row=a,_.col=E;const s=this.layer.tileInfo;s.updateTileInfo(_);const v=this.fetchAvailability(d,a,E,L).catch(C=>{if((0,K.D_)(C))throw C;if(s.upsampleTile(_))return this.fetchAvailabilityUpsample(_.level,_.row,_.col,_);throw C});return this._fetchAvailabilityUpsamplePrefetch(_.id,d,a,E,L,v),v}_fetchAvailabilityUpsamplePrefetch(d,a,E,_,L,s){var v=this;return(0,m.Z)(function*(){if(!v._prefetchingEnabled||null==d)return;const C=`prefetch-${d}`;if(v.handles.has(C))return;const j=new AbortController;s.then(()=>j.abort(),()=>j.abort());let F=!1;if(v.handles.add({remove(){F||(F=!0,j.abort())}},C),yield(0,U.MU)(10,j.signal).catch(()=>{}),F||(F=!0,v.handles.remove(C)),(0,K.Hc)(j))return;const X=new h.f(d,a,E,_),$={...L,signal:j.signal},Q=v.layer.tileInfo;for(let ee=0;R._prefetches.length<R._maxPrefetch&&Q.upsampleTile(X);++ee){const q=v.fetchAvailability(X.level,X.row,X.col,$);R._prefetches.push(q);const ne=()=>{R._prefetches.removeUnordered(q)};q.then(ne,ne)}})()}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const{parsedUrl:d,apiKey:a,customParameters:E}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:d.path,query:(0,S.B7)({...d.query,...E,token:a??d.query?.token}),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(d,a,E,_){_.level=d,_.row=a-a%this.size,_.col=E-E%this.size;const L=g(_);return this._tilemapCache.get(L)}_initializeAvailableLevels(d){this._availableLevels={},d&&d.forEach(a=>this._availableLevels[a.level]=!0)}get test(){const d=this;return{get prefetchingEnabled(){return d._prefetchingEnabled},set prefetchingEnabled(a){d._prefetchingEnabled=a},hasTilemap:(a,E,_)=>!!d._tilemapFromCache(a,E,_,d._tmpTilemapDefinition)}}};N._maxPrefetch=4,N._prefetches=new W.Z({initialSize:R._maxPrefetch}),(0,x._)([(0,D.Cb)({constructOnly:!0,type:Number})],N.prototype,"levels",void 0),(0,x._)([(0,y.p)("levels")],N.prototype,"castLevels",null),(0,x._)([(0,D.Cb)({readOnly:!0,type:Number})],N.prototype,"size",null),(0,x._)([(0,D.Cb)({constructOnly:!0,type:Number})],N.prototype,"cacheByteSize",void 0),(0,x._)([(0,D.Cb)({constructOnly:!0})],N.prototype,"layer",void 0),(0,x._)([(0,D.Cb)({constructOnly:!0})],N.prototype,"request",void 0),N=R=(0,x._)([(0,l.j)("esri.layers.support.TilemapCache")],N)},97326:(k,V,r)=>{r.d(V,{B:()=>G});var B,m=r(18100),x=r(44480),b=r(88684),M=r(9497),T=(r(83382),r(20891));let G=B=class extends x.wq{constructor(w){super(w)}clone(){return new B({customLayerParameters:(0,b.d9)(this.customLayerParameters),customParameters:(0,b.d9)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}};(0,m._)([(0,M.Cb)({json:{type:Object,write:!0}})],G.prototype,"customLayerParameters",void 0),(0,m._)([(0,M.Cb)({json:{type:Object,write:!0}})],G.prototype,"customParameters",void 0),(0,m._)([(0,M.Cb)({type:String,json:{write:!0}})],G.prototype,"layerIdentifier",void 0),(0,m._)([(0,M.Cb)({type:String,json:{write:!0}})],G.prototype,"tileMatrixSet",void 0),(0,m._)([(0,M.Cb)({type:String,json:{write:!0}})],G.prototype,"url",void 0),G=B=(0,m._)([(0,T.j)("esri.layer.support.WMTSLayerInfo")],G)},14103:(k,V,r)=>{r.d(V,{CS:()=>D,Cw:()=>S,Yu:()=>p,j5:()=>y,lm:()=>g});var m=r(71670),x=r(68327),b=r(84489),M=r(73889),A=r(1897),T=r(88684),B=r(55050),G=r(68230),w=r(73327),W=r(71949),K=r(59574),Z=r(87096);const U={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function S(P){const R=P.folders||[],N=R.slice(),d=new Map,a=new Map,E=new Map,_=new Map,L=new Map,s={esriGeometryPoint:a,esriGeometryPolyline:E,esriGeometryPolygon:_};(P.featureCollection&&P.featureCollection.layers||[]).forEach(C=>{const j=(0,T.d9)(C);j.featureSet.features=[];const F=C.featureSet.geometryType;d.set(F,j);const z=C.layerDefinition.objectIdField;"esriGeometryPoint"===F?O(a,z,C.featureSet.features):"esriGeometryPolyline"===F?O(E,z,C.featureSet.features):"esriGeometryPolygon"===F&&O(_,z,C.featureSet.features)}),P.groundOverlays&&P.groundOverlays.forEach(C=>{L.set(C.id,C)}),R.forEach(C=>{C.networkLinkIds.forEach(j=>{const F=function h(P,R,N){const d=function l(P,R){let N;return R.some(d=>d.id===P&&(N=d,!0)),N}(P,N);return d&&(d.parentFolderId=R,d.networkLink=d),d}(j,C.id,P.networkLinks);F&&N.push(F)})}),N.forEach(C=>{if(C.featureInfos){C.points=(0,T.d9)(d.get("esriGeometryPoint")),C.polylines=(0,T.d9)(d.get("esriGeometryPolyline")),C.polygons=(0,T.d9)(d.get("esriGeometryPolygon")),C.mapImages=[];for(const j of C.featureInfos)switch(j.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":{const F=s[j.type].get(j.id);F&&C[U[j.type]].featureSet.features.push(F);break}case"GroundOverlay":{const F=L.get(j.id);F&&C.mapImages.push(F);break}}C.fullExtent=g([C])}});const v=g(N);return{folders:R,sublayers:N,extent:v}}function D(P,R,N,d){const a=b.id&&b.id.findCredential(P);return P=(0,B.fl)(P,{token:a&&a.token}),(0,A.default)(x.default.kmlServiceUrl,{query:{url:P,model:"simple",folders:"",refresh:0!==N||void 0,outSR:JSON.stringify(R)},responseType:"json",signal:d})}function y(P,R,N=null,d=[]){const a=[],E={},_=R.sublayers,L=R.folders.map(s=>s.id);return _.forEach(s=>{const v=new P;if(N?v.read(s,N):v.read(s),d.length&&L.includes(v.id)&&(v.visible=d.includes(v.id)),E[s.id]=v,null!=s.parentFolderId&&-1!==s.parentFolderId){const C=E[s.parentFolderId];C.sublayers||(C.sublayers=[]),C.sublayers?.unshift(v)}else a.unshift(v)}),a}function O(P,R,N){N.forEach(d=>{P.set(d.attributes[R],d)})}function p(P){return I.apply(this,arguments)}function I(){return(I=(0,m.Z)(function*(P){const R=Z.Z.fromJSON(P.featureSet).features,d=(0,K.i)(P.layerDefinition.drawingInfo.renderer),a=M.Z.fromJSON(P.popupInfo),E=[];for(const _ of R){const L=yield d.getSymbolAsync(_);_.symbol=L,_.popupTemplate=a,_.visible=!0,E.push(_)}return E})).apply(this,arguments)}function g(P){const R=(0,w.Ue)(w.Gv),N=(0,w.Ue)(w.Gv);for(const d of P){if(d.polygons&&d.polygons.featureSet&&d.polygons.featureSet.features)for(const a of d.polygons.featureSet.features)(0,W.Yg)(R,a.geometry),(0,w.TC)(N,R);if(d.polylines&&d.polylines.featureSet&&d.polylines.featureSet.features)for(const a of d.polylines.featureSet.features)(0,W.Yg)(R,a.geometry),(0,w.TC)(N,R);if(d.points&&d.points.featureSet&&d.points.featureSet.features)for(const a of d.points.featureSet.features)(0,W.Yg)(R,a.geometry),(0,w.TC)(N,R);if(d.mapImages)for(const a of d.mapImages)(0,W.Yg)(R,a.extent),(0,w.TC)(N,R)}return(0,w.fS)(N,w.Gv)?void 0:{xmin:N[0],ymin:N[1],zmin:N[2],xmax:N[3],ymax:N[4],zmax:N[5],spatialReference:G.Z.WGS84}}},6147:(k,V,r)=>{r.d(V,{OE:()=>Z,Gc:()=>D,Qg:()=>U,Rq:()=>G,gX:()=>S,z2:()=>w,ET:()=>W,Vx:()=>O}),r(6010);var x=r(53661),M=r(13110),A=r(35787);const T=new Map,B=new class b{constructor(h=15e3,p=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=h,this._interval=Math.min(h,p)}decreaseRefCount(h,p){const I=h+"/"+p,g=this._cachedBlocks;if(g.has(I)){const P=g.get(I);return P.refCount--,P.refCount<=0&&(g.delete(I),P.controller&&P.controller.abort()),P.refCount}return 0}getBlock(h,p){const I=h+"/"+p,g=this._cachedBlocks;if(g.has(I)){const P=g.get(I);return P.ts=Date.now(),P.refCount++,g.delete(I),g.set(I,P),P.block}return null}putBlock(h,p,I,g){const P=this._cachedBlocks,R=h+"/"+p;if(P.has(R)){const N=P.get(R);N.ts=Date.now(),N.refCount++}else P.set(R,{block:I,ts:Date.now(),refCount:1,controller:g});this._trim(),this._updateTimer()}deleteBlock(h,p){const I=this._cachedBlocks,g=h+"/"+p;I.has(g)&&I.delete(g)}updateMaxSize(h){this._size=h,this._trim()}empty(){this._cachedBlocks.clear(),this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(null!=this._timer)return;const h=this._cachedBlocks;this._timer=setInterval(()=>{const p=Array.from(h),I=Date.now();for(let g=0;g<p.length&&p[g][1].ts<=I-this._duration;g++)h.delete(p[g][0]);0===h.size&&this._clearTimer()},this._interval)}_trim(){const h=this._cachedBlocks;if(-1===this._size||this._size>=h.size)return;const p=Array.from(h);for(let I=0;I<p.length-this._size;I++)h.delete(p[I][0])}_clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}};function G(l,h){return null==h?l:`${l}?sliceId=${h}`}function w(l,h){const p={extent:null,rasterInfo:h,cache:new Map},I=T.get(l);return I?(I.push(p),I.length-1):(T.set(l,[p]),0)}function W(l,h){const p=T.get(l);p&&(p[h]=null,p.some(I=>null!=I)||T.delete(l))}function Z(l,h,p){const I=T.get(l);if(!I)return null==h?B.decreaseRefCount(l,p):0;if(null==h||null==I[h])return B.decreaseRefCount(l,p);const g=I[h]?.cache,P=g?.get(p);if(g&&P){if(P.refCount--,0===P.refCount){g.delete(p);for(let R=0;R<I.length;R++)I[R]?.cache.delete(p);P.controller&&P.controller.abort()}return P.refCount}return 0}function U(l,h,p){const I=T.get(l);if(!I)return null==h?B.getBlock(l,p):null;if(null==h||null==I[h]){for(let P=0;P<I.length;P++){const R=I[P]?.cache.get(p);if(R)return R.refCount++,R.block}return B.getBlock(l,p)}const g=I[h]?.cache.get(p);if(g)return g.refCount++,g.block;for(let P=0;P<I.length;P++){if(P===h||!I[P])continue;const R=I[P]?.cache,N=R?.get(p);if(R&&N)return N.refCount++,R.set(p,N),N.block}return null}function S(l,h,p,I,g=null){const P=T.get(l);if(!P)return void(null==h&&B.putBlock(l,p,I,g));if(null==h||null==P[h])return void B.putBlock(l,p,I,g);const R={refCount:1,block:I,isResolved:!1,isRejected:!1,controller:g};I.then(()=>R.isResolved=!0).catch(()=>R.isRejected=!0),P[h]?.cache.set(p,R)}function D(l,h,p){const I=T.get(l);I?null!=h&&null!=I[h]?I[h]?.cache.delete(p):B.deleteBlock(l,p):null==h&&B.deleteBlock(l,p)}function O(l,h,p,I,g,P,R=null){const N=function y(l,h){const p=T.get(l);return p?p[h]??null:null}(l,h);if(!N)return;const d=N.extent,{cache:a,rasterInfo:E}=N;if(d&&d.xmin===p.xmin&&d.xmax===p.xmax&&d.ymin===p.ymin&&d.ymax===p.ymax)return;I=I??0;const _=p.clone().normalize(),{spatialReference:L,transform:s}=E,v=new Set;for(let C=0;C<_.length;C++){const j=_[C];if(j.xmax-j.xmin<=I||j.ymax-j.ymin<=I)continue;let F=(0,M.tB)(j,L,R);(0,x.pC)(s)&&(F=s.inverseTransform(F));const z=new A.Z({x:I,y:I,spatialReference:j.spatialReference});if(null==g&&!(g=(0,M.VO)(z,L,j,R)))return;const{pyramidLevel:X,pyramidResolution:$,excessiveReading:Q}=(0,M.kr)(g,E,P||"closest");if(Q)return;const{storageInfo:ee}=E,{origin:q}=ee,ne={x:Math.max(0,Math.floor((F.xmin-q.x)/$.x)),y:Math.max(0,Math.floor((q.y-F.ymax)/$.y))},Y=Math.ceil((F.xmax-F.xmin)/$.x-.1),J=Math.ceil((F.ymax-F.ymin)/$.y-.1),H=X>0?ee.pyramidBlockWidth:ee.blockWidth,te=X>0?ee.pyramidBlockHeight:ee.blockHeight,re=1,se=Math.max(0,Math.floor(ne.x/H)-re),oe=Math.max(0,Math.floor(ne.y/te)-re),le=Math.floor((ne.x+Y-1)/H)+re,ce=Math.floor((ne.y+J-1)/te)+re;for(let ie=oe;ie<=ce;ie++)for(let ae=se;ae<=le;ae++)v.add(`${X}/${ie}/${ae}`)}a.forEach((C,j)=>{if(!v.has(j)){const F=a.get(j);(null==F||F.isResolved||F.isRejected)&&a.delete(j)}}),N.extent={xmin:p.xmin,ymin:p.ymin,xmax:p.xmax,ymax:p.ymax}}},32651:(k,V,r)=>{r.d(V,{d:()=>b,h:()=>x});var m=r(51015);const x={type:m.Z,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:b}}}}};function b(M,A,T,B){if(!M)return null;const{minScale:G,maxScale:w,minLOD:W,maxLOD:K}=A;if(null!=W&&null!=K)return m.Z.fromJSON(B&&B.ignoreMinMaxLOD?M:{...M,lods:M.lods.filter(({level:Z})=>null!=Z&&Z>=W&&Z<=K)});if(0!==G&&0!==w){const Z=D=>Math.round(1e4*D)/1e4,U=G?Z(G):1/0,S=w?Z(w):-1/0;return m.Z.fromJSON({...M,lods:M.lods.filter(D=>{const y=Z(D.scale);return y<=U&&y>=S})})}return m.Z.fromJSON(M)}},87640:(k,V,r)=>{r.d(V,{B:()=>x});var m=r(55050);function x(w){return A[function b(w){return w instanceof Blob?w.type:function M(w){const W=(0,m.Ml)(w);return G[W]||T}(w.url)}(w)]||B}const A={},T="text/plain",B=A[T],G={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const w in G)A[G[w]]=w},20252:(k,V,r)=>{r.d(V,{Z:()=>y});var K,m=r(18100),x=r(88684),b=r(9497),M=r(83382),A=r(4139),T=r(20891),B=r(76277),G=r(81976),w=r(25764),W=r(44480);let Z=K=class extends W.wq{constructor(){super(...arguments),this.description=null,this.label=null,this.minValue=0,this.maxValue=0,this.color=null}clone(){return new K({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:(0,x.d9)(this.color)})}};(0,m._)([(0,b.Cb)({type:String,json:{write:!0}})],Z.prototype,"description",void 0),(0,m._)([(0,b.Cb)({type:String,json:{write:!0}})],Z.prototype,"label",void 0),(0,m._)([(0,b.Cb)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Z.prototype,"minValue",void 0),(0,m._)([(0,b.Cb)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Z.prototype,"maxValue",void 0),(0,m._)([(0,b.Cb)({type:w.Z,json:{type:[M.z8],write:!0}})],Z.prototype,"color",void 0),Z=K=(0,m._)([(0,T.j)("esri.renderers.support.pointCloud.ColorClassBreakInfo")],Z);const U=Z;var S;let D=S=class extends B.Z{constructor(O){super(O),this.type="point-cloud-class-breaks",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.colorClassBreakInfos=null}clone(){return new S({...this.cloneProperties(),field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:(0,x.d9)(this.colorClassBreakInfos),legendOptions:(0,x.d9)(this.legendOptions)})}};(0,m._)([(0,A.J)({pointCloudClassBreaksRenderer:"point-cloud-class-breaks"})],D.prototype,"type",void 0),(0,m._)([(0,b.Cb)({json:{write:!0},type:String})],D.prototype,"field",void 0),(0,m._)([(0,b.Cb)({type:G.I,json:{write:!0}})],D.prototype,"legendOptions",void 0),(0,m._)([(0,b.Cb)({type:B.Z.fieldTransformTypeKebabDict.apiValues,json:{type:B.Z.fieldTransformTypeKebabDict.jsonValues,read:B.Z.fieldTransformTypeKebabDict.read,write:B.Z.fieldTransformTypeKebabDict.write}})],D.prototype,"fieldTransformType",void 0),(0,m._)([(0,b.Cb)({type:[U],json:{write:!0}})],D.prototype,"colorClassBreakInfos",void 0),D=S=(0,m._)([(0,T.j)("esri.renderers.PointCloudClassBreaksRenderer")],D);const y=D},76277:(k,V,r)=>{r.d(V,{Z:()=>N});var w,m=r(18100),x=r(63321),b=r(44480),M=r(88684),A=r(9497),B=(r(83382),r(20891));r(19420);let W=w=class extends b.wq{constructor(){super(...arguments),this.field=null,this.minValue=0,this.maxValue=255}clone(){return new w({field:this.field,minValue:this.minValue,maxValue:this.maxValue})}};(0,m._)([(0,A.Cb)({type:String,json:{write:!0}})],W.prototype,"field",void 0),(0,m._)([(0,A.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],W.prototype,"minValue",void 0),(0,m._)([(0,A.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],W.prototype,"maxValue",void 0),W=w=(0,m._)([(0,B.j)("esri.renderers.support.pointCloud.ColorModulation")],W);const K=W,Z=new x.X({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});let U=class extends b.wq{};(0,m._)([(0,A.Cb)({type:Z.apiValues,readOnly:!0,nonNullable:!0,json:{type:Z.jsonValues,read:!1,write:Z.write}})],U.prototype,"type",void 0),U=(0,m._)([(0,B.j)("esri.renderers.support.pointCloud.PointSizeAlgorithm")],U);const S=U;var y,D=r(4139);let O=y=class extends S{constructor(){super(...arguments),this.type="fixed-size",this.size=0,this.useRealWorldSymbolSizes=null}clone(){return new y({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})}};(0,m._)([(0,D.J)({pointCloudFixedSizeAlgorithm:"fixed-size"})],O.prototype,"type",void 0),(0,m._)([(0,A.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],O.prototype,"size",void 0),(0,m._)([(0,A.Cb)({type:Boolean,json:{write:!0}})],O.prototype,"useRealWorldSymbolSizes",void 0),O=y=(0,m._)([(0,B.j)("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],O);const l=O;var h;let p=h=class extends S{constructor(){super(...arguments),this.type="splat",this.scaleFactor=1}clone(){return new h({scaleFactor:this.scaleFactor})}};(0,m._)([(0,D.J)({pointCloudSplatAlgorithm:"splat"})],p.prototype,"type",void 0),(0,m._)([(0,A.Cb)({type:Number,value:1,nonNullable:!0,json:{write:!0}})],p.prototype,"scaleFactor",void 0),p=h=(0,m._)([(0,B.j)("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],p);const g={key:"type",base:S,typeMap:{"fixed-size":l,splat:p}},P=(0,x.w)()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"});let R=class extends b.wq{constructor(d){super(d),this.type=void 0,this.pointSizeAlgorithm=null,this.colorModulation=null,this.pointsPerInch=10}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}cloneProperties(){return{pointSizeAlgorithm:(0,M.d9)(this.pointSizeAlgorithm),colorModulation:(0,M.d9)(this.colorModulation),pointsPerInch:(0,M.d9)(this.pointsPerInch)}}};(0,m._)([(0,A.Cb)({type:P.apiValues,readOnly:!0,nonNullable:!0,json:{type:P.jsonValues,read:!1,write:P.write}})],R.prototype,"type",void 0),(0,m._)([(0,A.Cb)({types:g,json:{write:!0}})],R.prototype,"pointSizeAlgorithm",void 0),(0,m._)([(0,A.Cb)({type:K,json:{write:!0}})],R.prototype,"colorModulation",void 0),(0,m._)([(0,A.Cb)({json:{write:!0},nonNullable:!0,type:Number})],R.prototype,"pointsPerInch",void 0),R=(0,m._)([(0,B.j)("esri.renderers.PointCloudRenderer")],R),(R||(R={})).fieldTransformTypeKebabDict=new x.X({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"});const N=R},4085:(k,V,r)=>{r.d(V,{Z:()=>Z});var W,m=r(18100),x=r(88684),b=r(9497),A=(r(83382),r(4139)),T=r(20891),B=r(76277),G=r(81976),w=r(27969);let K=W=class extends B.Z{constructor(U){super(U),this.type="point-cloud-stretch",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.stops=null}clone(){return new W({...this.cloneProperties(),field:(0,x.d9)(this.field),fieldTransformType:(0,x.d9)(this.fieldTransformType),stops:(0,x.d9)(this.stops),legendOptions:(0,x.d9)(this.legendOptions)})}};(0,m._)([(0,A.J)({pointCloudStretchRenderer:"point-cloud-stretch"})],K.prototype,"type",void 0),(0,m._)([(0,b.Cb)({json:{write:!0},type:String})],K.prototype,"field",void 0),(0,m._)([(0,b.Cb)({type:G.I,json:{write:!0}})],K.prototype,"legendOptions",void 0),(0,m._)([(0,b.Cb)({type:B.Z.fieldTransformTypeKebabDict.apiValues,json:{type:B.Z.fieldTransformTypeKebabDict.jsonValues,read:B.Z.fieldTransformTypeKebabDict.read,write:B.Z.fieldTransformTypeKebabDict.write}})],K.prototype,"fieldTransformType",void 0),(0,m._)([(0,b.Cb)({type:[w.Z],json:{write:!0}})],K.prototype,"stops",void 0),K=W=(0,m._)([(0,T.j)("esri.renderers.PointCloudStretchRenderer")],K);const Z=K},37130:(k,V,r)=>{r.d(V,{Z:()=>y});var K,m=r(18100),x=r(88684),b=r(9497),M=r(83382),A=r(4139),T=r(20891),B=r(76277),G=r(81976),w=r(25764),W=r(44480);let Z=K=class extends W.wq{constructor(){super(...arguments),this.description=null,this.label=null,this.values=null,this.color=null}clone(){return new K({description:this.description,label:this.label,values:(0,x.d9)(this.values),color:(0,x.d9)(this.color)})}};(0,m._)([(0,b.Cb)({type:String,json:{write:!0}})],Z.prototype,"description",void 0),(0,m._)([(0,b.Cb)({type:String,json:{write:!0}})],Z.prototype,"label",void 0),(0,m._)([(0,b.Cb)({type:[String],json:{write:!0}})],Z.prototype,"values",void 0),(0,m._)([(0,b.Cb)({type:w.Z,json:{type:[M.z8],write:!0}})],Z.prototype,"color",void 0),Z=K=(0,m._)([(0,T.j)("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],Z);const U=Z;var S;let D=S=class extends B.Z{constructor(O){super(O),this.type="point-cloud-unique-value",this.field=null,this.fieldTransformType=null,this.colorUniqueValueInfos=null,this.legendOptions=null}clone(){return new S({...this.cloneProperties(),field:(0,x.d9)(this.field),fieldTransformType:(0,x.d9)(this.fieldTransformType),colorUniqueValueInfos:(0,x.d9)(this.colorUniqueValueInfos),legendOptions:(0,x.d9)(this.legendOptions)})}};(0,m._)([(0,A.J)({pointCloudUniqueValueRenderer:"point-cloud-unique-value"})],D.prototype,"type",void 0),(0,m._)([(0,b.Cb)({json:{write:!0},type:String})],D.prototype,"field",void 0),(0,m._)([(0,b.Cb)({type:B.Z.fieldTransformTypeKebabDict.apiValues,json:{type:B.Z.fieldTransformTypeKebabDict.jsonValues,read:B.Z.fieldTransformTypeKebabDict.read,write:B.Z.fieldTransformTypeKebabDict.write}})],D.prototype,"fieldTransformType",void 0),(0,m._)([(0,b.Cb)({type:[U],json:{write:!0}})],D.prototype,"colorUniqueValueInfos",void 0),(0,m._)([(0,b.Cb)({type:G.I,json:{write:!0}})],D.prototype,"legendOptions",void 0),D=S=(0,m._)([(0,T.j)("esri.renderers.PointCloudUniqueValueRenderer")],D);const y=D},25080:(k,V,r)=>{r.d(V,{IJ:()=>K,m5:()=>D,vB:()=>O,w7:()=>U});var m=r(71670),x=r(1897),b=r(53661),M=r(55050),A=r(71182),T=r(42758),B=r(58558),G=r(59937);const w="Layer does not support extent calculation.";function W(h,p){const I=h.geometry,g=h.toJSON(),P=g;if((0,b.pC)(I)&&(P.geometry=JSON.stringify(I),P.geometryType=(0,A.Ji)(I),P.inSR=I.spatialReference.wkid||JSON.stringify(I.spatialReference)),g.topFilter?.groupByFields&&(P.topFilter.groupByFields=g.topFilter.groupByFields.join(",")),g.topFilter?.orderByFields&&(P.topFilter.orderByFields=g.topFilter.orderByFields.join(",")),g.topFilter&&(P.topFilter=JSON.stringify(P.topFilter)),g.objectIds&&(P.objectIds=g.objectIds.join(",")),g.orderByFields&&(P.orderByFields=g.orderByFields.join(",")),g.outFields&&!(p?.returnCountOnly||p?.returnExtentOnly||p?.returnIdsOnly)?P.outFields=g.outFields.includes("*")?"*":g.outFields.join(","):delete P.outFields,g.outSR?P.outSR=g.outSR.wkid||JSON.stringify(g.outSR):I&&g.returnGeometry&&(P.outSR=P.inSR),g.returnGeometry&&delete g.returnGeometry,g.timeExtent){const R=g.timeExtent,{start:N,end:d}=R;null==N&&null==d||(P.time=N===d?N:`${N??"null"},${d??"null"}`),delete g.timeExtent}return P}function K(h,p,I,g){return Z.apply(this,arguments)}function Z(){return(Z=(0,m.Z)(function*(h,p,I,g){const P=yield l(h,p,"json",g);return(0,G.p)(p,I,P.data),P})).apply(this,arguments)}function U(h,p,I){return S.apply(this,arguments)}function S(){return(S=(0,m.Z)(function*(h,p,I){return(0,b.pC)(p.timeExtent)&&p.timeExtent.isEmpty?{data:{objectIds:[]}}:l(h,p,"json",I,{returnIdsOnly:!0})})).apply(this,arguments)}function D(h,p,I){return y.apply(this,arguments)}function y(){return(y=(0,m.Z)(function*(h,p,I){return(0,b.pC)(p.timeExtent)&&p.timeExtent.isEmpty?{data:{count:0,extent:null}}:l(h,p,"json",I,{returnExtentOnly:!0,returnCountOnly:!0}).then(g=>{const P=g.data;if(P.hasOwnProperty("extent"))return g;if(P.features)throw new Error(w);if(P.hasOwnProperty("count"))throw new Error(w);return g})})).apply(this,arguments)}function O(h,p,I){return(0,b.pC)(p.timeExtent)&&p.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):l(h,p,"json",I,{returnIdsOnly:!0,returnCountOnly:!0})}function l(h,p,I,g={},P={}){const R="string"==typeof h?(0,M.mN)(h):h,N=p.geometry?[p.geometry]:[];return g.responseType="pbf"===I?"array-buffer":"json",(0,T.aX)(N,null,g).then(d=>{const a=d&&d[0];(0,b.pC)(a)&&((p=p.clone()).geometry=a);const E=(0,B.A)({...R.query,f:I,...P,...W(p,P)});return(0,x.default)((0,M.v_)(R.path,"queryTopFeatures"),{...g,query:{...E,...g.query}})})}},78987:(k,V,r)=>{r.d(V,{t:()=>b});var m=r(71670),x=r(1897);function b(A,T){return M.apply(this,arguments)}function M(){return(M=(0,m.Z)(function*(A,T){const{data:B}=yield(0,x.default)(A,{responseType:"image",...T});return B})).apply(this,arguments)}},70560:(k,V,r)=>{r.d(V,{Z:()=>h});var m=r(71670),x=r(1897),b=r(32995),M=r(30801),A=r(90801),T=r(69354);function G(){return(G=(0,m.Z)(function*(d,a){const E=(0,A.p)(d);if(E instanceof Error)throw E;yield E.createImages(),(0,M.k_)(a);const{frames:_,width:L,height:s}=E,v=document.createElement("canvas");v.width=L,v.height=s;const C=v.getContext("2d",{willReadFrequently:!0}),j=[],F=[];for(const z of _){F.push((0,T.HA)(z.delay||100));const X=z.imageElement;C.globalCompositeOperation=0===z.blendOp?"copy":"source-over";const $=2===z.disposeOp?C.getImageData(z.left,z.top,z.width,z.height):void 0;C.drawImage(X,z.left,z.top);const Q=C.getImageData(0,0,L,s);j.push(Q),0===z.disposeOp||(1===z.disposeOp?C.clearRect(z.left,z.top,z.width,z.height):2===z.disposeOp&&C.putImageData($,z.left,z.top))}return{frameDurations:F,getFrame:z=>j[z],width:L,height:s}})).apply(this,arguments)}const w=[137,80,78,71,13,10,26,10];var Z=r(90203),U=r(74165);function D(){return(D=(0,m.Z)(function*(d,a){const E=(0,U.p)(d),_=(0,U.d)(E,!0),{width:L,height:s}=E.lsd,v=document.createElement("canvas");v.width=L,v.height=s;const C=v.getContext("2d",{willReadFrequently:!0}),j=[],F=[];for(const z of _){F.push((0,T.HA)(z.delay||100));const X=new ImageData(z.patch,z.dims.width,z.dims.height),$=(0,Z.E0)(X),Q=3===z.disposalType?C.getImageData(z.dims.left,z.dims.top,z.dims.width,z.dims.height):void 0;C.drawImage($,z.dims.left,z.dims.top);const ee=C.getImageData(0,0,L,s);j.push(ee),1===z.disposalType||(2===z.disposalType?C.clearRect(z.dims.left,z.dims.top,z.dims.width,z.dims.height):3===z.disposalType&&C.putImageData(Q,z.dims.left,z.dims.top))}return{frameDurations:F,getFrame:z=>j[z],width:L,height:s}})).apply(this,arguments)}const y=[71,73,70];class h{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(a){return this._resourceMap.get(a)??null}fetchResource(a,E){var _=this;return(0,m.Z)(function*(){const L=_._resourceMap.get(a);if(L)return{width:L.width,height:L.height};let s=_._inFlightResourceMap.get(a);return s?s.then(v=>({width:v.width,height:v.height})):(s=function g(d,a){return P.apply(this,arguments)}(a,E),_._inFlightResourceMap.set(a,s),s.then(v=>(_._inFlightResourceMap.delete(a),_._resourceMap.set(a,v),{width:v.width,height:v.height}),()=>({width:0,height:0})))})()}deleteResource(a){this._inFlightResourceMap.delete(a),this._resourceMap.delete(a)}}function I(){return(I=(0,m.Z)(function*(d,a){const E=window.URL.createObjectURL(d);try{const{data:_}=yield(0,x.default)(E,{...a,responseType:"image"});return _}catch(_){throw(0,M.D_)(_)?_:new b.Z("mapview-invalid-resource",`Could not fetch requested resource at ${E}`)}finally{window.URL.revokeObjectURL(E)}})).apply(this,arguments)}function P(){return P=(0,m.Z)(function*(d,a){const{arrayBuffer:E,mediaType:_}=yield function R(d,a){return N.apply(this,arguments)}(d,a),L="image/png"===_;return"image/gif"===_&&function l(d){if(!function O(d){const a=new Uint8Array(d);return!y.some((E,_)=>E!==a[_])}(d))return!1;const a=new DataView(d),E=a.getUint8(10);let _=13+(128&E?3*2**(1+(7&E)):0),L=0,s=!1;for(;!s;){switch(a.getUint8(_++)){case 33:if(!v())return!1;break;case 44:C();break;case 59:s=!0;break;default:return!1}if(L>1)return!0}function v(){switch(a.getUint8(_++)){case 249:!function j(){_++,_+=4,$()}();break;case 1:!function F(){L++,_++,_+=12,$()}();break;case 254:!function z(){$()}();break;case 255:!function X(){_++,_+=8,_+=3,$()}();break;default:return!1}return!0}function C(){L++,_+=8;const Q=a.getUint8(_++);_+=128&Q?3*2**(1+(7&Q)):0,_++,$()}function $(){let Q;for(;Q=a.getUint8(_++);)_+=Q}return!1}(E)?function S(d,a){return D.apply(this,arguments)}(E):L&&function K(d){if(!function W(d){const a=new Uint8Array(d);return!w.some((E,_)=>E!==a[_])}(d))return!1;const a=new DataView(d),E=new Uint8Array(d);let _,L=8;do{const s=a.getUint32(L);if(_=String.fromCharCode.apply(String,Array.prototype.slice.call(E.subarray(L+4,L+8))),"acTL"===_)return!0;L+=12+s}while("IEND"!==_&&L<E.length);return!1}(E)?function B(d,a){return G.apply(this,arguments)}(E,a):function p(d,a){return I.apply(this,arguments)}(new Blob([E],{type:_}),a)}),P.apply(this,arguments)}function N(){return(N=(0,m.Z)(function*(d,a){let E;const _=";base64,";if(d.includes(_)){const L=d.indexOf(_),s=d.indexOf(_)+8,v=d.substring(s),C=atob(v),j=new Uint8Array(C.length);for(let F=0;F<C.length;F++)j[F]=C.charCodeAt(F);E={arrayBuffer:j.buffer,mediaType:d.substring(0,L).replace("data:","")}}else try{const L=yield(0,x.default)(d,{responseType:"array-buffer",...a});E={arrayBuffer:L.data,mediaType:L.getHeader("Content-Type")}}catch(L){if(!(0,M.D_)(L))throw new b.Z("mapview-invalid-resource",`Could not fetch requested resource at ${d}`)}return E})).apply(this,arguments)}},87656:(k,V,r)=>{r.d(V,{G:()=>b});var m=r(83345),x=r(69923);class b extends m.Z{constructor(){super(...arguments),this._prevFBO=void 0,this.requiresDedicatedFBO=!1}dispose(){}doRender(A){const T=this.createRenderParams(A),{context:B,painter:G,profiler:w}=T;this._prevFBO=B.getBoundFramebufferObject(),w.recordContainerStart(this.name);const W=this._getFbo(T),K=G.getRenderTarget();B.bindFramebuffer(W),G.setRenderTarget(W),B.setDepthWriteEnabled(!0),B.setColorMask(!0,!0,!0,!0),B.setClearColor(0,0,0,0),B.setClearDepth(1),B.clear(B.gl.COLOR_BUFFER_BIT|B.gl.DEPTH_BUFFER_BIT),B.setDepthWriteEnabled(!1);for(const Z of this.children)Z.beforeRender(A);for(const Z of this.children)Z.processRender(T);for(const Z of this.children)Z.afterRender(A);G.setRenderTarget(K),G.releaseFbo(W),B.bindFramebuffer(this._prevFBO),G.beforeRenderLayer(T,this._clippingInfos?255:0,this.computedOpacity),W.colorTexture&&(B.setStencilTestEnabled(!1),B.setStencilWriteMask(0),G.blitTexture(B,W.colorTexture,x.cw.NEAREST)),G.compositeLayer(T,this.computedOpacity),w.recordContainerEnd()}createRenderParams(A){return{...super.createRenderParams(A),blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1}}_getFbo(A){const{context:T,painter:B}=A,{width:G,height:w}=T.getViewport();return B.acquireFbo(G,w)}}},59690:(k,V,r)=>{r.d(V,{k:()=>U,p:()=>S});var m=r(30248),x=r(95442),M=(r(67087),r(53661)),A=r(34662),T=r(73327),B=r(56162),G=r(10002);const w=(0,T.Ue)();function W(D,y){return D<<16|y}function K(D){return(4294901760&D)>>>16}function Z(D){return 65535&D}const U={getObjectId:D=>D.getObjectId(),getAttributes:D=>D.readAttributes(),getAttribute:(D,y)=>D.readAttribute(y),cloneWithGeometry:(D,y)=>D,getGeometry:D=>D.readHydratedGeometry(),getCentroid:(D,y)=>D.readCentroid()};class S extends B.J{constructor(y,O,l){super(y,O),this.featureAdapter=U,this.events=new x.Z,this._featureSetsByInstance=new Map,this._objectIdToDisplayId=new Map,this._spatialIndexInvalid=!0,this._indexSearchCache=new m.Z(50),this._index=(0,A.r)(9,h=>({minX:this._storage.getXMin(h),minY:this._storage.getYMin(h),maxX:this._storage.getXMax(h),maxY:this._storage.getYMax(h)})),this.mode=l}get storeStatistics(){let y=0,O=0,l=0;return this.forEach(h=>{const p=h.readGeometry();p&&(O+=p.isPoint?1:p.lengths.reduce((I,g)=>I+g,0),l+=p.isPoint?1:p.lengths.length,y+=1)}),{featureCount:y,vertexCount:O,ringCount:l}}hasInstance(y){return this._featureSetsByInstance.has(y)}onTileData(y,O){if((0,M.Wi)(O.addOrUpdate))return O;if(O.addOrUpdate.attachStorage(this._storage),"snapshot"===this.mode){const h=O.addOrUpdate.getCursor();for(;h.next();){const p=h.getDisplayId();this.setComputedAttributes(this._storage,h,p,y.scale)}return O}this._featureSetsByInstance.set(O.addOrUpdate.instance,O.addOrUpdate);const l=O.addOrUpdate.getCursor();for(;l.next();)this._insertFeature(l,y.scale);return this._spatialIndexInvalid=!0,this.events.emit("changed"),O}search(y){this._rebuildIndex();const O=y.id,l=this._indexSearchCache.find(g=>g.tileId===O);if((0,M.pC)(l))return l.readers;const h=new Map,p=this._searchIndex(y.bounds),I=[];for(const g of p){const P=this._storage.getInstanceId(g),R=K(P),N=Z(P);h.has(R)||h.set(R,[]),h.get(R).push(N)}return h.forEach((g,P)=>{const R=this._featureSetsByInstance.get(P);I.push(G.t.from(R,g))}),this._indexSearchCache.enqueue({tileId:O,readers:I}),I}insert(y){const O=y.getCursor(),l=this._storage;for(;O.next();){const h=W(O.instance,O.getIndex()),p=O.getObjectId(),I=this._objectIdToDisplayId.get(p)??this._storage.createDisplayId();O.setDisplayId(I),l.setInstanceId(I,h),this._objectIdToDisplayId.set(p,I)}this._featureSetsByInstance.set(y.instance,y),this._spatialIndexInvalid=!0}remove(y){const O=this._objectIdToDisplayId.get(y);if(!O)return;const l=this._storage.getInstanceId(O),h=Z(l),p=K(l),I=this._featureSetsByInstance.get(p);this._objectIdToDisplayId.delete(y),this._storage.releaseDisplayId(O),I.removeAtIndex(h),I.isEmpty&&this._featureSetsByInstance.delete(p),this._spatialIndexInvalid=!0}forEach(y){this._objectIdToDisplayId.forEach(O=>{const l=this._storage.getInstanceId(O),h=this._lookupFeature(l);y(h)})}forEachUnsafe(y){this._objectIdToDisplayId.forEach(O=>{const l=this._storage.getInstanceId(O),h=K(l),p=Z(l),I=this._getFeatureSet(h);I.setIndex(p),y(I)})}forEachInBounds(y,O){const l=this._searchIndex(y);for(const h of l){const p=this.lookupFeatureByDisplayId(h,this._storage);O((0,M.Wg)(p))}}forEachBounds(y,O){this._rebuildIndex();for(const l of y){if(!l.readGeometry())continue;const h=l.getDisplayId();(0,T.bZ)(w,this._storage.getXMin(h),this._storage.getYMin(h),this._storage.getXMax(h),this._storage.getYMax(h)),O(w)}}sweepFeatures(y,O,l){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach((h,p)=>{y.has(h)||(O.releaseDisplayId(h),l&&l.unsetAttributeData(h),this._objectIdToDisplayId.delete(p))}),this.events.emit("changed")}sweepFeatureSets(y){this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach((O,l)=>{y.has(l)||this._featureSetsByInstance.delete(l)})}lookupObjectId(y,O){const l=this.lookupFeatureByDisplayId(y,O);return(0,M.Wi)(l)?null:l.getObjectId()}lookupDisplayId(y){return this._objectIdToDisplayId.get(y)}lookupFeatureByDisplayId(y,O){const l=O.getInstanceId(y);return this._lookupFeature(l)}lookupByDisplayIdUnsafe(y){const O=this._storage.getInstanceId(y),l=K(O),h=Z(O),p=this._getFeatureSet(l);return p?(p.setIndex(h),p):null}_insertFeature(y,O){const l=this._storage,h=y.getObjectId(),p=W(y.instance,y.getIndex());l.getInstanceId(y.getDisplayId());let I=this._objectIdToDisplayId.get(h);I||(I=l.createDisplayId(),this._objectIdToDisplayId.set(h,I),this._spatialIndexInvalid=!0),y.setDisplayId(I),l.setInstanceId(I,p),this.setComputedAttributes(l,y,I,O)}_searchIndex(y){return this._rebuildIndex(),this._index.search({minX:y[0],minY:y[1],maxX:y[2],maxY:y[3]})}_rebuildIndex(){if(!this._spatialIndexInvalid)return;const y=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(O=>{const l=O.getCursor();for(;l.next();){const h=l.getDisplayId();this._storage.setBounds(h,l)&&y.push(h)}}):this._objectIdToDisplayId.forEach(O=>{const l=this._storage.getInstanceId(O);this._storage.setBounds(O,this._lookupFeature(l))&&y.push(O)}),this._index.clear(),this._index.load(y),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}_lookupFeature(y){const O=K(y),l=this._getFeatureSet(O);if(!l)return;const h=l.getCursor(),p=Z(y);return h.setIndex(p),h}_getFeatureSet(y){return this._featureSetsByInstance.get(y)}}},56162:(k,V,r)=>{r.d(V,{J:()=>w});var m=r(71670),x=r(67087),b=r(53661),M=r(51118),A=r(77238),T=r(28191);const G=r.e(6674).then(r.bind(r,16674));class w{constructor(K,Z){this._canCacheExpressionValue=!1,this._sourceInfo=K,this._storage=Z,this._bitsets={computed:Z.getBitset(Z.createBitset())}}get storage(){return this._storage}invalidate(){this._bitsets.computed.clear()}updateSchema(K,Z){var U=this;return(0,m.Z)(function*(){const S=(0,M.Hg)(U._schema,Z);if(U._schema=Z,!Z||(0,b.Wi)(S)||!(0,M.uD)(S,"attributes"))return;(0,x.Z)("esri-2d-update-debug")&&console.debug("Applying Update - Store:",S),U._bitsets.computed.clear(),K.targets[Z.name]=!0;const D=Z.attributes,y=[],O=[];for(const l in D){const h=D[l];switch(h.type){case"field":break;case"expression":y.push(U._createArcadeComputedField(h));break;case"label-expression":y.push(U._createLabelArcadeComputedField(h));break;case"statistic":O.push(h)}}U._computedFields=yield Promise.all(y),U._canCacheExpressionValue=!U._computedFields.some(l=>"expression"===l.type&&(0,b.pC)(l.expression)&&l.expression.referencesScale()),U._statisticFields=O})()}setComputedAttributes(K,Z,U,S){const D=this._bitsets.computed;if(!this._canCacheExpressionValue||!D.has(U)){D.set(U);for(const y of this._computedFields){const O=this._evaluateField(Z,y,S);switch(y.resultType){case"numeric":K.setComputedNumericAtIndex(U,y.fieldIndex,O);break;case"string":K.setComputedStringAtIndex(U,y.fieldIndex,O)}}}}_createArcadeComputedField(K){var Z=this;return(0,m.Z)(function*(){const U=Z._sourceInfo.spatialReference,S=Z._sourceInfo.fieldsIndex;return{...K,expression:yield(0,A.Yi)(K.valueExpression,U,S)}})()}_createLabelArcadeComputedField(K){var Z=this;return(0,m.Z)(function*(){const U=Z._sourceInfo.spatialReference,S=Z._sourceInfo.fieldsIndex,{createLabelFunction:D}=yield G,y=yield D(K.label,S,U);return{...K,builder:y}})()}_evaluateField(K,Z,U){switch(Z.type){case"label-expression":{const S=K.readArcadeFeature();return Z.builder.evaluate(S)||""}case"expression":{const{expression:S}=Z;return function B(W,K,Z){if((0,b.Wi)(W))return null;const U=K.readArcadeFeature();try{return W.evaluate({...Z,$feature:U})}catch(S){return T.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",S),null}}(S,K,{$view:{scale:U}})}}}}},38672:(k,V,r)=>{r.d(V,{Z:()=>G});var m=r(18100),x=r(31882),b=r(9497),T=(r(83382),r(19420),r(20891));let B=class extends x.r{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const w=this.get("tileStore.tileScheme.spatialReference");return w&&w.toJSON()||null}};(0,m._)([(0,b.Cb)({readOnly:!0})],B.prototype,"supportsTileUpdates",null),(0,m._)([(0,b.Cb)({constructOnly:!0})],B.prototype,"remoteClient",void 0),(0,m._)([(0,b.Cb)({constructOnly:!0})],B.prototype,"service",void 0),(0,m._)([(0,b.Cb)()],B.prototype,"spatialReference",null),(0,m._)([(0,b.Cb)({constructOnly:!0})],B.prototype,"tileInfo",void 0),(0,m._)([(0,b.Cb)({constructOnly:!0})],B.prototype,"tileStore",void 0),B=(0,m._)([(0,T.j)("esri.views.2d.layers.features.processors.BaseProcessor")],B);const G=B},10002:(k,V,r)=>{r.d(V,{t:()=>x});var m=r(80074);class x extends m.s{static from(M,A){return new x(M.copy(),A)}constructor(M,A){super(m.s.createInstance(),M.fullSchema()),this._currentIndex=-1,this._reader=M,this._indices=A}get hasNext(){return this._currentIndex+1<this._indices.length}getSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const M=new x(this._reader.copy(),this._indices);return M._currentIndex=this._currentIndex,M}next(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}setArcadeSpatialReference(M){this._reader.setArcadeSpatialReference(M)}attachStorage(M){this._reader.attachStorage(M)}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}getStorage(){return this._reader.getStorage()}getComputedNumeric(M){return this._reader.getComputedNumericAtIndex(0)}setComputedNumeric(M,A){return this._reader.setComputedNumericAtIndex(A,0)}getComputedString(M){return this._reader.getComputedStringAtIndex(0)}setComputedString(M,A){return this._reader.setComputedStringAtIndex(0,A)}getComputedNumericAtIndex(M){return this._reader.getComputedNumericAtIndex(M)}setComputedNumericAtIndex(M,A){this._reader.setComputedNumericAtIndex(M,A)}getComputedStringAtIndex(M){return this._reader.getComputedStringAtIndex(M)}setComputedStringAtIndex(M,A){return this._reader.setComputedStringAtIndex(M,A)}transform(M,A,T,B){const G=this.copy();return G._reader=this._reader.transform(M,A,T,B),G}readAttribute(M,A=!1){return this._reader.readAttribute(M,A)}readAttributes(){return this._reader.readAttributes()}joinAttributes(M){return this._reader.joinAttributes(M)}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(M){return this.readAttribute(M,!0)}hasField(M){return this._reader.hasField(M)}setField(M,A){return this._reader.setField(M,A)}keys(){return this._reader.keys()}castToText(M=!1){return this._reader.castToText(M)}getQuantizationTransform(){return this._reader.getQuantizationTransform()}getFieldNames(){return this._reader.getFieldNames()}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(M){return this._reader.setDisplayId(M)}getGroupId(){return this._reader.getGroupId()}setGroupId(M){return this._reader.setGroupId(M)}getXHydrated(){return this._reader.getXHydrated()}getYHydrated(){return this._reader.getYHydrated()}getX(){return this._reader.getX()}getY(){return this._reader.getY()}setIndex(M){return this._reader.setIndex(M)}getIndex(){return this._reader.getIndex()}readLegacyFeature(){return this._reader.readLegacyFeature()}readOptimizedFeature(){return this._reader.readOptimizedFeature()}readLegacyPointGeometry(){return this._reader.readLegacyPointGeometry()}readLegacyGeometry(){return this._reader.readLegacyGeometry()}readLegacyCentroid(){return this._reader.readLegacyCentroid()}readGeometryArea(){return this._reader.readGeometryArea()}readUnquantizedGeometry(){return this._reader.readUnquantizedGeometry()}readHydratedGeometry(){return this._reader.readHydratedGeometry()}readGeometry(){return this._reader.readGeometry()}readCentroid(){return this._reader.readCentroid()}_readAttribute(M,A){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}_readAttributes(){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}}},43363:(k,V,r)=>{r.d(V,{Z:()=>G});var m=r(18100),x=r(31882),b=r(9497),T=(r(83382),r(19420),r(20891));let B=class extends x.r{constructor(w){super(w),this.tiles=new Map}destroy(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null}get updating(){return this.isUpdating()}acquireTile(w){const W=this.createTile(w);return W.once("isReady",()=>this.notifyChange("updating")),this.tiles.set(w.id,W),W}forceAttributeTextureUpload(){}forEachTile(w){this.tiles.forEach(w)}releaseTile(w){this.tiles.delete(w.key.id),this.disposeTile(w)}isUpdating(){let w=!0;return this.tiles.forEach(W=>{w=w&&W.isReady}),!w}setHighlight(){}invalidateLabels(){}requestUpdate(){this.layerView.requestUpdate()}};(0,m._)([(0,b.Cb)()],B.prototype,"layer",void 0),(0,m._)([(0,b.Cb)()],B.prototype,"layerView",void 0),(0,m._)([(0,b.Cb)()],B.prototype,"tileInfoView",void 0),(0,m._)([(0,b.Cb)()],B.prototype,"updating",null),B=(0,m._)([(0,T.j)("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],B);const G=B},8456:(k,V,r)=>{r.d(V,{Z:()=>N});var m=r(71670),x=r(18100),b=r(6365),A=(r(67087),r(30801)),T=r(9497),w=(r(83382),r(19420),r(20891)),W=r(6848),K=r(53492),Z=r(51015);const U=Math.PI/180;var O=r(88770),l=r(45396),h=r(67026);const p=(0,W.Ue)(),I=[0,0],g=new h.Z(0,0,0,0);let R=class extends b.Z{constructor(d){var a;super(d),a=this,this._imagePromise=null,this.bitmaps=[],this.hidpi=false,this.imageMaxWidth=2048,this.imageMaxHeight=2048,this.imageRotationSupported=false,this.imageNormalizationSupported=false,this.update=(0,A.Ds)(function(){var E=(0,m.Z)(function*(_,L){if((0,A.k_)(L),!_.stationary||a.destroyed)return;const s=_.state,v=(0,K.C5)(s.spatialReference),C=a.hidpi?_.pixelRatio:1,j=a.imageNormalizationSupported&&s.worldScreenWidth&&s.worldScreenWidth<s.size[0],F=a.imageMaxWidth??0,z=a.imageMaxHeight??0;j?(I[0]=s.worldScreenWidth,I[1]=s.size[1]):a.imageRotationSupported?(I[0]=s.size[0],I[1]=s.size[1]):function D(d,a){const E=function S(d){return d*U}(a.rotation),_=Math.abs(Math.cos(E)),L=Math.abs(Math.sin(E)),[s,v]=a.size;return d[0]=Math.round(v*L+s*_),d[1]=Math.round(v*_+s*L),d}(I,s);const X=Math.floor(I[0]*C)>F||Math.floor(I[1]*C)>z,Q=!a.imageNormalizationSupported&&v&&(s.extent.xmin<v.valid[0]||s.extent.xmax>v.valid[1]),ee=!X&&!Q,q=a.imageRotationSupported?s.rotation:0,ne=a.container.children.slice();if(ee){const Y=j?s.paddedViewState.center:s.center;a._imagePromise&&console.error("Image promise was not defined!"),a._imagePromise=a._singleExport(s,I,Y,s.resolution,q,C,L)}else{let Y=Math.min(F,z);Q&&(Y=Math.min(s.worldScreenWidth,Y)),a._imagePromise=a._tiledExport(s,Y,C,L)}try{const Y=(yield a._imagePromise)??[];(0,A.k_)(L);const J=[];if(a._imagePromise=null,a.destroyed)return;a.bitmaps=Y;for(const H of ne)Y.includes(H)||J.push(H.fadeOut().then(()=>{H.remove(),H.destroy()}));for(const H of Y)J.push(H.fadeIn());yield Promise.all(J)}catch(Y){a._imagePromise=null,(0,A.r9)(Y)}});return function(_,L){return E.apply(this,arguments)}}(),5e3),this.updateExports=(0,A.Ds)(function(){var E=(0,m.Z)(function*(_){const L=[];for(const s of a.container.children){if(!s.visible||!s.stage)return;L.push(_(s).then(()=>{s.invalidateTexture(),s.requestRender()}))}a._imagePromise=(0,A.as)(L).then(()=>a._imagePromise=null),yield a._imagePromise});return function(_){return E.apply(this,arguments)}}())}destroy(){this.bitmaps.forEach(d=>d.destroy()),this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}_export(d,a,E,_,L,s){var v=this;return(0,m.Z)(function*(){const C=yield v.fetchSource(d,Math.floor(a*L),Math.floor(E*L),{rotation:_,pixelRatio:L,signal:s});(0,A.k_)(s);const j=new O.eY(null,{immutable:!0,requestRenderOnSourceChangedEnabled:!0});return j.x=d.xmin,j.y=d.ymax,j.resolution=d.width/a,j.rotation=_,j.pixelRatio=L,j.opacity=0,v.container.addChild(j),yield j.setSourceAsync(C,s),(0,A.k_)(s),j})()}_singleExport(d,a,E,_,L,s,v){var C=this;return(0,m.Z)(function*(){!function y(d,a,E,_){const[L,s]=a,[v,C]=_,j=.5*E;d[0]=L-j*v,d[1]=s-j*C,d[2]=L+j*v,d[3]=s+j*C}(p,E,_,a);const j=(0,W.HH)(p,d.spatialReference);return[yield C._export(j,a[0],a[1],L,s,v)]})()}_tiledExport(d,a,E,_){const L=Z.Z.create({size:a,spatialReference:d.spatialReference,scales:[d.scale]}),s=new l.Z(L),v=s.getTileCoverage(d);if(!v)return null;const C=[];return v.forEach((j,F,z,X)=>{g.set(j,F,z,0),s.getTileBounds(p,g);const $=(0,W.HH)(p,d.spatialReference);C.push(this._export($,a,a,0,E,_).then(Q=>(0!==X&&(g.set(j,F,z,X),s.getTileBounds(p,g),Q.x=p[0],Q.y=p[3]),Q)))}),Promise.all(C)}};(0,x._)([(0,T.Cb)()],R.prototype,"_imagePromise",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"bitmaps",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"container",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"fetchSource",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"hidpi",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"imageMaxWidth",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"imageMaxHeight",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"imageRotationSupported",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"imageNormalizationSupported",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"requestUpdate",void 0),(0,x._)([(0,T.Cb)()],R.prototype,"updating",null),R=(0,x._)([(0,w.j)("esri.views.2d.layers.support.ExportStrategy")],R);const N=R},12042:(k,V,r)=>{r.d(V,{hu:()=>T,yK:()=>G}),r(83457),r(71943),(0,r(91746).c)();class A{constructor(D){this.message=D}toString(){return`AssertException: ${this.message}`}}function T(S,D){if(!S){D=D||"Assertion";const y=new Error(D).stack;throw new A(`${D} at ${y}`)}}function G(S,D,y,O){let l,h=(y[0]-S[0])/D[0],p=(O[0]-S[0])/D[0];h>p&&(l=h,h=p,p=l);let I=(y[1]-S[1])/D[1],g=(O[1]-S[1])/D[1];if(I>g&&(l=I,I=g,g=l),h>g||I>p)return!1;I>h&&(h=I),g<p&&(p=g);let P=(y[2]-S[2])/D[2],R=(O[2]-S[2])/D[2];return P>R&&(l=P,P=R,R=l),!(h>R||P>p||(R<p&&(p=R),p<0))}},27725:(k,V,r)=>{r.d(V,{Br:()=>B,Fm:()=>U,N9:()=>D,RA:()=>y,Tc:()=>w,Ue:()=>W,iC:()=>G,s9:()=>T,v:()=>S,xW:()=>Z,zS:()=>K});var m=r(53661),x=r(83457),b=r(87652),M=r(69923),A=r(74697);function T(l,h,p="nearest",I=!1){const g=!(I&&"u8"===h.pixelType),P=g?M.Br.FLOAT:M.Br.UNSIGNED_BYTE,R=null==h.pixels||0===h.pixels.length?null:g?h.getAsRGBAFloat():h.getAsRGBA(),N=l.capabilities.textureFloat?.textureFloatLinear;return new A.x(l,{width:h.width,height:h.height,target:M.No.TEXTURE_2D,pixelFormat:M.VI.RGBA,internalFormat:l.type===b.zO.WEBGL2&&g?M.lP.RGBA32F:M.VI.RGBA,samplingMode:!N||"bilinear"!==p&&"cubic"!==p?M.cw.NEAREST:M.cw.LINEAR,dataType:P,wrapMode:M.e8.CLAMP_TO_EDGE,flipped:!1},R)}function B(l,h){const{spacing:p,offsets:I,coefficients:g,size:[P,R]}=h,N=p[0]>1,d={width:N?4*P:P,height:R,target:M.No.TEXTURE_2D,pixelFormat:M.VI.RGBA,internalFormat:l.type===b.zO.WEBGL2?M.lP.RGBA32F:M.VI.RGBA,dataType:M.Br.FLOAT,samplingMode:M.cw.NEAREST,wrapMode:M.e8.CLAMP_TO_EDGE,flipped:!1},a=new Float32Array(N?P*R*16:2*I.length);if(N&&null!=g)for(let E=0,_=0;E<g.length;E++)a[_++]=g[E],E%3==2&&(a[_++]=1);else for(let E=0;E<R;E++)for(let _=0;_<P;_++){const L=4*(E*P+_),s=2*(_*R+E);a[L]=I[s],a[L+1]=I[s+1],a[L+3]=-1===I[s]?0:1}return new A.x(l,d,a)}function G(l,h){return new A.x(l,{width:h.length/4,height:1,target:M.No.TEXTURE_2D,pixelFormat:M.VI.RGBA,internalFormat:M.VI.RGBA,dataType:M.Br.UNSIGNED_BYTE,samplingMode:M.cw.NEAREST,wrapMode:M.e8.CLAMP_TO_EDGE,flipped:!1},h)}function w(l,h,p,I=1,g=!0){return{u_flipY:g,u_applyTransform:!!l,u_opacity:I,u_transformSpacing:l?l.spacing:x.Z,u_transformGridSize:l?l.size:x.Z,u_targetImageSize:h,u_srcImageSize:p}}function W(l,h){return{u_colormapOffset:h||0,u_colormapMaxIndex:l?l.length/4-1:0}}function K(l,h){return{u_scale:l,u_offset:h}}function Z(l){return{u_bandCount:l.bandCount,u_minOutput:l.outMin,u_maxOutput:l.outMax,u_minCutOff:l.minCutOff,u_maxCutOff:l.maxCutOff,u_factor:l.factor,u_useGamma:l.useGamma,u_gamma:l.gamma,u_gammaCorrection:l.gammaCorrection}}function U(l){return{u_hillshadeType:l.hillshadeType,u_sinZcosAs:l.sinZcosAs,u_sinZsinAs:l.sinZsinAs,u_cosZs:l.cosZs,u_weights:l.weights,u_factor:l.factor,u_minValue:l.minValue,u_maxValue:l.maxValue}}function S(l,h){const p=l.gl,I=h.glName,g=new Map;if((0,m.Wi)(I))return g;const P=p.getProgramParameter(I,p.ACTIVE_UNIFORMS);let R;for(let N=0;N<P;N++)R=p.getActiveUniform(I,N),R&&g.set(R.name,{location:p.getUniformLocation(I,R.name),info:R});return g}function D(l,h,p){Object.keys(p).forEach(I=>{const g=h.get(I)||h.get(I+"[0]");g&&function O(l,h,p,I){if(null===I||null==p)return!1;const{info:g}=I;switch(g.type){case M.Se.FLOAT:g.size>1?l.setUniform1fv(h,p):l.setUniform1f(h,p);break;case M.Se.FLOAT_VEC2:l.setUniform2fv(h,p);break;case M.Se.FLOAT_VEC3:l.setUniform3fv(h,p);break;case M.Se.FLOAT_VEC4:l.setUniform4fv(h,p);break;case M.Se.FLOAT_MAT3:l.setUniformMatrix3fv(h,p);break;case M.Se.FLOAT_MAT4:l.setUniformMatrix4fv(h,p);break;case M.Se.INT:g.size>1?l.setUniform1iv(h,p):l.setUniform1i(h,p);break;case M.Se.BOOL:l.setUniform1i(h,p?1:0);break;case M.Se.INT_VEC2:case M.Se.BOOL_VEC2:l.setUniform2iv(h,p);break;case M.Se.INT_VEC3:case M.Se.BOOL_VEC3:l.setUniform3iv(h,p);break;case M.Se.INT_VEC4:case M.Se.BOOL_VEC4:l.setUniform4iv(h,p);break;default:return!1}}(l,I,p[I],g)})}function y(l,h,p,I){p.length===I.length&&(I.some(g=>null==g)||p.some(g=>null==g)||p.forEach((g,P)=>{h.setUniform1i(g,P),l.bindTexture(I[P],P)}))}},34747:(k,V,r)=>{r.d(V,{d:()=>w});var m=r(71670),x=r(80970),b=r(9333),M=r(75301),A=r(31765);const G=(0,x.GH)(class extends x.mv{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.loading=!1,this.messages=void 0,this.messageOverrides=void 0,this.defaultMessages=void 0,this.effectiveLocale=""}onMessagesChange(){}effectiveLocaleChange(){(0,M.u)(this,this.effectiveLocale)}connectedCallback(){(0,b.c)(this),(0,M.c)(this)}componentWillLoad(){var W=this;return(0,m.Z)(function*(){yield(0,M.s)(W)})()}disconnectedCallback(){(0,b.d)(this),(0,M.d)(this)}render(){const{el:W,loading:K,messages:Z}=this,U=W.innerHTML.trim().length>0,S=K?(0,x.h)("calcite-loader",{label:Z.loading}):null,D=U?(0,x.h)("div",{class:"content"},(0,x.h)("slot",null)):null;return(0,x.h)("div",{class:"scrim"},S,D)}static get assetsDirs(){return["assets"]}get el(){return this}static get watchers(){return{messageOverrides:["onMessagesChange"],effectiveLocale:["effectiveLocaleChange"]}}static get style(){return"@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{position:absolute;inset:0px;z-index:700;display:flex;block-size:100%;inline-size:100%;flex-direction:column;align-items:stretch}@keyframes calcite-scrim-fade-in{0%{--tw-bg-opacity:0}100%{--tw-text-opacity:1}}.scrim{position:absolute;inset:0px;display:flex;flex-direction:column;align-content:center;align-items:center;justify-content:center;overflow:hidden;animation:calcite-scrim-fade-in var(--calcite-internal-animation-timing-medium) ease-in-out;background-color:var(--calcite-scrim-background, var(--calcite-scrim-background-internal))}.content{padding:1rem}"}},[1,"calcite-scrim",{loading:[516],messages:[1040],messageOverrides:[1040],defaultMessages:[32],effectiveLocale:[32]}]);function w(){typeof customElements>"u"||["calcite-scrim","calcite-loader"].forEach(K=>{switch(K){case"calcite-scrim":customElements.get(K)||customElements.define(K,G);break;case"calcite-loader":customElements.get(K)||(0,A.d)()}})}w()},34868:(k,V,r)=>{r.d(V,{C:()=>x,I:()=>A,M:()=>M,S:()=>b,a:()=>W,g:()=>G,u:()=>w});var m=r(80970);const x={container:"container",containerBorderSelected:"container--border-selected",containerBorderUnselected:"container--border-unselected",contentContainer:"content-container",contentContainerSelectable:"content-container--selectable",contentContainerHasCenterContent:"content-container--has-center-content",nestedContainer:"nested-container",nestedContainerHidden:"nested-container--hidden",content:"content",customContent:"custom-content",actionsStart:"actions-start",contentStart:"content-start",label:"label",description:"description",contentEnd:"content-end",actionsEnd:"actions-end",selectionContainer:"selection-container",openContainer:"open-container"},b={actionsStart:"actions-start",contentStart:"content-start",content:"content",contentEnd:"content-end",actionsEnd:"actions-end"},M=5,A={selectedMultiple:"check-circle-f",selectedSingle:"circle-f",unselected:"blank",closedLTR:"caret-right",closedRTL:"caret-left",open:"caret-down",blank:"blank"},T="calcite-list-item-group",B="calcite-list-item";function G(K){const Z=K.target.assignedElements({flatten:!0});return[...Z.filter(D=>D?.matches(T)).map(D=>Array.from(D.querySelectorAll(B))).reduce((D,y)=>[...D,...y],[]),...Z.filter(D=>D?.matches(B))]}function w(K){K.forEach(Z=>{Z.setPosition=K.indexOf(Z)+1,Z.setSize=K.length})}function W(K,Z=!1){return m.Z5.isBrowser?document.evaluate(Z?"ancestor::calcite-list-item | ancestor::calcite-list-item-group":"ancestor::calcite-list-item",K,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength:0}}}]);
//# sourceMappingURL=common.44995ec5cf88cce1.js.map