"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[3658],{53251:(Le,ie,a)=>{function h(){return[1,0,0,0,1,0,0,0,1]}function V(I,d,de,ve,A,L,F,me,re){return[I,d,de,ve,A,L,F,me,re]}function j(I,d){return new Float64Array(I,d,9)}a.d(ie,{a:()=>j,c:()=>h,f:()=>V}),Object.freeze(Object.defineProperty({__proto__:null,clone:function te(I){return[I[0],I[1],I[2],I[3],I[4],I[5],I[6],I[7],I[8]]},create:h,createView:j,fromValues:V},Symbol.toStringTag,{value:"Module"}))},18661:(Le,ie,a)=>{a.d(ie,{SR:()=>ve,Ui:()=>de});var h=a(53661),te=a(6848),V=a(71949),j=a(12818),u=a(71182),I=a(15686),d=a(53492);function de(c){return A(c,!0)}function ve(c){return A(c,!1)}function A(c,s){if((0,h.Wi)(c))return null;const l=c.spatialReference,i=(0,d.C5)(l),p="toJSON"in c?c.toJSON():c;if(!i)return p;const f=(0,d.sS)(l)?102100:4326,C=I.UZ[f].maxX,W=I.UZ[f].minX;if((0,u.wp)(p))return F(p,C,W);if((0,u.aW)(p))return p.points=p.points.map(E=>F(E,C,W)),p;if((0,u.YX)(p))return function L(c,s){if(!s)return c;const l=function me(c,s){const l=[],{ymin:i,ymax:p,xmin:f,xmax:C}=c,W=c.xmax-c.xmin,[E,x]=s.valid,{x:P,frameId:g}=re(c.xmin,s),{x:H,frameId:U}=re(c.xmax,s),xe=P===H&&W>0;if(W>2*x){const fe={xmin:f<C?P:H,ymin:i,xmax:x,ymax:p},Pe={xmin:E,ymin:i,xmax:f<C?H:P,ymax:p},ne={xmin:0,ymin:i,xmax:x,ymax:p},Y={xmin:E,ymin:i,xmax:0,ymax:p},$=[],R=[];le(fe,ne)&&$.push(g),le(fe,Y)&&R.push(g),le(Pe,ne)&&$.push(U),le(Pe,Y)&&R.push(U);for(let b=g+1;b<U;b++)$.push(b),R.push(b);l.push(new T(fe,[g]),new T(Pe,[U]),new T(ne,$),new T(Y,R))}else P>H||xe?l.push(new T({xmin:P,ymin:i,xmax:x,ymax:p},[g]),new T({xmin:E,ymin:i,xmax:H,ymax:p},[U])):l.push(new T({xmin:P,ymin:i,xmax:H,ymax:p},[g]));return l}(c,s).map(i=>i.extent);return l.length<2?l[0]||c:l.length>2?(c.xmin=s.valid[0],c.xmax=s.valid[1],c):{rings:l.map(i=>[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]])}}(p,i);if((0,u.oU)(p)||(0,u.l9)(p)){const E=(0,V.$P)(D,p),x={xmin:E[0],ymin:E[1],xmax:E[2],ymax:E[3]},P=(0,I.XZ)(x.xmin,W)*(2*C),g=0===P?p:(0,I.Sy)(p,P);return x.xmin+=P,x.xmax+=P,x.xmax>C?ce(g,C,s):x.xmin<W?ce(g,W,s):g}return p}function F(c,s,l){if(Array.isArray(c)){const i=c[0];if(i>s){const p=(0,I.XZ)(i,s);c[0]=i+p*(-2*s)}else if(i<l){const p=(0,I.XZ)(i,l);c[0]=i+p*(-2*l)}}else{const i=c.x;if(i>s){const p=(0,I.XZ)(i,s);c.x+=p*(-2*s)}else if(i<l){const p=(0,I.XZ)(i,l);c.x+=p*(-2*l)}}return c}function re(c,s){const[l,i]=s.valid,p=2*i;let f,C=0;return c>i?(f=Math.ceil(Math.abs(c-i)/p),c-=f*p,C=f):c<l&&(f=Math.ceil(Math.abs(c-l)/p),c+=f*p,C=-f),{x:c,frameId:C}}function le(c,s){const{xmin:l,ymin:i,xmax:p,ymax:f}=s;return ae(c,l,i)&&ae(c,l,f)&&ae(c,p,f)&&ae(c,p,i)}function ae(c,s,l){return s>=c.xmin&&s<=c.xmax&&l>=c.ymin&&l<=c.ymax}function ce(c,s,l=!0){const i=!(0,u.l9)(c);if(i&&(0,j.Zy)(c),l)return(new Re).cut(c,s);const p=i?c.rings:c.paths,f=i?4:2,C=p.length,W=-2*s;for(let E=0;E<C;E++){const x=p[E];if(x&&x.length>=f){const P=[];for(const g of x)P.push([g[0]+W,g[1]]);p.push(P)}}return i?c.rings=p:c.paths=p,c}class T{constructor(s,l){this.extent=s,this.frameIds=l}}const D=(0,te.Ue)();class Re{constructor(){this._linesIn=[],this._linesOut=[]}cut(s,l){let i;if(this._xCut=l,s.rings)this._closed=!0,i=s.rings,this._minPts=4;else{if(!s.paths)return null;this._closed=!1,i=s.paths,this._minPts=2}for(const f of i){if(!f||f.length<this._minPts)continue;let C=!0;for(const W of f)C?(this.moveTo(W),C=!1):this.lineTo(W);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),i=[];for(const f of this._linesIn)f&&f.length>=this._minPts&&i.push(f);const p=-2*this._xCut;for(const f of this._linesOut)if(f&&f.length>=this._minPts){for(const C of f)C[0]+=p;i.push(f)}return this._closed?s.rings=i:s.paths=i,s}moveTo(s){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(s[0]),this._moveTo(s[0],s[1],this._prevSide),this._prevPt=s,this._firstPt=s}lineTo(s){const l=this._side(s[0]);if(l*this._prevSide==-1){const i=this._intersect(this._prevPt,s);this._lineTo(this._xCut,i,0),this._prevSide=0,this._lineTo(s[0],s[1],l)}else this._lineTo(s[0],s[1],l);this._prevSide=l,this._prevPt=s}close(){const s=this._firstPt,l=this._prevPt;s[0]===l[0]&&s[1]===l[1]||this.lineTo(s),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(s,l,i){this._closed?(this._lineIn.push([i<=0?s:this._xCut,l]),this._lineOut.push([i>=0?s:this._xCut,l])):(i<=0&&this._lineIn.push([s,l]),i>=0&&this._lineOut.push([s,l]))}_lineTo(s,l,i){this._closed?(this._addPolyVertex(this._lineIn,i<=0?s:this._xCut,l),this._addPolyVertex(this._lineOut,i>=0?s:this._xCut,l)):i<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([s,l])):i>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([s,l])):this._prevSide<0?(this._lineIn.push([s,l]),this._lineOut.push([s,l])):this._prevSide>0&&(this._lineOut.push([s,l]),this._lineIn.push([s,l]))}_addPolyVertex(s,l,i){const p=s.length;p>1&&s[p-1][0]===l&&s[p-2][0]===l?s[p-1][1]=i:s.push([l,i])}_checkClosingPt(s){const l=s.length;l>3&&s[0][0]===this._xCut&&s[l-2][0]===this._xCut&&s[1][0]===this._xCut&&(s[0][1]=s[l-2][1],s.pop())}_side(s){return s<this._xCut?-1:s>this._xCut?1:0}_intersect(s,l){return s[1]+(this._xCut-s[0])/(l[0]-s[0])*(l[1]-s[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}},49122:(Le,ie,a)=>{a.r(ie),a.d(ie,{default:()=>at});var h=a(18100),te=a(97621),V=a(32995),j=a(28191),u=a(53661),I=a(90642),d=a(9497),de=a(36734),A=(a(19420),a(66508)),L=a(20891),F=a(70425),me=a(22735),re=a(29812),le=a(33829),ae=a(72450),ce=a(71670),T=a(1897),D=a(55050),Re=a(28772),s=(a(83382),a(20711)),l=a(44480),i=a(48500),p=a(6365),f=a(69851),C=a(55798),W=a(38974),E=a(53251),x=a(80775),P=a(83457),g=a(35787),H=a(55733),U=a(21789),xe=a(68230),fe=a(94904);a(67087);let ne=class extends fe.j{projectOrWarn(e,t){if((0,u.Wi)(e))return e;const{geometry:n,pending:o}=(0,U.dz)(e,t);return o?null:o||n?n:(j.Z.getLogger(this.declaredClass).warn("geometry could not be projected to the spatial reference",{georeference:this,geometry:e,sourceSpatialReference:e.spatialReference,targetSpatialReference:t}),null)}};ne=(0,h._)([(0,L.j)("esri.layers.support.GeoreferenceBase")],ne);const Y=ne,$=(0,E.c)(),R=(0,P.a)();let b=class extends p.Z{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};(0,h._)([(0,d.Cb)()],b.prototype,"sourcePoint",void 0),(0,h._)([(0,d.Cb)({type:g.Z})],b.prototype,"mapPoint",void 0),b=(0,h._)([(0,L.j)("esri.layers.support.ControlPoint")],b);let w=class extends((0,l.eC)(Y)){constructor(e){super(e),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}readControlPoints(e,t){const n=xe.Z.fromJSON(t.spatialReference),o=(0,E.f)(...t.coefficients,1);return e.map(r=>((0,x.s)(R,r.x,r.y),(0,f.H)(R,R,o),{sourcePoint:r,mapPoint:new g.Z({x:R[0],y:R[1],spatialReference:n})}))}writeControlPoints(e,t,n,o){if((0,u.Wi)(this.transform)){const r=new V.Z("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration.",{layer:o?.layer,georeference:this});o?.messages?o.messages.push(r):j.Z.getLogger(this.declaredClass).error(r.name,r.message)}else(0,u.pC)(e)&&M(e[0])&&(t.controlPoints=e.map(r=>{const m=(0,u.Wg)(r.sourcePoint);return{x:m.x,y:m.y}}),t.spatialReference=e[0].mapPoint.spatialReference.toJSON(),t.coefficients=this.transform.slice(0,8))}get coords(){if((0,u.Wi)(this.controlPoints))return null;const e=this._updateTransform($);return(0,u.Wi)(e)||!M(this.controlPoints[0])?null:function Ke(e,t,n,o){const r=(0,P.f)(0,n),m=(0,P.f)(0,0),v=(0,P.f)(t,0),y=(0,P.f)(t,n);return(0,f.H)(r,r,e),(0,f.H)(m,m,e),(0,f.H)(v,v,e),(0,f.H)(y,y,e),new H.Z({rings:[[r,m,v,y,r]],spatialReference:o})}(e,this.width,this.height,this.controlPoints[0].mapPoint.spatialReference)}set coords(e){if((0,u.Wi)(this.controlPoints)||!M(this.controlPoints[0]))return;const t=this.controlPoints[0].mapPoint.spatialReference;if(e=this.projectOrWarn(e,t),(0,u.Wi)(e))return;const{width:n,height:o}=this,{rings:[[r,m,v,y]]}=e,O={sourcePoint:(0,C.vW)(0,o),mapPoint:new g.Z({x:r[0],y:r[1],spatialReference:t})},Z={sourcePoint:(0,C.vW)(0,0),mapPoint:new g.Z({x:m[0],y:m[1],spatialReference:t})},B={sourcePoint:(0,C.vW)(n,0),mapPoint:new g.Z({x:v[0],y:v[1],spatialReference:t})},ee={sourcePoint:(0,C.vW)(n,o),mapPoint:new g.Z({x:y[0],y:y[1],spatialReference:t})};M(O)&&M(Z)&&M(B)&&M(ee)&&(Se($,O,Z,B,ee),this.controlPoints=(0,u.Wg)(this.controlPoints).map(({sourcePoint:X})=>((0,x.s)(R,X.x,X.y),(0,f.H)(R,R,$),{sourcePoint:X,mapPoint:new g.Z({x:R[0],y:R[1],spatialReference:t})})))}get inverseTransform(){return(0,u.Wi)(this.transform)?null:(0,W.e)((0,E.c)(),this.transform)}get transform(){return this._updateTransform()}toMap(e){if((0,u.Wi)(e)||(0,u.Wi)(this.transform)||(0,u.Wi)(this.controlPoints)||!M(this.controlPoints[0]))return null;(0,x.s)(R,e.x,e.y);const t=this.controlPoints[0].mapPoint.spatialReference;return(0,f.H)(R,R,this.transform),new g.Z({x:R[0],y:R[1],spatialReference:t})}toSource(e){if((0,u.Wi)(e)||(0,u.Wi)(this.inverseTransform)||(0,u.Wi)(this.controlPoints)||!M(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return e=e.normalize(),e=(0,U.dz)(e,t).geometry,(0,u.Wi)(e)?null:((0,x.s)(R,e.x,e.y),(0,f.H)(R,R,this.inverseTransform),(0,C.vW)(R[0],R[1]))}_updateTransform(e){const{controlPoints:t,width:n,height:o}=this;if((0,u.Wi)(t)||!(n>0)||!(o>0))return null;const[r,m,v,y]=t;if(!M(r))return null;const O=r.mapPoint.spatialReference,Z=this._projectControlPoint(m,O),B=this._projectControlPoint(v,O),ee=this._projectControlPoint(y,O);if(!(Z.valid&&B.valid&&ee.valid&&M(Z.controlPoint)))return null;(0,u.Wi)(e)&&(e=(0,E.c)());let X=null;return X=M(B.controlPoint)&&M(ee.controlPoint)?Se(e,r,Z.controlPoint,B.controlPoint,ee.controlPoint):M(B.controlPoint)?function Ae(e,t,n,o){return J(N,z,t),J(K,G,n),J(se,oe,o),(0,x.l)(Q,N,K,.5),(0,x.r)(Q,se,Q,Math.PI),(0,x.l)(_,z,G,.5),(0,x.r)(_,oe,_,Math.PI),Ie(e,N,K,se,Q,z,G,oe,_)}(e,r,Z.controlPoint,B.controlPoint):function Be(e,t,n){return J(N,z,t),J(K,G,n),(0,x.r)(se,K,N,Ce),(0,x.r)(Q,N,K,Ce),(0,x.r)(oe,G,z,-Ce),(0,x.r)(_,z,G,-Ce),Ie(e,N,K,se,Q,z,G,oe,_)}(e,r,Z.controlPoint),X.every(ct=>0===ct)?null:X}_projectControlPoint(e,t){if(!M(e))return{valid:!0,controlPoint:e};const{sourcePoint:n,mapPoint:o}=e,{geometry:r,pending:m}=(0,U.dz)(o,t);return m?{valid:!1,controlPoint:null}:m||r?{valid:!0,controlPoint:{sourcePoint:n,mapPoint:r}}:(j.Z.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:e,sourceSpatialReference:o.spatialReference,targetSpatialReference:t}),{valid:!1,controlPoint:null})}};function M(e){return(0,u.pC)(e)&&(0,u.pC)(e.sourcePoint)&&(0,u.pC)(e.mapPoint)}(0,h._)([(0,d.Cb)({type:[b],json:{write:{allowNull:!1,isRequired:!0}}})],w.prototype,"controlPoints",void 0),(0,h._)([(0,A.r)("controlPoints")],w.prototype,"readControlPoints",null),(0,h._)([(0,F.c)("controlPoints")],w.prototype,"writeControlPoints",null),(0,h._)([(0,d.Cb)()],w.prototype,"coords",null),(0,h._)([(0,d.Cb)({json:{write:!0}})],w.prototype,"height",void 0),(0,h._)([(0,d.Cb)({readOnly:!0})],w.prototype,"inverseTransform",null),(0,h._)([(0,d.Cb)({readOnly:!0})],w.prototype,"transform",null),(0,h._)([(0,d.Cb)({json:{write:!0}})],w.prototype,"width",void 0),w=(0,h._)([(0,L.j)("esri.layers.support.ControlPointsGeoreference")],w);const N=(0,P.a)(),K=(0,P.a)(),se=(0,P.a)(),Q=(0,P.a)(),z=(0,P.a)(),G=(0,P.a)(),oe=(0,P.a)(),_=(0,P.a)(),Ce=Math.PI/2;function J(e,t,n){(0,x.s)(e,n.sourcePoint.x,n.sourcePoint.y),(0,x.s)(t,n.mapPoint.x,n.mapPoint.y)}function Se(e,t,n,o,r){return J(N,z,t),J(K,G,n),J(se,oe,o),J(Q,_,r),Ie(e,N,K,se,Q,z,G,oe,_)}const De=new Array(8).fill(0),Ne=new Array(8).fill(0);function Ze(e,t,n,o,r){return e[0]=t[0],e[1]=t[1],e[2]=n[0],e[3]=n[1],e[4]=o[0],e[5]=o[1],e[6]=r[0],e[7]=r[1],e}function Ie(e,t,n,o,r,m,v,y,O){return(0,f.E)(e,Ze(De,t,n,o,r),Ze(Ne,m,v,y,O))}const je=w;let k=class extends Y{constructor(e){super(e),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:e,topRight:t,bottomLeft:n,bottomRight:o}=this;if((0,u.Wi)(e)||(0,u.Wi)(t)||(0,u.Wi)(n)||(0,u.Wi)(o))return null;const r=e.spatialReference;return t=this.projectOrWarn(t,r),n=this.projectOrWarn(n,r),o=this.projectOrWarn(o,r),(0,u.Wi)(t)||(0,u.Wi)(n)||(0,u.Wi)(o)?null:new H.Z({rings:[[[n.x,n.y],[e.x,e.y],[t.x,t.y],[o.x,o.y],[n.x,n.y]]],spatialReference:r})}set coords(e){const{topLeft:t}=this;if((0,u.Wi)(t))return;const n=t.spatialReference;if(e=this.projectOrWarn(e,n),(0,u.Wi)(e))return;const{rings:[[o,r,m,v]]}=e;this.bottomLeft=new g.Z({x:o[0],y:o[1],spatialReference:n}),this.topLeft=new g.Z({x:r[0],y:r[1],spatialReference:n}),this.topRight=new g.Z({x:m[0],y:m[1],spatialReference:n}),this.bottomRight=new g.Z({x:v[0],y:v[1],spatialReference:n})}};(0,h._)([(0,d.Cb)()],k.prototype,"coords",null),(0,h._)([(0,d.Cb)({type:g.Z})],k.prototype,"bottomLeft",void 0),(0,h._)([(0,d.Cb)({type:g.Z})],k.prototype,"bottomRight",void 0),(0,h._)([(0,d.Cb)({type:g.Z})],k.prototype,"topLeft",void 0),(0,h._)([(0,d.Cb)({type:g.Z})],k.prototype,"topRight",void 0),k=(0,h._)([(0,L.j)("esri.layers.support.CornersGeoreference")],k);const ze=k;var Ge=a(93142),Je=a(33980),Oe=a(10465);let he=class extends Y{constructor(e){super(e),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if((0,u.Wi)(this.extent))return null;const{xmin:e,ymin:t,xmax:n,ymax:o,spatialReference:r}=this.extent;let m;if(this.rotation){const{x:v,y}=this.extent.center,O=Te(v,y,this.rotation);m=[O(e,t),O(e,o),O(n,o),O(n,t)],m.push(m[0])}else m=[[e,t],[e,o],[n,o],[n,t],[e,t]];return new H.Z({rings:[m],spatialReference:r})}set coords(e){if((0,u.Wi)(e)||(0,u.Wi)(this.extent))return;const t=this.extent.spatialReference;if(e=this.projectOrWarn(e,t),(0,u.Wi)(e)||(0,u.Wi)(e.extent))return;const{rings:[[n,o,r]],extent:{center:{x:m,y:v}}}=e,y=(0,Ge.BV)(Math.PI/2-Math.atan2(o[1]-n[1],o[0]-n[0])),O=Te(m,v,-y),[Z,B]=O(n[0],n[1]),[ee,X]=O(r[0],r[1]);this.extent=new Oe.Z({xmin:Z,ymin:B,xmax:ee,ymax:X,spatialReference:t}),this.rotation=y}};function Te(e,t,n){const o=(0,Je.t)(n),r=Math.cos(o),m=Math.sin(o);return(v,y)=>[r*(v-e)+m*(y-t)+e,r*(y-t)-m*(v-e)+t]}(0,h._)([(0,d.Cb)()],he.prototype,"coords",null),(0,h._)([(0,d.Cb)({type:Oe.Z})],he.prototype,"extent",void 0),(0,h._)([(0,d.Cb)({type:Number})],he.prototype,"rotation",void 0),he=(0,h._)([(0,L.j)("esri.layers.support.ExtentAndRotationGeoreference")],he);const Xe={key:"type",base:Y,typeMap:{"control-points":je,corners:ze,"extent-and-rotation":he}};let ue=class extends((0,s.iv)((0,l.eC)(i.Z))){constructor(){super(...arguments),this.georeference=null,this.opacity=1}readGeoreference(e){return je.fromJSON(e)}};(0,h._)([(0,d.Cb)({types:Xe,json:{write:!0}})],ue.prototype,"georeference",void 0),(0,h._)([(0,A.r)("georeference")],ue.prototype,"readGeoreference",null),(0,h._)([(0,d.Cb)()],ue.prototype,"opacity",void 0),ue=(0,h._)([(0,L.j)("esri.layers.support.MediaElementBase")],ue);const Ee=ue;var Fe=a(87640),ye=a(29184);let q=class extends Ee{constructor(e){super(e),this.content=null,this.image=null,this.type="image",this.image=null}load(){const e=this.image;if("string"==typeof e){const t=(0,T.default)(e,{responseType:"image"}).then(({data:n})=>{this._set("content",n)});this.addResolvingPromise(t)}else if(e instanceof HTMLImageElement){const t=e.decode().then(()=>{this._set("content",e)});this.addResolvingPromise(t)}else e?this._set("content",e):this.addResolvingPromise(Promise.reject(new V.Z("image-element:invalid-image-type","Invalid image type",{image:e})));return Promise.resolve(this)}readImage(e,t,n){return(0,ye.f)(t.url,n)}writeImage(e,t,n,o){if((0,u.Wi)(e))return;const r=o?.portalItem,m=o?.resources;if(!r||!m)return void("string"==typeof e&&(t[n]=(0,ye.t)(e,o)));const v="string"!=typeof e||(0,D.HK)(e)||(0,D.jc)(e)?null:e;if(v){if(null==(0,ye.i)(v))return void(t[n]=v);const y=(0,ye.t)(v,{...o,verifyItemRelativeUrls:o&&o.verifyItemRelativeUrls?{writtenUrls:o.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},ye.M.NO);if(r&&y&&!(0,D.YP)(y))return m.toKeep.push({resource:r.resourceFromPath(y),compress:!1}),void(t[n]=y)}t[n]="<pending>",m.pendingOperations.push(we(e).then(y=>{const O=function $e(e,t){const n=(0,Re.D)(),o=`${(0,D.v_)("media",n)}.${(0,Fe.B)(e)}`;return t.resourceFromPath(o)}(y,r);t[n]=O.itemRelativeUrl,m.toAdd.push({resource:O,content:y,compress:!1,finish:Z=>{this.image=Z.url}})}))}};(0,h._)([(0,d.Cb)({readOnly:!0})],q.prototype,"content",void 0),(0,h._)([(0,d.Cb)({json:{name:"url",type:String}})],q.prototype,"image",void 0),(0,h._)([(0,A.r)("image",["url"])],q.prototype,"readImage",null),(0,h._)([(0,F.c)("image")],q.prototype,"writeImage",null),(0,h._)([(0,d.Cb)({readOnly:!0,json:{name:"mediaType"}})],q.prototype,"type",void 0),q=(0,h._)([(0,L.j)("esri.layers.support.ImageElement")],q);const Ue=q;function we(e){return We.apply(this,arguments)}function We(){return(We=(0,ce.Z)(function*(e){if("string"==typeof e){if((0,D.jc)(e)){const{data:t}=yield(0,T.default)(e,{responseType:"blob"});return t}return(0,D.HK)(e)?(0,D.fw)(e):we((yield(0,T.default)(e,{responseType:"image"})).data)}return new Promise(t=>function Ye(e){if(e instanceof HTMLCanvasElement)return e;const t=e instanceof HTMLImageElement?e.naturalWidth:e.width,n=e instanceof HTMLImageElement?e.naturalHeight:e.height,o=document.createElement("canvas"),r=o.getContext("2d");return o.width=t,o.height=n,e instanceof HTMLImageElement?r.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&r.putImageData(e,0,0),o}(e).toBlob(t))})).apply(this,arguments)}a(6010);var Qe=a(40434),_e=a(95442),ke=a(31882),qe=a(99508),et=a(30801),tt=a(7521),nt=a(6848),st=a(76438),ot=a(53492),it=a(97135),rt=a(6264);let ge=class extends Ee{constructor(e){super(e),this.content=null,this.type="video"}load(){const e=this.video;if("string"==typeof e){const t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.autoplay=!0,t.muted=!0,t.loop=!0,this.addResolvingPromise(this._loadVideo(t).then(()=>{this._set("content",t)}))}else e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then(()=>{this._set("content",e)})):this.addResolvingPromise(Promise.reject(new V.Z("video-element:invalid-video-type","Invalid video type",{video:e})));return Promise.resolve(this)}set video(e){"not-loaded"===this.loadStatus?this._set("video",e):j.Z.getLogger(this.declaredClass).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(e){return new Promise((t,n)=>{e.oncanplay=()=>{e.oncanplay=null,e.play().then(t,n)},"anonymous"!==e.crossOrigin&&(e.crossOrigin="anonymous",e.src=e.src)})}};(0,h._)([(0,d.Cb)({readOnly:!0})],ge.prototype,"content",void 0),(0,h._)([(0,d.Cb)()],ge.prototype,"video",null),ge=(0,h._)([(0,L.j)("esri.layers.support.VideoElement")],ge);const Ve=ge,He=te.Z.ofType({key:"type",defaultKeyValue:"image",base:Ee,typeMap:{image:Ue,video:Ve}});let pe=class extends(i.Z.LoadableMixin((0,qe.v)((0,ke.p)(_e.Z.EventedAccessor)))){constructor(e){super(e),this._index=new it.H,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=t=>{for(const o of t.removed){const r=this._elementViewsMap.get(o);this._elementViewsMap.delete(o),this._index.delete(r),this.handles.remove(r),r.destroy(),this.notifyChange("fullExtent")}const{spatialReference:n}=this;for(const o of t.added){if(this._elementViewsMap.get(o))continue;const r=new rt.L({spatialReference:n,element:o});this._elementViewsMap.set(o,r);const m=(0,tt.YP)(()=>r.coords,()=>this._updateIndexForElement(r,!1));this._updateIndexForElement(r,!0),this.handles.add(m,r)}this._elementsIndexes.clear(),this.elements.forEach((o,r)=>this._elementsIndexes.set(o,r)),this.emit("refresh")},this.elements=new He}load(e){var t=this;return(0,ce.Z)(function*(){if((0,et.k_)(e),!t.spatialReference){const n=t.elements.find(o=>(0,u.pC)(o.georeference)&&(0,u.pC)(o.georeference.coords));t._set("spatialReference",n?(0,u.Wg)((0,u.Wg)(n.georeference).coords).spatialReference:xe.Z.WGS84)}return t._elementsChangedHandler({added:t.elements.items,removed:[]}),t.handles.add(t.elements.on("change",t._elementsChangedHandler)),t})()}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",(0,Qe.Z)(e,this._get("elements"),He))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const e=this._index.fullBounds;return(0,u.Wi)(e)?null:new Oe.Z({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){"not-loaded"===this.loadStatus?this._set("spatialReference",e):j.Z.getLogger(this.declaredClass).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}queryElements(e,t){var n=this;return(0,ce.Z)(function*(){yield n.load(),yield(0,U.iQ)(e.spatialReference,n.spatialReference,null,t);const o=(0,ot.fS)(e.spatialReference,n.spatialReference)?e:(0,U.iV)(e,n.spatialReference);if(!o)return[];const r=o.normalize(),m=[];for(const v of r)n._index.forEachInBounds((0,nt.oJ)(v),({normalizedCoords:y,element:O})=>{(0,u.pC)(y)&&(0,st.Nl)(v,y)&&m.push(O)});return m.sort((v,y)=>n._elementsIndexes.get(v)-n._elementsIndexes.get(y)),m})()}_updateIndexForElement(e,t){const n=e.normalizedBounds,o=this._index.has(e),r=(0,u.pC)(n);this._index.delete(e),r&&this._index.set(e,n),this.notifyChange("fullExtent"),t||(o!==r?this.emit("refresh"):this.emit("change",{element:e.element}))}};(0,h._)([(0,d.Cb)()],pe.prototype,"elements",null),(0,h._)([(0,d.Cb)({readOnly:!0})],pe.prototype,"fullExtent",null),(0,h._)([(0,d.Cb)()],pe.prototype,"spatialReference",null),pe=(0,h._)([(0,L.j)("esri.layers.support.LocalMediaElementSource")],pe);const Me=pe;function be(e){return"object"==typeof e&&null!=e&&"type"in e}let S=class extends((0,re.h)((0,ae.M)((0,le.q)((0,I.R)(me.Z))))){constructor(e){super(e),this.effectiveSource=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this.source=new Me}load(e){const t=this.source;if(!t)return this.addResolvingPromise(Promise.reject(new V.Z("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer."))),Promise.resolve(this);const n=be(t)?new Me({elements:new te.Z([t])}):t;this._set("effectiveSource",n),this.spatialReference&&(n.spatialReference=this.spatialReference);const o=n.load(e).then(()=>{this.spatialReference=n.spatialReference});return this.addResolvingPromise(o),Promise.resolve(this)}destroy(){(0,u.Wg)(this.effectiveSource)?.destroy(),(0,u.Wg)(this.source)?.destroy()}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}set source(e){"not-loaded"===this.loadStatus?this._set("source",e):j.Z.getLogger(this.declaredClass).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)||e instanceof te.Z?new Me({elements:e}):e:null}readSource(e,t,n){const o="image"===t.mediaType?new Ue:"video"===t.mediaType?new Ve:null;return o?.read(t,n),o}writeSource(e,t,n,o){e&&be(e)&&"image"===e.type?e.write(t,o):o?.messages&&o?.messages?.push(new V.Z("media-layer:unsupported-source","source must be an 'ImageElement'"))}};(0,h._)([(0,d.Cb)({readOnly:!0})],S.prototype,"effectiveSource",void 0),(0,h._)([(0,d.Cb)({type:String})],S.prototype,"copyright",void 0),(0,h._)([(0,d.Cb)({readOnly:!0})],S.prototype,"fullExtent",null),(0,h._)([(0,d.Cb)({type:["MediaLayer"]})],S.prototype,"operationalLayerType",void 0),(0,h._)([(0,d.Cb)({type:["show","hide"]})],S.prototype,"listMode",void 0),(0,h._)([(0,d.Cb)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1}}})],S.prototype,"source",null),(0,h._)([(0,de.p)("source")],S.prototype,"castSource",null),(0,h._)([(0,A.r)("source",["url"])],S.prototype,"readSource",null),(0,h._)([(0,F.c)("source")],S.prototype,"writeSource",null),(0,h._)([(0,d.Cb)()],S.prototype,"spatialReference",void 0),(0,h._)([(0,d.Cb)({readOnly:!0})],S.prototype,"type",void 0),S=(0,h._)([(0,L.j)("esri.layers.MediaLayer")],S);const at=S}}]);
//# sourceMappingURL=3658.1aed1e3b55aa9d5d.js.map