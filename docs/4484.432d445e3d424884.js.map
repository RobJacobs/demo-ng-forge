{"version":3,"file":"4484.432d445e3d424884.js","mappings":"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","names":["p","a","initialize","this","exportImageParameters","s","layer","destroy","floors","view","exportImageVersion","commitProperty","_get","canResume","super","timeExtent","isEmpty","e","r","prototype","readOnly","o","t","f","c","d","m","constructor","arguments","_highlightGraphics","h","_updateHash","fetchPopupFeatures","_popupHighlightHelper","update","state","id","pixelRatio","stationary","strategy","catch","i","declaredClass","error","updateHighlightedFeatures","resolution","_highlightView","processUpdate","attach","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","container","addChild","g","graphics","requestUpdateCallback","requestUpdate","n","featuresTilingScheme","defaultPointSymbolEnabled","u","createFetchPopupFeaturesQueryGeometry","y","highlightGraphics","highlightGraphicUpdated","graphicUpdateHandler","graphic","property","layerView","updatingHandles","l","fetchSource","fetchImageBitmap","bind","imageRotationSupported","imageNormalizationSupported","hidpi","addAttachHandles","detach","removeAllChildren","moveStart","viewChange","moveEnd","supportsSpatialReference","serviceSupportsSpatialReference","doRefresh","_this","_asyncToGenerator","isUpdating","updating","updateRequested","fetchImage","highlight","w"],"sourceRoot":"webpack:///","sources":["./node_modules/@arcgis/core/views/layers/MapImageLayerView.js","./node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as o}from\"../../layers/support/commonProperties.js\";import{ExportImageParameters as s}from\"../../layers/support/ExportImageParameters.js\";const p=p=>{let a=class extends p{initialize(){this.exportImageParameters=new s({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),this.commitProperty(\"floors\"),(this._get(\"exportImageVersion\")||0)+1}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([r()],a.prototype,\"exportImageParameters\",void 0),e([r({readOnly:!0})],a.prototype,\"floors\",null),e([r({readOnly:!0})],a.prototype,\"exportImageVersion\",null),e([r()],a.prototype,\"layer\",void 0),e([r()],a.prototype,\"suspended\",void 0),e([r(o)],a.prototype,\"timeExtent\",void 0),a=e([t(\"esri.views.layers.MapImageLayerView\")],a),a};export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import e from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as r}from\"../../../core/reactiveUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{GraphicsCollection as h}from\"../../../support/GraphicsCollection.js\";import{BitmapContainer as o}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as p}from\"./LayerView2D.js\";import g from\"./graphics/GraphicsView2D.js\";import n from\"./graphics/HighlightGraphicContainer.js\";import l from\"./support/ExportStrategy.js\";import m from\"../../layers/LayerView.js\";import c from\"../../layers/MapImageLayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";import{MapServiceLayerViewHelper as u}from\"../../layers/support/MapServiceLayerViewHelper.js\";import{createQueryGeometry as y}from\"../../support/drapedUtils.js\";let f=class extends(c(d(p(m)))){constructor(){super(...arguments),this._highlightGraphics=new h,this._updateHash=\"\"}fetchPopupFeatures(t,e){return this._popupHighlightHelper.fetchPopupFeatures(t,e)}update(t){const r=`${this.exportImageVersion}/${t.state.id}/${t.pixelRatio}/${t.stationary}`;this._updateHash!==r&&(this._updateHash=r,this.strategy.update(t).catch((t=>{i(t)||e.getLogger(this.declaredClass).error(t)})),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}attach(){const{imageMaxWidth:t,imageMaxHeight:e,version:i}=this.layer,s=i>=10.3,a=i>=10;this._bitmapContainer=new o,this.container.addChild(this._bitmapContainer),this._highlightView=new g({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new n(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new u({createFetchPopupFeaturesQueryGeometry:(t,e)=>y(t,e,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(t,e)=>{this._highlightView.graphicUpdateHandler({graphic:t,property:e})},layerView:this,updatingHandles:this.updatingHandles}),this.strategy=new l({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:t,imageMaxHeight:e,imageRotationSupported:s,imageNormalizationSupported:a,hidpi:!0}),this.addAttachHandles(r((()=>this.exportImageVersion),(()=>this.requestUpdate()))),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(t){return this.layer.serviceSupportsSpatialReference(t)}async doRefresh(){this._updateHash=\"\",this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(t,e,i,r){return this.layer.fetchImage(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}fetchImageBitmap(t,e,i,r){return this.layer.fetchImageBitmap(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}highlight(t){return this._popupHighlightHelper.highlight(t)}};t([s()],f.prototype,\"strategy\",void 0),t([s()],f.prototype,\"updating\",void 0),f=t([a(\"esri.views.2d.layers.MapImageLayerView2D\")],f);const w=f;export{w as default};\n"],"x_google_ignoreList":[0,1]}