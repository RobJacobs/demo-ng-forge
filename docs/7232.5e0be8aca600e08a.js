"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[7232],{6099:(ht,V,R)=>{R.d(V,{G6:()=>S,Ie:()=>h,J9:()=>f,RF:()=>et,U1:()=>u,vY:()=>Q,ym:()=>c});var x=R(53661),p=R(71182);const Y=(e,r,i)=>[r,i],A=(e,r,i)=>[r,i,e[2]],z=(e,r,i)=>[r,i,e[2],e[3]];function Q(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,x.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function H({scale:e,translate:r},i){return Math.round((i-r[0])/e[0])}function y({scale:e,translate:r},i){return Math.round((r[1]-i)/e[1])}function j(e,r,i){const o=[];let l,s,m,g;for(let d=0;d<i.length;d++){const P=i[d];d>0?(m=H(e,P[0]),g=y(e,P[1]),m===l&&g===s||(o.push(r(P,m-l,g-s)),l=m,s=g)):(l=H(e,P[0]),s=y(e,P[1]),o.push(r(P,l,s)))}return o.length>0?o:null}function O({scale:e,translate:r},i){return i*e[0]+r[0]}function E({scale:e,translate:r},i){return r[1]-i*e[1]}function M(e,r,i){const o=new Array(i.length);if(!i.length)return o;const[l,s]=e.scale;let m=O(e,i[0][0]),g=E(e,i[0][1]);o[0]=r(i[0],m,g);for(let d=1;d<i.length;d++){const P=i[d];m+=P[0]*l,g-=P[1]*s,o[d]=r(P,m,g)}return o}function U(e,r,i){const o=new Array(i.length);for(let l=0;l<i.length;l++)o[l]=M(e,r,i[l]);return o}function et(e,r,i,o,l){return r.x=H(e,i.x),r.y=y(e,i.y),r!==i&&(o&&(r.z=i.z),l&&(r.m=i.m)),r}function c(e,r){return e&&r?(0,p.wp)(r)?et(e,{},r,!1,!1):(0,p.l9)(r)?function a(e,r,i,o,l){const s=function ot(e,r,i,o){const l=[],s=i?o?z:A:o?A:Y;for(let m=0;m<r.length;m++){const g=j(e,s,r[m]);g&&g.length>=2&&l.push(g)}return l.length?l:null}(e,i.paths,o,l);return s?(r.paths=s,r):null}(e,{},r,!1,!1):(0,p.oU)(r)?function w(e,r,i,o,l){const s=function it(e,r,i,o){const l=[],s=i?o?z:A:o?A:Y;for(let m=0;m<r.length;m++){const g=j(e,s,r[m]);g&&g.length>=3&&l.push(g)}return l.length?l:null}(e,i.rings,o,l);return s?(r.rings=s,r):null}(e,{},r,!1,!1):(0,p.aW)(r)?function ut(e,r,i,o,l){return r.points=function T(e,r,i,o){return j(e,i?o?z:A:o?A:Y,r)}(e,i.points,o,l)??[],r}(e,{},r,!1,!1):(0,p.YX)(r)?function at(e,r,i,o,l){return r.xmin=H(e,i.xmin),r.ymin=y(e,i.ymin),r.xmax=H(e,i.xmax),r.ymax=y(e,i.ymax),r!==i&&(o&&(r.zmin=i.zmin,r.zmax=i.zmax),l&&(r.mmin=i.mmin,r.mmax=i.mmax)),r}(e,{},r,!1,!1):null:null}function f(e,r,i,o,l){return(0,x.pC)(i)&&(r.points=function q(e,r,i,o){return M(e,i?o?z:A:o?A:Y,r)}(e,i.points,o,l)),r}function u(e,r,i,o,l){return(0,x.Wi)(i)||(r.x=O(e,i.x),r.y=E(e,i.y),r!==i&&(o&&(r.z=i.z),l&&(r.m=i.m))),r}function h(e,r,i,o,l){return(0,x.pC)(i)&&(r.rings=function lt(e,r,i,o){return U(e,i?o?z:A:o?A:Y,r)}(e,i.rings,o,l)),r}function S(e,r,i,o,l){return(0,x.pC)(i)&&(r.paths=function tt(e,r,i,o){return U(e,i?o?z:A:o?A:Y,r)}(e,i.paths,o,l)),r}},20877:(ht,V,R)=>{var x,p,L,Y,A,z,Q,$,H,y,j,rt,T,it,ot,O,E,M,U,J,q,tt,lt,nt,Z,ct,ft,st,at,ut,et,w,a,c,v,f,u,h,S,e,r,i,o,l,s,m,g,d,P,b,C,k,I,F,N,W,G,K,_,B,D,t;R.d(V,{$y:()=>tt,AH:()=>p,CS:()=>g,DD:()=>$,Dd:()=>at,Em:()=>q,JS:()=>s,Ky:()=>H,Lh:()=>d,Qb:()=>G,RL:()=>x,RS:()=>_,TF:()=>J,Tx:()=>A,UR:()=>E,UX:()=>W,bj:()=>m,eZ:()=>Q,id:()=>Z,kP:()=>f,of:()=>j,r4:()=>e,sj:()=>u,v2:()=>L,zQ:()=>st,zV:()=>O}),(t=x||(x={}))[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN",function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(p||(p={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(L||(L={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(Y||(Y={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(A||(A={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(z||(z={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(Q||(Q={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}($||($={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(H||(H={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(y||(y={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(j||(j={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(rt||(rt={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(T||(T={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(it||(it={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(ot||(ot={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(O||(O={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(E||(E={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(M||(M={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(U||(U={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(J||(J={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees"}(q||(q={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(tt||(tt={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(lt||(lt={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(nt||(nt={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(Z||(Z={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(ct||(ct={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(ft||(ft={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(st||(st={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(at||(at={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(ut||(ut={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(et||(et={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(w||(w={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AloneLine=1]="AloneLine"}(a||(a={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(c||(c={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(v||(v={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(f||(f={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(u||(u={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(h||(h={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(S||(S={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(e||(e={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(r||(r={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(i||(i={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(o||(o={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(l||(l={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(s||(s={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(m||(m={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(g||(g={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(d||(d={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(P||(P={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(b||(b={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(C||(C={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(k||(k={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(I||(I={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(F||(F={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(N||(N={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(W||(W={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(G||(G={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(K||(K={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(_||(_={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(B||(B={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(D||(D={}))},73674:(ht,V,R)=>{R.r(V),R.d(V,{previewCIMSymbol:()=>ut});var O,w,x=R(71670),p=R(55798),L=R(77213),Y=R(25764),A=R(1897),z=R(53661),Q=R(30801),$=R(61850),H=R(70560),y=R(14862),j=R(68757),rt=R(42353),T=R(2047),it=R(23638),ot=R(87804);(w=O||(O={})).Legend="legend",w.Preview="preview";const E=w=>w&&w.scaleFactor?w.scaleFactor:1;var tt=R(10532),lt=R(31319);const nt=new class U{constructor(a,c){this._spatialReference=a,this._avoidSDF=c,this._resourceCache=new Map,this._imageDataCanvas=null,this._pictureMarkerCache=new Map,this._textRasterizer=new rt.Z,this._cimResourceManager=new H.Z,this._rasterizer=new j.Z(this._cimResourceManager)}get resourceManager(){return this._cimResourceManager}rasterizeCIMSymbolAsync(a,c,v,f,u,h,S,e){var r=this;return(0,x.Z)(function*(){if(!a)return null;const{data:i}=a;if(!i||"CIMSymbolReference"!==i.type||!i.symbol)return null;const{symbol:o}=i;h||(h=(0,T.JW)(o));const l=yield L.E0.resolveSymbolOverrides(i,c,r._spatialReference,u,h,S,e);r._imageDataCanvas||(r._imageDataCanvas=document.createElement("canvas"));const s=r._imageDataCanvas,m=r._cimResourceManager,g=[];L.B$.fetchResources(l,m,g),g.length>0&&(yield Promise.all(g));const{width:d,height:P}=v,b=function J(w,a,c,v){const u=-a/2+1,h=a/2-1,S=c/2-1,e=-c/2+1;switch(w){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[u,0],[0,0],[h,0]]]};default:return"legend"===v?{rings:[[[u,S],[h,0],[h,e],[u,e],[u,S]]]}:{rings:[[[u,S],[h,S],[h,e],[u,e],[u,S]]]}}}(h,d,P,f),C=L.B$.getEnvelope(l,b,m);if(!C)return null;const k=1.3333333333333333*(window.devicePixelRatio||1);let I=1,F=0,N=0;switch(o.type){case"CIMPointSymbol":case"CIMTextSymbol":{let _=1;C.width>d&&(_=d/C.width);let B=1;C.height>P&&(B=P/C.height),"preview"===f&&(C.width<d&&(_=d/C.width),C.height<P&&(B=P/C.height)),I=Math.min(_,B),F=C.x+C.width/2,N=C.y+C.height/2}break;case"CIMLineSymbol":{let _=1;C.height>P&&(_=P/C.height),I=_,N=C.y+C.height/2;const B=C.x*I+d/2,D=(C.x+C.width)*I+d/2;if(B<0){const{paths:t}=b;t[0][0][0]-=B}if(D>d){const{paths:t}=b;t[0][2][0]-=D-d}}break;case"CIMPolygonSymbol":{F=C.x+C.width/2,N=C.y+C.height/2;const _=C.x*I+d/2,B=(C.x+C.width)*I+d/2,D=C.y*I+P/2,t=(C.y+C.height)*I+P/2,{rings:X}=b;_<0&&(X[0][0][0]-=_,X[0][3][0]-=_,X[0][4][0]-=_),D<0&&(X[0][0][1]+=D,X[0][1][1]+=D,X[0][4][1]+=D),B>d&&(X[0][1][0]-=B-d,X[0][2][0]-=B-d),t>P&&(X[0][2][1]+=t-P,X[0][3][1]+=t-P)}}s.width=d*k,s.height=P*k,s.width+=2,s.height+=2;const G=s.getContext("2d"),K=y.zA.createIdentity();return K.translate(-F,-N),K.scale(I*k,-I*k),K.translate(d*k/2+1,P*k/2+1),G.clearRect(0,0,s.width,s.height),new y.cD(G,m,K,!0).drawSymbol(l,b),G.getImageData(0,0,s.width,s.height)})()}analyzeCIMSymbol(a,c,v,f,u){var h=this;return(0,x.Z)(function*(){const S=[],e=c?{geometryType:f,spatialReference:h._spatialReference,fields:c}:null;let r;yield(0,$.c)(a.data,e,h._cimResourceManager,S,h._avoidSDF),(0,Q.k_)(u);for(const i of S)"CIMPictureMarker"!==i.cim.type&&"CIMPictureFill"!==i.cim.type&&"CIMPictureStroke"!==i.cim.type||(r||(r=[]),r.push(h._fetchPictureMarkerResource(i,u))),v&&"text"===i.type&&"string"==typeof i.text&&i.text.includes("[")&&(i.text=(0,T.Qs)(v,i.text,i.cim.textCase));return r&&(yield Promise.all(r)),S})()}rasterizeCIMSymbol3D(a,c,v,f,u,h){const S=[];for(const e of a){f&&"function"==typeof f.scaleFactor&&(f.scaleFactor=f.scaleFactor(c,u,h));const r=this._getRasterizedResource(e,c,v,f,u,h);if(!r)continue;let i=0,o=r.anchorX||0,l=r.anchorY||0,s=!1,m=0,g=0;if("esriGeometryPoint"===v){const d=E(f);if(m=(0,T.hf)(e.offsetX,c,u,h)*d||0,g=(0,T.hf)(e.offsetY,c,u,h)*d||0,"marker"===e.type)i=(0,T.hf)(e.rotation,c,u,h)||0,s=!!e.rotateClockwise&&e.rotateClockwise;else if("text"===e.type){if(i=(0,T.hf)(e.angle,c,u,h)||0,void 0!==e.horizontalAlignment)switch(e.horizontalAlignment){case"left":o=-.5;break;case"right":o=.5;break;default:o=0}if(void 0!==e.verticalAlignment)switch(e.verticalAlignment){case"top":l=.5;break;case"bottom":l=-.5;break;case"baseline":l=-.25;break;default:l=0}}}null!=r&&S.push({angle:i,rotateClockWise:s,anchorX:o,anchorY:l,offsetX:m,offsetY:g,rasterizedResource:r})}return this.getSymbolImage(S)}getSymbolImage(a){const c=document.createElement("canvas"),v=(0,z.s3)(c.getContext("2d"));let f=0,u=0,h=0,S=0;const e=[];for(let l=0;l<a.length;l++){const s=a[l],m=s.rasterizedResource;if(!m)continue;const g=m.size,d=s.offsetX,P=s.offsetY,b=s.anchorX,C=s.anchorY,k=s.rotateClockWise||!1;let I=s.angle,F=(0,p.F2)(d)-g[0]*(.5+b),N=(0,p.F2)(P)-g[1]*(.5+C),W=F+g[0],G=N+g[1];if(I){k&&(I=-I);const B=Math.sin(I*Math.PI/180),D=Math.cos(I*Math.PI/180),t=F*D-N*B,X=F*B+N*D,mt=F*D-G*B,gt=F*B+G*D,dt=W*D-G*B,pt=W*B+G*D,Ct=W*D-N*B,yt=W*B+N*D;F=Math.min(t,mt,dt,Ct),N=Math.min(X,gt,pt,yt),W=Math.max(t,mt,dt,Ct),G=Math.max(X,gt,pt,yt)}f=F<f?F:f,u=N<u?N:u,h=W>h?W:h,S=G>S?G:S;const K=v.createImageData(m.size[0],m.size[1]);K.data.set(new Uint8ClampedArray(m.image.buffer)),e.push({offsetX:d,offsetY:P,rotateClockwise:k,angle:I,rasterizedImage:K,anchorX:b,anchorY:C})}c.width=h-f,c.height=S-u;const r=-f,i=S;for(let l=0;l<e.length;l++){const s=e[l],m=this._imageDataToCanvas(s.rasterizedImage),P=r-s.rasterizedImage.width*(.5+s.anchorX),b=i-s.rasterizedImage.height*(.5-s.anchorY);if(s.angle){const C=(360-s.angle)*Math.PI/180;v.save(),v.translate((0,p.F2)(s.offsetX),-(0,p.F2)(s.offsetY)),v.translate(r,i),v.rotate(C),v.translate(-r,-i),v.drawImage(m,P,b),v.restore()}else v.drawImage(m,P+(0,p.F2)(s.offsetX),b-(0,p.F2)(s.offsetY))}const o=new ot.e({x:r/c.width-.5,y:i/c.height-.5});return{imageData:0!==c.width&&0!==c.height?v.getImageData(0,0,c.width,c.height):v.createImageData(1,1),anchorPosition:o}}_fetchPictureMarkerResource(a,c){var v=this;return(0,x.Z)(function*(){const f=a.materialHash;if(!v._pictureMarkerCache.get(f)){const u=(yield(0,A.default)(a.cim.url,{responseType:"image",signal:c&&c.signal})).data;v._pictureMarkerCache.set(f,u)}})()}_imageDataToCanvas(a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const c=this._imageDataCanvas,v=(0,z.s3)(c.getContext("2d"));return c.width=a.width,c.height=a.height,v.putImageData(a,0,0),c}_imageTo32Array(a,c,v,f){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const u=this._imageDataCanvas,h=(0,z.s3)(u.getContext("2d"));if(u.width=c,u.height=v,h.drawImage(a,0,0,c,v),f){h.save();const S=new Y.Z(f);h.fillStyle=S.toHex(),h.globalCompositeOperation="multiply",h.fillRect(0,0,c,v),h.globalCompositeOperation="destination-atop",h.drawImage(a,0,0,c,v),h.restore()}return new Uint32Array(h.getImageData(0,0,c,v).data.buffer)}_getRasterizedResource(a,c,v,f,u,h){let S,e,r;if("text"===a.type)return this._rasterizeTextResource(a,c,f,u,h);({analyzedCIM:S,hash:e}=function q(w,a,c,v){let f,u;return"function"==typeof w.materialHash?(f=(0,w.materialHash)(a,c,v),u=(0,$.S)(w.cim,w.materialOverrides)):(f=w.materialHash,u=w.cim),{analyzedCIM:u,hash:f}}(a,c,u,h));const l=E(f);if("CIMPictureMarker"===a.cim.type){const g=(0,T.hf)(a.size,c,u,h)*l,{image:d,width:P,height:b}=(0,z.s3)(this._getPictureResource(a,g,(0,T.hf)(a.color,c,u,h)));return r={image:d,size:[P,b],sdf:!1,simplePattern:!1,anchorX:a.anchorPoint?a.anchorPoint.x:0,anchorY:a.anchorPoint?a.anchorPoint.y:0},r}(0,it.FW)(S,l,{preserveOutlineWidth:!1});const s=S;e+=v,f&&(e+=JSON.stringify(f));const m=this._resourceCache;return m.has(e)?m.get(e):(r=this._rasterizer.rasterizeJSONResource({cim:s,type:a.type,url:a.url,mosaicHash:e,size:null,path:null},window.devicePixelRatio||1,this._avoidSDF),m.set(e,r),r)}_rasterizeTextResource(a,c,v,f,u){const h=E(v),S=(0,T.hf)(a.text,c,f,u);if(!S||0===S.length)return null;const e=(0,T.hf)(a.fontName,c,f,u),r=(0,T.hf)(a.style,c,f,u),i=(0,T.hf)(a.weight,c,f,u),o=(0,T.hf)(a.decoration,c,f,u),l=(0,T.hf)(a.size,c,f,u)*h,s=(0,T.hf)(a.horizontalAlignment,c,f,u),m=(0,T.hf)(a.verticalAlignment,c,f,u),g=(0,T.nn)((0,T.hf)(a.color,c,f,u)),d=(0,T.nn)((0,T.hf)(a.outlineColor,c,f,u)),P={color:g,size:l,horizontalAlignment:s,verticalAlignment:m,font:{family:e,style:r,weight:i,decoration:o},halo:{size:(0,T.hf)(a.outlineSize,c,f,u)||0,color:d,style:r},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(S,P)}_getPictureResource(a,c,v){const f=this._pictureMarkerCache.get(a.materialHash);if(!f)return null;const u=f.height/f.width,h=c?u>1?(0,p.F2)(c):(0,p.F2)(c)/u:f.width,S=c?u>1?(0,p.F2)(c)*u:(0,p.F2)(c):f.height;return{image:this._imageTo32Array(f,h,S,v),width:h,height:S}}}(null,!0),Z=(0,p.Wz)(tt.b_.size),ct=(0,p.Wz)(tt.b_.maxSize),ft=(0,p.Wz)(tt.b_.lineWidth),st=1;function ut(w){return et.apply(this,arguments)}function et(){return et=(0,x.Z)(function*(w,a={}){const{node:c,opacity:v,symbolConfig:f}=a,u="object"==typeof f&&"isSquareFill"in f&&f.isSquareFill,h=a.cimOptions||a,S=h.geometryType||(0,T.JW)(w?.data?.symbol),e=function at(w){const a=w?.size;return"number"==typeof a?{width:a,height:a}:{width:null!=a&&"object"==typeof a&&"width"in a?a.width:null,height:null!=a&&"object"==typeof a&&"height"in a?a.height:null}}(a),{feature:r,fieldMap:i}=h;if(null==e.width||null==e.height){const C=yield L.E0.resolveSymbolOverrides(w.data,r,null,i,S);if(!C)return null;(w=w.clone()).data={type:"CIMSymbolReference",symbol:C},w.data.primitiveOverrides=void 0;const k=[];L.B$.fetchResources(C,nt.resourceManager,k),k.length>0&&(yield Promise.all(k));const I=L.B$.getEnvelope(C,null,nt.resourceManager),F=I?.width,N=I?.height;e.width="esriGeometryPolygon"===S?Z:"esriGeometryPolyline"===S?ft:null!=F&&isFinite(F)?Math.min(F,ct):Z,e.height="esriGeometryPolygon"===S?Z:null!=N&&isFinite(N)?Math.max(Math.min(N,ct),st):Z}const o=yield nt.rasterizeCIMSymbolAsync(w,r,e,u||"esriGeometryPolygon"!==S?O.Preview:O.Legend,i,S);if(!o)return null;const{width:l,height:s}=o,m=document.createElement("canvas");m.width=l,m.height=s,m.getContext("2d").putImageData(o,0,0);const g=(0,p.F2)(e.width),d=(0,p.F2)(e.height),P=new Image(g,d);P.src=m.toDataURL(),null!=v&&(P.style.opacity=`${v}`);let b=P;return null!=a.effectView&&(b=(0,lt.wh)([[{shape:{type:"image",x:0,y:0,width:g,height:d,src:P.src},fill:null,stroke:null,offset:[0,0]}]],[g,d],{effectView:a.effectView})),c&&b&&c.appendChild(b),b}),et.apply(this,arguments)}},81925:(ht,V,R)=>{var x,p,y;function L(y){switch(y){case"left":return x.Left;case"right":return x.Right;case"center":return x.Center}}function Y(y){switch(y){case"top":return p.Top;case"middle":return p.Center;case"baseline":return p.Baseline;case"bottom":return p.Bottom}}function A(y){switch(y){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[x.Right,p.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[x.Center,p.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[x.Left,p.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[x.Right,p.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[x.Center,p.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[x.Left,p.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[x.Right,p.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[x.Center,p.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[x.Left,p.Top];default:return console.debug(`Found invalid placement type ${y}`),[x.Center,p.Center]}}function z(y){switch(y){case x.Right:return-1;case x.Center:return 0;case x.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${y}`),0}}function Q(y){switch(y){case p.Top:return 1;case p.Center:return 0;case p.Bottom:case p.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${y}`),0}}function $(y){switch(y){case"left":return x.Left;case"right":return x.Right;case"center":return x.Center}}function H(y){switch(y){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}R.d(V,{Hd:()=>$,M7:()=>x,NS:()=>H,TR:()=>p,b7:()=>Y,g:()=>z,kH:()=>L,qv:()=>A,tf:()=>Q}),(y=x||(x={}))[y.Left=-1]="Left",y[y.Center=0]="Center",y[y.Right=1]="Right",function(y){y[y.Top=1]="Top",y[y.Center=0]="Center",y[y.Bottom=-1]="Bottom",y[y.Baseline=2]="Baseline"}(p||(p={}))},80696:(ht,V,R)=>{R.d(V,{$0:()=>j,AI:()=>L,Al:()=>ct,By:()=>w,C1:()=>t,CQ:()=>mt,CU:()=>I,D3:()=>Z,Ex:()=>q,I_:()=>z,Ic:()=>ft,Ij:()=>ut,Ip:()=>K,Iv:()=>Ct,Iw:()=>tt,Jw:()=>f,MI:()=>D,QU:()=>v,SD:()=>vt,Tz:()=>gt,Uh:()=>X,V4:()=>k,XD:()=>wt,XJ:()=>G,Xj:()=>c,Zd:()=>g,_5:()=>S,_6:()=>yt,a:()=>F,aK:()=>i,dn:()=>C,e0:()=>pt,eF:()=>lt,eV:()=>rt,f2:()=>et,fL:()=>W,iJ:()=>st,iV:()=>d,jk:()=>Pt,kF:()=>u,lK:()=>l,m4:()=>s,mx:()=>a,nM:()=>at,nb:()=>Mt,oK:()=>dt,pU:()=>r,ru:()=>A,tQ:()=>b,u4:()=>xt,uG:()=>m,vw:()=>St,xl:()=>e,xm:()=>T,yP:()=>h});const L=1e-30,A=4294967295,z=512,j=8,rt=10,T=29,q=24,tt=8,lt={metrics:{width:15,height:17,left:0,top:-7,advance:14}},Z=0,ct=0,ft=0,st=1,at=2,ut=3,et=4,w=5,a=6,c=12,v=5,f=6,u=5,h=6,S=0,e=1,r=2,i=3,l=4,s=2,m=1,g=2,d=4,b=1.05,C=3,k=5,I=6,F=1.15,W=2,G=8,K=500,D=10,t=1024,X=2,mt=0,gt=1,dt=4,pt=8,Ct=16,yt=4,vt=1,Pt=4,St=8,xt=128,Mt=4,wt=2},72375:(ht,V,R)=>{R.d(V,{Au:()=>rt,Jz:()=>ot,UJ:()=>it});const x=new Float32Array(1);function rt(M){return[255&M,(65280&M)>>>8,(16711680&M)>>>16,(4278190080&M)>>>24]}function it(M,U){return 65535&M|U<<16}function ot(M,U,J,q){return 255&M|(255&U)<<8|(255&J)<<16|q<<24}new Uint32Array(x.buffer)}}]);
//# sourceMappingURL=7232.5e0be8aca600e08a.js.map