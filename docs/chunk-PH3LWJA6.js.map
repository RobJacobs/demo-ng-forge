{"version":3,"sources":["node_modules/dexie/dist/modern/dexie.mjs","src/app/storage/indexed-db-storage.ts","src/app/storage/storage.component.ts","src/app/storage/storage.component.html"],"sourcesContent":["/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version 3.2.7, Wed Mar 20 2024\n *\n * https://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n\nconst _global = typeof globalThis !== 'undefined' ? globalThis : typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : global;\nconst keys = Object.keys;\nconst isArray = Array.isArray;\nif (typeof Promise !== 'undefined' && !_global.Promise) {\n  _global.Promise = Promise;\n}\nfunction extend(obj, extension) {\n  if (typeof extension !== 'object') return obj;\n  keys(extension).forEach(function (key) {\n    obj[key] = extension[key];\n  });\n  return obj;\n}\nconst getProto = Object.getPrototypeOf;\nconst _hasOwn = {}.hasOwnProperty;\nfunction hasOwn(obj, prop) {\n  return _hasOwn.call(obj, prop);\n}\nfunction props(proto, extension) {\n  if (typeof extension === 'function') extension = extension(getProto(proto));\n  (typeof Reflect === \"undefined\" ? keys : Reflect.ownKeys)(extension).forEach(key => {\n    setProp(proto, key, extension[key]);\n  });\n}\nconst defineProperty = Object.defineProperty;\nfunction setProp(obj, prop, functionOrGetSet, options) {\n  defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ? {\n    get: functionOrGetSet.get,\n    set: functionOrGetSet.set,\n    configurable: true\n  } : {\n    value: functionOrGetSet,\n    configurable: true,\n    writable: true\n  }, options));\n}\nfunction derive(Child) {\n  return {\n    from: function (Parent) {\n      Child.prototype = Object.create(Parent.prototype);\n      setProp(Child.prototype, \"constructor\", Child);\n      return {\n        extend: props.bind(null, Child.prototype)\n      };\n    }\n  };\n}\nconst getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nfunction getPropertyDescriptor(obj, prop) {\n  const pd = getOwnPropertyDescriptor(obj, prop);\n  let proto;\n  return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n}\nconst _slice = [].slice;\nfunction slice(args, start, end) {\n  return _slice.call(args, start, end);\n}\nfunction override(origFunc, overridedFactory) {\n  return overridedFactory(origFunc);\n}\nfunction assert(b) {\n  if (!b) throw new Error(\"Assertion Failed\");\n}\nfunction asap$1(fn) {\n  if (_global.setImmediate) setImmediate(fn);else setTimeout(fn, 0);\n}\nfunction arrayToObject(array, extractor) {\n  return array.reduce((result, item, i) => {\n    var nameAndValue = extractor(item, i);\n    if (nameAndValue) result[nameAndValue[0]] = nameAndValue[1];\n    return result;\n  }, {});\n}\nfunction tryCatch(fn, onerror, args) {\n  try {\n    fn.apply(null, args);\n  } catch (ex) {\n    onerror && onerror(ex);\n  }\n}\nfunction getByKeyPath(obj, keyPath) {\n  if (typeof keyPath === 'string' && hasOwn(obj, keyPath)) return obj[keyPath];\n  if (!keyPath) return obj;\n  if (typeof keyPath !== 'string') {\n    var rv = [];\n    for (var i = 0, l = keyPath.length; i < l; ++i) {\n      var val = getByKeyPath(obj, keyPath[i]);\n      rv.push(val);\n    }\n    return rv;\n  }\n  var period = keyPath.indexOf('.');\n  if (period !== -1) {\n    var innerObj = obj[keyPath.substr(0, period)];\n    return innerObj == null ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n  }\n  return undefined;\n}\nfunction setByKeyPath(obj, keyPath, value) {\n  if (!obj || keyPath === undefined) return;\n  if ('isFrozen' in Object && Object.isFrozen(obj)) return;\n  if (typeof keyPath !== 'string' && 'length' in keyPath) {\n    assert(typeof value !== 'string' && 'length' in value);\n    for (var i = 0, l = keyPath.length; i < l; ++i) {\n      setByKeyPath(obj, keyPath[i], value[i]);\n    }\n  } else {\n    var period = keyPath.indexOf('.');\n    if (period !== -1) {\n      var currentKeyPath = keyPath.substr(0, period);\n      var remainingKeyPath = keyPath.substr(period + 1);\n      if (remainingKeyPath === \"\") {\n        if (value === undefined) {\n          if (isArray(obj) && !isNaN(parseInt(currentKeyPath))) obj.splice(currentKeyPath, 1);else delete obj[currentKeyPath];\n        } else obj[currentKeyPath] = value;\n      } else {\n        var innerObj = obj[currentKeyPath];\n        if (!innerObj || !hasOwn(obj, currentKeyPath)) innerObj = obj[currentKeyPath] = {};\n        setByKeyPath(innerObj, remainingKeyPath, value);\n      }\n    } else {\n      if (value === undefined) {\n        if (isArray(obj) && !isNaN(parseInt(keyPath))) obj.splice(keyPath, 1);else delete obj[keyPath];\n      } else obj[keyPath] = value;\n    }\n  }\n}\nfunction delByKeyPath(obj, keyPath) {\n  if (typeof keyPath === 'string') setByKeyPath(obj, keyPath, undefined);else if ('length' in keyPath) [].map.call(keyPath, function (kp) {\n    setByKeyPath(obj, kp, undefined);\n  });\n}\nfunction shallowClone(obj) {\n  var rv = {};\n  for (var m in obj) {\n    if (hasOwn(obj, m)) rv[m] = obj[m];\n  }\n  return rv;\n}\nconst concat = [].concat;\nfunction flatten(a) {\n  return concat.apply([], a);\n}\nconst intrinsicTypeNames = \"BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey\".split(',').concat(flatten([8, 16, 32, 64].map(num => [\"Int\", \"Uint\", \"Float\"].map(t => t + num + \"Array\")))).filter(t => _global[t]);\nconst intrinsicTypes = intrinsicTypeNames.map(t => _global[t]);\narrayToObject(intrinsicTypeNames, x => [x, true]);\nlet circularRefs = null;\nfunction deepClone(any) {\n  circularRefs = typeof WeakMap !== 'undefined' && new WeakMap();\n  const rv = innerDeepClone(any);\n  circularRefs = null;\n  return rv;\n}\nfunction innerDeepClone(any) {\n  if (!any || typeof any !== 'object') return any;\n  let rv = circularRefs && circularRefs.get(any);\n  if (rv) return rv;\n  if (isArray(any)) {\n    rv = [];\n    circularRefs && circularRefs.set(any, rv);\n    for (var i = 0, l = any.length; i < l; ++i) {\n      rv.push(innerDeepClone(any[i]));\n    }\n  } else if (intrinsicTypes.indexOf(any.constructor) >= 0) {\n    rv = any;\n  } else {\n    const proto = getProto(any);\n    rv = proto === Object.prototype ? {} : Object.create(proto);\n    circularRefs && circularRefs.set(any, rv);\n    for (var prop in any) {\n      if (hasOwn(any, prop)) {\n        rv[prop] = innerDeepClone(any[prop]);\n      }\n    }\n  }\n  return rv;\n}\nconst {\n  toString\n} = {};\nfunction toStringTag(o) {\n  return toString.call(o).slice(8, -1);\n}\nconst iteratorSymbol = typeof Symbol !== 'undefined' ? Symbol.iterator : '@@iterator';\nconst getIteratorOf = typeof iteratorSymbol === \"symbol\" ? function (x) {\n  var i;\n  return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n} : function () {\n  return null;\n};\nconst NO_CHAR_ARRAY = {};\nfunction getArrayOf(arrayLike) {\n  var i, a, x, it;\n  if (arguments.length === 1) {\n    if (isArray(arrayLike)) return arrayLike.slice();\n    if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string') return [arrayLike];\n    if (it = getIteratorOf(arrayLike)) {\n      a = [];\n      while (x = it.next(), !x.done) a.push(x.value);\n      return a;\n    }\n    if (arrayLike == null) return [arrayLike];\n    i = arrayLike.length;\n    if (typeof i === 'number') {\n      a = new Array(i);\n      while (i--) a[i] = arrayLike[i];\n      return a;\n    }\n    return [arrayLike];\n  }\n  i = arguments.length;\n  a = new Array(i);\n  while (i--) a[i] = arguments[i];\n  return a;\n}\nconst isAsyncFunction = typeof Symbol !== 'undefined' ? fn => fn[Symbol.toStringTag] === 'AsyncFunction' : () => false;\nvar debug = typeof location !== 'undefined' && /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\nfunction setDebug(value, filter) {\n  debug = value;\n  libraryFilter = filter;\n}\nvar libraryFilter = () => true;\nconst NEEDS_THROW_FOR_STACK = !new Error(\"\").stack;\nfunction getErrorWithStack() {\n  if (NEEDS_THROW_FOR_STACK) try {\n    getErrorWithStack.arguments;\n    throw new Error();\n  } catch (e) {\n    return e;\n  }\n  return new Error();\n}\nfunction prettyStack(exception, numIgnoredFrames) {\n  var stack = exception.stack;\n  if (!stack) return \"\";\n  numIgnoredFrames = numIgnoredFrames || 0;\n  if (stack.indexOf(exception.name) === 0) numIgnoredFrames += (exception.name + exception.message).split('\\n').length;\n  return stack.split('\\n').slice(numIgnoredFrames).filter(libraryFilter).map(frame => \"\\n\" + frame).join('');\n}\nvar dexieErrorNames = ['Modify', 'Bulk', 'OpenFailed', 'VersionChange', 'Schema', 'Upgrade', 'InvalidTable', 'MissingAPI', 'NoSuchDatabase', 'InvalidArgument', 'SubTransaction', 'Unsupported', 'Internal', 'DatabaseClosed', 'PrematureCommit', 'ForeignAwait'];\nvar idbDomErrorNames = ['Unknown', 'Constraint', 'Data', 'TransactionInactive', 'ReadOnly', 'Version', 'NotFound', 'InvalidState', 'InvalidAccess', 'Abort', 'Timeout', 'QuotaExceeded', 'Syntax', 'DataClone'];\nvar errorList = dexieErrorNames.concat(idbDomErrorNames);\nvar defaultTexts = {\n  VersionChanged: \"Database version changed by other database connection\",\n  DatabaseClosed: \"Database has been closed\",\n  Abort: \"Transaction aborted\",\n  TransactionInactive: \"Transaction has already completed or failed\",\n  MissingAPI: \"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb\"\n};\nfunction DexieError(name, msg) {\n  this._e = getErrorWithStack();\n  this.name = name;\n  this.message = msg;\n}\nderive(DexieError).from(Error).extend({\n  stack: {\n    get: function () {\n      return this._stack || (this._stack = this.name + \": \" + this.message + prettyStack(this._e, 2));\n    }\n  },\n  toString: function () {\n    return this.name + \": \" + this.message;\n  }\n});\nfunction getMultiErrorMessage(msg, failures) {\n  return msg + \". Errors: \" + Object.keys(failures).map(key => failures[key].toString()).filter((v, i, s) => s.indexOf(v) === i).join('\\n');\n}\nfunction ModifyError(msg, failures, successCount, failedKeys) {\n  this._e = getErrorWithStack();\n  this.failures = failures;\n  this.failedKeys = failedKeys;\n  this.successCount = successCount;\n  this.message = getMultiErrorMessage(msg, failures);\n}\nderive(ModifyError).from(DexieError);\nfunction BulkError(msg, failures) {\n  this._e = getErrorWithStack();\n  this.name = \"BulkError\";\n  this.failures = Object.keys(failures).map(pos => failures[pos]);\n  this.failuresByPos = failures;\n  this.message = getMultiErrorMessage(msg, failures);\n}\nderive(BulkError).from(DexieError);\nvar errnames = errorList.reduce((obj, name) => (obj[name] = name + \"Error\", obj), {});\nconst BaseException = DexieError;\nvar exceptions = errorList.reduce((obj, name) => {\n  var fullName = name + \"Error\";\n  function DexieError(msgOrInner, inner) {\n    this._e = getErrorWithStack();\n    this.name = fullName;\n    if (!msgOrInner) {\n      this.message = defaultTexts[name] || fullName;\n      this.inner = null;\n    } else if (typeof msgOrInner === 'string') {\n      this.message = `${msgOrInner}${!inner ? '' : '\\n ' + inner}`;\n      this.inner = inner || null;\n    } else if (typeof msgOrInner === 'object') {\n      this.message = `${msgOrInner.name} ${msgOrInner.message}`;\n      this.inner = msgOrInner;\n    }\n  }\n  derive(DexieError).from(BaseException);\n  obj[name] = DexieError;\n  return obj;\n}, {});\nexceptions.Syntax = SyntaxError;\nexceptions.Type = TypeError;\nexceptions.Range = RangeError;\nvar exceptionMap = idbDomErrorNames.reduce((obj, name) => {\n  obj[name + \"Error\"] = exceptions[name];\n  return obj;\n}, {});\nfunction mapError(domError, message) {\n  if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name]) return domError;\n  var rv = new exceptionMap[domError.name](message || domError.message, domError);\n  if (\"stack\" in domError) {\n    setProp(rv, \"stack\", {\n      get: function () {\n        return this.inner.stack;\n      }\n    });\n  }\n  return rv;\n}\nvar fullNameExceptions = errorList.reduce((obj, name) => {\n  if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1) obj[name + \"Error\"] = exceptions[name];\n  return obj;\n}, {});\nfullNameExceptions.ModifyError = ModifyError;\nfullNameExceptions.DexieError = DexieError;\nfullNameExceptions.BulkError = BulkError;\nfunction nop() {}\nfunction mirror(val) {\n  return val;\n}\nfunction pureFunctionChain(f1, f2) {\n  if (f1 == null || f1 === mirror) return f2;\n  return function (val) {\n    return f2(f1(val));\n  };\n}\nfunction callBoth(on1, on2) {\n  return function () {\n    on1.apply(this, arguments);\n    on2.apply(this, arguments);\n  };\n}\nfunction hookCreatingChain(f1, f2) {\n  if (f1 === nop) return f2;\n  return function () {\n    var res = f1.apply(this, arguments);\n    if (res !== undefined) arguments[0] = res;\n    var onsuccess = this.onsuccess,\n      onerror = this.onerror;\n    this.onsuccess = null;\n    this.onerror = null;\n    var res2 = f2.apply(this, arguments);\n    if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n    if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    return res2 !== undefined ? res2 : res;\n  };\n}\nfunction hookDeletingChain(f1, f2) {\n  if (f1 === nop) return f2;\n  return function () {\n    f1.apply(this, arguments);\n    var onsuccess = this.onsuccess,\n      onerror = this.onerror;\n    this.onsuccess = this.onerror = null;\n    f2.apply(this, arguments);\n    if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n    if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n  };\n}\nfunction hookUpdatingChain(f1, f2) {\n  if (f1 === nop) return f2;\n  return function (modifications) {\n    var res = f1.apply(this, arguments);\n    extend(modifications, res);\n    var onsuccess = this.onsuccess,\n      onerror = this.onerror;\n    this.onsuccess = null;\n    this.onerror = null;\n    var res2 = f2.apply(this, arguments);\n    if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n    if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    return res === undefined ? res2 === undefined ? undefined : res2 : extend(res, res2);\n  };\n}\nfunction reverseStoppableEventChain(f1, f2) {\n  if (f1 === nop) return f2;\n  return function () {\n    if (f2.apply(this, arguments) === false) return false;\n    return f1.apply(this, arguments);\n  };\n}\nfunction promisableChain(f1, f2) {\n  if (f1 === nop) return f2;\n  return function () {\n    var res = f1.apply(this, arguments);\n    if (res && typeof res.then === 'function') {\n      var thiz = this,\n        i = arguments.length,\n        args = new Array(i);\n      while (i--) args[i] = arguments[i];\n      return res.then(function () {\n        return f2.apply(thiz, args);\n      });\n    }\n    return f2.apply(this, arguments);\n  };\n}\nvar INTERNAL = {};\nconst LONG_STACKS_CLIP_LIMIT = 100,\n  MAX_LONG_STACKS = 20,\n  ZONE_ECHO_LIMIT = 100,\n  [resolvedNativePromise, nativePromiseProto, resolvedGlobalPromise] = typeof Promise === 'undefined' ? [] : (() => {\n    let globalP = Promise.resolve();\n    if (typeof crypto === 'undefined' || !crypto.subtle) return [globalP, getProto(globalP), globalP];\n    const nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n    return [nativeP, getProto(nativeP), globalP];\n  })(),\n  nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\nconst NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\nconst patchGlobalPromise = !!resolvedGlobalPromise;\nvar stack_being_generated = false;\nvar schedulePhysicalTick = resolvedGlobalPromise ? () => {\n  resolvedGlobalPromise.then(physicalTick);\n} : _global.setImmediate ? setImmediate.bind(null, physicalTick) : _global.MutationObserver ? () => {\n  var hiddenDiv = document.createElement(\"div\");\n  new MutationObserver(() => {\n    physicalTick();\n    hiddenDiv = null;\n  }).observe(hiddenDiv, {\n    attributes: true\n  });\n  hiddenDiv.setAttribute('i', '1');\n} : () => {\n  setTimeout(physicalTick, 0);\n};\nvar asap = function (callback, args) {\n  microtickQueue.push([callback, args]);\n  if (needsNewPhysicalTick) {\n    schedulePhysicalTick();\n    needsNewPhysicalTick = false;\n  }\n};\nvar isOutsideMicroTick = true,\n  needsNewPhysicalTick = true,\n  unhandledErrors = [],\n  rejectingErrors = [],\n  currentFulfiller = null,\n  rejectionMapper = mirror;\nvar globalPSD = {\n  id: 'global',\n  global: true,\n  ref: 0,\n  unhandleds: [],\n  onunhandled: globalError,\n  pgp: false,\n  env: {},\n  finalize: function () {\n    this.unhandleds.forEach(uh => {\n      try {\n        globalError(uh[0], uh[1]);\n      } catch (e) {}\n    });\n  }\n};\nvar PSD = globalPSD;\nvar microtickQueue = [];\nvar numScheduledCalls = 0;\nvar tickFinalizers = [];\nfunction DexiePromise(fn) {\n  if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n  this._listeners = [];\n  this.onuncatched = nop;\n  this._lib = false;\n  var psd = this._PSD = PSD;\n  if (debug) {\n    this._stackHolder = getErrorWithStack();\n    this._prev = null;\n    this._numPrev = 0;\n  }\n  if (typeof fn !== 'function') {\n    if (fn !== INTERNAL) throw new TypeError('Not a function');\n    this._state = arguments[1];\n    this._value = arguments[2];\n    if (this._state === false) handleRejection(this, this._value);\n    return;\n  }\n  this._state = null;\n  this._value = null;\n  ++psd.ref;\n  executePromiseTask(this, fn);\n}\nconst thenProp = {\n  get: function () {\n    var psd = PSD,\n      microTaskId = totalEchoes;\n    function then(onFulfilled, onRejected) {\n      var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n      const cleanup = possibleAwait && !decrementExpectedAwaits();\n      var rv = new DexiePromise((resolve, reject) => {\n        propagateToListener(this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait, cleanup), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait, cleanup), resolve, reject, psd));\n      });\n      debug && linkToPreviousPromise(rv, this);\n      return rv;\n    }\n    then.prototype = INTERNAL;\n    return then;\n  },\n  set: function (value) {\n    setProp(this, 'then', value && value.prototype === INTERNAL ? thenProp : {\n      get: function () {\n        return value;\n      },\n      set: thenProp.set\n    });\n  }\n};\nprops(DexiePromise.prototype, {\n  then: thenProp,\n  _then: function (onFulfilled, onRejected) {\n    propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n  },\n  catch: function (onRejected) {\n    if (arguments.length === 1) return this.then(null, onRejected);\n    var type = arguments[0],\n      handler = arguments[1];\n    return typeof type === 'function' ? this.then(null, err => err instanceof type ? handler(err) : PromiseReject(err)) : this.then(null, err => err && err.name === type ? handler(err) : PromiseReject(err));\n  },\n  finally: function (onFinally) {\n    return this.then(value => {\n      onFinally();\n      return value;\n    }, err => {\n      onFinally();\n      return PromiseReject(err);\n    });\n  },\n  stack: {\n    get: function () {\n      if (this._stack) return this._stack;\n      try {\n        stack_being_generated = true;\n        var stacks = getStack(this, [], MAX_LONG_STACKS);\n        var stack = stacks.join(\"\\nFrom previous: \");\n        if (this._state !== null) this._stack = stack;\n        return stack;\n      } finally {\n        stack_being_generated = false;\n      }\n    }\n  },\n  timeout: function (ms, msg) {\n    return ms < Infinity ? new DexiePromise((resolve, reject) => {\n      var handle = setTimeout(() => reject(new exceptions.Timeout(msg)), ms);\n      this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n    }) : this;\n  }\n});\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag) setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\nglobalPSD.env = snapShot();\nfunction Listener(onFulfilled, onRejected, resolve, reject, zone) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.resolve = resolve;\n  this.reject = reject;\n  this.psd = zone;\n}\nprops(DexiePromise, {\n  all: function () {\n    var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n    return new DexiePromise(function (resolve, reject) {\n      if (values.length === 0) resolve([]);\n      var remaining = values.length;\n      values.forEach((a, i) => DexiePromise.resolve(a).then(x => {\n        values[i] = x;\n        if (! --remaining) resolve(values);\n      }, reject));\n    });\n  },\n  resolve: value => {\n    if (value instanceof DexiePromise) return value;\n    if (value && typeof value.then === 'function') return new DexiePromise((resolve, reject) => {\n      value.then(resolve, reject);\n    });\n    var rv = new DexiePromise(INTERNAL, true, value);\n    linkToPreviousPromise(rv, currentFulfiller);\n    return rv;\n  },\n  reject: PromiseReject,\n  race: function () {\n    var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n    return new DexiePromise((resolve, reject) => {\n      values.map(value => DexiePromise.resolve(value).then(resolve, reject));\n    });\n  },\n  PSD: {\n    get: () => PSD,\n    set: value => PSD = value\n  },\n  totalEchoes: {\n    get: () => totalEchoes\n  },\n  newPSD: newScope,\n  usePSD: usePSD,\n  scheduler: {\n    get: () => asap,\n    set: value => {\n      asap = value;\n    }\n  },\n  rejectionMapper: {\n    get: () => rejectionMapper,\n    set: value => {\n      rejectionMapper = value;\n    }\n  },\n  follow: (fn, zoneProps) => {\n    return new DexiePromise((resolve, reject) => {\n      return newScope((resolve, reject) => {\n        var psd = PSD;\n        psd.unhandleds = [];\n        psd.onunhandled = reject;\n        psd.finalize = callBoth(function () {\n          run_at_end_of_this_or_next_physical_tick(() => {\n            this.unhandleds.length === 0 ? resolve() : reject(this.unhandleds[0]);\n          });\n        }, psd.finalize);\n        fn();\n      }, zoneProps, resolve, reject);\n    });\n  }\n});\nif (NativePromise) {\n  if (NativePromise.allSettled) setProp(DexiePromise, \"allSettled\", function () {\n    const possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n    return new DexiePromise(resolve => {\n      if (possiblePromises.length === 0) resolve([]);\n      let remaining = possiblePromises.length;\n      const results = new Array(remaining);\n      possiblePromises.forEach((p, i) => DexiePromise.resolve(p).then(value => results[i] = {\n        status: \"fulfilled\",\n        value\n      }, reason => results[i] = {\n        status: \"rejected\",\n        reason\n      }).then(() => --remaining || resolve(results)));\n    });\n  });\n  if (NativePromise.any && typeof AggregateError !== 'undefined') setProp(DexiePromise, \"any\", function () {\n    const possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n    return new DexiePromise((resolve, reject) => {\n      if (possiblePromises.length === 0) reject(new AggregateError([]));\n      let remaining = possiblePromises.length;\n      const failures = new Array(remaining);\n      possiblePromises.forEach((p, i) => DexiePromise.resolve(p).then(value => resolve(value), failure => {\n        failures[i] = failure;\n        if (! --remaining) reject(new AggregateError(failures));\n      }));\n    });\n  });\n}\nfunction executePromiseTask(promise, fn) {\n  try {\n    fn(value => {\n      if (promise._state !== null) return;\n      if (value === promise) throw new TypeError('A promise cannot be resolved with itself.');\n      var shouldExecuteTick = promise._lib && beginMicroTickScope();\n      if (value && typeof value.then === 'function') {\n        executePromiseTask(promise, (resolve, reject) => {\n          value instanceof DexiePromise ? value._then(resolve, reject) : value.then(resolve, reject);\n        });\n      } else {\n        promise._state = true;\n        promise._value = value;\n        propagateAllListeners(promise);\n      }\n      if (shouldExecuteTick) endMicroTickScope();\n    }, handleRejection.bind(null, promise));\n  } catch (ex) {\n    handleRejection(promise, ex);\n  }\n}\nfunction handleRejection(promise, reason) {\n  rejectingErrors.push(reason);\n  if (promise._state !== null) return;\n  var shouldExecuteTick = promise._lib && beginMicroTickScope();\n  reason = rejectionMapper(reason);\n  promise._state = false;\n  promise._value = reason;\n  debug && reason !== null && typeof reason === 'object' && !reason._promise && tryCatch(() => {\n    var origProp = getPropertyDescriptor(reason, \"stack\");\n    reason._promise = promise;\n    setProp(reason, \"stack\", {\n      get: () => stack_being_generated ? origProp && (origProp.get ? origProp.get.apply(reason) : origProp.value) : promise.stack\n    });\n  });\n  addPossiblyUnhandledError(promise);\n  propagateAllListeners(promise);\n  if (shouldExecuteTick) endMicroTickScope();\n}\nfunction propagateAllListeners(promise) {\n  var listeners = promise._listeners;\n  promise._listeners = [];\n  for (var i = 0, len = listeners.length; i < len; ++i) {\n    propagateToListener(promise, listeners[i]);\n  }\n  var psd = promise._PSD;\n  --psd.ref || psd.finalize();\n  if (numScheduledCalls === 0) {\n    ++numScheduledCalls;\n    asap(() => {\n      if (--numScheduledCalls === 0) finalizePhysicalTick();\n    }, []);\n  }\n}\nfunction propagateToListener(promise, listener) {\n  if (promise._state === null) {\n    promise._listeners.push(listener);\n    return;\n  }\n  var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n  if (cb === null) {\n    return (promise._state ? listener.resolve : listener.reject)(promise._value);\n  }\n  ++listener.psd.ref;\n  ++numScheduledCalls;\n  asap(callListener, [cb, promise, listener]);\n}\nfunction callListener(cb, promise, listener) {\n  try {\n    currentFulfiller = promise;\n    var ret,\n      value = promise._value;\n    if (promise._state) {\n      ret = cb(value);\n    } else {\n      if (rejectingErrors.length) rejectingErrors = [];\n      ret = cb(value);\n      if (rejectingErrors.indexOf(value) === -1) markErrorAsHandled(promise);\n    }\n    listener.resolve(ret);\n  } catch (e) {\n    listener.reject(e);\n  } finally {\n    currentFulfiller = null;\n    if (--numScheduledCalls === 0) finalizePhysicalTick();\n    --listener.psd.ref || listener.psd.finalize();\n  }\n}\nfunction getStack(promise, stacks, limit) {\n  if (stacks.length === limit) return stacks;\n  var stack = \"\";\n  if (promise._state === false) {\n    var failure = promise._value,\n      errorName,\n      message;\n    if (failure != null) {\n      errorName = failure.name || \"Error\";\n      message = failure.message || failure;\n      stack = prettyStack(failure, 0);\n    } else {\n      errorName = failure;\n      message = \"\";\n    }\n    stacks.push(errorName + (message ? \": \" + message : \"\") + stack);\n  }\n  if (debug) {\n    stack = prettyStack(promise._stackHolder, 2);\n    if (stack && stacks.indexOf(stack) === -1) stacks.push(stack);\n    if (promise._prev) getStack(promise._prev, stacks, limit);\n  }\n  return stacks;\n}\nfunction linkToPreviousPromise(promise, prev) {\n  var numPrev = prev ? prev._numPrev + 1 : 0;\n  if (numPrev < LONG_STACKS_CLIP_LIMIT) {\n    promise._prev = prev;\n    promise._numPrev = numPrev;\n  }\n}\nfunction physicalTick() {\n  beginMicroTickScope() && endMicroTickScope();\n}\nfunction beginMicroTickScope() {\n  var wasRootExec = isOutsideMicroTick;\n  isOutsideMicroTick = false;\n  needsNewPhysicalTick = false;\n  return wasRootExec;\n}\nfunction endMicroTickScope() {\n  var callbacks, i, l;\n  do {\n    while (microtickQueue.length > 0) {\n      callbacks = microtickQueue;\n      microtickQueue = [];\n      l = callbacks.length;\n      for (i = 0; i < l; ++i) {\n        var item = callbacks[i];\n        item[0].apply(null, item[1]);\n      }\n    }\n  } while (microtickQueue.length > 0);\n  isOutsideMicroTick = true;\n  needsNewPhysicalTick = true;\n}\nfunction finalizePhysicalTick() {\n  var unhandledErrs = unhandledErrors;\n  unhandledErrors = [];\n  unhandledErrs.forEach(p => {\n    p._PSD.onunhandled.call(null, p._value, p);\n  });\n  var finalizers = tickFinalizers.slice(0);\n  var i = finalizers.length;\n  while (i) finalizers[--i]();\n}\nfunction run_at_end_of_this_or_next_physical_tick(fn) {\n  function finalizer() {\n    fn();\n    tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n  }\n  tickFinalizers.push(finalizer);\n  ++numScheduledCalls;\n  asap(() => {\n    if (--numScheduledCalls === 0) finalizePhysicalTick();\n  }, []);\n}\nfunction addPossiblyUnhandledError(promise) {\n  if (!unhandledErrors.some(p => p._value === promise._value)) unhandledErrors.push(promise);\n}\nfunction markErrorAsHandled(promise) {\n  var i = unhandledErrors.length;\n  while (i) if (unhandledErrors[--i]._value === promise._value) {\n    unhandledErrors.splice(i, 1);\n    return;\n  }\n}\nfunction PromiseReject(reason) {\n  return new DexiePromise(INTERNAL, false, reason);\n}\nfunction wrap(fn, errorCatcher) {\n  var psd = PSD;\n  return function () {\n    var wasRootExec = beginMicroTickScope(),\n      outerScope = PSD;\n    try {\n      switchToZone(psd, true);\n      return fn.apply(this, arguments);\n    } catch (e) {\n      errorCatcher && errorCatcher(e);\n    } finally {\n      switchToZone(outerScope, false);\n      if (wasRootExec) endMicroTickScope();\n    }\n  };\n}\nconst task = {\n  awaits: 0,\n  echoes: 0,\n  id: 0\n};\nvar taskCounter = 0;\nvar zoneStack = [];\nvar zoneEchoes = 0;\nvar totalEchoes = 0;\nvar zone_id_counter = 0;\nfunction newScope(fn, props, a1, a2) {\n  var parent = PSD,\n    psd = Object.create(parent);\n  psd.parent = parent;\n  psd.ref = 0;\n  psd.global = false;\n  psd.id = ++zone_id_counter;\n  var globalEnv = globalPSD.env;\n  psd.env = patchGlobalPromise ? {\n    Promise: DexiePromise,\n    PromiseProp: {\n      value: DexiePromise,\n      configurable: true,\n      writable: true\n    },\n    all: DexiePromise.all,\n    race: DexiePromise.race,\n    allSettled: DexiePromise.allSettled,\n    any: DexiePromise.any,\n    resolve: DexiePromise.resolve,\n    reject: DexiePromise.reject,\n    nthen: getPatchedPromiseThen(globalEnv.nthen, psd),\n    gthen: getPatchedPromiseThen(globalEnv.gthen, psd)\n  } : {};\n  if (props) extend(psd, props);\n  ++parent.ref;\n  psd.finalize = function () {\n    --this.parent.ref || this.parent.finalize();\n  };\n  var rv = usePSD(psd, fn, a1, a2);\n  if (psd.ref === 0) psd.finalize();\n  return rv;\n}\nfunction incrementExpectedAwaits() {\n  if (!task.id) task.id = ++taskCounter;\n  ++task.awaits;\n  task.echoes += ZONE_ECHO_LIMIT;\n  return task.id;\n}\nfunction decrementExpectedAwaits() {\n  if (!task.awaits) return false;\n  if (--task.awaits === 0) task.id = 0;\n  task.echoes = task.awaits * ZONE_ECHO_LIMIT;\n  return true;\n}\nif (('' + nativePromiseThen).indexOf('[native code]') === -1) {\n  incrementExpectedAwaits = decrementExpectedAwaits = nop;\n}\nfunction onPossibleParallellAsync(possiblePromise) {\n  if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n    incrementExpectedAwaits();\n    return possiblePromise.then(x => {\n      decrementExpectedAwaits();\n      return x;\n    }, e => {\n      decrementExpectedAwaits();\n      return rejection(e);\n    });\n  }\n  return possiblePromise;\n}\nfunction zoneEnterEcho(targetZone) {\n  ++totalEchoes;\n  if (!task.echoes || --task.echoes === 0) {\n    task.echoes = task.id = 0;\n  }\n  zoneStack.push(PSD);\n  switchToZone(targetZone, true);\n}\nfunction zoneLeaveEcho() {\n  var zone = zoneStack[zoneStack.length - 1];\n  zoneStack.pop();\n  switchToZone(zone, false);\n}\nfunction switchToZone(targetZone, bEnteringZone) {\n  var currentZone = PSD;\n  if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (! --zoneEchoes || targetZone !== PSD)) {\n    enqueueNativeMicroTask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n  }\n  if (targetZone === PSD) return;\n  PSD = targetZone;\n  if (currentZone === globalPSD) globalPSD.env = snapShot();\n  if (patchGlobalPromise) {\n    var GlobalPromise = globalPSD.env.Promise;\n    var targetEnv = targetZone.env;\n    nativePromiseProto.then = targetEnv.nthen;\n    GlobalPromise.prototype.then = targetEnv.gthen;\n    if (currentZone.global || targetZone.global) {\n      Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n      GlobalPromise.all = targetEnv.all;\n      GlobalPromise.race = targetEnv.race;\n      GlobalPromise.resolve = targetEnv.resolve;\n      GlobalPromise.reject = targetEnv.reject;\n      if (targetEnv.allSettled) GlobalPromise.allSettled = targetEnv.allSettled;\n      if (targetEnv.any) GlobalPromise.any = targetEnv.any;\n    }\n  }\n}\nfunction snapShot() {\n  var GlobalPromise = _global.Promise;\n  return patchGlobalPromise ? {\n    Promise: GlobalPromise,\n    PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n    all: GlobalPromise.all,\n    race: GlobalPromise.race,\n    allSettled: GlobalPromise.allSettled,\n    any: GlobalPromise.any,\n    resolve: GlobalPromise.resolve,\n    reject: GlobalPromise.reject,\n    nthen: nativePromiseProto.then,\n    gthen: GlobalPromise.prototype.then\n  } : {};\n}\nfunction usePSD(psd, fn, a1, a2, a3) {\n  var outerScope = PSD;\n  try {\n    switchToZone(psd, true);\n    return fn(a1, a2, a3);\n  } finally {\n    switchToZone(outerScope, false);\n  }\n}\nfunction enqueueNativeMicroTask(job) {\n  nativePromiseThen.call(resolvedNativePromise, job);\n}\nfunction nativeAwaitCompatibleWrap(fn, zone, possibleAwait, cleanup) {\n  return typeof fn !== 'function' ? fn : function () {\n    var outerZone = PSD;\n    if (possibleAwait) incrementExpectedAwaits();\n    switchToZone(zone, true);\n    try {\n      return fn.apply(this, arguments);\n    } finally {\n      switchToZone(outerZone, false);\n      if (cleanup) enqueueNativeMicroTask(decrementExpectedAwaits);\n    }\n  };\n}\nfunction getPatchedPromiseThen(origThen, zone) {\n  return function (onResolved, onRejected) {\n    return origThen.call(this, nativeAwaitCompatibleWrap(onResolved, zone), nativeAwaitCompatibleWrap(onRejected, zone));\n  };\n}\nconst UNHANDLEDREJECTION = \"unhandledrejection\";\nfunction globalError(err, promise) {\n  var rv;\n  try {\n    rv = promise.onuncatched(err);\n  } catch (e) {}\n  if (rv !== false) try {\n    var event,\n      eventData = {\n        promise: promise,\n        reason: err\n      };\n    if (_global.document && document.createEvent) {\n      event = document.createEvent('Event');\n      event.initEvent(UNHANDLEDREJECTION, true, true);\n      extend(event, eventData);\n    } else if (_global.CustomEvent) {\n      event = new CustomEvent(UNHANDLEDREJECTION, {\n        detail: eventData\n      });\n      extend(event, eventData);\n    }\n    if (event && _global.dispatchEvent) {\n      dispatchEvent(event);\n      if (!_global.PromiseRejectionEvent && _global.onunhandledrejection) try {\n        _global.onunhandledrejection(event);\n      } catch (_) {}\n    }\n    if (debug && event && !event.defaultPrevented) {\n      console.warn(`Unhandled rejection: ${err.stack || err}`);\n    }\n  } catch (e) {}\n}\nvar rejection = DexiePromise.reject;\nfunction tempTransaction(db, mode, storeNames, fn) {\n  if (!db.idbdb || !db._state.openComplete && !PSD.letThrough && !db._vip) {\n    if (db._state.openComplete) {\n      return rejection(new exceptions.DatabaseClosed(db._state.dbOpenError));\n    }\n    if (!db._state.isBeingOpened) {\n      if (!db._options.autoOpen) return rejection(new exceptions.DatabaseClosed());\n      db.open().catch(nop);\n    }\n    return db._state.dbReadyPromise.then(() => tempTransaction(db, mode, storeNames, fn));\n  } else {\n    var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n    try {\n      trans.create();\n      db._state.PR1398_maxLoop = 3;\n    } catch (ex) {\n      if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n        console.warn('Dexie: Need to reopen db');\n        db._close();\n        return db.open().then(() => tempTransaction(db, mode, storeNames, fn));\n      }\n      return rejection(ex);\n    }\n    return trans._promise(mode, (resolve, reject) => {\n      return newScope(() => {\n        PSD.trans = trans;\n        return fn(resolve, reject, trans);\n      });\n    }).then(result => {\n      return trans._completion.then(() => result);\n    });\n  }\n}\nconst DEXIE_VERSION = '3.2.7';\nconst maxString = String.fromCharCode(65535);\nconst minKey = -Infinity;\nconst INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\nconst STRING_EXPECTED = \"String expected.\";\nconst connections = [];\nconst isIEOrEdge = typeof navigator !== 'undefined' && /(MSIE|Trident|Edge)/.test(navigator.userAgent);\nconst hasIEDeleteObjectStoreBug = isIEOrEdge;\nconst hangsOnDeleteLargeKeyRange = isIEOrEdge;\nconst dexieStackFrameFilter = frame => !/(dexie\\.js|dexie\\.min\\.js)/.test(frame);\nconst DBNAMES_DB = '__dbnames';\nconst READONLY = 'readonly';\nconst READWRITE = 'readwrite';\nfunction combine(filter1, filter2) {\n  return filter1 ? filter2 ? function () {\n    return filter1.apply(this, arguments) && filter2.apply(this, arguments);\n  } : filter1 : filter2;\n}\nconst AnyRange = {\n  type: 3,\n  lower: -Infinity,\n  lowerOpen: false,\n  upper: [[]],\n  upperOpen: false\n};\nfunction workaroundForUndefinedPrimKey(keyPath) {\n  return typeof keyPath === \"string\" && !/\\./.test(keyPath) ? obj => {\n    if (obj[keyPath] === undefined && keyPath in obj) {\n      obj = deepClone(obj);\n      delete obj[keyPath];\n    }\n    return obj;\n  } : obj => obj;\n}\nclass Table {\n  _trans(mode, fn, writeLocked) {\n    const trans = this._tx || PSD.trans;\n    const tableName = this.name;\n    function checkTableInTransaction(resolve, reject, trans) {\n      if (!trans.schema[tableName]) throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n      return fn(trans.idbtrans, trans);\n    }\n    const wasRootExec = beginMicroTickScope();\n    try {\n      return trans && trans.db === this.db ? trans === PSD.trans ? trans._promise(mode, checkTableInTransaction, writeLocked) : newScope(() => trans._promise(mode, checkTableInTransaction, writeLocked), {\n        trans: trans,\n        transless: PSD.transless || PSD\n      }) : tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n    } finally {\n      if (wasRootExec) endMicroTickScope();\n    }\n  }\n  get(keyOrCrit, cb) {\n    if (keyOrCrit && keyOrCrit.constructor === Object) return this.where(keyOrCrit).first(cb);\n    return this._trans('readonly', trans => {\n      return this.core.get({\n        trans,\n        key: keyOrCrit\n      }).then(res => this.hook.reading.fire(res));\n    }).then(cb);\n  }\n  where(indexOrCrit) {\n    if (typeof indexOrCrit === 'string') return new this.db.WhereClause(this, indexOrCrit);\n    if (isArray(indexOrCrit)) return new this.db.WhereClause(this, `[${indexOrCrit.join('+')}]`);\n    const keyPaths = keys(indexOrCrit);\n    if (keyPaths.length === 1) return this.where(keyPaths[0]).equals(indexOrCrit[keyPaths[0]]);\n    const compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(ix => {\n      if (ix.compound && keyPaths.every(keyPath => ix.keyPath.indexOf(keyPath) >= 0)) {\n        for (let i = 0; i < keyPaths.length; ++i) {\n          if (keyPaths.indexOf(ix.keyPath[i]) === -1) return false;\n        }\n        return true;\n      }\n      return false;\n    }).sort((a, b) => a.keyPath.length - b.keyPath.length)[0];\n    if (compoundIndex && this.db._maxKey !== maxString) {\n      const keyPathsInValidOrder = compoundIndex.keyPath.slice(0, keyPaths.length);\n      return this.where(keyPathsInValidOrder).equals(keyPathsInValidOrder.map(kp => indexOrCrit[kp]));\n    }\n    if (!compoundIndex && debug) console.warn(`The query ${JSON.stringify(indexOrCrit)} on ${this.name} would benefit of a ` + `compound index [${keyPaths.join('+')}]`);\n    const {\n      idxByName\n    } = this.schema;\n    const idb = this.db._deps.indexedDB;\n    function equals(a, b) {\n      try {\n        return idb.cmp(a, b) === 0;\n      } catch (e) {\n        return false;\n      }\n    }\n    const [idx, filterFunction] = keyPaths.reduce(([prevIndex, prevFilterFn], keyPath) => {\n      const index = idxByName[keyPath];\n      const value = indexOrCrit[keyPath];\n      return [prevIndex || index, prevIndex || !index ? combine(prevFilterFn, index && index.multi ? x => {\n        const prop = getByKeyPath(x, keyPath);\n        return isArray(prop) && prop.some(item => equals(value, item));\n      } : x => equals(value, getByKeyPath(x, keyPath))) : prevFilterFn];\n    }, [null, null]);\n    return idx ? this.where(idx.name).equals(indexOrCrit[idx.keyPath]).filter(filterFunction) : compoundIndex ? this.filter(filterFunction) : this.where(keyPaths).equals('');\n  }\n  filter(filterFunction) {\n    return this.toCollection().and(filterFunction);\n  }\n  count(thenShortcut) {\n    return this.toCollection().count(thenShortcut);\n  }\n  offset(offset) {\n    return this.toCollection().offset(offset);\n  }\n  limit(numRows) {\n    return this.toCollection().limit(numRows);\n  }\n  each(callback) {\n    return this.toCollection().each(callback);\n  }\n  toArray(thenShortcut) {\n    return this.toCollection().toArray(thenShortcut);\n  }\n  toCollection() {\n    return new this.db.Collection(new this.db.WhereClause(this));\n  }\n  orderBy(index) {\n    return new this.db.Collection(new this.db.WhereClause(this, isArray(index) ? `[${index.join('+')}]` : index));\n  }\n  reverse() {\n    return this.toCollection().reverse();\n  }\n  mapToClass(constructor) {\n    this.schema.mappedClass = constructor;\n    const readHook = obj => {\n      if (!obj) return obj;\n      const res = Object.create(constructor.prototype);\n      for (var m in obj) if (hasOwn(obj, m)) try {\n        res[m] = obj[m];\n      } catch (_) {}\n      return res;\n    };\n    if (this.schema.readHook) {\n      this.hook.reading.unsubscribe(this.schema.readHook);\n    }\n    this.schema.readHook = readHook;\n    this.hook(\"reading\", readHook);\n    return constructor;\n  }\n  defineClass() {\n    function Class(content) {\n      extend(this, content);\n    }\n    return this.mapToClass(Class);\n  }\n  add(obj, key) {\n    const {\n      auto,\n      keyPath\n    } = this.schema.primKey;\n    let objToAdd = obj;\n    if (keyPath && auto) {\n      objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n    }\n    return this._trans('readwrite', trans => {\n      return this.core.mutate({\n        trans,\n        type: 'add',\n        keys: key != null ? [key] : null,\n        values: [objToAdd]\n      });\n    }).then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult).then(lastResult => {\n      if (keyPath) {\n        try {\n          setByKeyPath(obj, keyPath, lastResult);\n        } catch (_) {}\n      }\n      return lastResult;\n    });\n  }\n  update(keyOrObject, modifications) {\n    if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n      const key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n      if (key === undefined) return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n      try {\n        if (typeof modifications !== \"function\") {\n          keys(modifications).forEach(keyPath => {\n            setByKeyPath(keyOrObject, keyPath, modifications[keyPath]);\n          });\n        } else {\n          modifications(keyOrObject, {\n            value: keyOrObject,\n            primKey: key\n          });\n        }\n      } catch (_a) {}\n      return this.where(\":id\").equals(key).modify(modifications);\n    } else {\n      return this.where(\":id\").equals(keyOrObject).modify(modifications);\n    }\n  }\n  put(obj, key) {\n    const {\n      auto,\n      keyPath\n    } = this.schema.primKey;\n    let objToAdd = obj;\n    if (keyPath && auto) {\n      objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n    }\n    return this._trans('readwrite', trans => this.core.mutate({\n      trans,\n      type: 'put',\n      values: [objToAdd],\n      keys: key != null ? [key] : null\n    })).then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult).then(lastResult => {\n      if (keyPath) {\n        try {\n          setByKeyPath(obj, keyPath, lastResult);\n        } catch (_) {}\n      }\n      return lastResult;\n    });\n  }\n  delete(key) {\n    return this._trans('readwrite', trans => this.core.mutate({\n      trans,\n      type: 'delete',\n      keys: [key]\n    })).then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined);\n  }\n  clear() {\n    return this._trans('readwrite', trans => this.core.mutate({\n      trans,\n      type: 'deleteRange',\n      range: AnyRange\n    })).then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined);\n  }\n  bulkGet(keys) {\n    return this._trans('readonly', trans => {\n      return this.core.getMany({\n        keys,\n        trans\n      }).then(result => result.map(res => this.hook.reading.fire(res)));\n    });\n  }\n  bulkAdd(objects, keysOrOptions, options) {\n    const keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n    options = options || (keys ? undefined : keysOrOptions);\n    const wantResults = options ? options.allKeys : undefined;\n    return this._trans('readwrite', trans => {\n      const {\n        auto,\n        keyPath\n      } = this.schema.primKey;\n      if (keyPath && keys) throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n      if (keys && keys.length !== objects.length) throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n      const numObjects = objects.length;\n      let objectsToAdd = keyPath && auto ? objects.map(workaroundForUndefinedPrimKey(keyPath)) : objects;\n      return this.core.mutate({\n        trans,\n        type: 'add',\n        keys: keys,\n        values: objectsToAdd,\n        wantResults\n      }).then(({\n        numFailures,\n        results,\n        lastResult,\n        failures\n      }) => {\n        const result = wantResults ? results : lastResult;\n        if (numFailures === 0) return result;\n        throw new BulkError(`${this.name}.bulkAdd(): ${numFailures} of ${numObjects} operations failed`, failures);\n      });\n    });\n  }\n  bulkPut(objects, keysOrOptions, options) {\n    const keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n    options = options || (keys ? undefined : keysOrOptions);\n    const wantResults = options ? options.allKeys : undefined;\n    return this._trans('readwrite', trans => {\n      const {\n        auto,\n        keyPath\n      } = this.schema.primKey;\n      if (keyPath && keys) throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n      if (keys && keys.length !== objects.length) throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n      const numObjects = objects.length;\n      let objectsToPut = keyPath && auto ? objects.map(workaroundForUndefinedPrimKey(keyPath)) : objects;\n      return this.core.mutate({\n        trans,\n        type: 'put',\n        keys: keys,\n        values: objectsToPut,\n        wantResults\n      }).then(({\n        numFailures,\n        results,\n        lastResult,\n        failures\n      }) => {\n        const result = wantResults ? results : lastResult;\n        if (numFailures === 0) return result;\n        throw new BulkError(`${this.name}.bulkPut(): ${numFailures} of ${numObjects} operations failed`, failures);\n      });\n    });\n  }\n  bulkDelete(keys) {\n    const numKeys = keys.length;\n    return this._trans('readwrite', trans => {\n      return this.core.mutate({\n        trans,\n        type: 'delete',\n        keys: keys\n      });\n    }).then(({\n      numFailures,\n      lastResult,\n      failures\n    }) => {\n      if (numFailures === 0) return lastResult;\n      throw new BulkError(`${this.name}.bulkDelete(): ${numFailures} of ${numKeys} operations failed`, failures);\n    });\n  }\n}\nfunction Events(ctx) {\n  var evs = {};\n  var rv = function (eventName, subscriber) {\n    if (subscriber) {\n      var i = arguments.length,\n        args = new Array(i - 1);\n      while (--i) args[i - 1] = arguments[i];\n      evs[eventName].subscribe.apply(null, args);\n      return ctx;\n    } else if (typeof eventName === 'string') {\n      return evs[eventName];\n    }\n  };\n  rv.addEventType = add;\n  for (var i = 1, l = arguments.length; i < l; ++i) {\n    add(arguments[i]);\n  }\n  return rv;\n  function add(eventName, chainFunction, defaultFunction) {\n    if (typeof eventName === 'object') return addConfiguredEvents(eventName);\n    if (!chainFunction) chainFunction = reverseStoppableEventChain;\n    if (!defaultFunction) defaultFunction = nop;\n    var context = {\n      subscribers: [],\n      fire: defaultFunction,\n      subscribe: function (cb) {\n        if (context.subscribers.indexOf(cb) === -1) {\n          context.subscribers.push(cb);\n          context.fire = chainFunction(context.fire, cb);\n        }\n      },\n      unsubscribe: function (cb) {\n        context.subscribers = context.subscribers.filter(function (fn) {\n          return fn !== cb;\n        });\n        context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n      }\n    };\n    evs[eventName] = rv[eventName] = context;\n    return context;\n  }\n  function addConfiguredEvents(cfg) {\n    keys(cfg).forEach(function (eventName) {\n      var args = cfg[eventName];\n      if (isArray(args)) {\n        add(eventName, cfg[eventName][0], cfg[eventName][1]);\n      } else if (args === 'asap') {\n        var context = add(eventName, mirror, function fire() {\n          var i = arguments.length,\n            args = new Array(i);\n          while (i--) args[i] = arguments[i];\n          context.subscribers.forEach(function (fn) {\n            asap$1(function fireEvent() {\n              fn.apply(null, args);\n            });\n          });\n        });\n      } else throw new exceptions.InvalidArgument(\"Invalid event config\");\n    });\n  }\n}\nfunction makeClassConstructor(prototype, constructor) {\n  derive(constructor).from({\n    prototype\n  });\n  return constructor;\n}\nfunction createTableConstructor(db) {\n  return makeClassConstructor(Table.prototype, function Table(name, tableSchema, trans) {\n    this.db = db;\n    this._tx = trans;\n    this.name = name;\n    this.schema = tableSchema;\n    this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n      \"creating\": [hookCreatingChain, nop],\n      \"reading\": [pureFunctionChain, mirror],\n      \"updating\": [hookUpdatingChain, nop],\n      \"deleting\": [hookDeletingChain, nop]\n    });\n  });\n}\nfunction isPlainKeyRange(ctx, ignoreLimitFilter) {\n  return !(ctx.filter || ctx.algorithm || ctx.or) && (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n}\nfunction addFilter(ctx, fn) {\n  ctx.filter = combine(ctx.filter, fn);\n}\nfunction addReplayFilter(ctx, factory, isLimitFilter) {\n  var curr = ctx.replayFilter;\n  ctx.replayFilter = curr ? () => combine(curr(), factory()) : factory;\n  ctx.justLimit = isLimitFilter && !curr;\n}\nfunction addMatchFilter(ctx, fn) {\n  ctx.isMatch = combine(ctx.isMatch, fn);\n}\nfunction getIndexOrStore(ctx, coreSchema) {\n  if (ctx.isPrimKey) return coreSchema.primaryKey;\n  const index = coreSchema.getIndexByKeyPath(ctx.index);\n  if (!index) throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n  return index;\n}\nfunction openCursor(ctx, coreTable, trans) {\n  const index = getIndexOrStore(ctx, coreTable.schema);\n  return coreTable.openCursor({\n    trans,\n    values: !ctx.keysOnly,\n    reverse: ctx.dir === 'prev',\n    unique: !!ctx.unique,\n    query: {\n      index,\n      range: ctx.range\n    }\n  });\n}\nfunction iter(ctx, fn, coreTrans, coreTable) {\n  const filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n  if (!ctx.or) {\n    return iterate(openCursor(ctx, coreTable, coreTrans), combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n  } else {\n    const set = {};\n    const union = (item, cursor, advance) => {\n      if (!filter || filter(cursor, advance, result => cursor.stop(result), err => cursor.fail(err))) {\n        var primaryKey = cursor.primaryKey;\n        var key = '' + primaryKey;\n        if (key === '[object ArrayBuffer]') key = '' + new Uint8Array(primaryKey);\n        if (!hasOwn(set, key)) {\n          set[key] = true;\n          fn(item, cursor, advance);\n        }\n      }\n    };\n    return Promise.all([ctx.or._iterate(union, coreTrans), iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)]);\n  }\n}\nfunction iterate(cursorPromise, filter, fn, valueMapper) {\n  var mappedFn = valueMapper ? (x, c, a) => fn(valueMapper(x), c, a) : fn;\n  var wrappedFn = wrap(mappedFn);\n  return cursorPromise.then(cursor => {\n    if (cursor) {\n      return cursor.start(() => {\n        var c = () => cursor.continue();\n        if (!filter || filter(cursor, advancer => c = advancer, val => {\n          cursor.stop(val);\n          c = nop;\n        }, e => {\n          cursor.fail(e);\n          c = nop;\n        })) wrappedFn(cursor.value, cursor, advancer => c = advancer);\n        c();\n      });\n    }\n  });\n}\nfunction cmp(a, b) {\n  try {\n    const ta = type(a);\n    const tb = type(b);\n    if (ta !== tb) {\n      if (ta === 'Array') return 1;\n      if (tb === 'Array') return -1;\n      if (ta === 'binary') return 1;\n      if (tb === 'binary') return -1;\n      if (ta === 'string') return 1;\n      if (tb === 'string') return -1;\n      if (ta === 'Date') return 1;\n      if (tb !== 'Date') return NaN;\n      return -1;\n    }\n    switch (ta) {\n      case 'number':\n      case 'Date':\n      case 'string':\n        return a > b ? 1 : a < b ? -1 : 0;\n      case 'binary':\n        {\n          return compareUint8Arrays(getUint8Array(a), getUint8Array(b));\n        }\n      case 'Array':\n        return compareArrays(a, b);\n    }\n  } catch (_a) {}\n  return NaN;\n}\nfunction compareArrays(a, b) {\n  const al = a.length;\n  const bl = b.length;\n  const l = al < bl ? al : bl;\n  for (let i = 0; i < l; ++i) {\n    const res = cmp(a[i], b[i]);\n    if (res !== 0) return res;\n  }\n  return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction compareUint8Arrays(a, b) {\n  const al = a.length;\n  const bl = b.length;\n  const l = al < bl ? al : bl;\n  for (let i = 0; i < l; ++i) {\n    if (a[i] !== b[i]) return a[i] < b[i] ? -1 : 1;\n  }\n  return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction type(x) {\n  const t = typeof x;\n  if (t !== 'object') return t;\n  if (ArrayBuffer.isView(x)) return 'binary';\n  const tsTag = toStringTag(x);\n  return tsTag === 'ArrayBuffer' ? 'binary' : tsTag;\n}\nfunction getUint8Array(a) {\n  if (a instanceof Uint8Array) return a;\n  if (ArrayBuffer.isView(a)) return new Uint8Array(a.buffer, a.byteOffset, a.byteLength);\n  return new Uint8Array(a);\n}\nclass Collection {\n  _read(fn, cb) {\n    var ctx = this._ctx;\n    return ctx.error ? ctx.table._trans(null, rejection.bind(null, ctx.error)) : ctx.table._trans('readonly', fn).then(cb);\n  }\n  _write(fn) {\n    var ctx = this._ctx;\n    return ctx.error ? ctx.table._trans(null, rejection.bind(null, ctx.error)) : ctx.table._trans('readwrite', fn, \"locked\");\n  }\n  _addAlgorithm(fn) {\n    var ctx = this._ctx;\n    ctx.algorithm = combine(ctx.algorithm, fn);\n  }\n  _iterate(fn, coreTrans) {\n    return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n  }\n  clone(props) {\n    var rv = Object.create(this.constructor.prototype),\n      ctx = Object.create(this._ctx);\n    if (props) extend(ctx, props);\n    rv._ctx = ctx;\n    return rv;\n  }\n  raw() {\n    this._ctx.valueMapper = null;\n    return this;\n  }\n  each(fn) {\n    var ctx = this._ctx;\n    return this._read(trans => iter(ctx, fn, trans, ctx.table.core));\n  }\n  count(cb) {\n    return this._read(trans => {\n      const ctx = this._ctx;\n      const coreTable = ctx.table.core;\n      if (isPlainKeyRange(ctx, true)) {\n        return coreTable.count({\n          trans,\n          query: {\n            index: getIndexOrStore(ctx, coreTable.schema),\n            range: ctx.range\n          }\n        }).then(count => Math.min(count, ctx.limit));\n      } else {\n        var count = 0;\n        return iter(ctx, () => {\n          ++count;\n          return false;\n        }, trans, coreTable).then(() => count);\n      }\n    }).then(cb);\n  }\n  sortBy(keyPath, cb) {\n    const parts = keyPath.split('.').reverse(),\n      lastPart = parts[0],\n      lastIndex = parts.length - 1;\n    function getval(obj, i) {\n      if (i) return getval(obj[parts[i]], i - 1);\n      return obj[lastPart];\n    }\n    var order = this._ctx.dir === \"next\" ? 1 : -1;\n    function sorter(a, b) {\n      var aVal = getval(a, lastIndex),\n        bVal = getval(b, lastIndex);\n      return aVal < bVal ? -order : aVal > bVal ? order : 0;\n    }\n    return this.toArray(function (a) {\n      return a.sort(sorter);\n    }).then(cb);\n  }\n  toArray(cb) {\n    return this._read(trans => {\n      var ctx = this._ctx;\n      if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n        const {\n          valueMapper\n        } = ctx;\n        const index = getIndexOrStore(ctx, ctx.table.core.schema);\n        return ctx.table.core.query({\n          trans,\n          limit: ctx.limit,\n          values: true,\n          query: {\n            index,\n            range: ctx.range\n          }\n        }).then(({\n          result\n        }) => valueMapper ? result.map(valueMapper) : result);\n      } else {\n        const a = [];\n        return iter(ctx, item => a.push(item), trans, ctx.table.core).then(() => a);\n      }\n    }, cb);\n  }\n  offset(offset) {\n    var ctx = this._ctx;\n    if (offset <= 0) return this;\n    ctx.offset += offset;\n    if (isPlainKeyRange(ctx)) {\n      addReplayFilter(ctx, () => {\n        var offsetLeft = offset;\n        return (cursor, advance) => {\n          if (offsetLeft === 0) return true;\n          if (offsetLeft === 1) {\n            --offsetLeft;\n            return false;\n          }\n          advance(() => {\n            cursor.advance(offsetLeft);\n            offsetLeft = 0;\n          });\n          return false;\n        };\n      });\n    } else {\n      addReplayFilter(ctx, () => {\n        var offsetLeft = offset;\n        return () => --offsetLeft < 0;\n      });\n    }\n    return this;\n  }\n  limit(numRows) {\n    this._ctx.limit = Math.min(this._ctx.limit, numRows);\n    addReplayFilter(this._ctx, () => {\n      var rowsLeft = numRows;\n      return function (cursor, advance, resolve) {\n        if (--rowsLeft <= 0) advance(resolve);\n        return rowsLeft >= 0;\n      };\n    }, true);\n    return this;\n  }\n  until(filterFunction, bIncludeStopEntry) {\n    addFilter(this._ctx, function (cursor, advance, resolve) {\n      if (filterFunction(cursor.value)) {\n        advance(resolve);\n        return bIncludeStopEntry;\n      } else {\n        return true;\n      }\n    });\n    return this;\n  }\n  first(cb) {\n    return this.limit(1).toArray(function (a) {\n      return a[0];\n    }).then(cb);\n  }\n  last(cb) {\n    return this.reverse().first(cb);\n  }\n  filter(filterFunction) {\n    addFilter(this._ctx, function (cursor) {\n      return filterFunction(cursor.value);\n    });\n    addMatchFilter(this._ctx, filterFunction);\n    return this;\n  }\n  and(filter) {\n    return this.filter(filter);\n  }\n  or(indexName) {\n    return new this.db.WhereClause(this._ctx.table, indexName, this);\n  }\n  reverse() {\n    this._ctx.dir = this._ctx.dir === \"prev\" ? \"next\" : \"prev\";\n    if (this._ondirectionchange) this._ondirectionchange(this._ctx.dir);\n    return this;\n  }\n  desc() {\n    return this.reverse();\n  }\n  eachKey(cb) {\n    var ctx = this._ctx;\n    ctx.keysOnly = !ctx.isMatch;\n    return this.each(function (val, cursor) {\n      cb(cursor.key, cursor);\n    });\n  }\n  eachUniqueKey(cb) {\n    this._ctx.unique = \"unique\";\n    return this.eachKey(cb);\n  }\n  eachPrimaryKey(cb) {\n    var ctx = this._ctx;\n    ctx.keysOnly = !ctx.isMatch;\n    return this.each(function (val, cursor) {\n      cb(cursor.primaryKey, cursor);\n    });\n  }\n  keys(cb) {\n    var ctx = this._ctx;\n    ctx.keysOnly = !ctx.isMatch;\n    var a = [];\n    return this.each(function (item, cursor) {\n      a.push(cursor.key);\n    }).then(function () {\n      return a;\n    }).then(cb);\n  }\n  primaryKeys(cb) {\n    var ctx = this._ctx;\n    if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n      return this._read(trans => {\n        var index = getIndexOrStore(ctx, ctx.table.core.schema);\n        return ctx.table.core.query({\n          trans,\n          values: false,\n          limit: ctx.limit,\n          query: {\n            index,\n            range: ctx.range\n          }\n        });\n      }).then(({\n        result\n      }) => result).then(cb);\n    }\n    ctx.keysOnly = !ctx.isMatch;\n    var a = [];\n    return this.each(function (item, cursor) {\n      a.push(cursor.primaryKey);\n    }).then(function () {\n      return a;\n    }).then(cb);\n  }\n  uniqueKeys(cb) {\n    this._ctx.unique = \"unique\";\n    return this.keys(cb);\n  }\n  firstKey(cb) {\n    return this.limit(1).keys(function (a) {\n      return a[0];\n    }).then(cb);\n  }\n  lastKey(cb) {\n    return this.reverse().firstKey(cb);\n  }\n  distinct() {\n    var ctx = this._ctx,\n      idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n    if (!idx || !idx.multi) return this;\n    var set = {};\n    addFilter(this._ctx, function (cursor) {\n      var strKey = cursor.primaryKey.toString();\n      var found = hasOwn(set, strKey);\n      set[strKey] = true;\n      return !found;\n    });\n    return this;\n  }\n  modify(changes) {\n    var ctx = this._ctx;\n    return this._write(trans => {\n      var modifyer;\n      if (typeof changes === 'function') {\n        modifyer = changes;\n      } else {\n        var keyPaths = keys(changes);\n        var numKeys = keyPaths.length;\n        modifyer = function (item) {\n          var anythingModified = false;\n          for (var i = 0; i < numKeys; ++i) {\n            var keyPath = keyPaths[i],\n              val = changes[keyPath];\n            if (getByKeyPath(item, keyPath) !== val) {\n              setByKeyPath(item, keyPath, val);\n              anythingModified = true;\n            }\n          }\n          return anythingModified;\n        };\n      }\n      const coreTable = ctx.table.core;\n      const {\n        outbound,\n        extractKey\n      } = coreTable.schema.primaryKey;\n      const limit = this.db._options.modifyChunkSize || 200;\n      const totalFailures = [];\n      let successCount = 0;\n      const failedKeys = [];\n      const applyMutateResult = (expectedCount, res) => {\n        const {\n          failures,\n          numFailures\n        } = res;\n        successCount += expectedCount - numFailures;\n        for (let pos of keys(failures)) {\n          totalFailures.push(failures[pos]);\n        }\n      };\n      return this.clone().primaryKeys().then(keys => {\n        const nextChunk = offset => {\n          const count = Math.min(limit, keys.length - offset);\n          return coreTable.getMany({\n            trans,\n            keys: keys.slice(offset, offset + count),\n            cache: \"immutable\"\n          }).then(values => {\n            const addValues = [];\n            const putValues = [];\n            const putKeys = outbound ? [] : null;\n            const deleteKeys = [];\n            for (let i = 0; i < count; ++i) {\n              const origValue = values[i];\n              const ctx = {\n                value: deepClone(origValue),\n                primKey: keys[offset + i]\n              };\n              if (modifyer.call(ctx, ctx.value, ctx) !== false) {\n                if (ctx.value == null) {\n                  deleteKeys.push(keys[offset + i]);\n                } else if (!outbound && cmp(extractKey(origValue), extractKey(ctx.value)) !== 0) {\n                  deleteKeys.push(keys[offset + i]);\n                  addValues.push(ctx.value);\n                } else {\n                  putValues.push(ctx.value);\n                  if (outbound) putKeys.push(keys[offset + i]);\n                }\n              }\n            }\n            const criteria = isPlainKeyRange(ctx) && ctx.limit === Infinity && (typeof changes !== 'function' || changes === deleteCallback) && {\n              index: ctx.index,\n              range: ctx.range\n            };\n            return Promise.resolve(addValues.length > 0 && coreTable.mutate({\n              trans,\n              type: 'add',\n              values: addValues\n            }).then(res => {\n              for (let pos in res.failures) {\n                deleteKeys.splice(parseInt(pos), 1);\n              }\n              applyMutateResult(addValues.length, res);\n            })).then(() => (putValues.length > 0 || criteria && typeof changes === 'object') && coreTable.mutate({\n              trans,\n              type: 'put',\n              keys: putKeys,\n              values: putValues,\n              criteria,\n              changeSpec: typeof changes !== 'function' && changes\n            }).then(res => applyMutateResult(putValues.length, res))).then(() => (deleteKeys.length > 0 || criteria && changes === deleteCallback) && coreTable.mutate({\n              trans,\n              type: 'delete',\n              keys: deleteKeys,\n              criteria\n            }).then(res => applyMutateResult(deleteKeys.length, res))).then(() => {\n              return keys.length > offset + count && nextChunk(offset + limit);\n            });\n          });\n        };\n        return nextChunk(0).then(() => {\n          if (totalFailures.length > 0) throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys);\n          return keys.length;\n        });\n      });\n    });\n  }\n  delete() {\n    var ctx = this._ctx,\n      range = ctx.range;\n    if (isPlainKeyRange(ctx) && (ctx.isPrimKey && !hangsOnDeleteLargeKeyRange || range.type === 3)) {\n      return this._write(trans => {\n        const {\n          primaryKey\n        } = ctx.table.core.schema;\n        const coreRange = range;\n        return ctx.table.core.count({\n          trans,\n          query: {\n            index: primaryKey,\n            range: coreRange\n          }\n        }).then(count => {\n          return ctx.table.core.mutate({\n            trans,\n            type: 'deleteRange',\n            range: coreRange\n          }).then(({\n            failures,\n            lastResult,\n            results,\n            numFailures\n          }) => {\n            if (numFailures) throw new ModifyError(\"Could not delete some values\", Object.keys(failures).map(pos => failures[pos]), count - numFailures);\n            return count - numFailures;\n          });\n        });\n      });\n    }\n    return this.modify(deleteCallback);\n  }\n}\nconst deleteCallback = (value, ctx) => ctx.value = null;\nfunction createCollectionConstructor(db) {\n  return makeClassConstructor(Collection.prototype, function Collection(whereClause, keyRangeGenerator) {\n    this.db = db;\n    let keyRange = AnyRange,\n      error = null;\n    if (keyRangeGenerator) try {\n      keyRange = keyRangeGenerator();\n    } catch (ex) {\n      error = ex;\n    }\n    const whereCtx = whereClause._ctx;\n    const table = whereCtx.table;\n    const readingHook = table.hook.reading.fire;\n    this._ctx = {\n      table: table,\n      index: whereCtx.index,\n      isPrimKey: !whereCtx.index || table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name,\n      range: keyRange,\n      keysOnly: false,\n      dir: \"next\",\n      unique: \"\",\n      algorithm: null,\n      filter: null,\n      replayFilter: null,\n      justLimit: true,\n      isMatch: null,\n      offset: 0,\n      limit: Infinity,\n      error: error,\n      or: whereCtx.or,\n      valueMapper: readingHook !== mirror ? readingHook : null\n    };\n  });\n}\nfunction simpleCompare(a, b) {\n  return a < b ? -1 : a === b ? 0 : 1;\n}\nfunction simpleCompareReverse(a, b) {\n  return a > b ? -1 : a === b ? 0 : 1;\n}\nfunction fail(collectionOrWhereClause, err, T) {\n  var collection = collectionOrWhereClause instanceof WhereClause ? new collectionOrWhereClause.Collection(collectionOrWhereClause) : collectionOrWhereClause;\n  collection._ctx.error = T ? new T(err) : new TypeError(err);\n  return collection;\n}\nfunction emptyCollection(whereClause) {\n  return new whereClause.Collection(whereClause, () => rangeEqual(\"\")).limit(0);\n}\nfunction upperFactory(dir) {\n  return dir === \"next\" ? s => s.toUpperCase() : s => s.toLowerCase();\n}\nfunction lowerFactory(dir) {\n  return dir === \"next\" ? s => s.toLowerCase() : s => s.toUpperCase();\n}\nfunction nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n  var length = Math.min(key.length, lowerNeedle.length);\n  var llp = -1;\n  for (var i = 0; i < length; ++i) {\n    var lwrKeyChar = lowerKey[i];\n    if (lwrKeyChar !== lowerNeedle[i]) {\n      if (cmp(key[i], upperNeedle[i]) < 0) return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n      if (cmp(key[i], lowerNeedle[i]) < 0) return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n      if (llp >= 0) return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n      return null;\n    }\n    if (cmp(key[i], lwrKeyChar) < 0) llp = i;\n  }\n  if (length < lowerNeedle.length && dir === \"next\") return key + upperNeedle.substr(key.length);\n  if (length < key.length && dir === \"prev\") return key.substr(0, upperNeedle.length);\n  return llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1);\n}\nfunction addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n  var upper,\n    lower,\n    compare,\n    upperNeedles,\n    lowerNeedles,\n    direction,\n    nextKeySuffix,\n    needlesLen = needles.length;\n  if (!needles.every(s => typeof s === 'string')) {\n    return fail(whereClause, STRING_EXPECTED);\n  }\n  function initDirection(dir) {\n    upper = upperFactory(dir);\n    lower = lowerFactory(dir);\n    compare = dir === \"next\" ? simpleCompare : simpleCompareReverse;\n    var needleBounds = needles.map(function (needle) {\n      return {\n        lower: lower(needle),\n        upper: upper(needle)\n      };\n    }).sort(function (a, b) {\n      return compare(a.lower, b.lower);\n    });\n    upperNeedles = needleBounds.map(function (nb) {\n      return nb.upper;\n    });\n    lowerNeedles = needleBounds.map(function (nb) {\n      return nb.lower;\n    });\n    direction = dir;\n    nextKeySuffix = dir === \"next\" ? \"\" : suffix;\n  }\n  initDirection(\"next\");\n  var c = new whereClause.Collection(whereClause, () => createRange(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix));\n  c._ondirectionchange = function (direction) {\n    initDirection(direction);\n  };\n  var firstPossibleNeedle = 0;\n  c._addAlgorithm(function (cursor, advance, resolve) {\n    var key = cursor.key;\n    if (typeof key !== 'string') return false;\n    var lowerKey = lower(key);\n    if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n      return true;\n    } else {\n      var lowestPossibleCasing = null;\n      for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n        var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n        if (casing === null && lowestPossibleCasing === null) firstPossibleNeedle = i + 1;else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n          lowestPossibleCasing = casing;\n        }\n      }\n      if (lowestPossibleCasing !== null) {\n        advance(function () {\n          cursor.continue(lowestPossibleCasing + nextKeySuffix);\n        });\n      } else {\n        advance(resolve);\n      }\n      return false;\n    }\n  });\n  return c;\n}\nfunction createRange(lower, upper, lowerOpen, upperOpen) {\n  return {\n    type: 2,\n    lower,\n    upper,\n    lowerOpen,\n    upperOpen\n  };\n}\nfunction rangeEqual(value) {\n  return {\n    type: 1,\n    lower: value,\n    upper: value\n  };\n}\nclass WhereClause {\n  get Collection() {\n    return this._ctx.table.db.Collection;\n  }\n  between(lower, upper, includeLower, includeUpper) {\n    includeLower = includeLower !== false;\n    includeUpper = includeUpper === true;\n    try {\n      if (this._cmp(lower, upper) > 0 || this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)) return emptyCollection(this);\n      return new this.Collection(this, () => createRange(lower, upper, !includeLower, !includeUpper));\n    } catch (e) {\n      return fail(this, INVALID_KEY_ARGUMENT);\n    }\n  }\n  equals(value) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => rangeEqual(value));\n  }\n  above(value) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(value, undefined, true));\n  }\n  aboveOrEqual(value) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(value, undefined, false));\n  }\n  below(value) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(undefined, value, false, true));\n  }\n  belowOrEqual(value) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(undefined, value));\n  }\n  startsWith(str) {\n    if (typeof str !== 'string') return fail(this, STRING_EXPECTED);\n    return this.between(str, str + maxString, true, true);\n  }\n  startsWithIgnoreCase(str) {\n    if (str === \"\") return this.startsWith(str);\n    return addIgnoreCaseAlgorithm(this, (x, a) => x.indexOf(a[0]) === 0, [str], maxString);\n  }\n  equalsIgnoreCase(str) {\n    return addIgnoreCaseAlgorithm(this, (x, a) => x === a[0], [str], \"\");\n  }\n  anyOfIgnoreCase() {\n    var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    if (set.length === 0) return emptyCollection(this);\n    return addIgnoreCaseAlgorithm(this, (x, a) => a.indexOf(x) !== -1, set, \"\");\n  }\n  startsWithAnyOfIgnoreCase() {\n    var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    if (set.length === 0) return emptyCollection(this);\n    return addIgnoreCaseAlgorithm(this, (x, a) => a.some(n => x.indexOf(n) === 0), set, maxString);\n  }\n  anyOf() {\n    const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    let compare = this._cmp;\n    try {\n      set.sort(compare);\n    } catch (e) {\n      return fail(this, INVALID_KEY_ARGUMENT);\n    }\n    if (set.length === 0) return emptyCollection(this);\n    const c = new this.Collection(this, () => createRange(set[0], set[set.length - 1]));\n    c._ondirectionchange = direction => {\n      compare = direction === \"next\" ? this._ascending : this._descending;\n      set.sort(compare);\n    };\n    let i = 0;\n    c._addAlgorithm((cursor, advance, resolve) => {\n      const key = cursor.key;\n      while (compare(key, set[i]) > 0) {\n        ++i;\n        if (i === set.length) {\n          advance(resolve);\n          return false;\n        }\n      }\n      if (compare(key, set[i]) === 0) {\n        return true;\n      } else {\n        advance(() => {\n          cursor.continue(set[i]);\n        });\n        return false;\n      }\n    });\n    return c;\n  }\n  notEqual(value) {\n    return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], {\n      includeLowers: false,\n      includeUppers: false\n    });\n  }\n  noneOf() {\n    const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    if (set.length === 0) return new this.Collection(this);\n    try {\n      set.sort(this._ascending);\n    } catch (e) {\n      return fail(this, INVALID_KEY_ARGUMENT);\n    }\n    const ranges = set.reduce((res, val) => res ? res.concat([[res[res.length - 1][1], val]]) : [[minKey, val]], null);\n    ranges.push([set[set.length - 1], this.db._maxKey]);\n    return this.inAnyRange(ranges, {\n      includeLowers: false,\n      includeUppers: false\n    });\n  }\n  inAnyRange(ranges, options) {\n    const cmp = this._cmp,\n      ascending = this._ascending,\n      descending = this._descending,\n      min = this._min,\n      max = this._max;\n    if (ranges.length === 0) return emptyCollection(this);\n    if (!ranges.every(range => range[0] !== undefined && range[1] !== undefined && ascending(range[0], range[1]) <= 0)) {\n      return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n    }\n    const includeLowers = !options || options.includeLowers !== false;\n    const includeUppers = options && options.includeUppers === true;\n    function addRange(ranges, newRange) {\n      let i = 0,\n        l = ranges.length;\n      for (; i < l; ++i) {\n        const range = ranges[i];\n        if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n          range[0] = min(range[0], newRange[0]);\n          range[1] = max(range[1], newRange[1]);\n          break;\n        }\n      }\n      if (i === l) ranges.push(newRange);\n      return ranges;\n    }\n    let sortDirection = ascending;\n    function rangeSorter(a, b) {\n      return sortDirection(a[0], b[0]);\n    }\n    let set;\n    try {\n      set = ranges.reduce(addRange, []);\n      set.sort(rangeSorter);\n    } catch (ex) {\n      return fail(this, INVALID_KEY_ARGUMENT);\n    }\n    let rangePos = 0;\n    const keyIsBeyondCurrentEntry = includeUppers ? key => ascending(key, set[rangePos][1]) > 0 : key => ascending(key, set[rangePos][1]) >= 0;\n    const keyIsBeforeCurrentEntry = includeLowers ? key => descending(key, set[rangePos][0]) > 0 : key => descending(key, set[rangePos][0]) >= 0;\n    function keyWithinCurrentRange(key) {\n      return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n    }\n    let checkKey = keyIsBeyondCurrentEntry;\n    const c = new this.Collection(this, () => createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers));\n    c._ondirectionchange = direction => {\n      if (direction === \"next\") {\n        checkKey = keyIsBeyondCurrentEntry;\n        sortDirection = ascending;\n      } else {\n        checkKey = keyIsBeforeCurrentEntry;\n        sortDirection = descending;\n      }\n      set.sort(rangeSorter);\n    };\n    c._addAlgorithm((cursor, advance, resolve) => {\n      var key = cursor.key;\n      while (checkKey(key)) {\n        ++rangePos;\n        if (rangePos === set.length) {\n          advance(resolve);\n          return false;\n        }\n      }\n      if (keyWithinCurrentRange(key)) {\n        return true;\n      } else if (this._cmp(key, set[rangePos][1]) === 0 || this._cmp(key, set[rangePos][0]) === 0) {\n        return false;\n      } else {\n        advance(() => {\n          if (sortDirection === ascending) cursor.continue(set[rangePos][0]);else cursor.continue(set[rangePos][1]);\n        });\n        return false;\n      }\n    });\n    return c;\n  }\n  startsWithAnyOf() {\n    const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    if (!set.every(s => typeof s === 'string')) {\n      return fail(this, \"startsWithAnyOf() only works with strings\");\n    }\n    if (set.length === 0) return emptyCollection(this);\n    return this.inAnyRange(set.map(str => [str, str + maxString]));\n  }\n}\nfunction createWhereClauseConstructor(db) {\n  return makeClassConstructor(WhereClause.prototype, function WhereClause(table, index, orCollection) {\n    this.db = db;\n    this._ctx = {\n      table: table,\n      index: index === \":id\" ? null : index,\n      or: orCollection\n    };\n    const indexedDB = db._deps.indexedDB;\n    if (!indexedDB) throw new exceptions.MissingAPI();\n    this._cmp = this._ascending = indexedDB.cmp.bind(indexedDB);\n    this._descending = (a, b) => indexedDB.cmp(b, a);\n    this._max = (a, b) => indexedDB.cmp(a, b) > 0 ? a : b;\n    this._min = (a, b) => indexedDB.cmp(a, b) < 0 ? a : b;\n    this._IDBKeyRange = db._deps.IDBKeyRange;\n  });\n}\nfunction eventRejectHandler(reject) {\n  return wrap(function (event) {\n    preventDefault(event);\n    reject(event.target.error);\n    return false;\n  });\n}\nfunction preventDefault(event) {\n  if (event.stopPropagation) event.stopPropagation();\n  if (event.preventDefault) event.preventDefault();\n}\nconst DEXIE_STORAGE_MUTATED_EVENT_NAME = 'storagemutated';\nconst STORAGE_MUTATED_DOM_EVENT_NAME = 'x-storagemutated-1';\nconst globalEvents = Events(null, DEXIE_STORAGE_MUTATED_EVENT_NAME);\nclass Transaction {\n  _lock() {\n    assert(!PSD.global);\n    ++this._reculock;\n    if (this._reculock === 1 && !PSD.global) PSD.lockOwnerFor = this;\n    return this;\n  }\n  _unlock() {\n    assert(!PSD.global);\n    if (--this._reculock === 0) {\n      if (!PSD.global) PSD.lockOwnerFor = null;\n      while (this._blockedFuncs.length > 0 && !this._locked()) {\n        var fnAndPSD = this._blockedFuncs.shift();\n        try {\n          usePSD(fnAndPSD[1], fnAndPSD[0]);\n        } catch (e) {}\n      }\n    }\n    return this;\n  }\n  _locked() {\n    return this._reculock && PSD.lockOwnerFor !== this;\n  }\n  create(idbtrans) {\n    if (!this.mode) return this;\n    const idbdb = this.db.idbdb;\n    const dbOpenError = this.db._state.dbOpenError;\n    assert(!this.idbtrans);\n    if (!idbtrans && !idbdb) {\n      switch (dbOpenError && dbOpenError.name) {\n        case \"DatabaseClosedError\":\n          throw new exceptions.DatabaseClosed(dbOpenError);\n        case \"MissingAPIError\":\n          throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n        default:\n          throw new exceptions.OpenFailed(dbOpenError);\n      }\n    }\n    if (!this.active) throw new exceptions.TransactionInactive();\n    assert(this._completion._state === null);\n    idbtrans = this.idbtrans = idbtrans || (this.db.core ? this.db.core.transaction(this.storeNames, this.mode, {\n      durability: this.chromeTransactionDurability\n    }) : idbdb.transaction(this.storeNames, this.mode, {\n      durability: this.chromeTransactionDurability\n    }));\n    idbtrans.onerror = wrap(ev => {\n      preventDefault(ev);\n      this._reject(idbtrans.error);\n    });\n    idbtrans.onabort = wrap(ev => {\n      preventDefault(ev);\n      this.active && this._reject(new exceptions.Abort(idbtrans.error));\n      this.active = false;\n      this.on(\"abort\").fire(ev);\n    });\n    idbtrans.oncomplete = wrap(() => {\n      this.active = false;\n      this._resolve();\n      if ('mutatedParts' in idbtrans) {\n        globalEvents.storagemutated.fire(idbtrans[\"mutatedParts\"]);\n      }\n    });\n    return this;\n  }\n  _promise(mode, fn, bWriteLock) {\n    if (mode === 'readwrite' && this.mode !== 'readwrite') return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n    if (!this.active) return rejection(new exceptions.TransactionInactive());\n    if (this._locked()) {\n      return new DexiePromise((resolve, reject) => {\n        this._blockedFuncs.push([() => {\n          this._promise(mode, fn, bWriteLock).then(resolve, reject);\n        }, PSD]);\n      });\n    } else if (bWriteLock) {\n      return newScope(() => {\n        var p = new DexiePromise((resolve, reject) => {\n          this._lock();\n          const rv = fn(resolve, reject, this);\n          if (rv && rv.then) rv.then(resolve, reject);\n        });\n        p.finally(() => this._unlock());\n        p._lib = true;\n        return p;\n      });\n    } else {\n      var p = new DexiePromise((resolve, reject) => {\n        var rv = fn(resolve, reject, this);\n        if (rv && rv.then) rv.then(resolve, reject);\n      });\n      p._lib = true;\n      return p;\n    }\n  }\n  _root() {\n    return this.parent ? this.parent._root() : this;\n  }\n  waitFor(promiseLike) {\n    var root = this._root();\n    const promise = DexiePromise.resolve(promiseLike);\n    if (root._waitingFor) {\n      root._waitingFor = root._waitingFor.then(() => promise);\n    } else {\n      root._waitingFor = promise;\n      root._waitingQueue = [];\n      var store = root.idbtrans.objectStore(root.storeNames[0]);\n      (function spin() {\n        ++root._spinCount;\n        while (root._waitingQueue.length) root._waitingQueue.shift()();\n        if (root._waitingFor) store.get(-Infinity).onsuccess = spin;\n      })();\n    }\n    var currentWaitPromise = root._waitingFor;\n    return new DexiePromise((resolve, reject) => {\n      promise.then(res => root._waitingQueue.push(wrap(resolve.bind(null, res))), err => root._waitingQueue.push(wrap(reject.bind(null, err)))).finally(() => {\n        if (root._waitingFor === currentWaitPromise) {\n          root._waitingFor = null;\n        }\n      });\n    });\n  }\n  abort() {\n    if (this.active) {\n      this.active = false;\n      if (this.idbtrans) this.idbtrans.abort();\n      this._reject(new exceptions.Abort());\n    }\n  }\n  table(tableName) {\n    const memoizedTables = this._memoizedTables || (this._memoizedTables = {});\n    if (hasOwn(memoizedTables, tableName)) return memoizedTables[tableName];\n    const tableSchema = this.schema[tableName];\n    if (!tableSchema) {\n      throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n    }\n    const transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n    transactionBoundTable.core = this.db.core.table(tableName);\n    memoizedTables[tableName] = transactionBoundTable;\n    return transactionBoundTable;\n  }\n}\nfunction createTransactionConstructor(db) {\n  return makeClassConstructor(Transaction.prototype, function Transaction(mode, storeNames, dbschema, chromeTransactionDurability, parent) {\n    this.db = db;\n    this.mode = mode;\n    this.storeNames = storeNames;\n    this.schema = dbschema;\n    this.chromeTransactionDurability = chromeTransactionDurability;\n    this.idbtrans = null;\n    this.on = Events(this, \"complete\", \"error\", \"abort\");\n    this.parent = parent || null;\n    this.active = true;\n    this._reculock = 0;\n    this._blockedFuncs = [];\n    this._resolve = null;\n    this._reject = null;\n    this._waitingFor = null;\n    this._waitingQueue = null;\n    this._spinCount = 0;\n    this._completion = new DexiePromise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n    this._completion.then(() => {\n      this.active = false;\n      this.on.complete.fire();\n    }, e => {\n      var wasActive = this.active;\n      this.active = false;\n      this.on.error.fire(e);\n      this.parent ? this.parent._reject(e) : wasActive && this.idbtrans && this.idbtrans.abort();\n      return rejection(e);\n    });\n  });\n}\nfunction createIndexSpec(name, keyPath, unique, multi, auto, compound, isPrimKey) {\n  return {\n    name,\n    keyPath,\n    unique,\n    multi,\n    auto,\n    compound,\n    src: (unique && !isPrimKey ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath)\n  };\n}\nfunction nameFromKeyPath(keyPath) {\n  return typeof keyPath === 'string' ? keyPath : keyPath ? '[' + [].join.call(keyPath, '+') + ']' : \"\";\n}\nfunction createTableSchema(name, primKey, indexes) {\n  return {\n    name,\n    primKey,\n    indexes,\n    mappedClass: null,\n    idxByName: arrayToObject(indexes, index => [index.name, index])\n  };\n}\nfunction safariMultiStoreFix(storeNames) {\n  return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\nlet getMaxKey = IdbKeyRange => {\n  try {\n    IdbKeyRange.only([[]]);\n    getMaxKey = () => [[]];\n    return [[]];\n  } catch (e) {\n    getMaxKey = () => maxString;\n    return maxString;\n  }\n};\nfunction getKeyExtractor(keyPath) {\n  if (keyPath == null) {\n    return () => undefined;\n  } else if (typeof keyPath === 'string') {\n    return getSinglePathKeyExtractor(keyPath);\n  } else {\n    return obj => getByKeyPath(obj, keyPath);\n  }\n}\nfunction getSinglePathKeyExtractor(keyPath) {\n  const split = keyPath.split('.');\n  if (split.length === 1) {\n    return obj => obj[keyPath];\n  } else {\n    return obj => getByKeyPath(obj, keyPath);\n  }\n}\nfunction arrayify(arrayLike) {\n  return [].slice.call(arrayLike);\n}\nlet _id_counter = 0;\nfunction getKeyPathAlias(keyPath) {\n  return keyPath == null ? \":id\" : typeof keyPath === 'string' ? keyPath : `[${keyPath.join('+')}]`;\n}\nfunction createDBCore(db, IdbKeyRange, tmpTrans) {\n  function extractSchema(db, trans) {\n    const tables = arrayify(db.objectStoreNames);\n    return {\n      schema: {\n        name: db.name,\n        tables: tables.map(table => trans.objectStore(table)).map(store => {\n          const {\n            keyPath,\n            autoIncrement\n          } = store;\n          const compound = isArray(keyPath);\n          const outbound = keyPath == null;\n          const indexByKeyPath = {};\n          const result = {\n            name: store.name,\n            primaryKey: {\n              name: null,\n              isPrimaryKey: true,\n              outbound,\n              compound,\n              keyPath,\n              autoIncrement,\n              unique: true,\n              extractKey: getKeyExtractor(keyPath)\n            },\n            indexes: arrayify(store.indexNames).map(indexName => store.index(indexName)).map(index => {\n              const {\n                name,\n                unique,\n                multiEntry,\n                keyPath\n              } = index;\n              const compound = isArray(keyPath);\n              const result = {\n                name,\n                compound,\n                keyPath,\n                unique,\n                multiEntry,\n                extractKey: getKeyExtractor(keyPath)\n              };\n              indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n              return result;\n            }),\n            getIndexByKeyPath: keyPath => indexByKeyPath[getKeyPathAlias(keyPath)]\n          };\n          indexByKeyPath[\":id\"] = result.primaryKey;\n          if (keyPath != null) {\n            indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n          }\n          return result;\n        })\n      },\n      hasGetAll: tables.length > 0 && 'getAll' in trans.objectStore(tables[0]) && !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) && !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) && [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n    };\n  }\n  function makeIDBKeyRange(range) {\n    if (range.type === 3) return null;\n    if (range.type === 4) throw new Error(\"Cannot convert never type to IDBKeyRange\");\n    const {\n      lower,\n      upper,\n      lowerOpen,\n      upperOpen\n    } = range;\n    const idbRange = lower === undefined ? upper === undefined ? null : IdbKeyRange.upperBound(upper, !!upperOpen) : upper === undefined ? IdbKeyRange.lowerBound(lower, !!lowerOpen) : IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n    return idbRange;\n  }\n  function createDbCoreTable(tableSchema) {\n    const tableName = tableSchema.name;\n    function mutate({\n      trans,\n      type,\n      keys,\n      values,\n      range\n    }) {\n      return new Promise((resolve, reject) => {\n        resolve = wrap(resolve);\n        const store = trans.objectStore(tableName);\n        const outbound = store.keyPath == null;\n        const isAddOrPut = type === \"put\" || type === \"add\";\n        if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange') throw new Error(\"Invalid operation type: \" + type);\n        const {\n          length\n        } = keys || values || {\n          length: 1\n        };\n        if (keys && values && keys.length !== values.length) {\n          throw new Error(\"Given keys array must have same length as given values array.\");\n        }\n        if (length === 0) return resolve({\n          numFailures: 0,\n          failures: {},\n          results: [],\n          lastResult: undefined\n        });\n        let req;\n        const reqs = [];\n        const failures = [];\n        let numFailures = 0;\n        const errorHandler = event => {\n          ++numFailures;\n          preventDefault(event);\n        };\n        if (type === 'deleteRange') {\n          if (range.type === 4) return resolve({\n            numFailures,\n            failures,\n            results: [],\n            lastResult: undefined\n          });\n          if (range.type === 3) reqs.push(req = store.clear());else reqs.push(req = store.delete(makeIDBKeyRange(range)));\n        } else {\n          const [args1, args2] = isAddOrPut ? outbound ? [values, keys] : [values, null] : [keys, null];\n          if (isAddOrPut) {\n            for (let i = 0; i < length; ++i) {\n              reqs.push(req = args2 && args2[i] !== undefined ? store[type](args1[i], args2[i]) : store[type](args1[i]));\n              req.onerror = errorHandler;\n            }\n          } else {\n            for (let i = 0; i < length; ++i) {\n              reqs.push(req = store[type](args1[i]));\n              req.onerror = errorHandler;\n            }\n          }\n        }\n        const done = event => {\n          const lastResult = event.target.result;\n          reqs.forEach((req, i) => req.error != null && (failures[i] = req.error));\n          resolve({\n            numFailures,\n            failures,\n            results: type === \"delete\" ? keys : reqs.map(req => req.result),\n            lastResult\n          });\n        };\n        req.onerror = event => {\n          errorHandler(event);\n          done(event);\n        };\n        req.onsuccess = done;\n      });\n    }\n    function openCursor({\n      trans,\n      values,\n      query,\n      reverse,\n      unique\n    }) {\n      return new Promise((resolve, reject) => {\n        resolve = wrap(resolve);\n        const {\n          index,\n          range\n        } = query;\n        const store = trans.objectStore(tableName);\n        const source = index.isPrimaryKey ? store : store.index(index.name);\n        const direction = reverse ? unique ? \"prevunique\" : \"prev\" : unique ? \"nextunique\" : \"next\";\n        const req = values || !('openKeyCursor' in source) ? source.openCursor(makeIDBKeyRange(range), direction) : source.openKeyCursor(makeIDBKeyRange(range), direction);\n        req.onerror = eventRejectHandler(reject);\n        req.onsuccess = wrap(ev => {\n          const cursor = req.result;\n          if (!cursor) {\n            resolve(null);\n            return;\n          }\n          cursor.___id = ++_id_counter;\n          cursor.done = false;\n          const _cursorContinue = cursor.continue.bind(cursor);\n          let _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n          if (_cursorContinuePrimaryKey) _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n          const _cursorAdvance = cursor.advance.bind(cursor);\n          const doThrowCursorIsNotStarted = () => {\n            throw new Error(\"Cursor not started\");\n          };\n          const doThrowCursorIsStopped = () => {\n            throw new Error(\"Cursor not stopped\");\n          };\n          cursor.trans = trans;\n          cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n          cursor.fail = wrap(reject);\n          cursor.next = function () {\n            let gotOne = 1;\n            return this.start(() => gotOne-- ? this.continue() : this.stop()).then(() => this);\n          };\n          cursor.start = callback => {\n            const iterationPromise = new Promise((resolveIteration, rejectIteration) => {\n              resolveIteration = wrap(resolveIteration);\n              req.onerror = eventRejectHandler(rejectIteration);\n              cursor.fail = rejectIteration;\n              cursor.stop = value => {\n                cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                resolveIteration(value);\n              };\n            });\n            const guardedCallback = () => {\n              if (req.result) {\n                try {\n                  callback();\n                } catch (err) {\n                  cursor.fail(err);\n                }\n              } else {\n                cursor.done = true;\n                cursor.start = () => {\n                  throw new Error(\"Cursor behind last entry\");\n                };\n                cursor.stop();\n              }\n            };\n            req.onsuccess = wrap(ev => {\n              req.onsuccess = guardedCallback;\n              guardedCallback();\n            });\n            cursor.continue = _cursorContinue;\n            cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n            cursor.advance = _cursorAdvance;\n            guardedCallback();\n            return iterationPromise;\n          };\n          resolve(cursor);\n        }, reject);\n      });\n    }\n    function query(hasGetAll) {\n      return request => {\n        return new Promise((resolve, reject) => {\n          resolve = wrap(resolve);\n          const {\n            trans,\n            values,\n            limit,\n            query\n          } = request;\n          const nonInfinitLimit = limit === Infinity ? undefined : limit;\n          const {\n            index,\n            range\n          } = query;\n          const store = trans.objectStore(tableName);\n          const source = index.isPrimaryKey ? store : store.index(index.name);\n          const idbKeyRange = makeIDBKeyRange(range);\n          if (limit === 0) return resolve({\n            result: []\n          });\n          if (hasGetAll) {\n            const req = values ? source.getAll(idbKeyRange, nonInfinitLimit) : source.getAllKeys(idbKeyRange, nonInfinitLimit);\n            req.onsuccess = event => resolve({\n              result: event.target.result\n            });\n            req.onerror = eventRejectHandler(reject);\n          } else {\n            let count = 0;\n            const req = values || !('openKeyCursor' in source) ? source.openCursor(idbKeyRange) : source.openKeyCursor(idbKeyRange);\n            const result = [];\n            req.onsuccess = event => {\n              const cursor = req.result;\n              if (!cursor) return resolve({\n                result\n              });\n              result.push(values ? cursor.value : cursor.primaryKey);\n              if (++count === limit) return resolve({\n                result\n              });\n              cursor.continue();\n            };\n            req.onerror = eventRejectHandler(reject);\n          }\n        });\n      };\n    }\n    return {\n      name: tableName,\n      schema: tableSchema,\n      mutate,\n      getMany({\n        trans,\n        keys\n      }) {\n        return new Promise((resolve, reject) => {\n          resolve = wrap(resolve);\n          const store = trans.objectStore(tableName);\n          const length = keys.length;\n          const result = new Array(length);\n          let keyCount = 0;\n          let callbackCount = 0;\n          let req;\n          const successHandler = event => {\n            const req = event.target;\n            if ((result[req._pos] = req.result) != null) ;\n            if (++callbackCount === keyCount) resolve(result);\n          };\n          const errorHandler = eventRejectHandler(reject);\n          for (let i = 0; i < length; ++i) {\n            const key = keys[i];\n            if (key != null) {\n              req = store.get(keys[i]);\n              req._pos = i;\n              req.onsuccess = successHandler;\n              req.onerror = errorHandler;\n              ++keyCount;\n            }\n          }\n          if (keyCount === 0) resolve(result);\n        });\n      },\n      get({\n        trans,\n        key\n      }) {\n        return new Promise((resolve, reject) => {\n          resolve = wrap(resolve);\n          const store = trans.objectStore(tableName);\n          const req = store.get(key);\n          req.onsuccess = event => resolve(event.target.result);\n          req.onerror = eventRejectHandler(reject);\n        });\n      },\n      query: query(hasGetAll),\n      openCursor,\n      count({\n        query,\n        trans\n      }) {\n        const {\n          index,\n          range\n        } = query;\n        return new Promise((resolve, reject) => {\n          const store = trans.objectStore(tableName);\n          const source = index.isPrimaryKey ? store : store.index(index.name);\n          const idbKeyRange = makeIDBKeyRange(range);\n          const req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n          req.onsuccess = wrap(ev => resolve(ev.target.result));\n          req.onerror = eventRejectHandler(reject);\n        });\n      }\n    };\n  }\n  const {\n    schema,\n    hasGetAll\n  } = extractSchema(db, tmpTrans);\n  const tables = schema.tables.map(tableSchema => createDbCoreTable(tableSchema));\n  const tableMap = {};\n  tables.forEach(table => tableMap[table.name] = table);\n  return {\n    stack: \"dbcore\",\n    transaction: db.transaction.bind(db),\n    table(name) {\n      const result = tableMap[name];\n      if (!result) throw new Error(`Table '${name}' not found`);\n      return tableMap[name];\n    },\n    MIN_KEY: -Infinity,\n    MAX_KEY: getMaxKey(IdbKeyRange),\n    schema\n  };\n}\nfunction createMiddlewareStack(stackImpl, middlewares) {\n  return middlewares.reduce((down, {\n    create\n  }) => ({\n    ...down,\n    ...create(down)\n  }), stackImpl);\n}\nfunction createMiddlewareStacks(middlewares, idbdb, {\n  IDBKeyRange,\n  indexedDB\n}, tmpTrans) {\n  const dbcore = createMiddlewareStack(createDBCore(idbdb, IDBKeyRange, tmpTrans), middlewares.dbcore);\n  return {\n    dbcore\n  };\n}\nfunction generateMiddlewareStacks({\n  _novip: db\n}, tmpTrans) {\n  const idbdb = tmpTrans.db;\n  const stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n  db.core = stacks.dbcore;\n  db.tables.forEach(table => {\n    const tableName = table.name;\n    if (db.core.schema.tables.some(tbl => tbl.name === tableName)) {\n      table.core = db.core.table(tableName);\n      if (db[tableName] instanceof db.Table) {\n        db[tableName].core = table.core;\n      }\n    }\n  });\n}\nfunction setApiOnPlace({\n  _novip: db\n}, objs, tableNames, dbschema) {\n  tableNames.forEach(tableName => {\n    const schema = dbschema[tableName];\n    objs.forEach(obj => {\n      const propDesc = getPropertyDescriptor(obj, tableName);\n      if (!propDesc || \"value\" in propDesc && propDesc.value === undefined) {\n        if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n          setProp(obj, tableName, {\n            get() {\n              return this.table(tableName);\n            },\n            set(value) {\n              defineProperty(this, tableName, {\n                value,\n                writable: true,\n                configurable: true,\n                enumerable: true\n              });\n            }\n          });\n        } else {\n          obj[tableName] = new db.Table(tableName, schema);\n        }\n      }\n    });\n  });\n}\nfunction removeTablesApi({\n  _novip: db\n}, objs) {\n  objs.forEach(obj => {\n    for (let key in obj) {\n      if (obj[key] instanceof db.Table) delete obj[key];\n    }\n  });\n}\nfunction lowerVersionFirst(a, b) {\n  return a._cfg.version - b._cfg.version;\n}\nfunction runUpgraders(db, oldVersion, idbUpgradeTrans, reject) {\n  const globalSchema = db._dbSchema;\n  const trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n  trans.create(idbUpgradeTrans);\n  trans._completion.catch(reject);\n  const rejectTransaction = trans._reject.bind(trans);\n  const transless = PSD.transless || PSD;\n  newScope(() => {\n    PSD.trans = trans;\n    PSD.transless = transless;\n    if (oldVersion === 0) {\n      keys(globalSchema).forEach(tableName => {\n        createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n      });\n      generateMiddlewareStacks(db, idbUpgradeTrans);\n      DexiePromise.follow(() => db.on.populate.fire(trans)).catch(rejectTransaction);\n    } else updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans).catch(rejectTransaction);\n  });\n}\nfunction updateTablesAndIndexes({\n  _novip: db\n}, oldVersion, trans, idbUpgradeTrans) {\n  const queue = [];\n  const versions = db._versions;\n  let globalSchema = db._dbSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n  let anyContentUpgraderHasRun = false;\n  const versToRun = versions.filter(v => v._cfg.version >= oldVersion);\n  versToRun.forEach(version => {\n    queue.push(() => {\n      const oldSchema = globalSchema;\n      const newSchema = version._cfg.dbschema;\n      adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n      adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n      globalSchema = db._dbSchema = newSchema;\n      const diff = getSchemaDiff(oldSchema, newSchema);\n      diff.add.forEach(tuple => {\n        createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n      });\n      diff.change.forEach(change => {\n        if (change.recreate) {\n          throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n        } else {\n          const store = idbUpgradeTrans.objectStore(change.name);\n          change.add.forEach(idx => addIndex(store, idx));\n          change.change.forEach(idx => {\n            store.deleteIndex(idx.name);\n            addIndex(store, idx);\n          });\n          change.del.forEach(idxName => store.deleteIndex(idxName));\n        }\n      });\n      const contentUpgrade = version._cfg.contentUpgrade;\n      if (contentUpgrade && version._cfg.version > oldVersion) {\n        generateMiddlewareStacks(db, idbUpgradeTrans);\n        trans._memoizedTables = {};\n        anyContentUpgraderHasRun = true;\n        let upgradeSchema = shallowClone(newSchema);\n        diff.del.forEach(table => {\n          upgradeSchema[table] = oldSchema[table];\n        });\n        removeTablesApi(db, [db.Transaction.prototype]);\n        setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema), upgradeSchema);\n        trans.schema = upgradeSchema;\n        const contentUpgradeIsAsync = isAsyncFunction(contentUpgrade);\n        if (contentUpgradeIsAsync) {\n          incrementExpectedAwaits();\n        }\n        let returnValue;\n        const promiseFollowed = DexiePromise.follow(() => {\n          returnValue = contentUpgrade(trans);\n          if (returnValue) {\n            if (contentUpgradeIsAsync) {\n              var decrementor = decrementExpectedAwaits.bind(null, null);\n              returnValue.then(decrementor, decrementor);\n            }\n          }\n        });\n        return returnValue && typeof returnValue.then === 'function' ? DexiePromise.resolve(returnValue) : promiseFollowed.then(() => returnValue);\n      }\n    });\n    queue.push(idbtrans => {\n      if (!anyContentUpgraderHasRun || !hasIEDeleteObjectStoreBug) {\n        const newSchema = version._cfg.dbschema;\n        deleteRemovedTables(newSchema, idbtrans);\n      }\n      removeTablesApi(db, [db.Transaction.prototype]);\n      setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n      trans.schema = db._dbSchema;\n    });\n  });\n  function runQueue() {\n    return queue.length ? DexiePromise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) : DexiePromise.resolve();\n  }\n  return runQueue().then(() => {\n    createMissingTables(globalSchema, idbUpgradeTrans);\n  });\n}\nfunction getSchemaDiff(oldSchema, newSchema) {\n  const diff = {\n    del: [],\n    add: [],\n    change: []\n  };\n  let table;\n  for (table in oldSchema) {\n    if (!newSchema[table]) diff.del.push(table);\n  }\n  for (table in newSchema) {\n    const oldDef = oldSchema[table],\n      newDef = newSchema[table];\n    if (!oldDef) {\n      diff.add.push([table, newDef]);\n    } else {\n      const change = {\n        name: table,\n        def: newDef,\n        recreate: false,\n        del: [],\n        add: [],\n        change: []\n      };\n      if ('' + (oldDef.primKey.keyPath || '') !== '' + (newDef.primKey.keyPath || '') || oldDef.primKey.auto !== newDef.primKey.auto && !isIEOrEdge) {\n        change.recreate = true;\n        diff.change.push(change);\n      } else {\n        const oldIndexes = oldDef.idxByName;\n        const newIndexes = newDef.idxByName;\n        let idxName;\n        for (idxName in oldIndexes) {\n          if (!newIndexes[idxName]) change.del.push(idxName);\n        }\n        for (idxName in newIndexes) {\n          const oldIdx = oldIndexes[idxName],\n            newIdx = newIndexes[idxName];\n          if (!oldIdx) change.add.push(newIdx);else if (oldIdx.src !== newIdx.src) change.change.push(newIdx);\n        }\n        if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n          diff.change.push(change);\n        }\n      }\n    }\n  }\n  return diff;\n}\nfunction createTable(idbtrans, tableName, primKey, indexes) {\n  const store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ? {\n    keyPath: primKey.keyPath,\n    autoIncrement: primKey.auto\n  } : {\n    autoIncrement: primKey.auto\n  });\n  indexes.forEach(idx => addIndex(store, idx));\n  return store;\n}\nfunction createMissingTables(newSchema, idbtrans) {\n  keys(newSchema).forEach(tableName => {\n    if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n      createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n    }\n  });\n}\nfunction deleteRemovedTables(newSchema, idbtrans) {\n  [].slice.call(idbtrans.db.objectStoreNames).forEach(storeName => newSchema[storeName] == null && idbtrans.db.deleteObjectStore(storeName));\n}\nfunction addIndex(store, idx) {\n  store.createIndex(idx.name, idx.keyPath, {\n    unique: idx.unique,\n    multiEntry: idx.multi\n  });\n}\nfunction buildGlobalSchema(db, idbdb, tmpTrans) {\n  const globalSchema = {};\n  const dbStoreNames = slice(idbdb.objectStoreNames, 0);\n  dbStoreNames.forEach(storeName => {\n    const store = tmpTrans.objectStore(storeName);\n    let keyPath = store.keyPath;\n    const primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", false, false, !!store.autoIncrement, keyPath && typeof keyPath !== \"string\", true);\n    const indexes = [];\n    for (let j = 0; j < store.indexNames.length; ++j) {\n      const idbindex = store.index(store.indexNames[j]);\n      keyPath = idbindex.keyPath;\n      var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== \"string\", false);\n      indexes.push(index);\n    }\n    globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n  });\n  return globalSchema;\n}\nfunction readGlobalSchema({\n  _novip: db\n}, idbdb, tmpTrans) {\n  db.verno = idbdb.version / 10;\n  const globalSchema = db._dbSchema = buildGlobalSchema(db, idbdb, tmpTrans);\n  db._storeNames = slice(idbdb.objectStoreNames, 0);\n  setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n}\nfunction verifyInstalledSchema(db, tmpTrans) {\n  const installedSchema = buildGlobalSchema(db, db.idbdb, tmpTrans);\n  const diff = getSchemaDiff(installedSchema, db._dbSchema);\n  return !(diff.add.length || diff.change.some(ch => ch.add.length || ch.change.length));\n}\nfunction adjustToExistingIndexNames({\n  _novip: db\n}, schema, idbtrans) {\n  const storeNames = idbtrans.db.objectStoreNames;\n  for (let i = 0; i < storeNames.length; ++i) {\n    const storeName = storeNames[i];\n    const store = idbtrans.objectStore(storeName);\n    db._hasGetAll = 'getAll' in store;\n    for (let j = 0; j < store.indexNames.length; ++j) {\n      const indexName = store.indexNames[j];\n      const keyPath = store.index(indexName).keyPath;\n      const dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n      if (schema[storeName]) {\n        const indexSpec = schema[storeName].idxByName[dexieName];\n        if (indexSpec) {\n          indexSpec.name = indexName;\n          delete schema[storeName].idxByName[dexieName];\n          schema[storeName].idxByName[indexName] = indexSpec;\n        }\n      }\n    }\n  }\n  if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) && !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) && _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope && [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n    db._hasGetAll = false;\n  }\n}\nfunction parseIndexSyntax(primKeyAndIndexes) {\n  return primKeyAndIndexes.split(',').map((index, indexNum) => {\n    index = index.trim();\n    const name = index.replace(/([&*]|\\+\\+)/g, \"\");\n    const keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n    return createIndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), indexNum === 0);\n  });\n}\nclass Version {\n  _parseStoresSpec(stores, outSchema) {\n    keys(stores).forEach(tableName => {\n      if (stores[tableName] !== null) {\n        var indexes = parseIndexSyntax(stores[tableName]);\n        var primKey = indexes.shift();\n        if (primKey.multi) throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n        indexes.forEach(idx => {\n          if (idx.auto) throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n          if (!idx.keyPath) throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n        });\n        outSchema[tableName] = createTableSchema(tableName, primKey, indexes);\n      }\n    });\n  }\n  stores(stores) {\n    const db = this.db;\n    this._cfg.storesSource = this._cfg.storesSource ? extend(this._cfg.storesSource, stores) : stores;\n    const versions = db._versions;\n    const storesSpec = {};\n    let dbschema = {};\n    versions.forEach(version => {\n      extend(storesSpec, version._cfg.storesSource);\n      dbschema = version._cfg.dbschema = {};\n      version._parseStoresSpec(storesSpec, dbschema);\n    });\n    db._dbSchema = dbschema;\n    removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n    setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n    db._storeNames = keys(dbschema);\n    return this;\n  }\n  upgrade(upgradeFunction) {\n    this._cfg.contentUpgrade = promisableChain(this._cfg.contentUpgrade || nop, upgradeFunction);\n    return this;\n  }\n}\nfunction createVersionConstructor(db) {\n  return makeClassConstructor(Version.prototype, function Version(versionNumber) {\n    this.db = db;\n    this._cfg = {\n      version: versionNumber,\n      storesSource: null,\n      dbschema: {},\n      tables: {},\n      contentUpgrade: null\n    };\n  });\n}\nfunction getDbNamesTable(indexedDB, IDBKeyRange) {\n  let dbNamesDB = indexedDB[\"_dbNamesDB\"];\n  if (!dbNamesDB) {\n    dbNamesDB = indexedDB[\"_dbNamesDB\"] = new Dexie$1(DBNAMES_DB, {\n      addons: [],\n      indexedDB,\n      IDBKeyRange\n    });\n    dbNamesDB.version(1).stores({\n      dbnames: \"name\"\n    });\n  }\n  return dbNamesDB.table(\"dbnames\");\n}\nfunction hasDatabasesNative(indexedDB) {\n  return indexedDB && typeof indexedDB.databases === \"function\";\n}\nfunction getDatabaseNames({\n  indexedDB,\n  IDBKeyRange\n}) {\n  return hasDatabasesNative(indexedDB) ? Promise.resolve(indexedDB.databases()).then(infos => infos.map(info => info.name).filter(name => name !== DBNAMES_DB)) : getDbNamesTable(indexedDB, IDBKeyRange).toCollection().primaryKeys();\n}\nfunction _onDatabaseCreated({\n  indexedDB,\n  IDBKeyRange\n}, name) {\n  !hasDatabasesNative(indexedDB) && name !== DBNAMES_DB && getDbNamesTable(indexedDB, IDBKeyRange).put({\n    name\n  }).catch(nop);\n}\nfunction _onDatabaseDeleted({\n  indexedDB,\n  IDBKeyRange\n}, name) {\n  !hasDatabasesNative(indexedDB) && name !== DBNAMES_DB && getDbNamesTable(indexedDB, IDBKeyRange).delete(name).catch(nop);\n}\nfunction vip(fn) {\n  return newScope(function () {\n    PSD.letThrough = true;\n    return fn();\n  });\n}\nfunction idbReady() {\n  var isSafari = !navigator.userAgentData && /Safari\\//.test(navigator.userAgent) && !/Chrom(e|ium)\\//.test(navigator.userAgent);\n  if (!isSafari || !indexedDB.databases) return Promise.resolve();\n  var intervalId;\n  return new Promise(function (resolve) {\n    var tryIdb = function () {\n      return indexedDB.databases().finally(resolve);\n    };\n    intervalId = setInterval(tryIdb, 100);\n    tryIdb();\n  }).finally(function () {\n    return clearInterval(intervalId);\n  });\n}\nfunction dexieOpen(db) {\n  const state = db._state;\n  const {\n    indexedDB\n  } = db._deps;\n  if (state.isBeingOpened || db.idbdb) return state.dbReadyPromise.then(() => state.dbOpenError ? rejection(state.dbOpenError) : db);\n  debug && (state.openCanceller._stackHolder = getErrorWithStack());\n  state.isBeingOpened = true;\n  state.dbOpenError = null;\n  state.openComplete = false;\n  const openCanceller = state.openCanceller;\n  function throwIfCancelled() {\n    if (state.openCanceller !== openCanceller) throw new exceptions.DatabaseClosed('db.open() was cancelled');\n  }\n  let resolveDbReady = state.dbReadyResolve,\n    upgradeTransaction = null,\n    wasCreated = false;\n  const tryOpenDB = () => new DexiePromise((resolve, reject) => {\n    throwIfCancelled();\n    if (!indexedDB) throw new exceptions.MissingAPI();\n    const dbName = db.name;\n    const req = state.autoSchema ? indexedDB.open(dbName) : indexedDB.open(dbName, Math.round(db.verno * 10));\n    if (!req) throw new exceptions.MissingAPI();\n    req.onerror = eventRejectHandler(reject);\n    req.onblocked = wrap(db._fireOnBlocked);\n    req.onupgradeneeded = wrap(e => {\n      upgradeTransaction = req.transaction;\n      if (state.autoSchema && !db._options.allowEmptyDB) {\n        req.onerror = preventDefault;\n        upgradeTransaction.abort();\n        req.result.close();\n        const delreq = indexedDB.deleteDatabase(dbName);\n        delreq.onsuccess = delreq.onerror = wrap(() => {\n          reject(new exceptions.NoSuchDatabase(`Database ${dbName} doesnt exist`));\n        });\n      } else {\n        upgradeTransaction.onerror = eventRejectHandler(reject);\n        var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;\n        wasCreated = oldVer < 1;\n        db._novip.idbdb = req.result;\n        runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n      }\n    }, reject);\n    req.onsuccess = wrap(() => {\n      upgradeTransaction = null;\n      const idbdb = db._novip.idbdb = req.result;\n      const objectStoreNames = slice(idbdb.objectStoreNames);\n      if (objectStoreNames.length > 0) try {\n        const tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n        if (state.autoSchema) readGlobalSchema(db, idbdb, tmpTrans);else {\n          adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n          if (!verifyInstalledSchema(db, tmpTrans)) {\n            console.warn(`Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.`);\n          }\n        }\n        generateMiddlewareStacks(db, tmpTrans);\n      } catch (e) {}\n      connections.push(db);\n      idbdb.onversionchange = wrap(ev => {\n        state.vcFired = true;\n        db.on(\"versionchange\").fire(ev);\n      });\n      idbdb.onclose = wrap(ev => {\n        db.on(\"close\").fire(ev);\n      });\n      if (wasCreated) _onDatabaseCreated(db._deps, dbName);\n      resolve();\n    }, reject);\n  }).catch(err => {\n    if (err && err.name === 'UnknownError' && state.PR1398_maxLoop > 0) {\n      state.PR1398_maxLoop--;\n      console.warn('Dexie: Workaround for Chrome UnknownError on open()');\n      return tryOpenDB();\n    } else {\n      return DexiePromise.reject(err);\n    }\n  });\n  return DexiePromise.race([openCanceller, (typeof navigator === 'undefined' ? DexiePromise.resolve() : idbReady()).then(tryOpenDB)]).then(() => {\n    throwIfCancelled();\n    state.onReadyBeingFired = [];\n    return DexiePromise.resolve(vip(() => db.on.ready.fire(db.vip))).then(function fireRemainders() {\n      if (state.onReadyBeingFired.length > 0) {\n        let remainders = state.onReadyBeingFired.reduce(promisableChain, nop);\n        state.onReadyBeingFired = [];\n        return DexiePromise.resolve(vip(() => remainders(db.vip))).then(fireRemainders);\n      }\n    });\n  }).finally(() => {\n    state.onReadyBeingFired = null;\n    state.isBeingOpened = false;\n  }).then(() => {\n    return db;\n  }).catch(err => {\n    state.dbOpenError = err;\n    try {\n      upgradeTransaction && upgradeTransaction.abort();\n    } catch (_a) {}\n    if (openCanceller === state.openCanceller) {\n      db._close();\n    }\n    return rejection(err);\n  }).finally(() => {\n    state.openComplete = true;\n    resolveDbReady();\n  });\n}\nfunction awaitIterator(iterator) {\n  var callNext = result => iterator.next(result),\n    doThrow = error => iterator.throw(error),\n    onSuccess = step(callNext),\n    onError = step(doThrow);\n  function step(getNext) {\n    return val => {\n      var next = getNext(val),\n        value = next.value;\n      return next.done ? value : !value || typeof value.then !== 'function' ? isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) : value.then(onSuccess, onError);\n    };\n  }\n  return step(callNext)();\n}\nfunction extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n  var i = arguments.length;\n  if (i < 2) throw new exceptions.InvalidArgument(\"Too few arguments\");\n  var args = new Array(i - 1);\n  while (--i) args[i - 1] = arguments[i];\n  scopeFunc = args.pop();\n  var tables = flatten(args);\n  return [mode, tables, scopeFunc];\n}\nfunction enterTransactionScope(db, mode, storeNames, parentTransaction, scopeFunc) {\n  return DexiePromise.resolve().then(() => {\n    const transless = PSD.transless || PSD;\n    const trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n    const zoneProps = {\n      trans: trans,\n      transless: transless\n    };\n    if (parentTransaction) {\n      trans.idbtrans = parentTransaction.idbtrans;\n    } else {\n      try {\n        trans.create();\n        db._state.PR1398_maxLoop = 3;\n      } catch (ex) {\n        if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n          console.warn('Dexie: Need to reopen db');\n          db._close();\n          return db.open().then(() => enterTransactionScope(db, mode, storeNames, null, scopeFunc));\n        }\n        return rejection(ex);\n      }\n    }\n    const scopeFuncIsAsync = isAsyncFunction(scopeFunc);\n    if (scopeFuncIsAsync) {\n      incrementExpectedAwaits();\n    }\n    let returnValue;\n    const promiseFollowed = DexiePromise.follow(() => {\n      returnValue = scopeFunc.call(trans, trans);\n      if (returnValue) {\n        if (scopeFuncIsAsync) {\n          var decrementor = decrementExpectedAwaits.bind(null, null);\n          returnValue.then(decrementor, decrementor);\n        } else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n          returnValue = awaitIterator(returnValue);\n        }\n      }\n    }, zoneProps);\n    return (returnValue && typeof returnValue.then === 'function' ? DexiePromise.resolve(returnValue).then(x => trans.active ? x : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\"))) : promiseFollowed.then(() => returnValue)).then(x => {\n      if (parentTransaction) trans._resolve();\n      return trans._completion.then(() => x);\n    }).catch(e => {\n      trans._reject(e);\n      return rejection(e);\n    });\n  });\n}\nfunction pad(a, value, count) {\n  const result = isArray(a) ? a.slice() : [a];\n  for (let i = 0; i < count; ++i) result.push(value);\n  return result;\n}\nfunction createVirtualIndexMiddleware(down) {\n  return {\n    ...down,\n    table(tableName) {\n      const table = down.table(tableName);\n      const {\n        schema\n      } = table;\n      const indexLookup = {};\n      const allVirtualIndexes = [];\n      function addVirtualIndexes(keyPath, keyTail, lowLevelIndex) {\n        const keyPathAlias = getKeyPathAlias(keyPath);\n        const indexList = indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || [];\n        const keyLength = keyPath == null ? 0 : typeof keyPath === 'string' ? 1 : keyPath.length;\n        const isVirtual = keyTail > 0;\n        const virtualIndex = {\n          ...lowLevelIndex,\n          isVirtual,\n          keyTail,\n          keyLength,\n          extractKey: getKeyExtractor(keyPath),\n          unique: !isVirtual && lowLevelIndex.unique\n        };\n        indexList.push(virtualIndex);\n        if (!virtualIndex.isPrimaryKey) {\n          allVirtualIndexes.push(virtualIndex);\n        }\n        if (keyLength > 1) {\n          const virtualKeyPath = keyLength === 2 ? keyPath[0] : keyPath.slice(0, keyLength - 1);\n          addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n        }\n        indexList.sort((a, b) => a.keyTail - b.keyTail);\n        return virtualIndex;\n      }\n      const primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n      indexLookup[\":id\"] = [primaryKey];\n      for (const index of schema.indexes) {\n        addVirtualIndexes(index.keyPath, 0, index);\n      }\n      function findBestIndex(keyPath) {\n        const result = indexLookup[getKeyPathAlias(keyPath)];\n        return result && result[0];\n      }\n      function translateRange(range, keyTail) {\n        return {\n          type: range.type === 1 ? 2 : range.type,\n          lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n          lowerOpen: true,\n          upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n          upperOpen: true\n        };\n      }\n      function translateRequest(req) {\n        const index = req.query.index;\n        return index.isVirtual ? {\n          ...req,\n          query: {\n            index,\n            range: translateRange(req.query.range, index.keyTail)\n          }\n        } : req;\n      }\n      const result = {\n        ...table,\n        schema: {\n          ...schema,\n          primaryKey,\n          indexes: allVirtualIndexes,\n          getIndexByKeyPath: findBestIndex\n        },\n        count(req) {\n          return table.count(translateRequest(req));\n        },\n        query(req) {\n          return table.query(translateRequest(req));\n        },\n        openCursor(req) {\n          const {\n            keyTail,\n            isVirtual,\n            keyLength\n          } = req.query.index;\n          if (!isVirtual) return table.openCursor(req);\n          function createVirtualCursor(cursor) {\n            function _continue(key) {\n              key != null ? cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) : req.unique ? cursor.continue(cursor.key.slice(0, keyLength).concat(req.reverse ? down.MIN_KEY : down.MAX_KEY, keyTail)) : cursor.continue();\n            }\n            const virtualCursor = Object.create(cursor, {\n              continue: {\n                value: _continue\n              },\n              continuePrimaryKey: {\n                value(key, primaryKey) {\n                  cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                }\n              },\n              primaryKey: {\n                get() {\n                  return cursor.primaryKey;\n                }\n              },\n              key: {\n                get() {\n                  const key = cursor.key;\n                  return keyLength === 1 ? key[0] : key.slice(0, keyLength);\n                }\n              },\n              value: {\n                get() {\n                  return cursor.value;\n                }\n              }\n            });\n            return virtualCursor;\n          }\n          return table.openCursor(translateRequest(req)).then(cursor => cursor && createVirtualCursor(cursor));\n        }\n      };\n      return result;\n    }\n  };\n}\nconst virtualIndexMiddleware = {\n  stack: \"dbcore\",\n  name: \"VirtualIndexMiddleware\",\n  level: 1,\n  create: createVirtualIndexMiddleware\n};\nfunction getObjectDiff(a, b, rv, prfx) {\n  rv = rv || {};\n  prfx = prfx || '';\n  keys(a).forEach(prop => {\n    if (!hasOwn(b, prop)) {\n      rv[prfx + prop] = undefined;\n    } else {\n      var ap = a[prop],\n        bp = b[prop];\n      if (typeof ap === 'object' && typeof bp === 'object' && ap && bp) {\n        const apTypeName = toStringTag(ap);\n        const bpTypeName = toStringTag(bp);\n        if (apTypeName !== bpTypeName) {\n          rv[prfx + prop] = b[prop];\n        } else if (apTypeName === 'Object') {\n          getObjectDiff(ap, bp, rv, prfx + prop + '.');\n        } else if (ap !== bp) {\n          rv[prfx + prop] = b[prop];\n        }\n      } else if (ap !== bp) rv[prfx + prop] = b[prop];\n    }\n  });\n  keys(b).forEach(prop => {\n    if (!hasOwn(a, prop)) {\n      rv[prfx + prop] = b[prop];\n    }\n  });\n  return rv;\n}\nfunction getEffectiveKeys(primaryKey, req) {\n  if (req.type === 'delete') return req.keys;\n  return req.keys || req.values.map(primaryKey.extractKey);\n}\nconst hooksMiddleware = {\n  stack: \"dbcore\",\n  name: \"HooksMiddleware\",\n  level: 2,\n  create: downCore => ({\n    ...downCore,\n    table(tableName) {\n      const downTable = downCore.table(tableName);\n      const {\n        primaryKey\n      } = downTable.schema;\n      const tableMiddleware = {\n        ...downTable,\n        mutate(req) {\n          const dxTrans = PSD.trans;\n          const {\n            deleting,\n            creating,\n            updating\n          } = dxTrans.table(tableName).hook;\n          switch (req.type) {\n            case 'add':\n              if (creating.fire === nop) break;\n              return dxTrans._promise('readwrite', () => addPutOrDelete(req), true);\n            case 'put':\n              if (creating.fire === nop && updating.fire === nop) break;\n              return dxTrans._promise('readwrite', () => addPutOrDelete(req), true);\n            case 'delete':\n              if (deleting.fire === nop) break;\n              return dxTrans._promise('readwrite', () => addPutOrDelete(req), true);\n            case 'deleteRange':\n              if (deleting.fire === nop) break;\n              return dxTrans._promise('readwrite', () => deleteRange(req), true);\n          }\n          return downTable.mutate(req);\n          function addPutOrDelete(req) {\n            const dxTrans = PSD.trans;\n            const keys = req.keys || getEffectiveKeys(primaryKey, req);\n            if (!keys) throw new Error(\"Keys missing\");\n            req = req.type === 'add' || req.type === 'put' ? {\n              ...req,\n              keys\n            } : {\n              ...req\n            };\n            if (req.type !== 'delete') req.values = [...req.values];\n            if (req.keys) req.keys = [...req.keys];\n            return getExistingValues(downTable, req, keys).then(existingValues => {\n              const contexts = keys.map((key, i) => {\n                const existingValue = existingValues[i];\n                const ctx = {\n                  onerror: null,\n                  onsuccess: null\n                };\n                if (req.type === 'delete') {\n                  deleting.fire.call(ctx, key, existingValue, dxTrans);\n                } else if (req.type === 'add' || existingValue === undefined) {\n                  const generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                  if (key == null && generatedPrimaryKey != null) {\n                    key = generatedPrimaryKey;\n                    req.keys[i] = key;\n                    if (!primaryKey.outbound) {\n                      setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                    }\n                  }\n                } else {\n                  const objectDiff = getObjectDiff(existingValue, req.values[i]);\n                  const additionalChanges = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                  if (additionalChanges) {\n                    const requestedValue = req.values[i];\n                    Object.keys(additionalChanges).forEach(keyPath => {\n                      if (hasOwn(requestedValue, keyPath)) {\n                        requestedValue[keyPath] = additionalChanges[keyPath];\n                      } else {\n                        setByKeyPath(requestedValue, keyPath, additionalChanges[keyPath]);\n                      }\n                    });\n                  }\n                }\n                return ctx;\n              });\n              return downTable.mutate(req).then(({\n                failures,\n                results,\n                numFailures,\n                lastResult\n              }) => {\n                for (let i = 0; i < keys.length; ++i) {\n                  const primKey = results ? results[i] : keys[i];\n                  const ctx = contexts[i];\n                  if (primKey == null) {\n                    ctx.onerror && ctx.onerror(failures[i]);\n                  } else {\n                    ctx.onsuccess && ctx.onsuccess(req.type === 'put' && existingValues[i] ? req.values[i] : primKey);\n                  }\n                }\n                return {\n                  failures,\n                  results,\n                  numFailures,\n                  lastResult\n                };\n              }).catch(error => {\n                contexts.forEach(ctx => ctx.onerror && ctx.onerror(error));\n                return Promise.reject(error);\n              });\n            });\n          }\n          function deleteRange(req) {\n            return deleteNextChunk(req.trans, req.range, 10000);\n          }\n          function deleteNextChunk(trans, range, limit) {\n            return downTable.query({\n              trans,\n              values: false,\n              query: {\n                index: primaryKey,\n                range\n              },\n              limit\n            }).then(({\n              result\n            }) => {\n              return addPutOrDelete({\n                type: 'delete',\n                keys: result,\n                trans\n              }).then(res => {\n                if (res.numFailures > 0) return Promise.reject(res.failures[0]);\n                if (result.length < limit) {\n                  return {\n                    failures: [],\n                    numFailures: 0,\n                    lastResult: undefined\n                  };\n                } else {\n                  return deleteNextChunk(trans, {\n                    ...range,\n                    lower: result[result.length - 1],\n                    lowerOpen: true\n                  }, limit);\n                }\n              });\n            });\n          }\n        }\n      };\n      return tableMiddleware;\n    }\n  })\n};\nfunction getExistingValues(table, req, effectiveKeys) {\n  return req.type === \"add\" ? Promise.resolve([]) : table.getMany({\n    trans: req.trans,\n    keys: effectiveKeys,\n    cache: \"immutable\"\n  });\n}\nfunction getFromTransactionCache(keys, cache, clone) {\n  try {\n    if (!cache) return null;\n    if (cache.keys.length < keys.length) return null;\n    const result = [];\n    for (let i = 0, j = 0; i < cache.keys.length && j < keys.length; ++i) {\n      if (cmp(cache.keys[i], keys[j]) !== 0) continue;\n      result.push(clone ? deepClone(cache.values[i]) : cache.values[i]);\n      ++j;\n    }\n    return result.length === keys.length ? result : null;\n  } catch (_a) {\n    return null;\n  }\n}\nconst cacheExistingValuesMiddleware = {\n  stack: \"dbcore\",\n  level: -1,\n  create: core => {\n    return {\n      table: tableName => {\n        const table = core.table(tableName);\n        return {\n          ...table,\n          getMany: req => {\n            if (!req.cache) {\n              return table.getMany(req);\n            }\n            const cachedResult = getFromTransactionCache(req.keys, req.trans[\"_cache\"], req.cache === \"clone\");\n            if (cachedResult) {\n              return DexiePromise.resolve(cachedResult);\n            }\n            return table.getMany(req).then(res => {\n              req.trans[\"_cache\"] = {\n                keys: req.keys,\n                values: req.cache === \"clone\" ? deepClone(res) : res\n              };\n              return res;\n            });\n          },\n          mutate: req => {\n            if (req.type !== \"add\") req.trans[\"_cache\"] = null;\n            return table.mutate(req);\n          }\n        };\n      }\n    };\n  }\n};\nfunction isEmptyRange(node) {\n  return !(\"from\" in node);\n}\nconst RangeSet = function (fromOrTree, to) {\n  if (this) {\n    extend(this, arguments.length ? {\n      d: 1,\n      from: fromOrTree,\n      to: arguments.length > 1 ? to : fromOrTree\n    } : {\n      d: 0\n    });\n  } else {\n    const rv = new RangeSet();\n    if (fromOrTree && \"d\" in fromOrTree) {\n      extend(rv, fromOrTree);\n    }\n    return rv;\n  }\n};\nprops(RangeSet.prototype, {\n  add(rangeSet) {\n    mergeRanges(this, rangeSet);\n    return this;\n  },\n  addKey(key) {\n    addRange(this, key, key);\n    return this;\n  },\n  addKeys(keys) {\n    keys.forEach(key => addRange(this, key, key));\n    return this;\n  },\n  [iteratorSymbol]() {\n    return getRangeSetIterator(this);\n  }\n});\nfunction addRange(target, from, to) {\n  const diff = cmp(from, to);\n  if (isNaN(diff)) return;\n  if (diff > 0) throw RangeError();\n  if (isEmptyRange(target)) return extend(target, {\n    from,\n    to,\n    d: 1\n  });\n  const left = target.l;\n  const right = target.r;\n  if (cmp(to, target.from) < 0) {\n    left ? addRange(left, from, to) : target.l = {\n      from,\n      to,\n      d: 1,\n      l: null,\n      r: null\n    };\n    return rebalance(target);\n  }\n  if (cmp(from, target.to) > 0) {\n    right ? addRange(right, from, to) : target.r = {\n      from,\n      to,\n      d: 1,\n      l: null,\n      r: null\n    };\n    return rebalance(target);\n  }\n  if (cmp(from, target.from) < 0) {\n    target.from = from;\n    target.l = null;\n    target.d = right ? right.d + 1 : 1;\n  }\n  if (cmp(to, target.to) > 0) {\n    target.to = to;\n    target.r = null;\n    target.d = target.l ? target.l.d + 1 : 1;\n  }\n  const rightWasCutOff = !target.r;\n  if (left && !target.l) {\n    mergeRanges(target, left);\n  }\n  if (right && rightWasCutOff) {\n    mergeRanges(target, right);\n  }\n}\nfunction mergeRanges(target, newSet) {\n  function _addRangeSet(target, {\n    from,\n    to,\n    l,\n    r\n  }) {\n    addRange(target, from, to);\n    if (l) _addRangeSet(target, l);\n    if (r) _addRangeSet(target, r);\n  }\n  if (!isEmptyRange(newSet)) _addRangeSet(target, newSet);\n}\nfunction rangesOverlap(rangeSet1, rangeSet2) {\n  const i1 = getRangeSetIterator(rangeSet2);\n  let nextResult1 = i1.next();\n  if (nextResult1.done) return false;\n  let a = nextResult1.value;\n  const i2 = getRangeSetIterator(rangeSet1);\n  let nextResult2 = i2.next(a.from);\n  let b = nextResult2.value;\n  while (!nextResult1.done && !nextResult2.done) {\n    if (cmp(b.from, a.to) <= 0 && cmp(b.to, a.from) >= 0) return true;\n    cmp(a.from, b.from) < 0 ? a = (nextResult1 = i1.next(b.from)).value : b = (nextResult2 = i2.next(a.from)).value;\n  }\n  return false;\n}\nfunction getRangeSetIterator(node) {\n  let state = isEmptyRange(node) ? null : {\n    s: 0,\n    n: node\n  };\n  return {\n    next(key) {\n      const keyProvided = arguments.length > 0;\n      while (state) {\n        switch (state.s) {\n          case 0:\n            state.s = 1;\n            if (keyProvided) {\n              while (state.n.l && cmp(key, state.n.from) < 0) state = {\n                up: state,\n                n: state.n.l,\n                s: 1\n              };\n            } else {\n              while (state.n.l) state = {\n                up: state,\n                n: state.n.l,\n                s: 1\n              };\n            }\n          case 1:\n            state.s = 2;\n            if (!keyProvided || cmp(key, state.n.to) <= 0) return {\n              value: state.n,\n              done: false\n            };\n          case 2:\n            if (state.n.r) {\n              state.s = 3;\n              state = {\n                up: state,\n                n: state.n.r,\n                s: 0\n              };\n              continue;\n            }\n          case 3:\n            state = state.up;\n        }\n      }\n      return {\n        done: true\n      };\n    }\n  };\n}\nfunction rebalance(target) {\n  var _a, _b;\n  const diff = (((_a = target.r) === null || _a === void 0 ? void 0 : _a.d) || 0) - (((_b = target.l) === null || _b === void 0 ? void 0 : _b.d) || 0);\n  const r = diff > 1 ? \"r\" : diff < -1 ? \"l\" : \"\";\n  if (r) {\n    const l = r === \"r\" ? \"l\" : \"r\";\n    const rootClone = {\n      ...target\n    };\n    const oldRootRight = target[r];\n    target.from = oldRootRight.from;\n    target.to = oldRootRight.to;\n    target[r] = oldRootRight[r];\n    rootClone[r] = oldRootRight[l];\n    target[l] = rootClone;\n    rootClone.d = computeDepth(rootClone);\n  }\n  target.d = computeDepth(target);\n}\nfunction computeDepth({\n  r,\n  l\n}) {\n  return (r ? l ? Math.max(r.d, l.d) : r.d : l ? l.d : 0) + 1;\n}\nconst observabilityMiddleware = {\n  stack: \"dbcore\",\n  level: 0,\n  create: core => {\n    const dbName = core.schema.name;\n    const FULL_RANGE = new RangeSet(core.MIN_KEY, core.MAX_KEY);\n    return {\n      ...core,\n      table: tableName => {\n        const table = core.table(tableName);\n        const {\n          schema\n        } = table;\n        const {\n          primaryKey\n        } = schema;\n        const {\n          extractKey,\n          outbound\n        } = primaryKey;\n        const tableClone = {\n          ...table,\n          mutate: req => {\n            const trans = req.trans;\n            const mutatedParts = trans.mutatedParts || (trans.mutatedParts = {});\n            const getRangeSet = indexName => {\n              const part = `idb://${dbName}/${tableName}/${indexName}`;\n              return mutatedParts[part] || (mutatedParts[part] = new RangeSet());\n            };\n            const pkRangeSet = getRangeSet(\"\");\n            const delsRangeSet = getRangeSet(\":dels\");\n            const {\n              type\n            } = req;\n            let [keys, newObjs] = req.type === \"deleteRange\" ? [req.range] : req.type === \"delete\" ? [req.keys] : req.values.length < 50 ? [[], req.values] : [];\n            const oldCache = req.trans[\"_cache\"];\n            return table.mutate(req).then(res => {\n              if (isArray(keys)) {\n                if (type !== \"delete\") keys = res.results;\n                pkRangeSet.addKeys(keys);\n                const oldObjs = getFromTransactionCache(keys, oldCache);\n                if (!oldObjs && type !== \"add\") {\n                  delsRangeSet.addKeys(keys);\n                }\n                if (oldObjs || newObjs) {\n                  trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs);\n                }\n              } else if (keys) {\n                const range = {\n                  from: keys.lower,\n                  to: keys.upper\n                };\n                delsRangeSet.add(range);\n                pkRangeSet.add(range);\n              } else {\n                pkRangeSet.add(FULL_RANGE);\n                delsRangeSet.add(FULL_RANGE);\n                schema.indexes.forEach(idx => getRangeSet(idx.name).add(FULL_RANGE));\n              }\n              return res;\n            });\n          }\n        };\n        const getRange = ({\n          query: {\n            index,\n            range\n          }\n        }) => {\n          var _a, _b;\n          return [index, new RangeSet((_a = range.lower) !== null && _a !== void 0 ? _a : core.MIN_KEY, (_b = range.upper) !== null && _b !== void 0 ? _b : core.MAX_KEY)];\n        };\n        const readSubscribers = {\n          get: req => [primaryKey, new RangeSet(req.key)],\n          getMany: req => [primaryKey, new RangeSet().addKeys(req.keys)],\n          count: getRange,\n          query: getRange,\n          openCursor: getRange\n        };\n        keys(readSubscribers).forEach(method => {\n          tableClone[method] = function (req) {\n            const {\n              subscr\n            } = PSD;\n            if (subscr) {\n              const getRangeSet = indexName => {\n                const part = `idb://${dbName}/${tableName}/${indexName}`;\n                return subscr[part] || (subscr[part] = new RangeSet());\n              };\n              const pkRangeSet = getRangeSet(\"\");\n              const delsRangeSet = getRangeSet(\":dels\");\n              const [queriedIndex, queriedRanges] = readSubscribers[method](req);\n              getRangeSet(queriedIndex.name || \"\").add(queriedRanges);\n              if (!queriedIndex.isPrimaryKey) {\n                if (method === \"count\") {\n                  delsRangeSet.add(FULL_RANGE);\n                } else {\n                  const keysPromise = method === \"query\" && outbound && req.values && table.query({\n                    ...req,\n                    values: false\n                  });\n                  return table[method].apply(this, arguments).then(res => {\n                    if (method === \"query\") {\n                      if (outbound && req.values) {\n                        return keysPromise.then(({\n                          result: resultingKeys\n                        }) => {\n                          pkRangeSet.addKeys(resultingKeys);\n                          return res;\n                        });\n                      }\n                      const pKeys = req.values ? res.result.map(extractKey) : res.result;\n                      if (req.values) {\n                        pkRangeSet.addKeys(pKeys);\n                      } else {\n                        delsRangeSet.addKeys(pKeys);\n                      }\n                    } else if (method === \"openCursor\") {\n                      const cursor = res;\n                      const wantValues = req.values;\n                      return cursor && Object.create(cursor, {\n                        key: {\n                          get() {\n                            delsRangeSet.addKey(cursor.primaryKey);\n                            return cursor.key;\n                          }\n                        },\n                        primaryKey: {\n                          get() {\n                            const pkey = cursor.primaryKey;\n                            delsRangeSet.addKey(pkey);\n                            return pkey;\n                          }\n                        },\n                        value: {\n                          get() {\n                            wantValues && pkRangeSet.addKey(cursor.primaryKey);\n                            return cursor.value;\n                          }\n                        }\n                      });\n                    }\n                    return res;\n                  });\n                }\n              }\n            }\n            return table[method].apply(this, arguments);\n          };\n        });\n        return tableClone;\n      }\n    };\n  }\n};\nfunction trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs) {\n  function addAffectedIndex(ix) {\n    const rangeSet = getRangeSet(ix.name || \"\");\n    function extractKey(obj) {\n      return obj != null ? ix.extractKey(obj) : null;\n    }\n    const addKeyOrKeys = key => ix.multiEntry && isArray(key) ? key.forEach(key => rangeSet.addKey(key)) : rangeSet.addKey(key);\n    (oldObjs || newObjs).forEach((_, i) => {\n      const oldKey = oldObjs && extractKey(oldObjs[i]);\n      const newKey = newObjs && extractKey(newObjs[i]);\n      if (cmp(oldKey, newKey) !== 0) {\n        if (oldKey != null) addKeyOrKeys(oldKey);\n        if (newKey != null) addKeyOrKeys(newKey);\n      }\n    });\n  }\n  schema.indexes.forEach(addAffectedIndex);\n}\nclass Dexie$1 {\n  constructor(name, options) {\n    this._middlewares = {};\n    this.verno = 0;\n    const deps = Dexie$1.dependencies;\n    this._options = options = {\n      addons: Dexie$1.addons,\n      autoOpen: true,\n      indexedDB: deps.indexedDB,\n      IDBKeyRange: deps.IDBKeyRange,\n      ...options\n    };\n    this._deps = {\n      indexedDB: options.indexedDB,\n      IDBKeyRange: options.IDBKeyRange\n    };\n    const {\n      addons\n    } = options;\n    this._dbSchema = {};\n    this._versions = [];\n    this._storeNames = [];\n    this._allTables = {};\n    this.idbdb = null;\n    this._novip = this;\n    const state = {\n      dbOpenError: null,\n      isBeingOpened: false,\n      onReadyBeingFired: null,\n      openComplete: false,\n      dbReadyResolve: nop,\n      dbReadyPromise: null,\n      cancelOpen: nop,\n      openCanceller: null,\n      autoSchema: true,\n      PR1398_maxLoop: 3\n    };\n    state.dbReadyPromise = new DexiePromise(resolve => {\n      state.dbReadyResolve = resolve;\n    });\n    state.openCanceller = new DexiePromise((_, reject) => {\n      state.cancelOpen = reject;\n    });\n    this._state = state;\n    this.name = name;\n    this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", \"close\", {\n      ready: [promisableChain, nop]\n    });\n    this.on.ready.subscribe = override(this.on.ready.subscribe, subscribe => {\n      return (subscriber, bSticky) => {\n        Dexie$1.vip(() => {\n          const state = this._state;\n          if (state.openComplete) {\n            if (!state.dbOpenError) DexiePromise.resolve().then(subscriber);\n            if (bSticky) subscribe(subscriber);\n          } else if (state.onReadyBeingFired) {\n            state.onReadyBeingFired.push(subscriber);\n            if (bSticky) subscribe(subscriber);\n          } else {\n            subscribe(subscriber);\n            const db = this;\n            if (!bSticky) subscribe(function unsubscribe() {\n              db.on.ready.unsubscribe(subscriber);\n              db.on.ready.unsubscribe(unsubscribe);\n            });\n          }\n        });\n      };\n    });\n    this.Collection = createCollectionConstructor(this);\n    this.Table = createTableConstructor(this);\n    this.Transaction = createTransactionConstructor(this);\n    this.Version = createVersionConstructor(this);\n    this.WhereClause = createWhereClauseConstructor(this);\n    this.on(\"versionchange\", ev => {\n      if (ev.newVersion > 0) console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`);else console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`);\n      this.close();\n    });\n    this.on(\"blocked\", ev => {\n      if (!ev.newVersion || ev.newVersion < ev.oldVersion) console.warn(`Dexie.delete('${this.name}') was blocked`);else console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${ev.oldVersion / 10}`);\n    });\n    this._maxKey = getMaxKey(options.IDBKeyRange);\n    this._createTransaction = (mode, storeNames, dbschema, parentTransaction) => new this.Transaction(mode, storeNames, dbschema, this._options.chromeTransactionDurability, parentTransaction);\n    this._fireOnBlocked = ev => {\n      this.on(\"blocked\").fire(ev);\n      connections.filter(c => c.name === this.name && c !== this && !c._state.vcFired).map(c => c.on(\"versionchange\").fire(ev));\n    };\n    this.use(virtualIndexMiddleware);\n    this.use(hooksMiddleware);\n    this.use(observabilityMiddleware);\n    this.use(cacheExistingValuesMiddleware);\n    this.vip = Object.create(this, {\n      _vip: {\n        value: true\n      }\n    });\n    addons.forEach(addon => addon(this));\n  }\n  version(versionNumber) {\n    if (isNaN(versionNumber) || versionNumber < 0.1) throw new exceptions.Type(`Given version is not a positive number`);\n    versionNumber = Math.round(versionNumber * 10) / 10;\n    if (this.idbdb || this._state.isBeingOpened) throw new exceptions.Schema(\"Cannot add version when database is open\");\n    this.verno = Math.max(this.verno, versionNumber);\n    const versions = this._versions;\n    var versionInstance = versions.filter(v => v._cfg.version === versionNumber)[0];\n    if (versionInstance) return versionInstance;\n    versionInstance = new this.Version(versionNumber);\n    versions.push(versionInstance);\n    versions.sort(lowerVersionFirst);\n    versionInstance.stores({});\n    this._state.autoSchema = false;\n    return versionInstance;\n  }\n  _whenReady(fn) {\n    return this.idbdb && (this._state.openComplete || PSD.letThrough || this._vip) ? fn() : new DexiePromise((resolve, reject) => {\n      if (this._state.openComplete) {\n        return reject(new exceptions.DatabaseClosed(this._state.dbOpenError));\n      }\n      if (!this._state.isBeingOpened) {\n        if (!this._options.autoOpen) {\n          reject(new exceptions.DatabaseClosed());\n          return;\n        }\n        this.open().catch(nop);\n      }\n      this._state.dbReadyPromise.then(resolve, reject);\n    }).then(fn);\n  }\n  use({\n    stack,\n    create,\n    level,\n    name\n  }) {\n    if (name) this.unuse({\n      stack,\n      name\n    });\n    const middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n    middlewares.push({\n      stack,\n      create,\n      level: level == null ? 10 : level,\n      name\n    });\n    middlewares.sort((a, b) => a.level - b.level);\n    return this;\n  }\n  unuse({\n    stack,\n    name,\n    create\n  }) {\n    if (stack && this._middlewares[stack]) {\n      this._middlewares[stack] = this._middlewares[stack].filter(mw => create ? mw.create !== create : name ? mw.name !== name : false);\n    }\n    return this;\n  }\n  open() {\n    return dexieOpen(this);\n  }\n  _close() {\n    const state = this._state;\n    const idx = connections.indexOf(this);\n    if (idx >= 0) connections.splice(idx, 1);\n    if (this.idbdb) {\n      try {\n        this.idbdb.close();\n      } catch (e) {}\n      this._novip.idbdb = null;\n    }\n    state.dbReadyPromise = new DexiePromise(resolve => {\n      state.dbReadyResolve = resolve;\n    });\n    state.openCanceller = new DexiePromise((_, reject) => {\n      state.cancelOpen = reject;\n    });\n  }\n  close() {\n    this._close();\n    const state = this._state;\n    this._options.autoOpen = false;\n    state.dbOpenError = new exceptions.DatabaseClosed();\n    if (state.isBeingOpened) state.cancelOpen(state.dbOpenError);\n  }\n  delete() {\n    const hasArguments = arguments.length > 0;\n    const state = this._state;\n    return new DexiePromise((resolve, reject) => {\n      const doDelete = () => {\n        this.close();\n        var req = this._deps.indexedDB.deleteDatabase(this.name);\n        req.onsuccess = wrap(() => {\n          _onDatabaseDeleted(this._deps, this.name);\n          resolve();\n        });\n        req.onerror = eventRejectHandler(reject);\n        req.onblocked = this._fireOnBlocked;\n      };\n      if (hasArguments) throw new exceptions.InvalidArgument(\"Arguments not allowed in db.delete()\");\n      if (state.isBeingOpened) {\n        state.dbReadyPromise.then(doDelete);\n      } else {\n        doDelete();\n      }\n    });\n  }\n  backendDB() {\n    return this.idbdb;\n  }\n  isOpen() {\n    return this.idbdb !== null;\n  }\n  hasBeenClosed() {\n    const dbOpenError = this._state.dbOpenError;\n    return dbOpenError && dbOpenError.name === 'DatabaseClosed';\n  }\n  hasFailed() {\n    return this._state.dbOpenError !== null;\n  }\n  dynamicallyOpened() {\n    return this._state.autoSchema;\n  }\n  get tables() {\n    return keys(this._allTables).map(name => this._allTables[name]);\n  }\n  transaction() {\n    const args = extractTransactionArgs.apply(this, arguments);\n    return this._transaction.apply(this, args);\n  }\n  _transaction(mode, tables, scopeFunc) {\n    let parentTransaction = PSD.trans;\n    if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1) parentTransaction = null;\n    const onlyIfCompatible = mode.indexOf('?') !== -1;\n    mode = mode.replace('!', '').replace('?', '');\n    let idbMode, storeNames;\n    try {\n      storeNames = tables.map(table => {\n        var storeName = table instanceof this.Table ? table.name : table;\n        if (typeof storeName !== 'string') throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n        return storeName;\n      });\n      if (mode == \"r\" || mode === READONLY) idbMode = READONLY;else if (mode == \"rw\" || mode == READWRITE) idbMode = READWRITE;else throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n      if (parentTransaction) {\n        if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n          if (onlyIfCompatible) {\n            parentTransaction = null;\n          } else throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n        }\n        if (parentTransaction) {\n          storeNames.forEach(storeName => {\n            if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n              if (onlyIfCompatible) {\n                parentTransaction = null;\n              } else throw new exceptions.SubTransaction(\"Table \" + storeName + \" not included in parent transaction.\");\n            }\n          });\n        }\n        if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n          parentTransaction = null;\n        }\n      }\n    } catch (e) {\n      return parentTransaction ? parentTransaction._promise(null, (_, reject) => {\n        reject(e);\n      }) : rejection(e);\n    }\n    const enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n    return parentTransaction ? parentTransaction._promise(idbMode, enterTransaction, \"lock\") : PSD.trans ? usePSD(PSD.transless, () => this._whenReady(enterTransaction)) : this._whenReady(enterTransaction);\n  }\n  table(tableName) {\n    if (!hasOwn(this._allTables, tableName)) {\n      throw new exceptions.InvalidTable(`Table ${tableName} does not exist`);\n    }\n    return this._allTables[tableName];\n  }\n}\nconst symbolObservable = typeof Symbol !== \"undefined\" && \"observable\" in Symbol ? Symbol.observable : \"@@observable\";\nclass Observable {\n  constructor(subscribe) {\n    this._subscribe = subscribe;\n  }\n  subscribe(x, error, complete) {\n    return this._subscribe(!x || typeof x === \"function\" ? {\n      next: x,\n      error,\n      complete\n    } : x);\n  }\n  [symbolObservable]() {\n    return this;\n  }\n}\nfunction extendObservabilitySet(target, newSet) {\n  keys(newSet).forEach(part => {\n    const rangeSet = target[part] || (target[part] = new RangeSet());\n    mergeRanges(rangeSet, newSet[part]);\n  });\n  return target;\n}\nfunction liveQuery(querier) {\n  let hasValue = false;\n  let currentValue = undefined;\n  const observable = new Observable(observer => {\n    const scopeFuncIsAsync = isAsyncFunction(querier);\n    function execute(subscr) {\n      if (scopeFuncIsAsync) {\n        incrementExpectedAwaits();\n      }\n      const exec = () => newScope(querier, {\n        subscr,\n        trans: null\n      });\n      const rv = PSD.trans ? usePSD(PSD.transless, exec) : exec();\n      if (scopeFuncIsAsync) {\n        rv.then(decrementExpectedAwaits, decrementExpectedAwaits);\n      }\n      return rv;\n    }\n    let closed = false;\n    let accumMuts = {};\n    let currentObs = {};\n    const subscription = {\n      get closed() {\n        return closed;\n      },\n      unsubscribe: () => {\n        closed = true;\n        globalEvents.storagemutated.unsubscribe(mutationListener);\n      }\n    };\n    observer.start && observer.start(subscription);\n    let querying = false,\n      startedListening = false;\n    function shouldNotify() {\n      return keys(currentObs).some(key => accumMuts[key] && rangesOverlap(accumMuts[key], currentObs[key]));\n    }\n    const mutationListener = parts => {\n      extendObservabilitySet(accumMuts, parts);\n      if (shouldNotify()) {\n        doQuery();\n      }\n    };\n    const doQuery = () => {\n      if (querying || closed) return;\n      accumMuts = {};\n      const subscr = {};\n      const ret = execute(subscr);\n      if (!startedListening) {\n        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, mutationListener);\n        startedListening = true;\n      }\n      querying = true;\n      Promise.resolve(ret).then(result => {\n        hasValue = true;\n        currentValue = result;\n        querying = false;\n        if (closed) return;\n        if (shouldNotify()) {\n          doQuery();\n        } else {\n          accumMuts = {};\n          currentObs = subscr;\n          observer.next && observer.next(result);\n        }\n      }, err => {\n        querying = false;\n        hasValue = false;\n        observer.error && observer.error(err);\n        subscription.unsubscribe();\n      });\n    };\n    doQuery();\n    return subscription;\n  });\n  observable.hasValue = () => hasValue;\n  observable.getValue = () => currentValue;\n  return observable;\n}\nlet domDeps;\ntry {\n  domDeps = {\n    indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n    IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n  };\n} catch (e) {\n  domDeps = {\n    indexedDB: null,\n    IDBKeyRange: null\n  };\n}\nconst Dexie = Dexie$1;\nprops(Dexie, {\n  ...fullNameExceptions,\n  delete(databaseName) {\n    const db = new Dexie(databaseName, {\n      addons: []\n    });\n    return db.delete();\n  },\n  exists(name) {\n    return new Dexie(name, {\n      addons: []\n    }).open().then(db => {\n      db.close();\n      return true;\n    }).catch('NoSuchDatabaseError', () => false);\n  },\n  getDatabaseNames(cb) {\n    try {\n      return getDatabaseNames(Dexie.dependencies).then(cb);\n    } catch (_a) {\n      return rejection(new exceptions.MissingAPI());\n    }\n  },\n  defineClass() {\n    function Class(content) {\n      extend(this, content);\n    }\n    return Class;\n  },\n  ignoreTransaction(scopeFunc) {\n    return PSD.trans ? usePSD(PSD.transless, scopeFunc) : scopeFunc();\n  },\n  vip,\n  async: function (generatorFn) {\n    return function () {\n      try {\n        var rv = awaitIterator(generatorFn.apply(this, arguments));\n        if (!rv || typeof rv.then !== 'function') return DexiePromise.resolve(rv);\n        return rv;\n      } catch (e) {\n        return rejection(e);\n      }\n    };\n  },\n  spawn: function (generatorFn, args, thiz) {\n    try {\n      var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n      if (!rv || typeof rv.then !== 'function') return DexiePromise.resolve(rv);\n      return rv;\n    } catch (e) {\n      return rejection(e);\n    }\n  },\n  currentTransaction: {\n    get: () => PSD.trans || null\n  },\n  waitFor: function (promiseOrFunction, optionalTimeout) {\n    const promise = DexiePromise.resolve(typeof promiseOrFunction === 'function' ? Dexie.ignoreTransaction(promiseOrFunction) : promiseOrFunction).timeout(optionalTimeout || 60000);\n    return PSD.trans ? PSD.trans.waitFor(promise) : promise;\n  },\n  Promise: DexiePromise,\n  debug: {\n    get: () => debug,\n    set: value => {\n      setDebug(value, value === 'dexie' ? () => true : dexieStackFrameFilter);\n    }\n  },\n  derive: derive,\n  extend: extend,\n  props: props,\n  override: override,\n  Events: Events,\n  on: globalEvents,\n  liveQuery,\n  extendObservabilitySet,\n  getByKeyPath: getByKeyPath,\n  setByKeyPath: setByKeyPath,\n  delByKeyPath: delByKeyPath,\n  shallowClone: shallowClone,\n  deepClone: deepClone,\n  getObjectDiff: getObjectDiff,\n  cmp,\n  asap: asap$1,\n  minKey: minKey,\n  addons: [],\n  connections: connections,\n  errnames: errnames,\n  dependencies: domDeps,\n  semVer: DEXIE_VERSION,\n  version: DEXIE_VERSION.split('.').map(n => parseInt(n)).reduce((p, c, i) => p + c / Math.pow(10, i * 2))\n});\nDexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\nif (typeof dispatchEvent !== 'undefined' && typeof addEventListener !== 'undefined') {\n  globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, updatedParts => {\n    if (!propagatingLocally) {\n      let event;\n      if (isIEOrEdge) {\n        event = document.createEvent('CustomEvent');\n        event.initCustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, true, true, updatedParts);\n      } else {\n        event = new CustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, {\n          detail: updatedParts\n        });\n      }\n      propagatingLocally = true;\n      dispatchEvent(event);\n      propagatingLocally = false;\n    }\n  });\n  addEventListener(STORAGE_MUTATED_DOM_EVENT_NAME, ({\n    detail\n  }) => {\n    if (!propagatingLocally) {\n      propagateLocally(detail);\n    }\n  });\n}\nfunction propagateLocally(updateParts) {\n  let wasMe = propagatingLocally;\n  try {\n    propagatingLocally = true;\n    globalEvents.storagemutated.fire(updateParts);\n  } finally {\n    propagatingLocally = wasMe;\n  }\n}\nlet propagatingLocally = false;\nif (typeof BroadcastChannel !== 'undefined') {\n  const bc = new BroadcastChannel(STORAGE_MUTATED_DOM_EVENT_NAME);\n  if (typeof bc.unref === 'function') {\n    bc.unref();\n  }\n  globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, changedParts => {\n    if (!propagatingLocally) {\n      bc.postMessage(changedParts);\n    }\n  });\n  bc.onmessage = ev => {\n    if (ev.data) propagateLocally(ev.data);\n  };\n} else if (typeof self !== 'undefined' && typeof navigator !== 'undefined') {\n  globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, changedParts => {\n    try {\n      if (!propagatingLocally) {\n        if (typeof localStorage !== 'undefined') {\n          localStorage.setItem(STORAGE_MUTATED_DOM_EVENT_NAME, JSON.stringify({\n            trig: Math.random(),\n            changedParts\n          }));\n        }\n        if (typeof self['clients'] === 'object') {\n          [...self['clients'].matchAll({\n            includeUncontrolled: true\n          })].forEach(client => client.postMessage({\n            type: STORAGE_MUTATED_DOM_EVENT_NAME,\n            changedParts\n          }));\n        }\n      }\n    } catch (_a) {}\n  });\n  if (typeof addEventListener !== 'undefined') {\n    addEventListener('storage', ev => {\n      if (ev.key === STORAGE_MUTATED_DOM_EVENT_NAME) {\n        const data = JSON.parse(ev.newValue);\n        if (data) propagateLocally(data.changedParts);\n      }\n    });\n  }\n  const swContainer = self.document && navigator.serviceWorker;\n  if (swContainer) {\n    swContainer.addEventListener('message', propagateMessageLocally);\n  }\n}\nfunction propagateMessageLocally({\n  data\n}) {\n  if (data && data.type === STORAGE_MUTATED_DOM_EVENT_NAME) {\n    propagateLocally(data.changedParts);\n  }\n}\nDexiePromise.rejectionMapper = mapError;\nsetDebug(debug, dexieStackFrameFilter);\nexport { Dexie$1 as Dexie, RangeSet, Dexie$1 as default, liveQuery, mergeRanges, rangesOverlap };\n","import Dexie, { Table } from 'dexie';\n\nimport { IPerson } from 'src/app/shared/interfaces/person.interface';\n\nexport class IndexedDBStorage extends Dexie {\n  public people?: Table<IPerson>;\n\n  constructor() {\n    super('demo-ng-forge');\n    // https://dexie.org/docs/Version/Version.stores()\n    this.version(1).stores({\n      people: '++id, firstName, lastName, gender, occupation'\n    });\n  }\n}\n\nexport const storageDb = new IndexedDBStorage();\n","import { Component, inject } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Subject } from 'rxjs';\r\nimport { Observable as DexieObservable } from 'dexie';\r\nimport { ForgeButtonModule, ForgeLabelValueModule, ForgeToolbarModule } from '@tylertech/forge-angular';\r\n\r\nimport { Utils } from 'src/utils';\r\nimport { AppDataService } from 'src/app/app-data.service';\r\nimport { IPerson } from 'src/app/shared/interfaces/person.interface';\r\nimport { storageDb } from './indexed-db-storage';\r\n@Component({\r\n  selector: 'app-storage',\r\n  standalone: true,\r\n  imports: [CommonModule, ForgeButtonModule, ForgeLabelValueModule, ForgeToolbarModule],\r\n  templateUrl: './storage.component.html',\r\n  styleUrls: ['./storage.component.scss']\r\n})\r\nexport class StorageComponent {\r\n  private appDataService = inject(AppDataService);\r\n\r\n  private readonly storageKey = 'app--storage-key';\r\n\r\n  public storageSpace = {\r\n    total: '?',\r\n    used: '?',\r\n    localStorage: '?'\r\n  };\r\n\r\n  public localStorageData?: IPerson[] = [];\r\n\r\n  // https://dexie.org/docs/liveQuery()\r\n  // public indexedDbData$ = from(liveQuery(() => storageDb.people.toArray()));\r\n  public indexedDbData?: IPerson[];\r\n\r\n  constructor() {\r\n    this.calcStorageSpace();\r\n    this.onLoadLocal();\r\n    this.onLoadDb();\r\n  }\r\n\r\n  public onSaveLocal() {\r\n    this.appDataService.getPeople().subscribe((result) => {\r\n      this.localStorageData = result.data;\r\n      localStorage.setItem(`${this.storageKey}:${new Date().getTime()}`, JSON.stringify(this.localStorageData));\r\n      this.calcStorageSpace();\r\n    });\r\n  }\r\n\r\n  public onDeleteLocal() {\r\n    this.localStorageData = undefined;\r\n    localStorage.removeItem(this.storageKey);\r\n    this.calcStorageSpace();\r\n  }\r\n\r\n  public onLoadLocal() {\r\n    const localStorageResult = localStorage.getItem(this.storageKey);\r\n    if (localStorageResult?.length) {\r\n      try {\r\n        this.localStorageData = JSON.parse(localStorageResult);\r\n      } catch {}\r\n    }\r\n  }\r\n\r\n  public onDeleteDb() {\r\n    storageDb.people?.clear().finally(() => {\r\n      this.onLoadDb();\r\n      this.calcStorageSpace();\r\n    });\r\n  }\r\n\r\n  public onSaveDb() {\r\n    this.appDataService.getPeople().subscribe((result) => {\r\n      storageDb.people\r\n        ?.bulkAdd([\r\n          ...result.data.map((p) => {\r\n            delete (p as any).id;\r\n            return p;\r\n          })\r\n        ])\r\n        .finally(() => {\r\n          this.onLoadDb();\r\n          this.calcStorageSpace();\r\n        });\r\n    });\r\n  }\r\n\r\n  public onLoadDb() {\r\n    storageDb.people\r\n      ?.toArray()\r\n      .then((result) => (this.indexedDbData = result))\r\n      .catch((error) => console.log(error));\r\n\r\n    // this.dexiePromiseToSubject(storageDb.people.toArray()).subscribe({\r\n    //   next: value => console.log(value),\r\n    //   error: error => console.log(console.error)\r\n    // });\r\n\r\n    // this.dexieObservableToSubject(liveQuery(() => storageDb.people.toArray()))\r\n    //   .subscribe({\r\n    //     next: result => this.indexedDbData = result,\r\n    //     error: error => console.log(error)\r\n    //   });\r\n  }\r\n\r\n  private calcStorageSpace() {\r\n    navigator.storage.estimate().then((result) => {\r\n      this.storageSpace = {\r\n        total: `${Utils.formatNumber((result.quota ?? 0) / 1000000)}mb`,\r\n        used: `${Utils.formatNumber((result.usage ?? 0) / 1000000)}mb`,\r\n        localStorage: `${Utils.formatNumber((localStorage.getItem(this.storageKey)?.length ?? 0) / 1000000)}mb`\r\n      };\r\n    });\r\n  }\r\n\r\n  private dexieObservableToSubject<T>(o: DexieObservable<T>): Subject<T> {\r\n    const subject = new Subject<T>();\r\n    const dexieSub = o.subscribe({\r\n      next: (value) => {\r\n        subject.next(value);\r\n        dexieSub.unsubscribe();\r\n        subject.complete();\r\n      },\r\n      error: (error) => {\r\n        subject.error(error);\r\n        dexieSub.unsubscribe();\r\n        subject.complete();\r\n      }\r\n    });\r\n    return subject;\r\n  }\r\n\r\n  private dexiePromiseToSubject<T>(p: Promise<T>): Subject<T> {\r\n    const subject = new Subject<T>();\r\n    p.then((value) => {\r\n      subject.next(value);\r\n      subject.complete();\r\n    }).catch((error) => {\r\n      subject.error(error);\r\n      subject.complete();\r\n    });\r\n    return subject;\r\n  }\r\n}\r\n","<forge-toolbar class=\"header\">\r\n  <div slot=\"start\">\r\n    <h2 class=\"forge-typography--subheading4\">Storage</h2>\r\n  </div>\r\n\r\n  <div slot=\"end\">\r\n    <span>Total: {{ storageSpace.total }}</span>\r\n    <span>Used: {{ storageSpace.used }}</span>\r\n    <span>Local: {{ storageSpace.localStorage }}</span>\r\n  </div>\r\n</forge-toolbar>\r\n\r\n<div class=\"body\">\r\n  <div class=\"card\">\r\n    <div class=\"card__actions\">\r\n      <forge-button variant=\"outlined\" (click)=\"onLoadLocal()\"> Load local </forge-button>\r\n      <forge-button variant=\"outlined\" (click)=\"onSaveLocal()\"> Save local </forge-button>\r\n      <forge-button variant=\"outlined\" (click)=\"onDeleteLocal()\"> Delete local </forge-button>\r\n    </div>\r\n    <forge-label-value>\r\n      <span slot=\"label\">localStorage</span>\r\n      <span slot=\"value\">{{ localStorageData | json }}</span>\r\n    </forge-label-value>\r\n  </div>\r\n\r\n  <div class=\"card\">\r\n    <div class=\"card__actions\">\r\n      <forge-button variant=\"outlined\" (click)=\"onLoadDb()\"> Load db </forge-button>\r\n      <forge-button variant=\"outlined\" (click)=\"onSaveDb()\"> Save db </forge-button>\r\n      <forge-button variant=\"outlined\" (click)=\"onDeleteDb()\"> Delete db </forge-button>\r\n    </div>\r\n\r\n    <forge-label-value>\r\n      <span slot=\"label\">indexedDB</span>\r\n      <span slot=\"value\">{{ indexedDbData | json }}</span>\r\n    </forge-label-value>\r\n  </div>\r\n</div>\r\n"],"mappings":"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","names":["_global","keys","isArray","extend","obj","extension","key","getProto","_hasOwn","hasOwn","prop","props","proto","setProp","defineProperty","functionOrGetSet","options","derive","Child","Parent","getOwnPropertyDescriptor","getPropertyDescriptor","pd","_slice","slice","args","start","end","override","origFunc","overridedFactory","assert","b","asap$1","fn","arrayToObject","array","extractor","result","item","nameAndValue","tryCatch","onerror","ex","getByKeyPath","keyPath","rv","i","l","val","period","innerObj","setByKeyPath","value","currentKeyPath","remainingKeyPath","delByKeyPath","kp","shallowClone","m","concat","flatten","a","intrinsicTypeNames","num","t","intrinsicTypes","x","circularRefs","deepClone","any","innerDeepClone","toString","toStringTag","o","iteratorSymbol","getIteratorOf","NO_CHAR_ARRAY","getArrayOf","arrayLike","it","isAsyncFunction","debug","setDebug","filter","libraryFilter","NEEDS_THROW_FOR_STACK","getErrorWithStack","e","prettyStack","exception","numIgnoredFrames","stack","frame","dexieErrorNames","idbDomErrorNames","errorList","defaultTexts","DexieError","name","msg","getMultiErrorMessage","failures","v","s","ModifyError","successCount","failedKeys","BulkError","pos","errnames","BaseException","exceptions","fullName","msgOrInner","inner","exceptionMap","mapError","domError","message","fullNameExceptions","nop","mirror","pureFunctionChain","f1","f2","callBoth","on1","on2","hookCreatingChain","res","onsuccess","res2","hookDeletingChain","hookUpdatingChain","modifications","reverseStoppableEventChain","promisableChain","thiz","INTERNAL","LONG_STACKS_CLIP_LIMIT","MAX_LONG_STACKS","ZONE_ECHO_LIMIT","resolvedNativePromise","nativePromiseProto","resolvedGlobalPromise","globalP","nativeP","nativePromiseThen","NativePromise","patchGlobalPromise","stack_being_generated","schedulePhysicalTick","physicalTick","hiddenDiv","asap","callback","microtickQueue","needsNewPhysicalTick","isOutsideMicroTick","unhandledErrors","rejectingErrors","currentFulfiller","rejectionMapper","globalPSD","globalError","uh","PSD","numScheduledCalls","tickFinalizers","DexiePromise","psd","handleRejection","executePromiseTask","thenProp","microTaskId","totalEchoes","then","onFulfilled","onRejected","possibleAwait","cleanup","decrementExpectedAwaits","resolve","reject","propagateToListener","Listener","nativeAwaitCompatibleWrap","linkToPreviousPromise","type","handler","err","PromiseReject","onFinally","stacks","getStack","ms","handle","snapShot","zone","values","onPossibleParallellAsync","remaining","newScope","usePSD","zoneProps","run_at_end_of_this_or_next_physical_tick","possiblePromises","results","p","reason","failure","promise","shouldExecuteTick","beginMicroTickScope","propagateAllListeners","endMicroTickScope","origProp","addPossiblyUnhandledError","listeners","len","finalizePhysicalTick","listener","cb","callListener","ret","markErrorAsHandled","limit","errorName","prev","numPrev","wasRootExec","callbacks","unhandledErrs","finalizers","finalizer","wrap","errorCatcher","outerScope","switchToZone","task","taskCounter","zoneStack","zoneEchoes","zone_id_counter","a1","a2","parent","globalEnv","getPatchedPromiseThen","incrementExpectedAwaits","possiblePromise","rejection","zoneEnterEcho","targetZone","zoneLeaveEcho","bEnteringZone","currentZone","enqueueNativeMicroTask","GlobalPromise","targetEnv","a3","job","outerZone","origThen","onResolved","UNHANDLEDREJECTION","event","eventData","tempTransaction","db","mode","storeNames","trans","DEXIE_VERSION","maxString","minKey","INVALID_KEY_ARGUMENT","STRING_EXPECTED","connections","isIEOrEdge","hasIEDeleteObjectStoreBug","hangsOnDeleteLargeKeyRange","dexieStackFrameFilter","DBNAMES_DB","READONLY","READWRITE","combine","filter1","filter2","AnyRange","workaroundForUndefinedPrimKey","Table","writeLocked","tableName","checkTableInTransaction","keyOrCrit","indexOrCrit","keyPaths","compoundIndex","ix","keyPathsInValidOrder","idxByName","idb","equals","idx","filterFunction","prevIndex","prevFilterFn","index","thenShortcut","offset","numRows","constructor","readHook","Class","content","auto","objToAdd","lastResult","keyOrObject","objects","keysOrOptions","wantResults","numObjects","objectsToAdd","numFailures","objectsToPut","numKeys","Events","ctx","evs","eventName","subscriber","add","chainFunction","defaultFunction","addConfiguredEvents","context","cfg","makeClassConstructor","prototype","createTableConstructor","tableSchema","isPlainKeyRange","ignoreLimitFilter","addFilter","addReplayFilter","factory","isLimitFilter","curr","addMatchFilter","getIndexOrStore","coreSchema","openCursor","coreTable","iter","coreTrans","set","union","cursor","advance","primaryKey","iterate","cursorPromise","valueMapper","mappedFn","c","wrappedFn","advancer","cmp","ta","tb","compareUint8Arrays","getUint8Array","compareArrays","al","bl","tsTag","Collection","count","parts","lastPart","lastIndex","getval","order","sorter","aVal","bVal","offsetLeft","rowsLeft","bIncludeStopEntry","indexName","strKey","found","changes","modifyer","anythingModified","outbound","extractKey","totalFailures","applyMutateResult","expectedCount","nextChunk","addValues","putValues","putKeys","deleteKeys","origValue","criteria","deleteCallback","range","coreRange","createCollectionConstructor","whereClause","keyRangeGenerator","keyRange","error","whereCtx","table","readingHook","simpleCompare","simpleCompareReverse","fail","collectionOrWhereClause","T","collection","WhereClause","emptyCollection","rangeEqual","upperFactory","dir","lowerFactory","nextCasing","lowerKey","upperNeedle","lowerNeedle","length","llp","lwrKeyChar","addIgnoreCaseAlgorithm","match","needles","suffix","upper","lower","compare","upperNeedles","lowerNeedles","direction","nextKeySuffix","needlesLen","initDirection","needleBounds","needle","nb","createRange","firstPossibleNeedle","lowestPossibleCasing","casing","lowerOpen","upperOpen","includeLower","includeUpper","str","n","ranges","ascending","descending","min","max","includeLowers","includeUppers","addRange","newRange","sortDirection","rangeSorter","rangePos","keyIsBeyondCurrentEntry","keyIsBeforeCurrentEntry","keyWithinCurrentRange","checkKey","createWhereClauseConstructor","orCollection","indexedDB","eventRejectHandler","preventDefault","DEXIE_STORAGE_MUTATED_EVENT_NAME","STORAGE_MUTATED_DOM_EVENT_NAME","globalEvents","Transaction","fnAndPSD","idbtrans","idbdb","dbOpenError","ev","bWriteLock","promiseLike","root","store","spin","currentWaitPromise","memoizedTables","transactionBoundTable","createTransactionConstructor","dbschema","chromeTransactionDurability","wasActive","createIndexSpec","unique","multi","compound","isPrimKey","nameFromKeyPath","createTableSchema","primKey","indexes","safariMultiStoreFix","getMaxKey","IdbKeyRange","getKeyExtractor","getSinglePathKeyExtractor","arrayify","_id_counter","getKeyPathAlias","createDBCore","tmpTrans","extractSchema","tables","autoIncrement","indexByKeyPath","multiEntry","makeIDBKeyRange","createDbCoreTable","mutate","isAddOrPut","req","reqs","errorHandler","args1","args2","done","query","reverse","source","_cursorContinue","_cursorContinuePrimaryKey","_cursorAdvance","doThrowCursorIsNotStarted","doThrowCursorIsStopped","gotOne","iterationPromise","resolveIteration","rejectIteration","guardedCallback","hasGetAll","request","nonInfinitLimit","idbKeyRange","keyCount","callbackCount","successHandler","schema","tableMap","createMiddlewareStack","stackImpl","middlewares","down","create","__spreadValues","createMiddlewareStacks","IDBKeyRange","generateMiddlewareStacks","tbl","setApiOnPlace","objs","tableNames","propDesc","removeTablesApi","lowerVersionFirst","runUpgraders","oldVersion","idbUpgradeTrans","globalSchema","rejectTransaction","transless","createTable","updateTablesAndIndexes","queue","versions","buildGlobalSchema","anyContentUpgraderHasRun","version","oldSchema","newSchema","adjustToExistingIndexNames","diff","getSchemaDiff","tuple","change","addIndex","idxName","contentUpgrade","upgradeSchema","contentUpgradeIsAsync","returnValue","promiseFollowed","decrementor","deleteRemovedTables","runQueue","createMissingTables","oldDef","newDef","oldIndexes","newIndexes","oldIdx","newIdx","storeName","j","idbindex","readGlobalSchema","verifyInstalledSchema","installedSchema","ch","dexieName","indexSpec","parseIndexSyntax","primKeyAndIndexes","indexNum","Version","stores","outSchema","storesSpec","upgradeFunction","createVersionConstructor","versionNumber","getDbNamesTable","dbNamesDB","Dexie$1","hasDatabasesNative","getDatabaseNames","infos","info","_onDatabaseCreated","_onDatabaseDeleted","vip","idbReady","isSafari","intervalId","tryIdb","dexieOpen","state","openCanceller","throwIfCancelled","resolveDbReady","upgradeTransaction","wasCreated","tryOpenDB","dbName","delreq","oldVer","objectStoreNames","fireRemainders","remainders","awaitIterator","iterator","callNext","doThrow","onSuccess","step","onError","getNext","next","extractTransactionArgs","_tableArgs_","scopeFunc","enterTransactionScope","parentTransaction","scopeFuncIsAsync","pad","createVirtualIndexMiddleware","__spreadProps","indexLookup","allVirtualIndexes","addVirtualIndexes","keyTail","lowLevelIndex","keyPathAlias","indexList","keyLength","isVirtual","virtualIndex","virtualKeyPath","findBestIndex","translateRange","translateRequest","createVirtualCursor","_continue","virtualIndexMiddleware","getObjectDiff","prfx","ap","bp","apTypeName","bpTypeName","getEffectiveKeys","hooksMiddleware","downCore","downTable","dxTrans","deleting","creating","updating","addPutOrDelete","deleteRange","getExistingValues","existingValues","contexts","existingValue","generatedPrimaryKey","objectDiff","additionalChanges","requestedValue","deleteNextChunk","effectiveKeys","getFromTransactionCache","cache","clone","cacheExistingValuesMiddleware","core","cachedResult","isEmptyRange","node","RangeSet","fromOrTree","to","rangeSet","mergeRanges","getRangeSetIterator","target","from","left","right","rebalance","rightWasCutOff","newSet","_addRangeSet","r","rangesOverlap","rangeSet1","rangeSet2","i1","nextResult1","i2","nextResult2","keyProvided","_a","_b","rootClone","oldRootRight","computeDepth","observabilityMiddleware","FULL_RANGE","tableClone","mutatedParts","getRangeSet","part","pkRangeSet","delsRangeSet","newObjs","oldCache","oldObjs","trackAffectedIndexes","getRange","readSubscribers","method","subscr","queriedIndex","queriedRanges","keysPromise","resultingKeys","pKeys","wantValues","pkey","addAffectedIndex","addKeyOrKeys","_","oldKey","newKey","_Dexie$1","deps","addons","subscribe","bSticky","unsubscribe","addon","versionInstance","level","mw","hasArguments","doDelete","onlyIfCompatible","idbMode","enterTransaction","symbolObservable","Observable","complete","extendObservabilitySet","liveQuery","querier","hasValue","currentValue","observable","observer","execute","exec","closed","accumMuts","currentObs","subscription","mutationListener","querying","startedListening","shouldNotify","doQuery","domDeps","Dexie","databaseName","generatorFn","promiseOrFunction","optionalTimeout","updatedParts","propagatingLocally","detail","propagateLocally","updateParts","wasMe","bc","changedParts","client","data","swContainer","propagateMessageLocally","IndexedDBStorage","Dexie","constructor","version","stores","people","storageDb","StorageComponent","constructor","appDataService","inject","AppDataService","storageKey","storageSpace","total","used","localStorage","localStorageData","calcStorageSpace","onLoadLocal","onLoadDb","onSaveLocal","getPeople","subscribe","result","data","setItem","Date","getTime","JSON","stringify","onDeleteLocal","undefined","removeItem","localStorageResult","getItem","length","parse","onDeleteDb","storageDb","people","clear","finally","onSaveDb","bulkAdd","map","p","id","toArray","then","indexedDbData","catch","error","console","log","navigator","storage","estimate","Utils","formatNumber","quota","usage","dexieObservableToSubject","o","subject","Subject","dexieSub","next","value","unsubscribe","complete","dexiePromiseToSubject","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","ɵɵadvance","ɵɵtextInterpolate1","ɵɵtextInterpolate","ɵɵpipeBind1","CommonModule","JsonPipe","ForgeButtonModule","ButtonComponent","ForgeLabelValueModule","LabelValueComponent","ForgeToolbarModule","ToolbarComponent","styles","_StorageComponent"],"x_google_ignoreList":[0]}