{"version":3,"file":"3428.5801377dc2443fc7.js","mappings":"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","names":["i","writtenProperties","forEach","target","propName","t","newOrigin","e","r","originOf","updateOrigin","I","S","g","title","id","declaredClass","j","type","L","_x","_L","apply","this","arguments","_asyncToGenerator","load","c","J","_x2","_x3","_x4","_J","beforeSave","a","write","P","messages","filter","map","name","message","details","ignoreUnsupported","length","errors","N","layer","layerJSON","isTable","layers","tables","O","w","h","typeKeywords","indexOf","T","_x5","_x6","_T","test","url","$","_x7","_x8","_$","customParameters","apiKey","o","s","fetchData","x","_x9","_x10","_x11","_x12","layerId","l","K","serviceJSON","n","layersJSON","u","p","A","y","itemResources","d","added","m","U","_x13","_x14","_x15","_x16","_U","removed","some","push","includes","sourceJSON","find","loaded","defaultPopupTemplate","popupInfo","toJSON","F","findIndex","R","portalItem","dynamicDataSource","_D","Promise","all","Set","size","_z","fullExtent","serverType","extent","v","b","_C","portal","signIn","user","addItem","item","data","folder","M","Y","_x23","_x24","_Y","E","error","f","update","_","_ref","D","_x17","slice","reload","clone","_x25","_x26","B","G","_x27","_x28","_x29","_G","q","z","_x18","_x19","C","_x20","_x21","_x22","_r","currentVersion","origin","itemUrl","readResourcePaths","_t","responseType","query","token"],"sourceRoot":"webpack:///","sources":["./node_modules/@arcgis/core/core/accessorSupport/originUtils.js","./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js","./node_modules/@arcgis/core/layers/save/featureLayerUtils.js","./node_modules/@arcgis/core/layers/support/fetchService.js","./node_modules/@arcgis/core/portal/support/jsonContext.js","./node_modules/@arcgis/core/support/requestPresets.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isMultiOriginJSONMixin as r}from\"../multiOriginJSONSupportUtils.js\";function i(i){i&&i.writtenProperties&&i.writtenProperties.forEach((({target:i,propName:t,newOrigin:e})=>{r(i)&&e&&i.originOf(t)!==e&&i.updateOrigin(t,e)}))}export{i as updateOrigins};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nfunction i(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{i as isMultiOriginJSONMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{difference as e}from\"../../core/arrayUtils.js\";import t from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{isNone as a,isSome as o}from\"../../core/maybe.js\";import{debounce as s,eachAlways as l}from\"../../core/promiseUtils.js\";import{updateOrigins as i}from\"../../core/accessorSupport/originUtils.js\";import n from\"../FeatureLayer.js\";import{parse as u}from\"../support/arcgisLayerUrl.js\";import{fetchFeatureService as p}from\"../support/fetchService.js\";import{isFeatureCollectionLayer as c,isFeatureServiceLayer as y}from\"../support/layerUtils.js\";import d from\"../../portal/Portal.js\";import m from\"../../portal/PortalItem.js\";import{createForItemWrite as f}from\"../../portal/support/jsonContext.js\";import{addTypeKeyword as w,TypeKeyword as h,getWGS84ExtentForItem as v,removeTypeKeyword as b}from\"../../portal/support/portalItemUtils.js\";const I=r.getLogger(\"esri.layers.FeatureLayer\"),S=\"Feature Service\";function g(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function j(e,r){if(r.type!==S)throw new t(\"feature-layer:portal-item-wrong-type\",g(e,`should have portal item of type \"${S}\"`))}async function L(e){if(await e.load(),c(e))throw new t(\"feature-layer:save\",g(e,\"using an in-memory source cannot be saved to a portal item\"))}function P(e,r){let a=(e.messages??[]).filter((({type:e})=>\"error\"===e)).map((({name:e,message:r,details:a})=>new t(e,r,a)));if(r?.ignoreUnsupported&&(a=a.filter((({name:e})=>\"layer:unsupported\"!==e&&\"symbol:unsupported\"!==e&&\"symbol-layer:unsupported\"!==e&&\"property:unsupported\"!==e&&\"url:unsupported\"!==e))),a.length>0)throw new t(\"feature-layer:save\",\"Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:a})}async function J(e,t,r){\"beforeSave\"in e&&\"function\"==typeof e.beforeSave&&await e.beforeSave();const a=e.write({},t);return P(t,r),a}function N(e){const{layer:t,layerJSON:r}=e;return t.isTable?{layers:[],tables:[r]}:{layers:[r],tables:[]}}function O(e){w(e,h.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}function E(e){const r=e.portalItem;if(!r)throw I.error(\"save: requires the portalItem property to be set\"),new t(\"feature-layer:portal-item-not-set\",g(e,\"requires the portalItem property to be set\"));if(!r.loaded)throw new t(\"feature-layer:portal-item-not-loaded\",g(e,\"cannot be saved to a portal item that does not exist or is inaccessible\"));j(e,r)}async function T(e,t){return/\\/\\d+\\/?$/.test(e.url??\"\")?N(t[0]):$(e,t)}async function $(e,t){const{layer:{url:r,customParameters:a,apiKey:o}}=t[0];let s=await e.fetchData(\"json\");s&&null!=s.layers&&null!=s.tables||(s=await x(s,{url:r??\"\",customParameters:a,apiKey:o},t.map((e=>e.layer.layerId))));for(const l of t)K(l.layer,l.layerJSON,s);return s}async function x(e,t,r){var a,o;e||(e={}),(a=e).layers||(a.layers=[]),(o=e).tables||(o.tables=[]);const{url:s,customParameters:l,apiKey:i}=t,{serviceJSON:n,layersJSON:u}=await p(s,{customParameters:l,apiKey:i}),c=A(e.layers,n.layers,r),y=A(e.tables,n.tables,r);e.layers=c.itemResources,e.tables=y.itemResources;const d=[...c.added,...y.added],m=u?[...u.layers,...u.tables]:[];return await U(e,d,s,m),e}function A(t,r,a){const o=e(t,r,((e,t)=>e.id===t.id));t=t.filter((e=>!o.removed.some((t=>t.id===e.id))));const s=o.added.map((({id:e})=>({id:e})));return s.forEach((({id:e})=>{t.push({id:e})})),{itemResources:t,added:s.filter((({id:e})=>!a.includes(e)))}}async function U(e,t,r,o){const s=t.map((({id:e})=>new n({url:r,layerId:e,sourceJSON:o.find((({id:t})=>t===e))})));await l(s.map((e=>e.load()))),s.forEach((t=>{const{layerId:r,loaded:o,defaultPopupTemplate:s}=t;if(!o||a(s))return;K(t,{id:r,popupInfo:s.toJSON()},e)}))}function K(e,t,r){e.isTable?F(r.tables,t):F(r.layers,t)}function F(e,t){if(!e)return;const r=e.findIndex((({id:e})=>e===t.id));-1===r?e.push(t):e[r]=t}function R(e){const{portalItem:t}=e;return y(e)&&!e.dynamicDataSource&&!!t?.loaded&&t.type===S}async function D(e){if(!e?.length)throw new t(\"feature-layer-utils-saveall:missing-parameters\",\"'layers' array should contain at least one feature layer\");await Promise.all(e.map((e=>e.load())));for(const o of e)if(!R(o))throw new t(\"feature-layer-utils-saveall:invalid-parameters\",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${g(o,\"does not conform\")}`,{layer:o});const r=e.map((e=>e.portalItem.id));if(new Set(r).size>1)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"All layers in the 'layers' array should be loaded from the same portal item\");const a=e.map((e=>e.layerId));if(new Set(a).size!==a.length)throw new t(\"feature-layer-utils-saveall:invalid-parameters\",\"'layers' array should contain only one instance each of layer or table in a feature service\")}function q(e,t){var r,a;let o=m.from(t);return o.id&&(o=o.clone(),o.id=null),(r=o).type??(r.type=S),(a=o).portal??(a.portal=d.getDefault()),j(e,o),o}async function z(e,t){const{url:r,layerId:a,title:s,fullExtent:l,isTable:i}=e,n=u(r),p=o(n)&&\"FeatureServer\"===n.serverType;t.url=p?r:`${r}/${a}`,t.title||(t.title=s),t.extent=null,!i&&o(l)&&(t.extent=await v(l)),b(t,h.METADATA),b(t,h.MULTI_LAYER),w(t,h.SINGLE_LAYER),i&&w(t,h.TABLE),O(t)}async function C(e,t,r){const a=e.portal;await(a?.signIn()),await(a?.user?.addItem({item:e,data:t,folder:r?.folder}))}const M=s(Y);async function Y(e,t){await L(e),E(e);const r=e.portalItem,a=f(r),o=await J(e,a,t),s=await T(r,[{layer:e,layerJSON:o}]);return O(r),await r.update({data:s}),i(a),r}const _=s((async(e,t)=>{await D(e);const r=e[0].portalItem,a=f(r),o=await Promise.all(e.map((e=>J(e,a,t)))),s=await T(r,e.map(((e,t)=>({layer:e,layerJSON:o[t]}))));return O(r),await r.update({data:s}),await Promise.all(e.slice(1).map((e=>e.portalItem.reload()))),i(a),r.clone()})),B=s(G);async function G(e,t,r){await L(e);const a=q(e,t),o=f(a),s=N({layer:e,layerJSON:await J(e,o,r)});return await z(e,a),await C(a,s,r),e.portalItem=a,i(o),a}export{M as save,_ as saveAll,B as saveAs};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{fetchArcGISServiceJSON as e}from\"../../support/requestPresets.js\";async function r(r,s){const a=await e(r,s);a.layers=a.layers.filter(t);const n={serviceJSON:a};if((a.currentVersion??0)<10.5)return n;const i=await e(r+\"/layers\",s);return n.layersJSON={layers:i.layers.filter(t),tables:i.tables},n}function t(e){return!e.type||\"Feature Layer\"===e.type}export{r as fetchFeatureService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{urlToObject as r}from\"../../core/urlUtils.js\";import t from\"../Portal.js\";function e(e){return{origin:\"portal-item\",url:r(e.itemUrl),portal:e.portal||t.getDefault(),portalItem:e,readResourcePaths:[]}}function o(e){return{origin:\"portal-item\",messages:[],writtenProperties:[],url:e.itemUrl?r(e.itemUrl):null,portal:e.portal||t.getDefault(),portalItem:e}}export{e as createForItemRead,o as createForItemWrite};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";async function t(t,o){const{data:r}=await e(t,{responseType:\"json\",query:{f:\"json\",...o?.customParameters,token:o?.apiKey}});return r}export{t as fetchArcGISServiceJSON};\n"],"x_google_ignoreList":[0,1,2,3,4,5]}