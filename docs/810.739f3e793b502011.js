"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[810],{5810:(X,f,l)=>{l.r(f),l.d(f,{SearchComponent:()=>Y});var e=l(8559),i=l(496),m=l(8758),s=l(4607),g=l(5342),_=l(9452),C=l(271),v=l(827),d=l(316),b=l(7123),S=l(2575);let P=(()=>{class a{constructor(){this.dialogConfig=(0,e.WQX)(s.Qsx),this.dialogRef=(0,e.WQX)(s.cez),this.formGroup=new i.gE({name:new i.MJ(null,{validators:[i.k0.required]}),description:new i.MJ,isDefault:new i.MJ,isPublic:new i.MJ}),this.record=this.dialogConfig,this.formGroup.patchValue(this.record)}onSave(){this.dialogRef.close({...this.record,...this.formGroup.getRawValue()})}onCancel(){this.formGroup.markAsPristine(),this.dialogRef.close(!1)}static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-search-save"]],standalone:!0,features:[e.aNF],decls:22,vars:3,consts:[["dialogTitle","Save search"],["novalidate","","autocomplete","off",1,"form-grid",3,"formGroup"],["required","",3,"appFormControlInvalid"],["type","text","id","search-save--name","formControlName","name","autofocus",""],["for","search-save--name","slot","label"],["slot","support-text",1,"app-form-control-invalid"],["type","text","id","search-save--description","formControlName","description"],["for","search-save--description","slot","label"],["formControlName","isDefault"],["formControlName","isPublic"],["app-dialog-footer",""],["slot","end","variant","outlined",3,"click"],["slot","end","variant","raised",3,"click","disabled"]],template:function(r,o){1&r&&(e.j41(0,"app-dialog",0)(1,"form",1)(2,"forge-text-field",2),e.nrm(3,"input",3),e.j41(4,"label",4),e.EFF(5,"Name"),e.k0s(),e.j41(6,"span",5),e.EFF(7,"A name is required"),e.k0s()(),e.j41(8,"forge-text-field"),e.nrm(9,"input",6),e.j41(10,"label",7),e.EFF(11,"Description"),e.k0s()(),e.j41(12,"div")(13,"forge-checkbox",8),e.EFF(14," Make this your default search "),e.k0s(),e.j41(15,"forge-checkbox",9),e.EFF(16," Make this search public "),e.k0s()()(),e.qex(17,10),e.j41(18,"forge-button",11),e.bIt("click",function(){return o.onCancel()}),e.EFF(19," Cancel "),e.k0s(),e.j41(20,"forge-button",12),e.bIt("click",function(){return o.onSave()}),e.EFF(21," Save "),e.k0s(),e.bVm(),e.k0s()),2&r&&(e.R7$(),e.Y8G("formGroup",o.formGroup),e.R7$(),e.Y8G("appFormControlInvalid",o.formGroup.controls.name),e.R7$(18),e.Y8G("disabled",o.formGroup.invalid||!o.formGroup.dirty))},dependencies:[d.MD,i.X1,i.qT,i.me,i.BC,i.cb,i.j4,i.JD,s.ei2,s.Qpp,s.VQY,s.EQJ,s.PYJ,s.nVi,s.vzf,s.xYY,s.LHr,b.W,S.m],styles:['\n\n\n\n\n[_nghost-%COMP%]{display:contents}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,320px);gap:16px}.form-grid--row-break[_ngcontent-%COMP%]{grid-column-start:1}.form-grid--col-span[_ngcontent-%COMP%]{grid-column:1/-1}.form-grid--col-span.form-grid--col-span[_ngcontent-%COMP%]{width:auto}.form-grid--col-span2[_ngcontent-%COMP%]{grid-column:span 2}.form-grid--col-span2.form-grid--col-span2[_ngcontent-%COMP%]{width:656px}.form-grid--col-span3[_ngcontent-%COMP%]{grid-column:span 3}.form-grid--col-span3.form-grid--col-span3[_ngcontent-%COMP%]{width:992px}.form-grid[_ngcontent-%COMP%]   [slot=value][_ngcontent-%COMP%]:empty:before{content:"n/a";color:var(--forge-theme-text-medium);font-style:italic}.app-form-control-invalid[_ngcontent-%COMP%]{display:none}.app-form-control-invalid[invalid][_ngcontent-%COMP%], .app-form-control-invalid[invalid][_ngcontent-%COMP%]   .app-form-control-invalid[_ngcontent-%COMP%]{display:block}']})}return a})();var x=l(2267);const O=["*"],k={provide:i.kq,useExisting:(0,e.Rfq)(()=>u),multi:!0};let u=(()=>{class a{constructor(){this.renderer=(0,e.WQX)(e.sFG),this.elementRef=(0,e.WQX)(e.aKT),this.onChange=t=>{},this.onTouched=()=>{}}get forgeCheckBox(){return this.elementRef.nativeElement.querySelector("forge-checkbox")}elementBlur(){this.onTouched()}ngOnInit(){this.forgeCheckBox.addEventListener("change",()=>{this.value=!0!==this.value&&(!1!==this.value||null),this.setCheckboxState(),this.onChange(this.value),this.onTouched()})}writeValue(t){this.value=t,this.setCheckboxState()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.forgeCheckBox.disabled=t}setCheckboxState(){!0===this.value?(this.renderer.setProperty(this.forgeCheckBox,"checked",!0),this.renderer.setProperty(this.forgeCheckBox,"indeterminate",!1)):!1===this.value?(this.renderer.setProperty(this.forgeCheckBox,"checked",!1),this.renderer.setProperty(this.forgeCheckBox,"indeterminate",!1)):requestAnimationFrame(()=>{this.renderer.setProperty(this.forgeCheckBox,"checked",!1),requestAnimationFrame(()=>{this.renderer.setProperty(this.forgeCheckBox,"indeterminate",!0)})})}static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-checkbox-indeterminate"]],hostBindings:function(r,o){1&r&&e.bIt("blur",function(){return o.elementBlur()})},standalone:!0,features:[e.Jv_([k]),e.aNF],ngContentSelectors:O,decls:1,vars:0,template:function(r,o){1&r&&(e.NAR(),e.SdG(0))},styles:["[_nghost-%COMP%]{display:contents}"]})}return a})();const F=["searchesPopup"],M=(a,p)=>p.id,y=()=>({name:"name"}),G=()=>({name:"dateOfBirth"}),w=()=>({name:"address"}),j=a=>({"operator__addon--selected":a});function N(a,p){if(1&a&&(e.nrm(0,"forge-divider",31),e.j41(1,"span",32),e.EFF(2),e.k0s(),e.j41(3,"span",33),e.EFF(4),e.k0s()),2&a){const t=e.XpG();e.R7$(2),e.JRh(t.searchName),e.R7$(2),e.JRh(t.searchDescription)}}function T(a,p){if(1&a){const t=e.RV6();e.j41(0,"forge-list-item",36)(1,"button",35),e.EFF(2),e.k0s(),e.j41(3,"div",8)(4,"forge-icon-button",37),e.bIt("mousedown",function(o){const n=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.onSearchAction(o,"edit",n.id))}),e.nrm(5,"forge-icon",38),e.k0s(),e.j41(6,"forge-icon-button",39),e.bIt("mousedown",function(o){const n=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.onSearchAction(o,"delete",n.id))}),e.nrm(7,"forge-icon",40),e.k0s()()()}if(2&a){const t=p.$implicit;e.Y8G("value",t.id),e.R7$(2),e.JRh(t.name)}}function E(a,p){if(1&a){const t=e.RV6();e.j41(0,"forge-list",34),e.bIt("forge-list-item-select",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.onSearchAction(o,"search",o.detail.value))}),e.j41(1,"forge-list-item")(2,"button",35),e.EFF(3,"Add new search"),e.k0s()(),e.nrm(4,"forge-divider"),e.Z7z(5,T,8,2,"forge-list-item",36,M),e.k0s()}if(2&a){const t=e.XpG();e.R7$(5),e.Dyx(t.searchCache.searches)}}function R(a,p){1&a&&e.eu8(0)}function I(a,p){1&a&&e.eu8(0)}function V(a,p){1&a&&e.eu8(0)}function B(a,p){if(1&a){const t=e.RV6();e.j41(0,"forge-icon-button",41,4),e.bIt("click",function(o){const n=e.eBV(t).name,c=e.sdS(1),h=e.XpG();return e.Njj(h.onOperatorPopupOpen(o,c,n))}),e.nrm(2,"forge-icon",42),e.k0s()}if(2&a){let t;const r=p.name,o=e.XpG(),n=e.sdS(52);e.Y8G("ngClass",e.eq3(2,j,null==(t=o.formGroup.get(r))?null:t.value.operator))("forgePopover",n)}}function D(a,p){1&a&&e.nrm(0,"forge-icon",45)}function J(a,p){if(1&a&&(e.j41(0,"forge-list-item",44)(1,"button",35),e.EFF(2),e.k0s(),e.DNE(3,D,1,0,"forge-icon",45),e.k0s()),2&a){const t=p.$implicit,r=e.XpG(2);e.Y8G("value",t.value)("selected",(null==r.operatorPopupFormGroup?null:r.operatorPopupFormGroup.value.operator)===t.value),e.R7$(2),e.JRh(t.label),e.R7$(),e.vxM(3,(null==r.operatorPopupFormGroup?null:r.operatorPopupFormGroup.value.operator)===t.value?3:-1)}}function $(a,p){if(1&a){const t=e.RV6();e.j41(0,"forge-list",43),e.bIt("forge-list-item-select",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.onOperatorSelected(o.detail.value))}),e.Z7z(1,J,4,4,"forge-list-item",44,e.Vm6),e.k0s()}if(2&a){const t=e.XpG();e.R7$(),e.Dyx(t.operatorOptions)}}let Y=(()=>{class a{constructor(){this.dialogService=(0,e.WQX)(s.o3x),this.toastService=(0,e.WQX)(s.fwc),this.dataService=(0,e.WQX)(v.D),this.storageKey="search-searches",this.searchCache={activeSearchId:void 0,searches:[]},this.formGroup=new i.gE({name:new i.gE({value:new i.MJ,operator:new i.MJ}),dateOfBirth:new i.gE({value:new i.MJ,operator:new i.MJ}),address:new i.gE({value:new i.MJ,operator:new i.MJ}),include:new i.MJ,facet:new i.MJ}),this.facetOptions=[],this.operatorOptions=[{value:null,label:"None"},{value:0,label:"Equal"},{value:1,label:"Not equal"},{value:2,label:"Greater than"},{value:3,label:"Less than"},{value:4,label:"Greater than equal to"},{value:5,label:"Less than equal to"},{value:6,label:"Range"},{value:7,label:"Contains"},{value:8,label:"Not contains"},{value:9,label:"Empty"}],this.nameFilter=t=>(0,g.s)(this.dataService.getPeople().pipe((0,C.T)(r=>r.data.filter(o=>o.firstName.toLocaleLowerCase().includes(t.toLocaleLowerCase())||o.lastName.toLocaleLowerCase().includes(t.toLocaleLowerCase())).map(o=>({label:`${o.firstName} ${o.lastName}`,value:o.id}))))),this.facetFilter=t=>(0,_.of)(this.facetOptions)}ngOnInit(){this.dataService.getSearches(this.storageKey).subscribe(t=>{this.searchCache.searches=t||[];const r=this.searchCache.searches.find(o=>o.id===this.searchCache.activeSearchId);(0,m.O9)(r)&&(this.searchName=r?.name,this.searchDescription=r?.description,this.formGroup.patchValue(r?.filters))});for(let t=0;t<20;t++)this.facetOptions.push({value:t,label:`Facet Option ${t}`})}onSearch(){}onSaveSearch(t){const r=(0,m.O9)(t)?t:this.searchCache.searches.find(n=>n.id===this.searchCache.activeSearchId);this.dialogService.open(P,{data:{id:r?.id,name:r?.name,description:r?.description,isDefault:r?.isDefault,isPublic:r?.isPublic,filters:this.formGroup.value},options:{persistent:!0}}).afterClosed.subscribe(n=>{if(n){if((0,m.O9)(n.id)){const c=this.searchCache.searches.findIndex(h=>h.id===n.id);-1!==c&&(this.searchCache.searches[c]=n)}else n.id=this.searchCache.searches.length?Math.max(...this.searchCache.searches.map(c=>c.id))+1:1,this.searchCache.searches.push(n);this.dataService.saveSearches(this.storageKey,this.searchCache.searches).subscribe({next:()=>{this.searchCache.activeSearchId=n.id,this.searchName=n.name,this.searchDescription=n.description,this.toastService.show({message:"Search saved"})},error:()=>this.toastService.show({message:"Search save failed"})})}})}onClearSearch(){this.formGroup.controls.include.setValue(null),this.formGroup.reset()}onSearchAction(t,r,o){if(t.stopPropagation(),this.searchesPopup?.close(),(0,m.O9)(o)){const n=this.searchCache.searches.find(c=>c.id===o);if((0,m.O9)(n))switch(r){case"search":this.searchCache.activeSearchId=n?.id,this.searchName=n?.name,this.searchDescription=n?.description,this.formGroup.patchValue(n?.filters),this.onSearch();break;case"edit":this.searchCache.activeSearchId=n?.id,this.searchName=n?.name,this.searchDescription=n?.description,this.formGroup.patchValue(n?.filters);break;case"copy":{const c=JSON.parse(JSON.stringify(n));c.id=void 0,c.name=`${c.name} copy`,c.isDefault=!1,this.onSaveSearch(c);break}case"delete":{const c=this.searchCache.searches.findIndex(h=>h.id===n?.id);-1!==c&&(this.searchCache.searches.splice(c,1),this.dataService.saveSearches(this.storageKey,this.searchCache.searches).subscribe(h=>{})),this.searchCache.activeSearchId===n?.id&&(this.searchCache.activeSearchId=void 0,this.searchName="",this.searchDescription="");break}}}else this.searchCache.activeSearchId=void 0,this.searchName="",this.searchDescription="",this.formGroup.reset()}onOperatorPopupOpen(t,r,o){t.stopPropagation(),this.operatorPopupFormGroup=this.formGroup.get(o),this.operatorPopup=r,this.operatorPopup.open()}onOperatorSelected(t){t=parseInt(t,10),this.operatorPopupFormGroup?.get("operator")?.setValue(t),this.operatorPopup?.close()}static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-search"]],viewQuery:function(r,o){if(1&r&&e.GBs(F,5),2&r){let n;e.mGM(n=e.lsd())&&(o.searchesPopup=n.first)}},standalone:!0,features:[e.aNF],decls:53,vars:18,consts:[["searchesPopup","forgePopover"],["searchesPopupTemplate",""],["opertatorAddonTemplate",""],["operatorPopupTemplate",""],["operatorPopup","forgePopover"],[1,"header"],["slot","start"],[1,"forge-typography--subheading4"],["slot","end"],["variant","outlined",3,"click"],["variant","outlined",3,"click","forgePopover","forgePopoverPlacement"],["name","arrow_drop_down"],["variant","raised",3,"click"],[1,"body"],["novalidate","","autocomplete","off",1,"form",3,"ngSubmit","formGroup"],["formGroupName","name"],["multiple","true","formControlName","value","allow-unmatched","true",3,"filter"],["type","text","id","search--name"],["for","search--name"],["slot","end","name","arrow_drop_down",1,"forge-dropdown-icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formGroupName","dateOfBirth"],["formControlName","value"],["type","text","id","search--date-of-birth"],["for","search--date-of-birth"],["formGroupName","address"],["type","text","id","search--address","formControlName","value"],["for","search--address","slot","label"],["formControlName","facet","label","Facet",3,"optionFilter"],["formControlName","include"],["id","search--include"],["vertical",""],[1,"forge-typography--heading2"],[1,"forge-typography--subheading1"],[1,"searches-popup",3,"forge-list-item-select"],["type","button"],[3,"value"],["aria-label","Edit",3,"mousedown"],["name","edit"],["aria-label","Delete",3,"mousedown"],["name","delete"],["slot","addon-end","aria-label","Filter operator",1,"operator__addon",3,"click","ngClass","forgePopover"],["name","bolt"],[1,"operator-popup",3,"forge-list-item-select"],[3,"value","selected"],["name","check","slot","end"]],template:function(r,o){if(1&r){const n=e.RV6();e.j41(0,"forge-toolbar",5)(1,"div",6)(2,"h2",7),e.EFF(3,"Search"),e.k0s(),e.DNE(4,N,5,2),e.k0s(),e.j41(5,"div",8)(6,"forge-button",9),e.bIt("click",function(){return e.eBV(n),e.Njj(o.onSaveSearch())}),e.EFF(7," Save search "),e.k0s(),e.j41(8,"forge-button",10,0),e.bIt("click",function(){e.eBV(n);const h=e.sdS(9);return e.Njj(h.open())}),e.j41(10,"span"),e.EFF(11,"Saved searches"),e.k0s(),e.nrm(12,"forge-icon",11),e.k0s(),e.j41(13,"forge-button",9),e.bIt("click",function(){return e.eBV(n),e.Njj(o.onClearSearch())}),e.EFF(14," Clear all "),e.k0s(),e.j41(15,"forge-button",12),e.bIt("click",function(){return e.eBV(n),e.Njj(o.onSearch())}),e.EFF(16," Search "),e.k0s()()(),e.DNE(17,E,7,0,"ng-template",null,1,e.C5r),e.j41(19,"div",13)(20,"form",14),e.bIt("ngSubmit",function(){return e.eBV(n),e.Njj(o.onSearch())}),e.qex(21,15),e.j41(22,"forge-autocomplete",16)(23,"forge-text-field"),e.nrm(24,"input",17),e.j41(25,"label",18),e.EFF(26,"Name"),e.k0s(),e.nrm(27,"forge-icon",19),e.DNE(28,R,1,0,"ng-container",20),e.k0s()(),e.bVm(),e.qex(29,21),e.j41(30,"forge-date-picker",22)(31,"forge-text-field"),e.nrm(32,"input",23),e.j41(33,"label",24),e.EFF(34,"Date"),e.k0s(),e.DNE(35,I,1,0,"ng-container",20),e.k0s()(),e.bVm(),e.qex(36,25),e.j41(37,"forge-text-field"),e.nrm(38,"input",26),e.j41(39,"label",27),e.EFF(40,"Address"),e.k0s(),e.DNE(41,V,1,0,"ng-container",20),e.k0s(),e.bVm(),e.nrm(42,"app-autocomplete-range",28),e.j41(43,"app-checkbox-indeterminate",29)(44,"forge-checkbox",30),e.EFF(45," Include "),e.k0s()()(),e.j41(46,"p"),e.EFF(47),e.nI1(48,"json"),e.k0s()(),e.DNE(49,B,3,4,"ng-template",null,2,e.C5r)(51,$,3,0,"ng-template",null,3,e.C5r)}if(2&r){const n=e.sdS(18),c=e.sdS(50);e.R7$(4),e.vxM(4,o.searchCache.activeSearchId?4:-1),e.R7$(4),e.Y8G("forgePopover",n)("forgePopoverPlacement","bottom-start"),e.R7$(12),e.Y8G("formGroup",o.formGroup),e.R7$(2),e.Y8G("filter",o.nameFilter),e.R7$(6),e.Y8G("ngTemplateOutlet",c)("ngTemplateOutletContext",e.lJ4(15,y)),e.R7$(7),e.Y8G("ngTemplateOutlet",c)("ngTemplateOutletContext",e.lJ4(16,G)),e.R7$(6),e.Y8G("ngTemplateOutlet",c)("ngTemplateOutletContext",e.lJ4(17,w)),e.R7$(),e.Y8G("optionFilter",o.facetFilter),e.R7$(5),e.JRh(e.bMT(48,13,o.formGroup.getRawValue()))}},dependencies:[d.MD,d.YU,d.T3,d.TG,i.X1,i.qT,i.me,i.BC,i.cb,i.j4,i.JD,i.$R,s.UHk,s.vP6,s.sHR,s.ei2,s.Qpp,s.VQY,s.PYJ,s.mJn,s.dBB,s.Iah,s.b$f,s.heP,s.nVi,s.xBz,s.RlV,s.vzf,s.nkw,s.Ptl,s.svQ,s.sB8,s.fNY,s.Hci,s.xYY,s.LHr,s.N1z,s.H_6,x.h,u],styles:['\n\n\n\n\n[_nghost-%COMP%]{display:grid;grid-template-rows:auto 1fr;overflow:hidden}  .searches-popup{min-width:280px}  .searches-popup *[slot=trailing]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;margin-right:-16px}  .operator-popup{min-width:200px}  .operator-popup forge-list-item{cursor:pointer}.header[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap}.header[_ngcontent-%COMP%]   forge-button[_ngcontent-%COMP%]{margin-left:16px}.header[_ngcontent-%COMP%]   [slot=start][_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center}.header[_ngcontent-%COMP%]   [slot=start][_ngcontent-%COMP%]   forge-divider[_ngcontent-%COMP%]{margin:0 16px;height:32px}.header[_ngcontent-%COMP%]   [slot=start][_ngcontent-%COMP%]   span[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:16px}.body[_ngcontent-%COMP%]{overflow:auto;padding:24px}.body[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{background-color:var(--forge-theme-surface);border-radius:var(--forge-shape-medium);border-color:var(--forge-theme-outline);box-shadow:var(--forge-elevation-1);padding:16px;display:grid;grid-template-columns:repeat(auto-fill,320px);gap:16px}.body[_ngcontent-%COMP%]   .form--row-break[_ngcontent-%COMP%]{grid-column-start:1}.body[_ngcontent-%COMP%]   .form--col-span[_ngcontent-%COMP%]{grid-column:1/-1}.body[_ngcontent-%COMP%]   .form--col-span.body[_ngcontent-%COMP%]   .form--col-span[_ngcontent-%COMP%]{width:auto}.body[_ngcontent-%COMP%]   .form--col-span2[_ngcontent-%COMP%]{grid-column:span 2}.body[_ngcontent-%COMP%]   .form--col-span2.body[_ngcontent-%COMP%]   .form--col-span2[_ngcontent-%COMP%]{width:656px}.body[_ngcontent-%COMP%]   .form--col-span3[_ngcontent-%COMP%]{grid-column:span 3}.body[_ngcontent-%COMP%]   .form--col-span3.body[_ngcontent-%COMP%]   .form--col-span3[_ngcontent-%COMP%]{width:992px}.body[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   [slot=value][_ngcontent-%COMP%]:empty:before{content:"n/a";color:var(--forge-theme-text-medium);font-style:italic}.operator__addon--selected[_ngcontent-%COMP%]{color:var(--forge-theme-info)}']})}return a})()}}]);
//# sourceMappingURL=810.739f3e793b502011.js.map