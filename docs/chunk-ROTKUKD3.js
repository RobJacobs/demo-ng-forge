import{a as be}from"./chunk-AQM4HU7X.js";import{a as ye}from"./chunk-Q65ABCTW.js";import{Ab as te,Ac as ce,Dc as fe,E as x,Ec as se,Hb as re,Ib as ne,Jb as ie,Ob as oe,Pb as le,Tc as _e,Uc as ge,Vc as xe,g as L,gb as j,i as H,ib as S,k as U,kb as J,kd as ve,lb as K,ld as Ce,nb as P,nc as ae,ob as _,oc as pe,pc as ue,qb as X,qc as me,sb as z,tb as W,vb as Y,wb as Z,xb as ee,yb as Q,zc as de}from"./chunk-TDRYUBHM.js";import{$a as i,$b as I,Ab as w,Bb as B,Cb as b,Db as q,Gb as V,Hb as m,Kb as s,Pb as F,Qb as u,Rb as G,Sb as N,Zb as D,ac as E,bc as $,cc as R,gc as A,ka as k,mb as c,pb as p,tb as T,ub as v,va as h,vb as C,wa as O,wb as y,xb as o,yb as a,zb as f}from"./chunk-UO34YWUS.js";import"./chunk-NCBA65HR.js";var Fe=(t,l)=>({formGroup:t,index:l}),he=t=>({formGroup:t});function Oe(t,l){t&1&&b(0)}function Te(t,l){if(t&1&&(o(0,"div",4),c(1,Oe,1,0,"ng-container",7),a()),t&2){let e=l.$implicit,r=l.$index;m();let n=F(11);i(),p("ngTemplateOutlet",n)("ngTemplateOutletContext",E(2,Fe,e,r))}}function Ve(t,l){t&1&&b(0)}function Ge(t,l){if(t&1&&c(0,Ve,1,0,"ng-container",7),t&2){let e=m().formGroup;m();let r=F(13);p("ngTemplateOutlet",r)("ngTemplateOutletContext",I(2,he,e))}}function Se(t,l){if(t&1&&(o(0,"forge-option",17),u(1),a()),t&2){let e=l.$implicit;p("value",e.value),i(),G(e.label)}}function Me(t,l){if(t&1&&(o(0,"div",18)(1,"forge-text-field",11),f(2,"input",24),o(3,"label",25),u(4,"Minimum"),a(),o(5,"span",15),u(6,"A minimum value is required"),a()(),o(7,"forge-text-field",11),f(8,"input",26),o(9,"label",25),u(10,"Maximum"),a(),o(11,"span",15),u(12),a()()()),t&2){let e=m(),r=e.formGroup,n=e.index;i(),p("appFormControlInvalid",r.controls.minValue),i(),s("id","query-builder--filter-min-"+n),i(),s("for","query-builder--filter-min-"+n),i(4),p("appFormControlInvalid",r.controls.maxValue),i(),s("id","query-builder--filter-max-"+n),i(),s("for","query-builder--filter-max-"+n),i(3),N(" ",r.controls.maxValue.errors.required?"A maximum value is required":r.controls.maxValue.errors.range?"Max value must be greater or equal to min value":""," ")}}function we(t,l){if(t&1&&(o(0,"forge-text-field",11),f(1,"input",27),o(2,"label",25),u(3,"Value"),a(),o(4,"span",15),u(5,"A value is required"),a()()),t&2){let e=m(),r=e.formGroup,n=e.index;p("appFormControlInvalid",r.controls.value),i(),s("id","query-builder--filter-value-"+n),i(),s("for","query-builder--filter-value-"+n)}}function Be(t,l){t&1&&b(0)}function qe(t,l){t&1&&b(0)}function Ie(t,l){if(t&1&&(c(0,Be,1,0,"ng-container",7),o(1,"div",4),c(2,qe,1,0,"ng-container",7),a()),t&2){let e=l.$implicit,r=l.$index;m(3);let n=F(11),d=F(13);p("ngTemplateOutlet",d)("ngTemplateOutletContext",I(4,he,e)),i(2),p("ngTemplateOutlet",n)("ngTemplateOutletContext",E(6,Fe,e,r))}}function Ee(t,l){if(t&1&&(w(0,3),C(1,Ie,3,9,null,null,v),B()),t&2){let e=m().formGroup;i(),y(e.controls.filters.controls)}}function Ae(t,l){if(t&1){let e=q();c(0,Ge,1,4,"ng-container"),w(1,8),o(2,"div",9)(3,"forge-autocomplete",10)(4,"forge-text-field",11),f(5,"input",12),o(6,"label",13),u(7,"Property"),a(),f(8,"forge-icon",14),o(9,"span",15),u(10,"A property is required"),a()()(),o(11,"forge-select",16),C(12,Se,2,2,"forge-option",17,v),o(14,"span",15),u(15,"An operator is required"),a()(),c(16,Me,13,7,"div",18)(17,we,6,3,"forge-text-field",11),o(18,"div",19)(19,"forge-menu",20),V("forge-menu-select",function(n){let d=h(e).formGroup,g=m();return O(g.onAddFilter(d,n.detail.value))}),o(20,"forge-icon-button",21),f(21,"forge-icon",6),a()(),o(22,"forge-icon-button",22),V("click",function(){let n=h(e).formGroup,d=m();return O(d.onDeleteFilter(n))}),f(23,"forge-icon",23),a()()(),c(24,Ee,3,0,"ng-container",3),B()}if(t&2){let e=l.formGroup,r=l.index,n=m();T(r>0?0:-1),i(),p("formGroup",e),i(2),p("filter",n.propertyFilter),i(),p("appFormControlInvalid",e.controls.property),i(),s("id","query-builder--filter-property-"+r),i(),s("for","query-builder--filter-property-"+r),i(5),p("appFormControlInvalid",e.controls.operator),i(),y(n.operatorOptions),i(4),T(e.controls.operator.value===6?16:17),i(3),p("options",n.filterOptions),i(5),T(e.controls.filters.controls!=null&&e.controls.filters.controls.length?24:-1)}}function Pe(t,l){if(t&1&&(o(0,"forge-option",17),u(1),a()),t&2){let e=l.$implicit;p("value",e.value),i(),G(e.label)}}function Qe(t,l){if(t&1&&(o(0,"div",28)(1,"forge-select",29),C(2,Pe,2,2,"forge-option",17,v),a()()),t&2){let e=l.formGroup,r=m();i(),p("formControl",e.get("condition")),i(),y(r.conditionOptions)}}var Ke=(()=>{class t{constructor(){this.formGroup=new P({filters:new Q([this.buildFilterFormGroup()])}),this.conditionOptions=[{value:"and",label:"And"},{value:"or",label:"Or"}],this.propertyOptions=[{value:"firstName",label:"First name"},{value:"lastName",label:"Last name"},{value:"dateOfBirth",label:"Date of birth"},{value:"gender",label:"Gender"},{value:"occupation",label:"Occupation"}],this.operatorOptions=[{value:0,label:"Equal"},{value:1,label:"Not equal"},{value:2,label:"Greater than"},{value:3,label:"Less than"},{value:4,label:"Greater than equal to"},{value:5,label:"Less than equal to"},{value:6,label:"Range"},{value:7,label:"Contains"},{value:8,label:"Not contains"},{value:9,label:"Empty"}],this.filterOptions=[{value:"condition",label:"Add condition"},{value:"group",label:"Add group"}],this.propertyFilter=e=>ye.filterData(this.propertyOptions,[{key:"label",value:e}])}onAddFilter(e,r){if(e===this.formGroup)this.formGroup.controls.filters.push(this.buildFilterFormGroup());else switch(r){case"condition":{let n=e.parent.controls.indexOf(e)+1;e.parent.insert(n,this.buildFilterFormGroup());break}case"group":e.get("filters").push(this.buildFilterFormGroup());break}}onDeleteFilter(e){let r=e.parent,n=r.controls.indexOf(e);n!==-1&&r.removeAt(n)}buildFilterFormGroup(e){return new P({property:new _(e?.property,{validators:[S.required]}),condition:new _(e?.condition||"and",{validators:[S.required]}),operator:new _(e?.operator,{validators:[S.required]}),value:new _(e?.value,{validators:[this.validateFilterValue("value")]}),minValue:new _(e?.minValue,{validators:[this.validateFilterValue("minValue")]}),maxValue:new _(e?.minValue,{validators:[this.validateFilterValue("maxValue")]}),filters:new Q([])})}validateFilterValue(e){return r=>{let n=r.parent;if(!n)return null;let d=n.value.operator;if(!x(d))return null;switch(d){case 6:{if(e==="value")return null;if(!x(r.value)||!r.value.toString().length)return{required:!0};let g=n.value.minValue,M=n.value.maxValue;if(e==="minValue"&&x(M)&&g.localeCompare(M,navigator.language,{numeric:!0,ignorePunctuation:!0})<1&&n.get("maxValue")?.setErrors(null),e==="maxValue"){if(!x(g))return null;if(g.localeCompare(M,navigator.language,{numeric:!0,ignorePunctuation:!0})>0)return{range:!0}}return null}default:return e==="minValue"||e==="maxValue"?null:!x(r.value)||!r.value.toString().length?{required:!0}:null}}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=k({type:t,selectors:[["app-query-builder"]],standalone:!0,features:[D],decls:14,vars:4,consts:[["filterFormTemplate",""],["filterHeaderTemplate",""],["novalidate","","autocomplete","off",3,"formGroup"],["formArrayName","filters"],[1,"filter__group"],[1,"filter__group__add",3,"click"],["name","add_circle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"formGroup"],[1,"filter__form"],["formControlName","property",3,"filter"],["required","",3,"appFormControlInvalid"],["type","text",3,"id"],[3,"for"],["slot","end","name","arrow_drop_down",1,"forge-dropdown-icon"],["slot","support-text",1,"app-form-control-invalid"],["formControlName","operator","label","Operator","required","",3,"appFormControlInvalid"],[3,"value"],[1,"filter__form__range"],[1,"filter__form__action"],[3,"forge-menu-select","options"],["aria-label","Add filter"],["aria-label","Delete filter",3,"click"],["name","delete"],["type","text","formControlName","minValue",3,"id"],["slot","label",3,"for"],["type","text","formControlName","maxValue",3,"id"],["type","text","formControlName","value",3,"id"],[1,"filter__header"],[1,"filter__header__condition",3,"formControl"]],template:function(r,n){if(r&1){let d=q();o(0,"form",2)(1,"div",3),C(2,Te,2,5,"div",4,v),a(),o(4,"forge-button",5),V("click",function(){return h(d),O(n.onAddFilter(n.formGroup,"condition"))}),f(5,"forge-icon",6),u(6," Add a new condition "),a(),o(7,"p"),u(8),$(9,"json"),a()(),c(10,Ae,25,10,"ng-template",null,0,A)(12,Qe,4,1,"ng-template",null,1,A)}r&2&&(p("formGroup",n.formGroup),i(2),y(n.formGroup.controls.filters.controls),i(6),G(R(9,2,n.formGroup.getRawValue())))},dependencies:[U,L,H,te,X,j,J,K,ee,z,W,Z,Y,ie,ne,re,le,oe,me,ue,ae,pe,ce,de,se,fe,xe,ge,_e,Ce,ve,be],styles:[`[_nghost-%COMP%]{display:block;padding:24px}.filter__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;margin:8px 0}.filter__header__condition[_ngcontent-%COMP%]{--forge-field-height: 2.5rem;--forge-field-outline-style: none;--forge-field-background: #eee}.filter__form[_ngcontent-%COMP%]{display:grid;grid-gap:0 16px;grid-template-columns:216px 168px minmax(400px,1fr) 96px;align-items:start}.filter__form__range[_ngcontent-%COMP%]{display:grid;grid-gap:0 16px;grid-template-columns:minmax(192px,1fr) minmax(192px,1fr);align-items:start}.filter__form__action[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;align-self:flex-end}.filter__group[_ngcontent-%COMP%]{background-color:var(--forge-theme-surface);border-radius:var(--forge-shape-medium);border:1px solid var(--forge-theme-outline);padding:16px;border-left:4px solid var(--forge-theme-primary);margin:16px 0}.filter__group[_ngcontent-%COMP%]   .filter__group[_ngcontent-%COMP%]{border:1px dashed #9e9e9e;margin:8px 0;padding:8px 16px}.filter__group[_ngcontent-%COMP%]:first-of-type{margin-top:0}.filter__group__add[_ngcontent-%COMP%]{--forge-button-height: 3rem;border:1px dashed #9e9e9e;border-radius:var(--forge-shape-medium);background-color:#f5f5f5}.app-form-control-invalid[_ngcontent-%COMP%]{display:none}.app-form-control-invalid[invalid][_ngcontent-%COMP%], .app-form-control-invalid[invalid][_ngcontent-%COMP%]   .app-form-control-invalid[_ngcontent-%COMP%]{display:block}






/*# sourceMappingURL=query-builder.component-KPEXNBTI.css.map */`]})}}return t})();export{Ke as QueryBuilderComponent};
//# sourceMappingURL=chunk-ROTKUKD3.js.map
