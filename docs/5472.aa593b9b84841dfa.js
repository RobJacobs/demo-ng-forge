"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[5472],{99266:(Z,A,_)=>{function v(g,i){const d=g.count;i||(i=new g.TypedArrayConstructor(d));for(let x=0;x<d;x++)i[x]=g.get(x);return i}_.d(A,{m:()=>v}),Object.freeze(Object.defineProperty({__proto__:null,copy:function y(g,i,d){const x=g.typedBuffer,o=g.typedBufferStride,l=i.typedBuffer,s=i.typedBufferStride,u=d?d.count:i.count;let r=(d&&d.dstIndex?d.dstIndex:0)*o,f=(d&&d.srcIndex?d.srcIndex:0)*s;for(let m=0;m<u;++m)x[r]=l[f],r+=o,f+=s},makeDense:v},Symbol.toStringTag,{value:"Module"}))},88948:(Z,A,_)=>{_.d(A,{f:()=>g,n:()=>w});var y=_(78161);function v(d,x,o){const l=d.typedBuffer,s=d.typedBufferStride,u=x.typedBuffer,r=x.typedBufferStride,f=o?o.count:x.count;let m=(o&&o.dstIndex?o.dstIndex:0)*s,b=(o&&o.srcIndex?o.srcIndex:0)*r;for(let T=0;T<f;++T)l[m]=u[b],l[m+1]=u[b+1],m+=s,b+=r}function w(d,x,o){const l=d.typedBuffer,s=d.typedBufferStride,u=x.typedBuffer,r=x.typedBufferStride,f=o?o.count:x.count;let m=(o&&o.dstIndex?o.dstIndex:0)*s,b=(o&&o.srcIndex?o.srcIndex:0)*r;if((0,y.U)(x.elementType)){const T=(0,y.Op)(x.elementType);if((0,y.B3)(x.elementType))for(let E=0;E<f;++E)l[m]=Math.max(u[b]/T,-1),l[m+1]=Math.max(u[b+1]/T,-1),m+=s,b+=r;else for(let E=0;E<f;++E)l[m]=u[b]/T,l[m+1]=u[b+1]/T,m+=s,b+=r}else v(d,x,o);return d}function g(d,x,o,l){const s=d.typedBuffer,u=d.typedBufferStride,r=l?.count??d.count;let f=(l?.dstIndex??0)*u;for(let m=0;m<r;++m)s[f]=x,s[f+1]=o,f+=u}Object.freeze(Object.defineProperty({__proto__:null,copy:v,fill:g,normalizeIntegerBuffer:w},Symbol.toStringTag,{value:"Module"}))},41859:(Z,A,_)=>{_.d(A,{a:()=>d,n:()=>g,s:()=>i,t:()=>w});var y=_(97277);function w(o,l,s){if(o.count!==l.count)return void y.c.error("source and destination buffers need to have the same number of elements");const u=o.count,r=s[0],f=s[1],m=s[2],b=s[3],T=s[4],E=s[5],S=s[6],I=s[7],U=s[8],L=o.typedBuffer,B=o.typedBufferStride,k=l.typedBuffer,ee=l.typedBufferStride;for(let K=0;K<u;K++){const V=K*B,W=K*ee,G=k[W],z=k[W+1],F=k[W+2],$=k[W+3];L[V]=r*G+b*z+S*F,L[V+1]=f*G+T*z+I*F,L[V+2]=m*G+E*z+U*F,L[V+3]=$}}function g(o,l){const s=Math.min(o.count,l.count),u=o.typedBuffer,r=o.typedBufferStride,f=l.typedBuffer,m=l.typedBufferStride;for(let b=0;b<s;b++){const T=b*r,E=b*m,S=f[E],I=f[E+1],U=f[E+2],L=S*S+I*I+U*U;if(L>0){const B=1/Math.sqrt(L);u[T]=B*S,u[T+1]=B*I,u[T+2]=B*U}}}function i(o,l,s){const u=Math.min(o.count,l.count),r=o.typedBuffer,f=o.typedBufferStride,m=l.typedBuffer,b=l.typedBufferStride;for(let T=0;T<u;T++){const E=T*f,S=T*b;r[E]=s*m[S],r[E+1]=s*m[S+1],r[E+2]=s*m[S+2],r[E+3]=s*m[S+3]}}function d(o,l,s){const u=Math.min(o.count,l.count),r=o.typedBuffer,f=o.typedBufferStride,m=l.typedBuffer,b=l.typedBufferStride;for(let T=0;T<u;T++){const E=T*f,S=T*b;r[E]=m[S]>>s,r[E+1]=m[S+1]>>s,r[E+2]=m[S+2]>>s,r[E+3]=m[S+3]>>s}}Object.freeze(Object.defineProperty({__proto__:null,normalize:g,scale:i,shiftRight:d,transformMat3:w,transformMat4:function v(o,l,s){if(o.count!==l.count)return void y.c.error("source and destination buffers need to have the same number of elements");const u=o.count,r=s[0],f=s[1],m=s[2],b=s[3],T=s[4],E=s[5],S=s[6],I=s[7],U=s[8],L=s[9],B=s[10],k=s[11],ee=s[12],K=s[13],V=s[14],W=s[15],G=o.typedBuffer,z=o.typedBufferStride,F=l.typedBuffer,$=l.typedBufferStride;for(let P=0;P<u;P++){const X=P*z,J=P*$,H=F[J],Y=F[J+1],Q=F[J+2],q=F[J+3];G[X]=r*H+T*Y+U*Q+ee*q,G[X+1]=f*H+E*Y+L*Q+K*q,G[X+2]=m*H+S*Y+B*Q+V*q,G[X+3]=b*H+I*Y+k*Q+W*q}}},Symbol.toStringTag,{value:"Module"}))},57986:(Z,A,_)=>{function y(g,i,d){const x=g.typedBuffer,o=g.typedBufferStride,l=i.typedBuffer,s=i.typedBufferStride,u=d?d.count:i.count;let r=(d&&d.dstIndex?d.dstIndex:0)*o,f=(d&&d.srcIndex?d.srcIndex:0)*s;for(let m=0;m<u;++m)x[r]=l[f],x[r+1]=l[f+1],x[r+2]=l[f+2],x[r+3]=l[f+3],r+=o,f+=s}function v(g,i,d,x,o,l){const s=g.typedBuffer,u=g.typedBufferStride,r=l?.count??g.count;let f=(l?.dstIndex??0)*u;for(let m=0;m<r;++m)s[f]=i,s[f+1]=d,s[f+2]=x,s[f+3]=o,f+=u}_.d(A,{c:()=>y,f:()=>v}),Object.freeze(Object.defineProperty({__proto__:null,copy:y,fill:v},Symbol.toStringTag,{value:"Module"}))},66914:(Z,A,_)=>{_.d(A,{G:()=>v});var y=_(32995);let v=class{constructor(w,g,i=""){this.major=w,this.minor=g,this._context=i}lessThan(w,g){return this.major<w||w===this.major&&this.minor<g}since(w,g){return!this.lessThan(w,g)}validate(w){if(this.major!==w.major)throw new y.Z((this._context&&this._context+":")+"unsupported-version",`Required major ${this._context&&this._context+" "}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:w})}clone(){return new v(this.major,this.minor,this._context)}static parse(w,g=""){const[i,d]=w.split("."),x=/^\s*\d+\s*$/;if(!i||!i.match||!i.match(x))throw new y.Z((g&&g+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:w});if(!d||!d.match||!d.match(x))throw new y.Z((g&&g+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:w});const o=parseInt(i,10),l=parseInt(d,10);return new v(o,l,g)}}},78161:(Z,A,_)=>{function y(i){switch(i){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}function v(i){switch(i){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0}}function w(i){switch(i){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1}}function g(i){switch(i){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303}}_.d(A,{B3:()=>v,Op:()=>g,U:()=>w,n1:()=>y})},11162:(Z,A,_)=>{_.d(A,{gS:()=>s});var y=_(78161);function s(u,r){return new u(new ArrayBuffer(r*u.ElementCount*(0,y.n1)(u.ElementType)))}Object.freeze(Object.defineProperty({__proto__:null,copy:function v(u,r,f){const m=u.typedBuffer,b=u.typedBufferStride,T=r.typedBuffer,E=r.typedBufferStride,S=f?f.count:r.count;let I=(f&&f.dstIndex?f.dstIndex:0)*b,U=(f&&f.srcIndex?f.srcIndex:0)*E;for(let L=0;L<S;++L){for(let B=0;B<9;++B)m[I+B]=T[U+B];I+=b,U+=E}}},Symbol.toStringTag,{value:"Module"})),Object.freeze(Object.defineProperty({__proto__:null,copy:function g(u,r,f){const m=u.typedBuffer,b=u.typedBufferStride,T=r.typedBuffer,E=r.typedBufferStride,S=f?f.count:r.count;let I=(f&&f.dstIndex?f.dstIndex:0)*b,U=(f&&f.srcIndex?f.srcIndex:0)*E;for(let L=0;L<S;++L){for(let B=0;B<16;++B)m[I+B]=T[U+B];I+=b,U+=E}}},Symbol.toStringTag,{value:"Module"})),_(99266),_(88948),_(93916),_(57986)},45981:(Z,A,_)=>{_.d(A,{C:()=>o});var y=_(71670),v=_(1897),w=_(11823),g=_(32995),i=_(53661),d=_(30801),x=_(55050);class o{constructor(u){this._streamDataRequester=u}loadJSON(u,r){var f=this;return(0,y.Z)(function*(){return f._load("json",u,r)})()}loadBinary(u,r){var f=this;return(0,y.Z)(function*(){return(0,x.HK)(u)?((0,d.k_)(r),(0,x.AH)(u)):f._load("binary",u,r)})()}loadImage(u,r){var f=this;return(0,y.Z)(function*(){return f._load("image",u,r)})()}_load(u,r,f){var m=this;return(0,y.Z)(function*(){if((0,i.Wi)(m._streamDataRequester))return(yield(0,v.default)(r,{responseType:l[u]})).data;const b=yield(0,w.q6)(m._streamDataRequester.request(r,u,f));if(!0===b.ok)return b.value;throw(0,d.r9)(b.error),new g.Z("",`Request for resource failed: ${b.error}`)})()}}const l={image:"image",binary:"array-buffer",json:"json"}},44229:(Z,A,_)=>{_.d(A,{DA:()=>g,jX:()=>i,nh:()=>w});var y=_(13878),v=_(8330);function w(d,x=v.p){return"number"==typeof d?x(d):(0,y.Uc)(d)||(0,y.lq)(d)?new Uint32Array(d):d}function g(d){const x="number"==typeof d?d:d.length;if(x<3)return[];const o=x-2,l=(0,v.$z)(o);if("number"==typeof d){let s=0;for(let u=0;u<o;u+=1)u%2==0?(l[s++]=u,l[s++]=u+1,l[s++]=u+2):(l[s++]=u+1,l[s++]=u,l[s++]=u+2)}else{let s=0;for(let u=0;u<o;u+=1)if(u%2==0){const f=d[u+1],m=d[u+2];l[s++]=d[u],l[s++]=f,l[s++]=m}else{const f=d[u],m=d[u+2];l[s++]=d[u+1],l[s++]=f,l[s++]=m}}return l}function i(d){const x="number"==typeof d?d:d.length;if(x<3)return new Uint16Array(0);const o=x-2,l=o<=65536?new Uint16Array(3*o):new Uint32Array(3*o);if("number"==typeof d){let s=0;for(let u=0;u<o;++u)l[s++]=0,l[s++]=u+1,l[s++]=u+2;return l}{const s=d[0];let u=d[1],r=0;for(let f=0;f<o;++f){const m=d[f+2];l[r++]=s,l[r++]=u,l[r++]=m,u=m}return l}}},67894:(Z,A,_)=>{_.d(A,{$A:()=>g,Ml:()=>x,NM:()=>w,i$:()=>i});var y=_(71670),v=_(2754);class w{constructor(s){this.data=s,this.type="encoded-mesh-texture",this.encoding=v.Ti.KTX2_ENCODING}}function g(l){return"encoded-mesh-texture"===l?.type}function i(l){return d.apply(this,arguments)}function d(){return(d=(0,y.Z)(function*(l){return new Promise((s,u)=>{const r=new Blob([l]),f=new FileReader;f.onload=()=>{s(JSON.parse(f.result))},f.onerror=m=>{u(m)},f.readAsText(r)})})).apply(this,arguments)}function x(l,s){return o.apply(this,arguments)}function o(){return(o=(0,y.Z)(function*(l,s){return s===v.Ti.KTX2_ENCODING?new w(l):new Promise((u,r)=>{const f=new Blob([l],{type:s}),m=URL.createObjectURL(f),b=new Image,T=()=>{URL.revokeObjectURL(m),"decode"in b?b.decode().then(()=>u(b),()=>u(b)).then(S):(u(b),S())},E=I=>{URL.revokeObjectURL(m),r(I),S()},S=()=>{b.removeEventListener("load",T),b.removeEventListener("error",E)};b.addEventListener("load",T),b.addEventListener("error",E),b.src=m})})).apply(this,arguments)}},931:(Z,A,_)=>{_.d(A,{Q:()=>pe});var I,U,c,y=_(71670),v=_(28191),w=_(53661),g=_(23160),i=_(69923),o=_(32995),l=_(20359),s=_(30801),u=_(55050),r=_(66914),f=_(64544),m=_(50894),b=_(29042),T=_(9565),E=_(99266);class S{constructor(t){this._data=t,this._offset4=0,this._dataUint32=new Uint32Array(this._data,0,Math.floor(this._data.byteLength/4))}readUint32(){const t=this._offset4;return this._offset4+=1,this._dataUint32[t]}readUint8Array(t){const n=4*this._offset4;return this._offset4+=t/4,new Uint8Array(this._data,n,t)}remainingBytes(){return this._data.byteLength-4*this._offset4}}(c=I||(I={})).SCALAR="SCALAR",c.VEC2="VEC2",c.VEC3="VEC3",c.VEC4="VEC4",c.MAT2="MAT2",c.MAT3="MAT3",c.MAT4="MAT4",function(c){c[c.ARRAY_BUFFER=34962]="ARRAY_BUFFER",c[c.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"}(U||(U={}));var L=_(31385);const B={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},k={pbrMetallicRoughness:B,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},ee={ESRI_externalColorMixMode:"tint"},K=(c={})=>{const t={...B,...c.pbrMetallicRoughness},n=function V(c){switch(c.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:(0,L.Bg)(c.ESRI_externalColorMixMode),c.ESRI_externalColorMixMode="tint"}return c}({...ee,...c.extras});return{...k,...c,pbrMetallicRoughness:t,extras:n}},W={magFilter:i.cw.LINEAR,minFilter:i.cw.LINEAR_MIPMAP_LINEAR,wrapS:i.e8.REPEAT,wrapT:i.e8.REPEAT};var F=_(67894);class P{constructor(t,n,a,e){if(this._context=t,this.uri=n,this.json=a,this._glbBuffer=e,this._bufferLoaders=new Map,this._textureLoaders=new Map,this._textureCache=new Map,this._materialCache=new Map,this._nodeParentMap=new Map,this._nodeTransformCache=new Map,this._supportedExtensions=["KHR_texture_basisu"],this._baseUri=function z(c){let t,n;return c.replace(/^(.*\/)?([^/]*)$/,(a,e,p)=>(t=e||"",n=p||"","")),{dirPart:t,filePart:n}}(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),null==a.scenes)throw new o.Z("gltf-loader-unsupported-feature","Scenes must be defined.");if(null==a.meshes)throw new o.Z("gltf-loader-unsupported-feature","Meshes must be defined");if(null==a.nodes)throw new o.Z("gltf-loader-unsupported-feature","Nodes must be defined.");this._computeNodeParents()}static load(t,n,a){var e=this;return(0,y.Z)(function*(){if((0,u.HK)(n)){const O=(0,u.sJ)(n);if(O&&"model/gltf-binary"!==O.mediaType)try{const C=JSON.parse(O.isBase64?atob(O.data):O.data);return new P(t,n,C)}catch{}const M=(0,u.AH)(n);if(P._isGLBData(M))return e._fromGLBData(t,n,M)}if(n.endsWith(".gltf")){const O=yield t.loadJSON(n,a);return new P(t,n,O)}const p=yield t.loadBinary(n,a);if(P._isGLBData(p))return e._fromGLBData(t,n,p);const h=yield t.loadJSON(n,a);return new P(t,n,h)})()}static _isGLBData(t){if(null==t)return!1;const n=new S(t);return n.remainingBytes()>=4&&1179937895===n.readUint32()}static _fromGLBData(t,n,a){return(0,y.Z)(function*(){const e=yield P._parseGLBData(a);return new P(t,n,e.json,e.binaryData)})()}static _parseGLBData(t){return(0,y.Z)(function*(){const n=new S(t);if(n.remainingBytes()<12)throw new o.Z("gltf-loader-error","GLB binary data is insufficiently large.");const a=n.readUint32(),e=n.readUint32(),p=n.readUint32();if(1179937895!==a)throw new o.Z("gltf-loader-error","Magic first 4 bytes do not fit to expected GLB value.");if(t.byteLength<p)throw new o.Z("gltf-loader-error","GLB binary data is smaller than header specifies.");if(2!==e)throw new o.Z("gltf-loader-unsupported-feature","An unsupported GLB container version was detected. Only version 2 is supported.");let h,O,M=0;for(;n.remainingBytes()>=8;){const C=n.readUint32(),R=n.readUint32();if(0===M){if(1313821514!==R)throw new o.Z("gltf-loader-error","First GLB chunk must be JSON.");if(C<0)throw new o.Z("gltf-loader-error","No JSON data found.");h=yield(0,F.i$)(n.readUint8Array(C))}else if(1===M){if(5130562!==R)throw new o.Z("gltf-loader-unsupported-feature","Second GLB chunk expected to be BIN.");O=n.readUint8Array(C)}else v.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] More than 2 GLB chunks detected. Skipping.");M+=1}if(!h)throw new o.Z("gltf-loader-error","No GLB JSON chunk detected.");return{json:h,binaryData:O}})()}getBuffer(t,n){var a=this;return(0,y.Z)(function*(){const e=a.json.buffers[t];if(null==e.uri){if(null==a._glbBuffer)throw new o.Z("gltf-loader-error","GLB buffer not present");return a._glbBuffer}const p=yield a._getBufferLoader(t,n);if(p.byteLength!==e.byteLength)throw new o.Z("gltf-loader-error","Buffer byte lengths should match.");return p})()}_getBufferLoader(t,n){var a=this;return(0,y.Z)(function*(){const e=a._bufferLoaders.get(t);if(e)return e;const h=a._context.loadBinary(a._resolveUri(a.json.buffers[t].uri),n).then(O=>new Uint8Array(O));return a._bufferLoaders.set(t,h),h})()}getAccessor(t,n){var a=this;return(0,y.Z)(function*(){if(!a.json.accessors)throw new o.Z("gltf-loader-unsupported-feature","Accessors missing.");const e=a.json.accessors[t];if(null==e?.bufferView)throw new o.Z("gltf-loader-unsupported-feature","Some accessor does not specify a bufferView.");if(e.type in[I.MAT2,I.MAT3,I.MAT4])throw new o.Z("gltf-loader-unsupported-feature",`AttributeType ${e.type} is not supported`);const p=a.json.bufferViews[e.bufferView],h=yield a.getBuffer(p.buffer,n),O=Y[e.type],M=Q[e.componentType],C=O*M,R=p.byteStride||C;return{raw:h.buffer,byteStride:R,byteOffset:h.byteOffset+(p.byteOffset||0)+(e.byteOffset||0),entryCount:e.count,isDenselyPacked:R===C,componentCount:O,componentByteSize:M,componentType:e.componentType,min:e.min,max:e.max,normalized:!!e.normalized}})()}getIndexData(t,n){var a=this;return(0,y.Z)(function*(){if(null==t.indices)return;const e=yield a.getAccessor(t.indices,n);if(e.isDenselyPacked)switch(e.componentType){case i.g.UNSIGNED_BYTE:return new Uint8Array(e.raw,e.byteOffset,e.entryCount);case i.g.UNSIGNED_SHORT:return new Uint16Array(e.raw,e.byteOffset,e.entryCount);case i.g.UNSIGNED_INT:return new Uint32Array(e.raw,e.byteOffset,e.entryCount)}else switch(e.componentType){case i.g.UNSIGNED_BYTE:return(0,E.m)(a._wrapAccessor(T.D_,e));case i.g.UNSIGNED_SHORT:return(0,E.m)(a._wrapAccessor(T.av,e));case i.g.UNSIGNED_INT:return(0,E.m)(a._wrapAccessor(T.Nu,e))}})()}getPositionData(t,n){var a=this;return(0,y.Z)(function*(){if(null==t.attributes.POSITION)throw new o.Z("gltf-loader-unsupported-feature","No POSITION vertex data found.");const e=yield a.getAccessor(t.attributes.POSITION,n);if(e.componentType!==i.g.FLOAT)throw new o.Z("gltf-loader-unsupported-feature","Expected type FLOAT for POSITION vertex attribute, but found "+i.g[e.componentType]);if(3!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","POSITION vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return a._wrapAccessor(T.ct,e)})()}getNormalData(t,n){var a=this;return(0,y.Z)(function*(){if(null==t.attributes.NORMAL)throw new o.Z("gltf-loader-error","No NORMAL vertex data found.");const e=yield a.getAccessor(t.attributes.NORMAL,n);if(e.componentType!==i.g.FLOAT)throw new o.Z("gltf-loader-unsupported-feature","Expected type FLOAT for NORMAL vertex attribute, but found "+i.g[e.componentType]);if(3!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","NORMAL vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return a._wrapAccessor(T.ct,e)})()}getTangentData(t,n){var a=this;return(0,y.Z)(function*(){if(null==t.attributes.TANGENT)throw new o.Z("gltf-loader-error","No TANGENT vertex data found.");const e=yield a.getAccessor(t.attributes.TANGENT,n);if(e.componentType!==i.g.FLOAT)throw new o.Z("gltf-loader-unsupported-feature","Expected type FLOAT for TANGENT vertex attribute, but found "+i.g[e.componentType]);if(4!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","TANGENT vertex attribute must have 4 components, but found "+e.componentCount.toFixed());return new T.ek(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount)})()}getTextureCoordinates(t,n){var a=this;return(0,y.Z)(function*(){if(null==t.attributes.TEXCOORD_0)throw new o.Z("gltf-loader-error","No TEXCOORD_0 vertex data found.");const e=yield a.getAccessor(t.attributes.TEXCOORD_0,n);if(2!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","TEXCOORD_0 vertex attribute must have 2 components, but found "+e.componentCount.toFixed());if(e.componentType===i.g.FLOAT)return a._wrapAccessor(T.Eu,e);if(!e.normalized)throw new o.Z("gltf-loader-unsupported-feature","Integer component types are only supported for a normalized accessor for TEXCOORD_0.");return function q(c){switch(c.componentType){case i.g.BYTE:return new T.Vs(c.raw,c.byteOffset,c.byteStride,c.byteOffset+c.byteStride*c.entryCount);case i.g.UNSIGNED_BYTE:return new T.xA(c.raw,c.byteOffset,c.byteStride,c.byteOffset+c.byteStride*c.entryCount);case i.g.SHORT:return new T.or(c.raw,c.byteOffset,c.byteStride,c.byteOffset+c.byteStride*c.entryCount);case i.g.UNSIGNED_SHORT:return new T.TS(c.raw,c.byteOffset,c.byteStride,c.byteOffset+c.byteStride*c.entryCount);case i.g.UNSIGNED_INT:return new T.qt(c.raw,c.byteOffset,c.byteStride,c.byteOffset+c.byteStride*c.entryCount);case i.g.FLOAT:return new T.Eu(c.raw,c.byteOffset,c.byteStride,c.byteOffset+c.byteStride*c.entryCount)}}(e)})()}getVertexColors(t,n){var a=this;return(0,y.Z)(function*(){if(null==t.attributes.COLOR_0)throw new o.Z("gltf-loader-error","No COLOR_0 vertex data found.");const e=yield a.getAccessor(t.attributes.COLOR_0,n);if(4!==e.componentCount&&3!==e.componentCount)throw new o.Z("gltf-loader-unsupported-feature","COLOR_0 attribute must have 3 or 4 components, but found "+e.componentCount.toFixed());if(4===e.componentCount){if(e.componentType===i.g.FLOAT)return a._wrapAccessor(T.ek,e);if(e.componentType===i.g.UNSIGNED_BYTE)return a._wrapAccessor(T.mc,e);if(e.componentType===i.g.UNSIGNED_SHORT)return a._wrapAccessor(T.v6,e)}else if(3===e.componentCount){if(e.componentType===i.g.FLOAT)return a._wrapAccessor(T.ct,e);if(e.componentType===i.g.UNSIGNED_BYTE)return a._wrapAccessor(T.ne,e);if(e.componentType===i.g.UNSIGNED_SHORT)return a._wrapAccessor(T.mw,e)}throw new o.Z("gltf-loader-unsupported-feature","Unsupported component type for COLOR_0 attribute: "+i.g[e.componentType])})()}hasPositions(t){return void 0!==t.attributes.POSITION}hasNormals(t){return void 0!==t.attributes.NORMAL}hasVertexColors(t){return void 0!==t.attributes.COLOR_0}hasTextureCoordinates(t){return void 0!==t.attributes.TEXCOORD_0}hasTangents(t){return void 0!==t.attributes.TANGENT}getMaterial(t,n,a){var e=this;return(0,y.Z)(function*(){let p=t.material?e._materialCache.get(t.material):void 0;if(!p){const h=null!=t.material?K(e.json.materials[t.material]):K(),O=h.pbrMetallicRoughness,M=e.hasVertexColors(t),C=e.getTexture(O.baseColorTexture,n),R=e.getTexture(h.normalTexture,n),N=a?e.getTexture(h.occlusionTexture,n):void 0,D=a?e.getTexture(h.emissiveTexture,n):void 0,j=a?e.getTexture(O.metallicRoughnessTexture,n):void 0,re=null!=t.material?t.material:-1;p={alphaMode:h.alphaMode,alphaCutoff:h.alphaCutoff,color:O.baseColorFactor,doubleSided:!!h.doubleSided,colorTexture:yield C,normalTexture:yield R,name:h.name,id:re,occlusionTexture:yield N,emissiveTexture:yield D,emissiveFactor:h.emissiveFactor,metallicFactor:O.metallicFactor,roughnessFactor:O.roughnessFactor,metallicRoughnessTexture:yield j,hasVertexColors:M,ESRI_externalColorMixMode:h.extras.ESRI_externalColorMixMode,colorTextureTransform:O?.baseColorTexture?.extensions?.KHR_texture_transform,normalTextureTransform:h.normalTexture?.extensions?.KHR_texture_transform,occlusionTextureTransform:h.occlusionTexture?.extensions?.KHR_texture_transform,emissiveTextureTransform:h.emissiveTexture?.extensions?.KHR_texture_transform,metallicRoughnessTextureTransform:O?.metallicRoughnessTexture?.extensions?.KHR_texture_transform}}return p})()}getTexture(t,n){var a=this;return(0,y.Z)(function*(){if(!t)return;if(0!==(t.texCoord||0))throw new o.Z("gltf-loader-unsupported-feature","Only TEXCOORD with index 0 is supported.");const e=t.index,p=a.json.textures[e],h=(c=>({...W,...c}))(null!=p.sampler?a.json.samplers[p.sampler]:{}),O=a._getTextureSourceId(p),M=a.json.images[O],C=yield a._loadTextureImageData(e,p,n);return(0,l.s1)(a._textureCache,e,()=>{const R=D=>33071===D||33648===D||10497===D,N=D=>{throw new o.Z("gltf-loader-error",`Unexpected TextureSampler WrapMode: ${D}`)};return{data:C,wrapS:R(h.wrapS)?h.wrapS:N(h.wrapS),wrapT:R(h.wrapT)?h.wrapT:N(h.wrapT),minFilter:h.minFilter,name:M.name,id:e}})})()}getNodeTransform(t){if(void 0===t)return X;let n=this._nodeTransformCache.get(t);if(!n){const a=this.getNodeTransform(this._getNodeParent(t)),e=this.json.nodes[t];e.matrix?n=(0,f.m)((0,g.c)(),a,e.matrix):e.translation||e.rotation||e.scale?(n=(0,g.b)(a),e.translation&&(0,f.w)(n,n,e.translation),e.rotation&&(H[3]=(0,m.g)(H,e.rotation),(0,f.e)(n,n,H[3],H)),e.scale&&(0,f.k)(n,n,e.scale)):n=(0,g.b)(a),this._nodeTransformCache.set(t,n)}return n}_wrapAccessor(t,n){return new t(n.raw,n.byteOffset,n.byteStride,n.byteOffset+n.byteStride*(n.entryCount-1)+n.componentByteSize*n.componentCount)}_resolveUri(t){return(0,u.hF)(t,this._baseUri)}_getNodeParent(t){return this._nodeParentMap.get(t)}_checkVersionSupported(){const t=r.G.parse(this.json.asset.version,"glTF");J.validate(t)}_checkRequiredExtensionsSupported(){const t=this.json;if(t.extensionsRequired&&!t.extensionsRequired.every(n=>this._supportedExtensions.includes(n)))throw new o.Z("gltf-loader-unsupported-feature","gltf loader was not able to load unsupported feature. Required extensions: "+t.extensionsRequired.join(", "))}_computeNodeParents(){this.json.nodes.forEach((t,n)=>{t.children&&t.children.forEach(a=>{this._nodeParentMap.set(a,n)})})}_loadTextureImageData(t,n,a){var e=this;return(0,y.Z)(function*(){const p=e._textureLoaders.get(t);if(p)return p;const h=e._createTextureLoader(n,a);return e._textureLoaders.set(t,h),h})()}_getTextureSourceId(t){if(void 0!==t.extensions&&null!==t.extensions.KHR_texture_basisu)return t.extensions.KHR_texture_basisu.source;if(null!==t.source)return t.source;throw new o.Z("gltf-loader-unsupported-feature","Source is expected to be defined for a texture. It can also be omitted in favour of an KHR_texture_basisu extension tag.")}_createTextureLoader(t,n){var a=this;return(0,y.Z)(function*(){const e=a._getTextureSourceId(t),p=a.json.images[e];if(p.uri){if(p.uri.endsWith(".ktx2")){const C=yield a._context.loadBinary(a._resolveUri(p.uri),n);return new F.NM(new Uint8Array(C))}return a._context.loadImage(a._resolveUri(p.uri),n)}if(null==p.bufferView)throw new o.Z("gltf-loader-unsupported-feature","Image bufferView must be defined.");if(null==p.mimeType)throw new o.Z("gltf-loader-unsupported-feature","Image mimeType must be defined.");const h=a.json.bufferViews[p.bufferView],O=yield a.getBuffer(h.buffer,n);if(null!=h.byteStride)throw new o.Z("gltf-loader-unsupported-feature","byteStride not supported for image buffer");return(0,F.Ml)(new Uint8Array(O.buffer,O.byteOffset+(h.byteOffset||0),h.byteLength),p.mimeType)})()}getLoadedBuffersSize(){var t=this;return(0,y.Z)(function*(){if(t._glbBuffer)return t._glbBuffer.byteLength;const n=yield(0,s.WW)(Array.from(t._bufferLoaders.values())),a=yield(0,s.WW)(Array.from(t._textureLoaders.values()));return n.reduce((e,p)=>e+(p?.byteLength??0),0)+a.reduce((e,p)=>e+(p?(0,F.$A)(p)?p.data.byteLength:p.width*p.height*4:0),0)})()}}const X=(0,f.A)((0,g.c)(),Math.PI/2),J=new r.G(2,0,"glTF"),H=(0,b.a)(),Y={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},Q={[i.g.BYTE]:1,[i.g.UNSIGNED_BYTE]:1,[i.g.SHORT]:2,[i.g.UNSIGNED_SHORT]:2,[i.g.FLOAT]:4,[i.g.UNSIGNED_INT]:4};let fe=0;function pe(c,t){return ne.apply(this,arguments)}function ne(){return ne=(0,y.Z)(function*(c,t,n={},a=!0){const e=yield P.load(c,t,n),p="gltf_"+fe++,h={lods:[],materials:new Map,textures:new Map,meta:me(e)},O=!(!e.json.asset.extras||"symbolResource"!==e.json.asset.extras.ESRI_type),M=new Map;yield function _e(c,t){return oe.apply(this,arguments)}(e,function(){var R=(0,y.Z)(function*(N,D,j,re){const se=M.get(j)??0;M.set(j,se+1);const te=void 0!==N.mode?N.mode:i.MX.TRIANGLES,ae=te===i.MX.TRIANGLES||te===i.MX.TRIANGLE_STRIP||te===i.MX.TRIANGLE_FAN?te:null;if((0,w.Wi)(ae))return void v.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Unsupported primitive mode ("+i.MX[te]+"). Skipping primitive.");if(!e.hasPositions(N))return void v.Z.getLogger("esri.views.3d.glTF").warn("Skipping primitive without POSITION vertex attribute.");const Te=e.getPositionData(N,n),xe=e.getMaterial(N,n,a),ue=e.hasNormals(N)?e.getNormalData(N,n):null,ie=e.hasTangents(N)?e.getTangentData(N,n):null,ce=e.hasTextureCoordinates(N)?e.getTextureCoordinates(N,n):null,le=e.hasVertexColors(N)?e.getVertexColors(N,n):null,be=e.getIndexData(N,n),we={transform:(0,g.b)(D),attributes:{position:yield Te,normal:ue?yield ue:null,texCoord0:ce?yield ce:null,color:le?yield le:null,tangent:ie?yield ie:null},indices:yield be,primitiveType:ae,material:ye(h,yield xe,p)};let de=null;(0,w.pC)(h.meta)&&(0,w.pC)(h.meta.ESRI_lod)&&"screenSpaceRadius"===h.meta.ESRI_lod.metric&&(de=h.meta.ESRI_lod.thresholds[j]),h.lods[j]=h.lods[j]||{parts:[],name:re,lodThreshold:de},h.lods[j].parts[se]=we});return function(N,D,j,re){return R.apply(this,arguments)}}());for(const R of h.lods)R.parts=R.parts.filter(N=>!!N);const C=yield e.getLoadedBuffersSize();return{model:h,meta:{isEsriSymbolResource:O,uri:e.uri},customMeta:{},size:C}}),ne.apply(this,arguments)}function me(c){let n=null;return c.json.nodes.forEach(a=>{const e=a.extras;(0,w.pC)(e)&&(e.ESRI_proxyEllipsoid||e.ESRI_lod)&&(n=e)}),n}function oe(){return oe=(0,y.Z)(function*(c,t){const n=c.json,a=n.scenes[n.scene||0].nodes,e=a.length>1,p=[];for(const M of a){const C=n.nodes[M];p.push(h(M,0)),he(C)&&!e&&C.extensions.MSFT_lod.ids.forEach((R,N)=>h(R,N+1))}function h(M,C){return O.apply(this,arguments)}function O(){return(O=(0,y.Z)(function*(M,C){const R=n.nodes[M],N=c.getNodeTransform(M);if(null!=R.weights&&v.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Morph targets are not supported."),null!=R.mesh){const D=n.meshes[R.mesh];for(const j of D.primitives)p.push(t(j,N,C,D.name))}for(const D of R.children||[])p.push(h(D,C))})).apply(this,arguments)}yield Promise.all(p)}),oe.apply(this,arguments)}function he(c){return c.extensions&&c.extensions.MSFT_lod&&Array.isArray(c.extensions.MSFT_lod.ids)}function ye(c,t,n){const a=p=>{const h=`${n}_tex_${p&&p.id}${p&&p.name?"_"+p.name:""}`;if(p&&!c.textures.has(h)){const O=function x(c,t={}){return{data:c,parameters:{wrap:{s:i.e8.REPEAT,t:i.e8.REPEAT,...t.wrap},noUnpackFlip:!0,mipmap:!1,...t}}}(p.data,{wrap:{s:p.wrapS,t:p.wrapT},mipmap:ge.includes(p.minFilter),noUnpackFlip:!0});c.textures.set(h,O)}return h},e=`${n}_mat_${t.id}_${t.name}`;if(!c.materials.has(e)){const p=function d(c={}){return{color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,colorTextureTransform:null,normalTextureTransform:null,occlusionTextureTransform:null,emissiveTextureTransform:null,metallicRoughnessTextureTransform:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply",...c}}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?a(t.colorTexture):void 0,textureNormal:t.normalTexture?a(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?a(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?a(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?a(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],colorTextureTransform:t.colorTextureTransform,normalTextureTransform:t.normalTextureTransform,occlusionTextureTransform:t.occlusionTextureTransform,emissiveTextureTransform:t.emissiveTextureTransform,metallicRoughnessTextureTransform:t.metallicRoughnessTextureTransform,metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});c.materials.set(e,p)}return e}const ge=[i.cw.LINEAR_MIPMAP_LINEAR,i.cw.LINEAR_MIPMAP_NEAREST]},2754:(Z,A,_)=>{var y,v,w,g,i,d,x,o,l,s,u,r;_.d(A,{CE:()=>x,Gv:()=>v,JJ:()=>l,Rw:()=>g,Ti:()=>u,V_:()=>d,Vr:()=>y,hU:()=>i}),(r=y||(y={}))[r.None=0]="None",r[r.Front=1]="Front",r[r.Back=2]="Back",r[r.COUNT=3]="COUNT",function(r){r[r.Less=0]="Less",r[r.Lequal=1]="Lequal",r[r.COUNT=2]="COUNT"}(v||(v={})),function(r){r[r.BACKGROUND=0]="BACKGROUND",r[r.UPDATE=1]="UPDATE"}(w||(w={})),function(r){r[r.NOT_LOADED=0]="NOT_LOADED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED"}(g||(g={})),function(r){r[r.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",r[r.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(i||(i={})),function(r){r[r.Highlight=0]="Highlight",r[r.MaskOccludee=1]="MaskOccludee",r[r.COUNT=2]="COUNT"}(d||(d={})),function(r){r[r.STRETCH=1]="STRETCH",r[r.PAD=2]="PAD"}(x||(x={})),function(r){r[r.CHANGED=0]="CHANGED",r[r.UNCHANGED=1]="UNCHANGED"}(o||(o={})),function(r){r[r.Blend=0]="Blend",r[r.Opaque=1]="Opaque",r[r.Mask=2]="Mask",r[r.MaskBlend=3]="MaskBlend",r[r.COUNT=4]="COUNT"}(l||(l={})),function(r){r[r.OFF=0]="OFF",r[r.ON=1]="ON"}(s||(s={})),function(r){r.DDS_ENCODING="image/vnd-ms.dds",r.KTX2_ENCODING="image/ktx2",r.BASIS_ENCODING="image/x.basis"}(u||(u={}))},5205:(Z,A,_)=>{_.d(A,{K:()=>y});const y=2.1}}]);
//# sourceMappingURL=5472.aa593b9b84841dfa.js.map