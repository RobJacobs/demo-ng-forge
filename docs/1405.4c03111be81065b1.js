"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[1405],{99704:(_,L,t)=>{t.d(L,{T:()=>O});var R=t(71670),h=t(30801),S=t(20834),Z=t(28679),b=t(53971),d=t(53661),A=t(55798),H=t(82769),M=t(1611),I=t(52300),w=t(70260),W=t(51399),x=t(86626);function U(C,i){const a=i.length;if(C<i[0].value||1===a)return i[0].size;for(let s=1;s<a;s++)if(C<i[s].value)return i[s-1].size+(C-i[s-1].value)/(i[s].value-i[s-1].value)*(i[s].size-i[s-1].size);return i[a-1].size}class B{constructor(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.outsideLabelsVisible=!1,this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this._technique=w.v}getSizeVVFieldStops(i){const a=this._vvSizeFieldStops;if(a)switch(a.type){case"static":return a;case"level-dependent":return(0,d.Pt)(a.levels[i],()=>{let s=1/0,l=0;for(const c in a.levels){const p=parseFloat(c),g=Math.abs(i-p);g<s&&(s=g,l=p)}if(s===1/0)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};const y=2**((i-l)/2),E=(0,d.Wg)(a.levels[l]),u=new Float32Array(E.values);return u[2]*=y,u[3]*=y,{sizes:(0,d.Wg)(E.sizes),values:u}});default:return}}get vvMaterialParameters(){return this._vvMaterialParameters}update(i){(0,d.pC)(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,i)}setInfo(i,a,s){this._updateEffects(s),this._vvInfo=a,this._technique=(0,W.EJ)(i),this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,i)}getVariation(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:(0,x.hc)("2d").supportsTextureFloat}}getVariationHash(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)}_updateEffects(i){this.outsideLabelsVisible=!!(0,d.pC)(i)&&i.excludedLabelsVisible}_updateVisualVariables(i,a){const s=this._vvMaterialParameters;if(s.vvOpacityEnabled=!1,s.vvSizeEnabled=!1,s.vvColorEnabled=!1,s.vvRotationEnabled=!1,!i)return;const l=i.size;if(l){if(s.vvSizeEnabled=!0,l.minMaxValue){const c=l.minMaxValue;let p,g;if((0,I.$K)(c.minSize)&&(0,I.$K)(c.maxSize))if((0,I.hj)(c.minSize)&&(0,I.hj)(c.maxSize))p=(0,A.F2)(c.minSize),g=(0,A.F2)(c.maxSize);else{const f=a.scale;p=(0,A.F2)(U(f,c.minSize.stops)),g=(0,A.F2)(U(f,c.maxSize.stops))}this.vvSizeMinMaxValue.set([c.minDataValue,c.maxDataValue,p,g])}if(l.scaleStops&&(this.vvSizeScaleStopsValue=(0,A.F2)(U(a.scale,l.scaleStops.stops))),l.unitValue){const c=(0,H.c9)(a.spatialReference)/M.a[l.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=c/a.resolution}l.fieldStops&&(this._vvSizeFieldStops=l.fieldStops)}const y=i.color;y&&(s.vvColorEnabled=!0,this.vvColorValues.set(y.values),this.vvColors.set(y.colors));const E=i.opacity;E&&(s.vvOpacityEnabled=!0,this.vvOpacityValues.set(E.values),this.vvOpacities.set(E.opacities));const u=i.rotation;u&&(s.vvRotationEnabled=!0,s.vvRotationType=u.type)}}class O extends b.Z{constructor(i){super(i),this._rendererInfo=new B,this._materialItemsRequestQueue=new S.Z,this.attributeView=new Z.H(()=>this.onAttributeStoreUpdate())}destroy(){this.children.forEach(i=>i.destroy()),this.removeAllChildren(),this.attributeView.destroy(),this._materialItemsRequestQueue.clear()}setRendererInfo(i,a,s){this._rendererInfo.setInfo(i,a,s),this.requestRender()}getMaterialItems(i,a){var s=this;return(0,R.Z)(function*(){if(!i||0===i.length)return[];const l=(0,h.hh)();return s._materialItemsRequestQueue.push({items:i,abortOptions:a,resolver:l}),s.requestRender(),l.promise})()}doRender(i){if(i.context.capabilities.enable("textureFloat"),i.context.capabilities.enable("vao"),this._materialItemsRequestQueue.length>0){let a=this._materialItemsRequestQueue.pop();for(;a;)this._processMaterialItemRequest(i,a),a=this._materialItemsRequestQueue.pop()}super.doRender(i)}renderChildren(i){for(const a of this.children)a.commit(i);this._rendererInfo.update(i.state),super.renderChildren(i)}updateTransforms(i){if(this.children.some(a=>a.hasData))for(const a of this.children)a.setTransform(i)}createRenderParams(i){const a=super.createRenderParams(i);return a.rendererInfo=this._rendererInfo,a.attributeView=this.attributeView,a}onAttributeStoreUpdate(){}_processMaterialItemRequest(i,{items:a,abortOptions:s,resolver:l}){const{painter:y,pixelRatio:E}=i,u=a.map(c=>y.textureManager.rasterizeItem(c.symbol,E,c.glyphIds,s));Promise.all(u).then(c=>{if(!this.stage)return void l.reject();const p=c.map((g,f)=>({id:a[f].id,mosaicItem:g}));l.resolve(p)},l.reject)}}},81405:(_,L,t)=>{t.r(L),t.d(L,{default:()=>ce});var R=t(71670),h=t(18100),S=t(26763),Z=t(97621),b=t(7521),d=t(9497),M=(t(83382),t(19420),t(20891)),I=t(33928),w=t(43503),W=t(63982),x=t(18825),U=t(15097),B=t(6365),O=t(28191),C=t(53661),i=t(30801),a=t(26890),s=t(21109),l=t(98806),y=t(7585),E=t(8456);let u=class extends B.Z{constructor(){super(...arguments),this.attached=!1,this.container=new l.W,this.updateRequested=!1,this.type="imagery",this._bitmapView=new s.c}destroy(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}get updating(){return!this.attached||this.isUpdating()}update(e){this.strategy.update(e).catch(r=>{(0,i.D_)(r)||O.Z.getLogger(this.declaredClass).error(r)})}hitTest(e){return new S.Z({attributes:{},geometry:e.clone(),layer:this.layer})}attach(){this.container.addChild(this._bitmapView),this.strategy=new E.Z({container:this._bitmapView,imageNormalizationSupported:this.layer.version>=10,imageMaxHeight:this.layer.version>=10.1?this.layer.imageMaxHeight:2048,imageMaxWidth:this.layer.version>=10.1?this.layer.imageMaxWidth:2048,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()})}detach(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren(),this.updateRequested=!1}redraw(){var e=this;this.strategy.updateExports(function(){var r=(0,R.Z)(function*(n){const{source:o}=n;if(!o||o instanceof ImageBitmap)return;const v=yield e.layer.applyRenderer({extent:o.extent,pixelBlock:o.originalPixelBlock??o.pixelBlock});o.filter=m=>e.layer.pixelFilter?e.layer.applyFilter(m):{...v,extent:o.extent}});return function(n){return r.apply(this,arguments)}}()).catch(r=>{(0,i.D_)(r)||O.Z.getLogger(this.declaredClass).error(r)})}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}isUpdating(){return this.strategy.updating||this.updateRequested}getPixelData(){if(this.updating)return null;const e=this.strategy.bitmaps;if(1===e.length&&e[0].source)return{extent:e[0].source.extent,pixelBlock:e[0].source.originalPixelBlock};if(e.length>1){const r=this.view.extent,n=e.map(v=>v.source).filter(v=>v.extent&&v.extent.intersects(r)).map(v=>({extent:v.extent,pixelBlock:v.originalPixelBlock})),o=(0,a.Kh)(n,r);return(0,C.pC)(o)?{extent:o.extent,pixelBlock:o.pixelBlock}:null}return null}_fetchImage(e,r,n,o){var v=this;return(0,R.Z)(function*(){(o=o||{}).timeExtent=v.timeExtent,o.requestAsImageElement=!0,o.returnImageBitmap=!0;const m=yield v.layer.fetchImage(e,r,n,o);if(m.imageBitmap)return m.imageBitmap;const P=yield v.layer.applyRenderer(m.pixelData,{signal:o.signal}),D=new y.Z(P.pixelBlock,P.extent?.clone(),m.pixelData.pixelBlock);return D.filter=V=>v.layer.applyFilter(V),D})()}};(0,h._)([(0,d.Cb)()],u.prototype,"attached",void 0),(0,h._)([(0,d.Cb)()],u.prototype,"container",void 0),(0,h._)([(0,d.Cb)()],u.prototype,"layer",void 0),(0,h._)([(0,d.Cb)()],u.prototype,"strategy",void 0),(0,h._)([(0,d.Cb)()],u.prototype,"timeExtent",void 0),(0,h._)([(0,d.Cb)()],u.prototype,"view",void 0),(0,h._)([(0,d.Cb)()],u.prototype,"updateRequested",void 0),(0,h._)([(0,d.Cb)()],u.prototype,"updating",null),(0,h._)([(0,d.Cb)()],u.prototype,"type",void 0),u=(0,h._)([(0,M.j)("esri.views.2d.layers.imagery.ImageryView2D")],u);const c=u;var p=t(1897),g=t(31882),f=t(10465),q=t(13110),Y=t(62265),X=t(65565),N=t(20753),k=t(83345);class ee extends k.Z{constructor(){super(...arguments),this.symbolTypes=["triangle"]}get requiresDedicatedFBO(){return!1}prepareRenderPasses(r){const n=r.registerRenderPass({name:"imagery (vf)",brushes:[X.Z],target:()=>this.children,drawPhase:N.jx.MAP});return[...super.prepareRenderPasses(r),n]}doRender(r){this.visible&&r.drawPhase===N.jx.MAP&&this.symbolTypes.forEach(n=>{r.renderPass=n,super.doRender(r)})}}var T=t(46483);let G=class extends B.Z{constructor(e){super(e),this._loading=null,this.update=(0,i.Ds)((r,n)=>this._update(r,n).catch(o=>{(0,i.D_)(o)||O.Z.getLogger(this.declaredClass).error(o)}))}get updating(){return!!this._loading}redraw(e){if(!this.container.children.length)return;const r=this.container.children[0];r.symbolizerParameters=e,r.invalidateVAO(),this.container.symbolTypes="wind_speed"===e.style?["scalar","triangle"]:"simple_scalar"===e.style?["scalar"]:["triangle"],this.container.requestRender()}_update(e,r,n){var o=this;return(0,R.Z)(function*(){if(!e.stationary)return;const{extent:v,spatialReference:m}=e.state,P=new f.Z({xmin:v.xmin,ymin:v.ymin,xmax:v.xmax,ymax:v.ymax,spatialReference:m}),[D,V]=e.state.size;o._loading=o.fetchPixels(P,D,V,n);const z=yield o._loading;o._addToDisplay(z,r,e.state),o._loading=null})()}_addToDisplay(e,r,n){if((0,C.Wi)(e.pixelBlock))return this.container.children.forEach(P=>P.destroy()),void this.container.removeAllChildren();const{extent:o,pixelBlock:v}=e,m=new T.F(v);m.offset=[0,0],m.symbolizerParameters=r,m.rawPixelData=e,m.invalidateVAO(),m.x=o.xmin,m.y=o.ymax,m.pixelRatio=n.pixelRatio,m.rotation=n.rotation,m.resolution=n.resolution,m.width=v.width*r.symbolTileSize,m.height=v.height*r.symbolTileSize,this.container.children.forEach(P=>P.destroy()),this.container.removeAllChildren(),this.container.symbolTypes="wind_speed"===r.style?["scalar","triangle"]:"simple_scalar"===r.style?["scalar"]:["triangle"],this.container.addChild(m)}};(0,h._)([(0,d.Cb)()],G.prototype,"fetchPixels",void 0),(0,h._)([(0,d.Cb)()],G.prototype,"container",void 0),(0,h._)([(0,d.Cb)()],G.prototype,"_loading",void 0),(0,h._)([(0,d.Cb)()],G.prototype,"updating",null),G=(0,h._)([(0,M.j)("esri.views.2d.layers.imagery.ImageryVFStrategy")],G);const re=G;let F=class extends g.r{constructor(){var e;super(...arguments),e=this,this.attached=!1,this.container=new ee,this.type="imageryVF",this._dataParameters={exportParametersVersion:0,bbox:"",symbolTileSize:0,time:""},this._fetchpixels=function(){var r=(0,R.Z)(function*(n,o,v,m){const P=yield e._projectFullExtentPromise,{symbolTileSize:D}=e.layer.renderer,{extent:V,width:z,height:K}=(0,Y.BH)(n,o,v,D,P);if((0,C.pC)(P)&&!P.intersects(n))return{extent:V,pixelBlock:null};const $={bbox:`${V.xmin}, ${V.ymin}, ${V.xmax}, ${V.ymax}`,exportParametersVersion:e.layer.exportImageServiceParameters.version,symbolTileSize:D,time:JSON.stringify(e.timeExtent||"")};if(e._canReuseVectorFieldData($)){const j=e.getPixelData();if((0,C.pC)(j)&&`${j.extent.xmin}, ${j.extent.ymin}, ${j.extent.xmax}, ${j.extent.ymax}`===$.bbox)return j}const{pixelData:te}=yield e.layer.fetchImage(V,z,K,{timeExtent:e.timeExtent,requestAsImageElement:!1,signal:m});e._dataParameters=$;const J=te?.pixelBlock;return(0,C.Wi)(J)?{extent:V,pixelBlock:null}:{extent:V,pixelBlock:"vector-uv"===e.layer.rasterInfo.dataType?(0,C.Wg)((0,Y.KC)(J,"vector-uv")):J}});return function(n,o,v,m){return r.apply(this,arguments)}}()}get updating(){return!this.attached||this._strategy.updating}attach(){this._projectFullExtentPromise=this._getProjectedFullExtent(this.view.spatialReference),this._strategy=new re({container:this.container,fetchPixels:this._fetchpixels}),this.handles.add((0,b.YP)(()=>this.layer.renderer,e=>this._updateSymbolizerParams(e),b.tX),"attach")}detach(){this._strategy.destroy(),this.container.children.forEach(e=>e.destroy()),this.container.removeAllChildren(),this.handles.remove("attach"),this._strategy=this.container=this._projectFullExtentPromise=null}getPixelData(){const e=this.container.children[0]?.rawPixelData;if(this.updating||!e)return null;const{extent:r,pixelBlock:n}=e;return{extent:r,pixelBlock:n}}hitTest(e){return new S.Z({attributes:{},geometry:e.clone(),layer:this.layer})}update(e){this._strategy.update(e,this._symbolizerParams)}redraw(){const{renderer:e}=this.layer;e&&(this._updateSymbolizerParams(e),this._strategy.redraw(this._symbolizerParams))}_canReuseVectorFieldData(e){return this._dataParameters.exportParametersVersion===e.exportParametersVersion&&this._dataParameters.time===e.time&&this._dataParameters.symbolTileSize===e.symbolTileSize&&this._dataParameters.bbox===e.bbox}_getProjectedFullExtent(e){var r=this;return(0,R.Z)(function*(){try{return yield(0,q.tB)(r.layer.fullExtent,e)}catch{try{const o=(yield(0,p.default)(r.layer.url,{query:{option:"footprints",outSR:e.wkid||JSON.stringify(e.toJSON()),f:"json"}})).data.featureCollection.layers[0].layerDefinition.extent;return o?f.Z.fromJSON(o):null}catch{return null}}})()}_updateSymbolizerParams(e){"vector-field"===e.type&&(this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null}))}};(0,h._)([(0,d.Cb)()],F.prototype,"attached",void 0),(0,h._)([(0,d.Cb)()],F.prototype,"container",void 0),(0,h._)([(0,d.Cb)()],F.prototype,"layer",void 0),(0,h._)([(0,d.Cb)()],F.prototype,"timeExtent",void 0),(0,h._)([(0,d.Cb)()],F.prototype,"type",void 0),(0,h._)([(0,d.Cb)()],F.prototype,"view",void 0),(0,h._)([(0,d.Cb)()],F.prototype,"updating",null),F=(0,h._)([(0,M.j)("esri.views.2d.layers.imagery.VectorFieldView2D")],F);const ae=F;var ie=t(32995),se=t(35787),ne=t(51299),oe=t(28665),le=t(24927);const he=e=>{let r=class extends e{constructor(){super(...arguments),this.view=null}fetchPopupFeatures(n,o){var v=this;return(0,R.Z)(function*(){const{layer:m}=v;if(!n)throw new ie.Z("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:m});const{popupEnabled:P}=m,D=(0,le.V)(m,o);if(!P||(0,C.Wi)(D))throw new ie.Z("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:P,popupTemplate:D});const V=yield D.getRequiredFields(),z=new oe.Z;z.timeExtent=v.timeExtent,z.geometry=n,z.outFields=V,z.outSpatialReference=n.spatialReference;const{resolution:K,spatialReference:$}=v.view,te="2d"===v.view.type?new se.Z(K,K,$):new se.Z(.5*K,.5*K,$),{returnTopmostRaster:J,showNoDataRecords:j}=D.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},ve={returnDomainValues:!0,returnTopmostRaster:J,pixelSize:te,showNoDataRecords:j,signal:(0,C.pC)(o)?o.signal:null};return m.queryVisibleRasters(z,ve).then(pe=>pe)})()}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return(0,h._)([(0,d.Cb)()],r.prototype,"layer",void 0),(0,h._)([(0,d.Cb)()],r.prototype,"suspended",void 0),(0,h._)([(0,d.Cb)(ne.qG)],r.prototype,"timeExtent",void 0),(0,h._)([(0,d.Cb)()],r.prototype,"view",void 0),r=(0,h._)([(0,M.j)("esri.views.layers.ImageryLayerView")],r),r};var de=t(3589),ue=t(34040);let Q=class extends(he((0,ue.Z)((0,W.y)(de.Z)))){constructor(){super(...arguments),this._exportImageVersion=-1,this._highlightGraphics=new I.J,this._highlightView=void 0,this.layer=null,this.subview=null}get pixelData(){const{subview:e}=this;return this.updating||!e?null:"getPixelData"in e?e.getPixelData():null}hitTest(e,r){var n=this;return(0,R.Z)(function*(){return n.subview?[{type:"graphic",graphic:n.subview.hitTest(e),layer:n.layer,mapPoint:e}]:null})()}update(e){this.subview?.update(e)}attach(){this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.view&&(this._highlightView=new x.Z({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new U.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._highlightView.container)),this.addAttachHandles([(0,b.YP)(()=>this.layer.blendMode??"normal",e=>this.subview&&(this.subview.container.blendMode=e),b.tX),(0,b.YP)(()=>this.layer.effect??null,e=>this.subview&&(this.subview.container.effect=e),b.tX),(0,b.YP)(()=>this.layer.exportImageServiceParameters.version,e=>{e&&this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())},b.Z_),(0,b.YP)(()=>this.timeExtent,e=>{const{subview:r}=this;r&&(r.timeExtent=e,"redraw"in r?this.requestUpdate():r.redrawOrRefetch())},b.Z_),this.layer.on("redraw",()=>{const{subview:e}=this;e&&("redraw"in e?e.redraw():e.redrawOrRefetch())}),(0,b.YP)(()=>this.layer.renderer,()=>this._setSubView())])}detach(){this.layer.decreaseRasterJobHandlerUsage(),this.container.removeAllChildren(),this._detachSubview(this.subview),this.subview?.destroy(),this.subview=null,this._highlightView?.destroy(),this._exportImageVersion=-1}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}highlight(e,r){if(!((Array.isArray(e)?e[0]:Z.Z.isCollection(e)?e.getItemAt(0):e)instanceof S.Z))return{remove:()=>{}};let n=[];return Array.isArray(e)||Z.Z.isCollection(e)?n=e.map(o=>o.clone()):e instanceof S.Z&&(n=[e.clone()]),this._highlightGraphics.addMany(n),{remove:()=>{this._highlightGraphics.removeMany(n)}}}doRefresh(){var e=this;return(0,R.Z)(function*(){e.requestUpdate()})()}isUpdating(){return!this.subview||this.subview.updating}_setSubView(){if(!this.view)return;const e=this.layer.renderer?.type;let r="imagery";if("vector-field"===e?r="imageryVF":"flow"===e&&(r="flow"),this.subview){const{type:n}=this.subview;if(n===r)return this._attachSubview(this.subview),void("flow"===n?this.subview.redrawOrRefetch():"imagery"===n&&"lerc"===this.layer.format?this.subview.redraw():this.requestUpdate());this._detachSubview(this.subview),this.subview?.destroy()}this.subview="imagery"===r?new c({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):"imageryVF"===r?new ae({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new w.Z({layer:this.layer,layerView:this}),this._attachSubview(this.subview),this.requestUpdate()}_attachSubview(e){e&&!e.attached&&(e.attach(),e.attached=!0,this.container.addChildAt(e.container,0),e.container.blendMode=this.layer.blendMode,e.container.effect=this.layer.effect)}_detachSubview(e){e?.attached&&(this.container.removeChild(e.container),e.detach(),e.attached=!1)}};(0,h._)([(0,d.Cb)()],Q.prototype,"pixelData",null),(0,h._)([(0,d.Cb)()],Q.prototype,"subview",void 0),Q=(0,h._)([(0,M.j)("esri.views.2d.layers.ImageryLayerView2D")],Q);const ce=Q},37436:(_,L,t)=>{t.d(L,{Z:()=>C});var R=t(53661),h=t(99704),S=t(38974),Z=t(40334),b=t(12288),d=t(49533),A=t(42758),H=t(99390),M=t(52300),I=t(10615),w=t(69923),W=t(19955);const x=Math.PI/180;class B extends H.s{constructor(a){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=(0,Z.c)(),this._localOrigin={x:0,y:0},this._getBounds=a}destroy(){this._vao&&(this._vao.dispose(!0),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=(0,R.M2)(this._program)}doRender(a){const{context:s}=a,l=this._getBounds();if(l.length<1)return;this._createShaderProgram(s),this._updateMatricesAndLocalOrigin(a),this._updateBufferData(s,l),s.setBlendingEnabled(!0),s.setDepthTestEnabled(!1),s.setStencilWriteMask(0),s.setStencilTestEnabled(!1),s.setBlendFunction(w.zi.ONE,w.zi.ONE_MINUS_SRC_ALPHA),s.setColorMask(!0,!0,!0,!0);const y=this._program;s.bindVAO(this._vao),s.useProgram(y),y.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),s.gl.lineWidth(1),s.drawElements(w.MX.LINES,8*l.length,w.g.UNSIGNED_INT,0),s.bindVAO()}_createTransforms(){return{dvs:(0,Z.c)()}}_createShaderProgram(a){this._program||(this._program=a.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\n      }",O().attributes))}_updateMatricesAndLocalOrigin(a){const{state:s}=a,{displayMat3:l,size:y,resolution:E,pixelRatio:u,rotation:c,viewpoint:p}=s,g=x*c,{x:f,y:q}=p.targetGeometry,Y=(0,A.or)(f,s.spatialReference);this._localOrigin.x=Y,this._localOrigin.y=q;const X=u*y[0],N=u*y[1],k=E*X,ee=E*N,T=(0,S.g)(this._dvsMat3);(0,S.m)(T,T,l),(0,S.h)(T,T,(0,b.f)(X/2,N/2)),(0,S.d)(T,T,(0,d.f)(y[0]/k,-N/ee,1)),(0,S.r)(T,T,-g)}_updateBufferData(a,s){const{x:l,y}=this._localOrigin,u=new Float32Array(8*s.length),c=new Uint32Array(8*s.length);let p=0,g=0;for(const f of s)f&&(u[2*p+0]=f[0]-l,u[2*p+1]=f[1]-y,u[2*p+2]=f[0]-l,u[2*p+3]=f[3]-y,u[2*p+4]=f[2]-l,u[2*p+5]=f[3]-y,u[2*p+6]=f[2]-l,u[2*p+7]=f[1]-y,c[g+0]=p+0,c[g+1]=p+3,c[g+2]=p+3,c[g+3]=p+2,c[g+4]=p+2,c[g+5]=p+1,c[g+6]=p+1,c[g+7]=p+0,p+=4,g+=8);if(this._vertexBuffer?this._vertexBuffer.setData(u.buffer):this._vertexBuffer=I.f.createVertex(a,w.l1.DYNAMIC_DRAW,u.buffer),this._indexBuffer?this._indexBuffer.setData(c):this._indexBuffer=I.f.createIndex(a,w.l1.DYNAMIC_DRAW,c),!this._vao){const f=O();this._vao=new W.U(a,f.attributes,f.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer)}}}const O=()=>(0,M.cM)("bounds",{geometry:[{location:0,name:"a_position",count:2,type:w.g.FLOAT}]});let C=class extends h.T{constructor(i){super(i),this.hasHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=(0,R.SC)(this._boundsRenderer)}enableRenderingBounds(i){this._boundsRenderer=new B(i),this.requestRender()}get hasLabels(){return!1}onTileData(i,a){i.patch(a),this.contains(i)||this.addChild(i),this.requestRender()}onTileError(i){i.clear(),this.contains(i)||this.addChild(i)}_renderChildren(i,a){for(const s of this.children)s.isReady&&s.hasData&&(s.commit(i),i.context.setStencilFunction(w.wb.EQUAL,s.stencilRef,255),s.getDisplayList().replay(i,s,a))}}},15097:(_,L,t)=>{t.d(L,{Z:()=>W});var R=t(18100),A=(t(28191),t(83382),t(19420),t(32995),t(67087),t(20891)),H=t(20753),M=t(37436),I=t(69923);let w=class extends M.Z{doRender(x){x.drawPhase===H.jx.HIGHLIGHT&&super.doRender(x)}renderChildren(x){if(this.attributeView.update(),!this.children.some(O=>O.hasData))return;this.attributeView.bindTextures(x.context),super.renderChildren(x);const{painter:U}=x,B=U.effects.highlight;B.bind(x),x.context.setColorMask(!0,!0,!0,!0),x.context.clear(I.lk.COLOR_BUFFER_BIT),this._renderChildren(x,B.defines.concat(["highlightAll"])),B.draw(x),B.unbind()}};w=(0,R._)([(0,A.j)("esri.views.2d.layers.support.HighlightGraphicContainer")],w);const W=w}}]);
//# sourceMappingURL=1405.4c03111be81065b1.js.map