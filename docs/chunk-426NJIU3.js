import{a as Fe}from"./chunk-UH44EAOS.js";import{a as be}from"./chunk-DA33O62B.js";import{Ab as re,Cc as se,Dc as _e,F as x,Hb as ne,Ib as ie,Jb as oe,Ob as le,Pb as ae,Sc as ge,Tc as xe,Uc as ve,g as H,gb as J,i as U,ib as M,jd as Ce,k as j,kb as K,kd as ye,lb as X,mc as pe,nb as k,nc as ue,ob as _,oc as me,pc as de,qb as z,sb as W,tb as Y,vb as Z,wb as ee,xb as te,yb as Q,yc as ce,zc as fe}from"./chunk-AWYXD4HD.js";import{$b as R,Ab as I,Bb as b,Cb as B,Fb as G,Gb as d,Jb as s,Ob as F,Pb as m,Qb as S,Rb as D,Xb as $,Ya as o,Zb as E,_b as A,ac as L,ec as P,ja as N,mb as c,ob as u,sb as V,tb as v,ua as O,ub as C,va as T,vb as y,wb as l,xb as p,yb as f,zb as q}from"./chunk-CFL2K3XP.js";import"./chunk-O62F43XY.js";var he=(t,i)=>({formGroup:t,index:i}),Oe=t=>({formGroup:t});function Te(t,i){t&1&&b(0)}function Ve(t,i){if(t&1&&(l(0,"div",4),c(1,Te,1,0,"ng-container",7),p()),t&2){let n=i.$implicit,e=i.$index;d();let r=F(11);o(),u("ngTemplateOutlet",r)("ngTemplateOutletContext",A(2,he,n,e))}}function Ge(t,i){t&1&&b(0)}function Se(t,i){if(t&1&&c(0,Ge,1,0,"ng-container",7),t&2){let n=d().formGroup;d();let e=F(13);u("ngTemplateOutlet",e)("ngTemplateOutletContext",E(2,Oe,n))}}function Me(t,i){if(t&1&&(l(0,"forge-option",17),m(1),p()),t&2){let n=i.$implicit;u("value",n.value),o(),S(n.label)}}function we(t,i){if(t&1&&(l(0,"div",18)(1,"forge-text-field",11),f(2,"input",24),l(3,"label",25),m(4,"Minimum"),p(),l(5,"span",15),m(6,"A minimum value is required"),p()(),l(7,"forge-text-field",11),f(8,"input",26),l(9,"label",25),m(10,"Maximum"),p(),l(11,"span",15),m(12),p()()()),t&2){let n=d(),e=n.formGroup,r=n.index;o(),u("appFormControlInvalid",e.controls.minValue),o(),s("id","query-builder--filter-min-"+r),o(),s("for","query-builder--filter-min-"+r),o(4),u("appFormControlInvalid",e.controls.maxValue),o(),s("id","query-builder--filter-max-"+r),o(),s("for","query-builder--filter-max-"+r),o(3),D(" ",e.controls.maxValue.errors.required?"A maximum value is required":e.controls.maxValue.errors.range?"Max value must be greater or equal to min value":""," ")}}function qe(t,i){if(t&1&&(l(0,"forge-text-field",11),f(1,"input",27),l(2,"label",25),m(3,"Value"),p(),l(4,"span",15),m(5,"A value is required"),p()()),t&2){let n=d(),e=n.formGroup,r=n.index;u("appFormControlInvalid",e.controls.value),o(),s("id","query-builder--filter-value-"+r),o(),s("for","query-builder--filter-value-"+r)}}function Ie(t,i){t&1&&b(0)}function Be(t,i){t&1&&b(0)}function Ee(t,i){if(t&1&&(c(0,Ie,1,0,"ng-container",7),l(1,"div",4),c(2,Be,1,0,"ng-container",7),p()),t&2){let n=i.$implicit,e=i.$index;d(3);let r=F(11),a=F(13);u("ngTemplateOutlet",a)("ngTemplateOutletContext",E(4,Oe,n)),o(2),u("ngTemplateOutlet",r)("ngTemplateOutletContext",A(6,he,n,e))}}function Ae(t,i){if(t&1&&(q(0,3),C(1,Ee,3,9,null,null,v),I()),t&2){let n=d().formGroup;o(),y(n.controls.filters.controls)}}function Pe(t,i){if(t&1){let n=B();c(0,Se,1,4,"ng-container"),q(1,8),l(2,"div",9)(3,"forge-autocomplete",10)(4,"forge-text-field",11),f(5,"input",12),l(6,"label",13),m(7,"Property"),p(),f(8,"forge-icon",14),l(9,"span",15),m(10,"A property is required"),p()()(),l(11,"forge-select",16),C(12,Me,2,2,"forge-option",17,v),l(14,"span",15),m(15,"An operator is required"),p()(),c(16,we,13,7,"div",18)(17,qe,6,3,"forge-text-field",11),l(18,"div",19)(19,"forge-menu",20),G("forge-menu-select",function(r){let a=O(n).formGroup,g=d();return T(g.onAddFilter(a,r.detail.value))}),l(20,"forge-icon-button",21),f(21,"forge-icon",6),p()(),l(22,"forge-icon-button",22),G("click",function(){let r=O(n).formGroup,a=d();return T(a.onDeleteFilter(r))}),f(23,"forge-icon",23),p()()(),c(24,Ae,3,0,"ng-container",3),I()}if(t&2){let n=i.formGroup,e=i.index,r=d();V(e>0?0:-1),o(),u("formGroup",n),o(2),u("filter",r.propertyFilter),o(),u("appFormControlInvalid",n.controls.property),o(),s("id","query-builder--filter-property-"+e),o(),s("for","query-builder--filter-property-"+e),o(5),u("appFormControlInvalid",n.controls.operator),o(),y(r.operatorOptions),o(4),V(n.controls.operator.value===6?16:17),o(3),u("options",r.filterOptions),o(5),V(n.controls.filters.controls!=null&&n.controls.filters.controls.length?24:-1)}}function ke(t,i){if(t&1&&(l(0,"forge-option",17),m(1),p()),t&2){let n=i.$implicit;u("value",n.value),o(),S(n.label)}}function Qe(t,i){if(t&1&&(l(0,"div",28)(1,"forge-select",29),C(2,ke,2,2,"forge-option",17,v),p()()),t&2){let n=i.formGroup,e=d();o(),u("formControl",n.get("condition")),o(),y(e.conditionOptions)}}var Xe=(()=>{let i=class i{constructor(){this.formGroup=new k({filters:new Q([this.buildFilterFormGroup()])}),this.conditionOptions=[{value:"and",label:"And"},{value:"or",label:"Or"}],this.propertyOptions=[{value:"firstName",label:"First name"},{value:"lastName",label:"Last name"},{value:"dateOfBirth",label:"Date of birth"},{value:"gender",label:"Gender"},{value:"occupation",label:"Occupation"}],this.operatorOptions=[{value:0,label:"Equal"},{value:1,label:"Not equal"},{value:2,label:"Greater than"},{value:3,label:"Less than"},{value:4,label:"Greater than equal to"},{value:5,label:"Less than equal to"},{value:6,label:"Range"},{value:7,label:"Contains"},{value:8,label:"Not contains"},{value:9,label:"Empty"}],this.filterOptions=[{value:"condition",label:"Add condition"},{value:"group",label:"Add group"}],this.propertyFilter=e=>be.filterData(this.propertyOptions,[{key:"label",value:e}])}onAddFilter(e,r){if(e===this.formGroup)this.formGroup.controls.filters.push(this.buildFilterFormGroup());else switch(r){case"condition":{let a=e.parent.controls.indexOf(e)+1;e.parent.insert(a,this.buildFilterFormGroup());break}case"group":e.get("filters").push(this.buildFilterFormGroup());break}}onDeleteFilter(e){let r=e.parent,a=r.controls.indexOf(e);a!==-1&&r.removeAt(a)}buildFilterFormGroup(e){return new k({property:new _(e?.property,{validators:[M.required]}),condition:new _(e?.condition||"and",{validators:[M.required]}),operator:new _(e?.operator,{validators:[M.required]}),value:new _(e?.value,{validators:[this.validateFilterValue("value")]}),minValue:new _(e?.minValue,{validators:[this.validateFilterValue("minValue")]}),maxValue:new _(e?.minValue,{validators:[this.validateFilterValue("maxValue")]}),filters:new Q([])})}validateFilterValue(e){return r=>{let a=r.parent;if(!a)return null;let g=a.value.operator;if(!x(g))return null;switch(g){case 6:{if(e==="value")return null;if(!x(r.value)||!r.value.toString().length)return{required:!0};let h=a.value.minValue,w=a.value.maxValue;if(e==="minValue"&&x(w)&&h.localeCompare(w,navigator.language,{numeric:!0,ignorePunctuation:!0})<1&&a.get("maxValue")?.setErrors(null),e==="maxValue"){if(!x(h))return null;if(h.localeCompare(w,navigator.language,{numeric:!0,ignorePunctuation:!0})>0)return{range:!0}}return null}default:return e==="minValue"||e==="maxValue"?null:!x(r.value)||!r.value.toString().length?{required:!0}:null}}}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=N({type:i,selectors:[["app-query-builder"]],standalone:!0,features:[$],decls:14,vars:4,consts:[["filterFormTemplate",""],["filterHeaderTemplate",""],["novalidate","","autocomplete","off",3,"formGroup"],["formArrayName","filters"],[1,"filter__group"],[1,"filter__group__add",3,"click"],["name","add_circle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"formGroup"],[1,"filter__form"],["formControlName","property",3,"filter"],["required","",3,"appFormControlInvalid"],["type","text",3,"id"],[3,"for"],["slot","end","name","arrow_drop_down",1,"forge-dropdown-icon"],["slot","support-text",1,"app-form-control-invalid"],["formControlName","operator","label","Operator","required","",3,"appFormControlInvalid"],[3,"value"],[1,"filter__form__range"],[1,"filter__form__action"],[3,"forge-menu-select","options"],["aria-label","Add filter"],["aria-label","Delete filter",3,"click"],["name","delete"],["type","text","formControlName","minValue",3,"id"],["slot","label",3,"for"],["type","text","formControlName","maxValue",3,"id"],["type","text","formControlName","value",3,"id"],[1,"filter__header"],[1,"filter__header__condition",3,"formControl"]],template:function(r,a){if(r&1){let g=B();l(0,"form",2)(1,"div",3),C(2,Ve,2,5,"div",4,v),p(),l(4,"forge-button",5),G("click",function(){return O(g),T(a.onAddFilter(a.formGroup,"condition"))}),f(5,"forge-icon",6),m(6," Add a new condition "),p(),l(7,"p"),m(8),R(9,"json"),p()(),c(10,Pe,25,10,"ng-template",null,0,P)(12,Qe,4,1,"ng-template",null,1,P)}r&2&&(u("formGroup",a.formGroup),o(2),y(a.formGroup.controls.filters.controls),o(6),S(L(9,2,a.formGroup.getRawValue())))},dependencies:[j,H,U,re,z,J,K,X,te,W,Y,ee,Z,oe,ie,ne,ae,le,de,me,pe,ue,fe,ce,_e,se,ve,xe,ge,ye,Ce,Fe],styles:[`[_nghost-%COMP%]{display:block;padding:24px}.filter__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;margin:8px 0}.filter__header__condition[_ngcontent-%COMP%]{--forge-field-height: 2.5rem;--forge-field-outline-style: none;--forge-field-background: #eee}.filter__form[_ngcontent-%COMP%]{display:grid;grid-gap:0 16px;grid-template-columns:216px 168px minmax(400px,1fr) 96px;align-items:start}.filter__form__range[_ngcontent-%COMP%]{display:grid;grid-gap:0 16px;grid-template-columns:minmax(192px,1fr) minmax(192px,1fr);align-items:start}.filter__form__action[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;align-self:flex-end}.filter__group[_ngcontent-%COMP%]{background-color:var(--forge-theme-surface);border-radius:var(--forge-shape-medium);border:1px solid var(--forge-theme-outline);padding:16px;border-left:4px solid var(--forge-theme-primary);margin:16px 0}.filter__group[_ngcontent-%COMP%]   .filter__group[_ngcontent-%COMP%]{border:1px dashed #9e9e9e;margin:8px 0;padding:8px 16px}.filter__group[_ngcontent-%COMP%]:first-of-type{margin-top:0}.filter__group__add[_ngcontent-%COMP%]{--forge-button-height: 3rem;border:1px dashed #9e9e9e;border-radius:var(--forge-shape-medium);background-color:#f5f5f5}.app-form-control-invalid[_ngcontent-%COMP%]{display:none}.app-form-control-invalid[invalid][_ngcontent-%COMP%], .app-form-control-invalid[invalid][_ngcontent-%COMP%]   .app-form-control-invalid[_ngcontent-%COMP%]{display:block}






/*# sourceMappingURL=query-builder.component-KPEXNBTI.css.map */`]});let t=i;return t})();export{Xe as QueryBuilderComponent};
//# sourceMappingURL=chunk-426NJIU3.js.map
