"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[2598],{9915:(L,v,e)=>{e.r(v),e.d(v,{default:()=>ee});var O=e(71670),s=e(18100),M=e(1897),y=e(55025),d=e(32995),f=e(31882),P=e(93205),R=e(53661),U=e(90642),I=e(30801),_=e(9497),j=e(83382),A=(e(19420),e(66508)),S=e(20891),x=e(70425),h=e(61434),B=e(10465),K=e(78998),W=e(22735),b=e(450),F=e(54861),N=e(6363),Z=e(29812),J=e(55123),V=e(33829),$=e(16617),G=e(17085),z=e(72450),H=e(58336),Q=e(37302),Y=e(51299),X=e(67652),w=e(57062),k=e(57054),C=e(48878),q=e(49067),T=e(27655);let o=class extends((0,Z.h)((0,Q.n)((0,z.M)((0,H.x)((0,F.O)((0,N.Y)((0,V.q)((0,$.I)((0,U.R)((0,G.Q)((0,b.V)((0,J.N)((0,f.p)(W.Z)))))))))))))){constructor(...r){super(...r),this.dateFieldsTimeReference=null,this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.preferredTimeReference=null,this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(r,t){return"string"==typeof r?{url:r,...t}:r}load(r){const t=(0,R.pC)(r)?r.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},r).catch(I.r9).then(()=>this._fetchService(t))),Promise.resolve(this)}readImageFormat(r,t){const l=t.supportedImageFormatTypes;return l&&l.includes("PNG32")?"png32":"png24"}writeSublayers(r,t,l,i){if(!this.loaded||!r)return;const p=r.slice().reverse().flatten(({sublayers:n})=>n&&n.toArray().reverse()).toArray();let a=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap?.supportsDynamicLayers){const n=(0,h.M9)(i.origin);if(n===h.s3.PORTAL_ITEM){const u=this.createSublayersForOrigin("service").sublayers;a=(0,C.QV)(p,u,h.s3.SERVICE)}else if(n>h.s3.PORTAL_ITEM){const u=this.createSublayersForOrigin("portal-item");a=(0,C.QV)(p,u.sublayers,(0,h.M9)(u.origin))}}const E=[],c={writeSublayerStructure:a,...i};let m=a;p.forEach(n=>{const u=n.write({},c);E.push(u),m=m||"user"===n.originOf("visible")}),E.some(n=>Object.keys(n).length>1)&&(t.layers=E),m&&(t.visibleLayers=p.filter(n=>n.visible).map(n=>n.id))}createExportImageParameters(r,t,l,i){const p=i&&i.pixelRatio||1;r&&this.version>=10&&(r=r.clone().shiftCentralMeridian());const a=new X.R({layer:this,floors:i?.floors,scale:(0,K.yZ)({extent:r,width:t})*p}),E=a.toJSON();a.destroy();const c=!i||!i.rotation||this.version<10.3?{}:{rotation:-i.rotation},m=r&&r.spatialReference,n=m.wkid||JSON.stringify(m.toJSON());E.dpi*=p;const u={};if(i?.timeExtent){const{start:D,end:g}=i.timeExtent.toJSON();u.time=D&&g&&D===g?""+D:`${D??"null"},${g??"null"}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(u.time="null,null");return{bbox:r&&r.xmin+","+r.ymin+","+r.xmax+","+r.ymax,bboxSR:n,imageSR:n,size:t+","+l,...E,...c,...u}}fetchImage(r,t,l,i){var p=this;return(0,O.Z)(function*(){const{data:a}=yield p._fetchImage("image",r,t,l,i);return a})()}fetchImageBitmap(r,t,l,i){var p=this;return(0,O.Z)(function*(){const{data:a,url:E}=yield p._fetchImage("blob",r,t,l,i);return(0,w.g)(a,E)})()}fetchRecomputedExtents(r={}){var t=this;return(0,O.Z)(function*(){const l={...r,query:{returnUpdates:!0,f:"json",...t.customParameters,token:t.apiKey}},{data:i}=yield(0,M.default)(t.url,l),{extent:p,fullExtent:a,timeExtent:E}=i,c=p||a;return{fullExtent:c&&B.Z.fromJSON(c),timeExtent:E&&y.Z.fromJSON({start:E[0],end:E[1]})}})()}loadAll(){return(0,P.G)(this,r=>{r(this.allSublayers)})}serviceSupportsSpatialReference(r){return(0,q.D)(this,r)}_fetchImage(r,t,l,i,p){var a=this;return(0,O.Z)(function*(){const E={responseType:r,signal:p?.signal??null,query:{...a.parsedUrl.query,...a.createExportImageParameters(t,l,i,p),f:"image",...a.refreshParameters,...a.customParameters,token:a.apiKey}},c=a.parsedUrl.path+"/export";if(null!=E.query?.dynamicLayers&&!a.capabilities?.exportMap?.supportsDynamicLayers)throw new d.Z("mapimagelayer:dynamiclayer-not-supported",`service ${a.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:E.query});try{const{data:m}=yield(0,M.default)(c,E);return{data:m,url:c}}catch(m){throw(0,I.D_)(m)?m:new d.Z("mapimagelayer:image-fetch-error",`Unable to load image: ${c}`,{error:m})}})()}_fetchService(r){var t=this;return(0,O.Z)(function*(){if(t.sourceJSON)return void t.read(t.sourceJSON,{origin:"service",url:t.parsedUrl});const{data:l,ssl:i}=yield(0,M.default)(t.parsedUrl.path,{query:{f:"json",...t.parsedUrl.query,...t.customParameters,token:t.apiKey},signal:r});i&&(t.url=t.url.replace(/^http:/i,"https:")),t.sourceJSON=l,t.read(l,{origin:"service",url:t.parsedUrl})})()}};(0,s._)([(0,_.Cb)({type:T.Z})],o.prototype,"dateFieldsTimeReference",void 0),(0,s._)([(0,_.Cb)({type:Boolean})],o.prototype,"datesInUnknownTimezone",void 0),(0,s._)([(0,_.Cb)()],o.prototype,"dpi",void 0),(0,s._)([(0,_.Cb)()],o.prototype,"gdbVersion",void 0),(0,s._)([(0,_.Cb)()],o.prototype,"imageFormat",void 0),(0,s._)([(0,A.r)("imageFormat",["supportedImageFormatTypes"])],o.prototype,"readImageFormat",null),(0,s._)([(0,_.Cb)({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],o.prototype,"imageMaxHeight",void 0),(0,s._)([(0,_.Cb)({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],o.prototype,"imageMaxWidth",void 0),(0,s._)([(0,_.Cb)()],o.prototype,"imageTransparency",void 0),(0,s._)([(0,_.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],o.prototype,"isReference",void 0),(0,s._)([(0,_.Cb)({json:{read:!1,write:!1}})],o.prototype,"labelsVisible",void 0),(0,s._)([(0,_.Cb)({type:["ArcGISMapServiceLayer"]})],o.prototype,"operationalLayerType",void 0),(0,s._)([(0,_.Cb)({json:{read:!1,write:!1}})],o.prototype,"popupEnabled",void 0),(0,s._)([(0,_.Cb)({type:T.Z})],o.prototype,"preferredTimeReference",void 0),(0,s._)([(0,_.Cb)()],o.prototype,"sourceJSON",void 0),(0,s._)([(0,_.Cb)({json:{write:{ignoreOrigin:!0}}})],o.prototype,"sublayers",void 0),(0,s._)([(0,x.c)("sublayers",{layers:{type:[k.Z]},visibleLayers:{type:[j.z8]}})],o.prototype,"writeSublayers",null),(0,s._)([(0,_.Cb)({type:["show","hide","hide-children"]})],o.prototype,"listMode",void 0),(0,s._)([(0,_.Cb)({json:{read:!1},readOnly:!0,value:"map-image"})],o.prototype,"type",void 0),(0,s._)([(0,_.Cb)(Y.HQ)],o.prototype,"url",void 0),o=(0,s._)([(0,S.j)("esri.layers.MapImageLayer")],o);const ee=o},1167:(L,v,e)=>{function O(y){const d=y.layer;return"floorInfo"in d&&d.floorInfo?.floorField&&"floors"in y.view?M(y.view.floors,d.floorInfo.floorField):null}function s(y,d){return"floorInfo"in d&&d.floorInfo?.floorField?M(y,d.floorInfo.floorField):null}function M(y,d){if(!y?.length)return null;const f=y.filter(P=>""!==P).map(P=>`'${P}'`);return f.push("''"),`${d} IN (${f.join(",")}) OR ${d} IS NULL`}e.d(v,{c:()=>O,f:()=>s})}}]);
//# sourceMappingURL=2598.d465d36b20cbc330.js.map