"use strict";(self.webpackChunkdemo_ng_forge=self.webpackChunkdemo_ng_forge||[]).push([[6253],{66253:(ue,Z,g)=>{g.r(Z),g.d(Z,{registerFunctions:()=>ge});var T=g(71670),U=g(82734),V=g(14433),C=g(27500),l=g(43918),B=g(26214),j=g(16535),F=g(85682),L=g(98909),t=g(44819),ee=g(8425),E=g(11945),M=g(57187),W=g(89843),fe=g(98477),ce=g(24310),de=g(3870),me=g(84263),K=g(84940),ne=g(48697),z=g(69231),ye=g(30801),x=g(30753),G=g(36102),$=g(23973);function X(s,n,i){return J.apply(this,arguments)}function J(){return(J=(0,T.Z)(function*(s,n,i){const y=s.getVariables();if(y.length>0){const h=[];for(let e=0;e<y.length;e++){const a={name:y[e]};h.push(yield n.evaluateIdentifier(i,a))}const f={};for(let e=0;e<y.length;e++)f[y[e]]=h[e];return s.parameters=f,s}return s})).apply(this,arguments)}function m(s,n,i=null){for(const y in s)if(y.toLowerCase()===n.toLowerCase())return s[y];return i}function te(s){if(null===s)return null;const n={type:m(s,"type",""),name:m(s,"name","")};if("range"===n.type)n.range=m(s,"range",[]);else{n.codedValues=[];for(const i of m(s,"codedValues",[]))n.codedValues.push({name:m(i,"name",""),code:m(i,"code",null)})}return n}function Q(s){if(null===s)return null;const n={},i=m(s,"wkt",null);null!==i&&(n.wkt=i);const y=m(s,"wkid",null);return null!==y&&(n.wkid=y),n}function re(s){if(null===s)return null;const n={hasZ:m(s,"hasz",!1),hasM:m(s,"hasm",!1)},i=m(s,"spatialreference",null);i&&(n.spatialReference=Q(i));const y=m(s,"x",null);if(null!==y)return n.x=y,n.y=m(s,"y",null),n;const h=m(s,"rings",null);if(null!==h)return n.rings=h,n;const f=m(s,"paths",null);if(null!==f)return n.paths=f,n;const e=m(s,"points",null);if(null!==e)return n.points=e,n;for(const a of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const u=m(s,a,null);null!==u&&(n[a]=u)}return n}function ge(s){"async"===s.mode&&(s.functions.timezone=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){if((0,t.y)(e,1,2,n,i),(0,t.T)(e[0])){if(yield e[0].load(),1===e.length||null===e[1])return e[0].dateTimeReferenceFieldIndex.layerDateFieldsTimeZone;if(!(e[1]instanceof C.Z)||!1===e[1].hasField("type"))throw new l.aV(n,l.rH.InvalidParameter,i);const p=e[1].field("type");if(!1===(0,t.c)(p))throw new l.aV(n,l.rH.InvalidParameter,i);switch((0,t.j)(p).toLowerCase()){case"preferredtimezone":return e[0].dateTimeReferenceFieldIndex.layerPreferredTimeZone;case"editfieldsinfo":return e[0].dateTimeReferenceFieldIndex.layerEditFieldsTimeZone;case"timeinfo":return e[0].dateTimeReferenceFieldIndex.layerTimeInfoTimeZone;case"field":if(e[1].hasField("fieldname")&&(0,t.c)(e[1].field("fieldname")))return e[0].dateTimeReferenceFieldIndex.fieldTimeZone((0,t.j)(e[1].field("fieldname")))}throw new l.aV(n,l.rH.InvalidParameter,i)}const a=(0,t.l)(e[0],(0,t.C)(n));if(null===a)return null;const u=a.timeZone;return"system"===u?U.iG.systemTimeZoneCanonicalName:u});return function(h,f,e){return y.apply(this,arguments)}}())},s.functions.sqltimestamp=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){(0,t.y)(e,1,3,n,i);const a=e[0];if((0,t.k)(a)){if(1===e.length)return a.toSQLString();if(2===e.length)return a.changeTimeZone((0,t.j)(e[1])).toSQLString();throw new l.aV(n,l.rH.InvalidParameter,i)}if((0,t.T)(a)){if(3!==e.length)throw new l.aV(n,l.rH.InvalidParameter,i);yield a.load();const u=(0,t.j)(e[1]);if(!1===(0,t.k)(e[2]))throw new l.aV(n,l.rH.InvalidParameter,i);const p=a.fieldTimeZone(u);return null===p?e[2].toSQLString():e[2].changeTimeZone(p).toSQLString()}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"sqltimestamp",min:2,max:4}),s.functions.featuresetbyid=function(n,i){return s.standardFunctionAsync(n,i,(y,h,f)=>{if((0,t.y)(f,2,4,n,i),f[0]instanceof j.Z){const e=(0,t.j)(f[1]);let a=(0,t.A)(f[2],null);const u=(0,t.h)((0,t.A)(f[3],!0));if(null===a&&(a=["*"]),!1===(0,t.m)(a))throw new l.aV(n,l.rH.InvalidParameter,i);return f[0].featureSetById(e,u,a)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyid",min:2,max:4}),s.functions.getfeatureset=function(n,i){return s.standardFunctionAsync(n,i,(y,h,f)=>{if((0,t.y)(f,1,2,n,i),(0,t.w)(f[0])){let e=(0,t.A)(f[1],"datasource");return null===e&&(e="datasource"),e=(0,t.j)(e).toLowerCase(),(0,F.convertToFeatureSet)(f[0].fullSchema(),e,n.lrucache,n.interceptor,n.spatialReference)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"getfeatureset",min:1,max:2}),s.functions.featuresetbyportalitem=function(n,i){return s.standardFunctionAsync(n,i,(y,h,f)=>{if((0,t.y)(f,2,5,n,i),null===f[0])throw new l.aV(n,l.rH.PortalRequired,i);if(f[0]instanceof V.Z){const _=(0,t.j)(f[1]),o=(0,t.j)(f[2]);let r=(0,t.A)(f[3],null);const c=(0,t.h)((0,t.A)(f[4],!0));if(null===r&&(r=["*"]),!1===(0,t.m)(r))throw new l.aV(n,l.rH.InvalidParameter,i);let d=null;return n.services&&n.services.portal&&(d=n.services.portal),d=(0,ee._)(f[0],d),(0,F.constructFeatureSetFromPortalItem)(_,o,n.spatialReference,r,c,d,n.lrucache,n.interceptor)}if(!1===(0,t.c)(f[0]))throw new l.aV(n,l.rH.PortalRequired,i);const e=(0,t.j)(f[0]),a=(0,t.j)(f[1]);let u=(0,t.A)(f[2],null);const p=(0,t.h)((0,t.A)(f[3],!0));if(null===u&&(u=["*"]),!1===(0,t.m)(u))throw new l.aV(n,l.rH.InvalidParameter,i);if(n.services&&n.services.portal)return(0,F.constructFeatureSetFromPortalItem)(e,a,n.spatialReference,u,p,n.services.portal,n.lrucache,n.interceptor);throw new l.aV(n,l.rH.PortalRequired,i)})},s.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),s.functions.featuresetbyname=function(n,i){return s.standardFunctionAsync(n,i,(y,h,f)=>{if((0,t.y)(f,2,4,n,i),f[0]instanceof j.Z){const e=(0,t.j)(f[1]);let a=(0,t.A)(f[2],null);const u=(0,t.h)((0,t.A)(f[3],!0));if(null===a&&(a=["*"]),!1===(0,t.m)(a))throw new l.aV(n,l.rH.InvalidParameter,i);return f[0].featureSetByName(e,u,a)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyname",min:2,max:4}),s.functions.featureset=function(n,i){return s.standardFunction(n,i,(y,h,f)=>{(0,t.y)(f,1,1,n,i);let e=f[0];const a={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,t.c)(e))e=JSON.parse(e),void 0!==e.layerDefinition?(a.layerDefinition=e.layerDefinition,a.featureSet=e.featureSet,e.layerDefinition.spatialReference&&(a.layerDefinition.spatialReference=e.layerDefinition.spatialReference)):(a.featureSet.features=e.features,a.featureSet.geometryType=e.geometryType,a.layerDefinition.geometryType=a.featureSet.geometryType,a.layerDefinition.objectIdField=e.objectIdFieldName,a.layerDefinition.typeIdField=e.typeIdFieldName,a.layerDefinition.globalIdField=e.globalIdFieldName,a.layerDefinition.fields=e.fields,e.spatialReference&&(a.layerDefinition.spatialReference=e.spatialReference));else{if(!(f[0]instanceof C.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{e=JSON.parse(f[0].castToText(!0));const u=m(e,"layerdefinition");if(null!==u){a.layerDefinition.geometryType=m(u,"geometrytype",""),a.featureSet.geometryType=a.layerDefinition.geometryType,a.layerDefinition.globalIdField=m(u,"globalidfield",""),a.layerDefinition.objectIdField=m(u,"objectidfield",""),a.layerDefinition.typeIdField=m(u,"typeidfield","");const p=m(u,"spatialreference",null);p&&(a.layerDefinition.spatialReference=Q(p));for(const o of m(u,"fields",[])){const r={name:m(o,"name",""),alias:m(o,"alias",""),type:m(o,"type",""),nullable:m(o,"nullable",!0),editable:m(o,"editable",!0),length:m(o,"length",null),domain:te(m(o,"domain"))};a.layerDefinition.fields.push(r)}const _=m(e,"featureset",null);if(_){const o={};for(const r of a.layerDefinition.fields)o[r.name.toLowerCase()]=r.name;for(const r of m(_,"features",[])){const c={},d=m(r,"attributes",{});for(const w in d)c[o[w.toLowerCase()]]=d[w];a.featureSet.features.push({attributes:c,geometry:re(m(r,"geometry",null))})}}}else{a.layerDefinition.geometryType=m(e,"geometrytype",""),a.featureSet.geometryType=a.layerDefinition.geometryType,a.layerDefinition.objectIdField=m(e,"objectidfieldname",""),a.layerDefinition.typeIdField=m(e,"typeidfieldname","");const p=m(e,"spatialreference",null);p&&(a.layerDefinition.spatialReference=Q(p));for(const o of m(e,"fields",[])){const r={name:m(o,"name",""),alias:m(o,"alias",""),type:m(o,"type",""),nullable:m(o,"nullable",!0),editable:m(o,"editable",!0),length:m(o,"length",null),domain:te(m(o,"domain"))};a.layerDefinition.fields.push(r)}const _={};for(const o of a.layerDefinition.fields)_[o.name.toLowerCase()]=o.name;for(const o of m(e,"features",[])){const r={},c=m(o,"attributes",{});for(const d in c)r[_[d.toLowerCase()]]=c[d];a.featureSet.features.push({attributes:r,geometry:re(m(o,"geometry",null))})}}}}if(!1===function _e(s){return!!s.layerDefinition&&!!s.featureSet&&!1!==function he(s,n){for(const i of n)if(i===s)return!0;return!1}(s.layerDefinition.geometryType,["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&null!==s.layerDefinition.objectIdField&&""!==s.layerDefinition.objectIdField&&!1!==(0,t.m)(s.layerDefinition.fields)&&!1!==(0,t.m)(s.featureSet.features)}(a))throw new l.aV(n,l.rH.InvalidParameter,i);return""===(a?.layerDefinition?.geometryType||"")&&(a.layerDefinition.geometryType="esriGeometryNull"),de.Z.create(a,n.spatialReference)})},s.signatures.push({name:"featureset",min:1,max:1}),s.functions.filter=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){if((0,t.y)(e,2,2,n,i),(0,t.m)(e[0])||(0,t.x)(e[0])){const a=[];let u=e[0];u instanceof L.Z&&(u=u.toArray());let p=null;if(!(0,t.i)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);p=e[1].createFunction(n);for(const _ of u){const o=p(_);(0,ye.y8)(o)?!0===(yield o)&&a.push(_):!0===o&&a.push(_)}return a}if((0,t.T)(e[0])){const a=yield e[0].load(),u=x.WhereClause.create(e[1],a.getFieldsIndex()),p=u.getVariables();if(p.length>0){const _=[];for(let r=0;r<p.length;r++){const c={name:p[r]};_.push(yield s.evaluateIdentifier(n,c))}const o={};for(let r=0;r<p.length;r++)o[p[r]]=_[r];return u.parameters=o,new M.Z({parentfeatureset:e[0],whereclause:u})}return new M.Z({parentfeatureset:e[0],whereclause:u})}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"filter",min:2,max:2}),s.functions.orderby=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){if((0,t.y)(e,2,2,n,i),(0,t.T)(e[0])){const a=new me.Z(e[1]);return new W.Z({parentfeatureset:e[0],orderbyclause:a})}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"orderby",min:2,max:2}),s.functions.top=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){if((0,t.y)(e,2,2,n,i),(0,t.T)(e[0]))return new fe.Z({parentfeatureset:e[0],topnum:e[1]});if((0,t.m)(e[0]))return(0,t.g)(e[1])>=e[0].length?e[0].slice(0):e[0].slice(0,(0,t.g)(e[1]));if((0,t.x)(e[0]))return(0,t.g)(e[1])>=e[0].length()?e[0].slice(0):e[0].slice(0,(0,t.g)(e[1]));throw new l.aV(n,l.rH.InvalidParameter,i)});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"top",min:2,max:2}),s.functions.first=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){if((0,t.y)(e,1,1,n,i),(0,t.T)(e[0])){const a=yield e[0].first(h.abortSignal);if(null!==a){const u=B.Z.createFromGraphicLikeObject(a.geometry,a.attributes,e[0],n.timeReference);return u._underlyingGraphic=a,u}return a}return(0,t.m)(e[0])?0===e[0].length?null:e[0][0]:(0,t.x)(e[0])?0===e[0].length()?null:e[0].get(0):null});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"first",min:1,max:1}),s.functions.attachments=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){(0,t.y)(e,1,2,n,i);const a={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(e.length>1)if(e[1]instanceof C.Z){if(e[1].hasField("minsize")&&(a.minsize=(0,t.g)(e[1].field("minsize"))),e[1].hasField("metadata")&&(a.returnMetadata=(0,t.h)(e[1].field("metadata"))),e[1].hasField("maxsize")&&(a.maxsize=(0,t.g)(e[1].field("maxsize"))),e[1].hasField("types")){const u=(0,t.X)(e[1].field("types"),!1);u.length>0&&(a.types=u)}}else if(null!==e[1])throw new l.aV(n,l.rH.InvalidParameter,i);if((0,t.w)(e[0])){let u=e[0]._layer;return u instanceof G.default&&(u=(0,F.constructFeatureSet)(u,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===u||!1===(0,t.T)(u)?[]:(yield u.load(),u.queryAttachments(e[0].field(u.objectIdField),a.minsize,a.maxsize,a.types,a.returnMetadata))}if(null===e[0])return[];throw new l.aV(n,l.rH.InvalidParameter,i)});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"attachments",min:1,max:2}),s.functions.featuresetbyrelationshipname=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){(0,t.y)(e,2,4,n,i);const a=e[0],u=(0,t.j)(e[1]);let p=(0,t.A)(e[2],null);const _=(0,t.h)((0,t.A)(e[3],!0));if(null===p&&(p=["*"]),!1===(0,t.m)(p))throw new l.aV(n,l.rH.InvalidParameter,i);if(null===e[0])return null;if(!(0,t.w)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);let o=a._layer;if(o instanceof G.default&&(o=(0,F.constructFeatureSet)(o,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===o||!1===(0,t.T)(o))return null;o=yield o.load();const r=o.relationshipMetaData().filter(A=>A.name===u);if(0===r.length)return null;if(null!=r[0].relationshipTableId&&r[0].relationshipTableId>-1)return(0,F.constructFeatureSetFromRelationship)(o,r[0],a.field(o.objectIdField),o.spatialReference,p,_,n.lrucache,n.interceptor);let c=o.serviceUrl();if(!c)return null;c="/"===c.charAt(c.length-1)?c+r[0].relatedTableId.toString():c+"/"+r[0].relatedTableId.toString();const d=yield(0,F.constructFeatureSetFromUrl)(c,o.spatialReference,p,_,n.lrucache,n.interceptor);yield d.load();let w=d.relationshipMetaData();if(w=w.filter(A=>A.id===r[0].id),!1===a.hasField(r[0].keyField)||null===a.field(r[0].keyField)){const A=yield o.getFeatureByObjectId(a.field(o.objectIdField),[r[0].keyField]);if(A){const P=x.WhereClause.create(w[0].keyField+"= @id",d.getFieldsIndex());return P.parameters={id:A.attributes[r[0].keyField]},d.filter(P)}return new ce.Z({parentfeatureset:d})}const v=x.WhereClause.create(w[0].keyField+"= @id",d.getFieldsIndex());return v.parameters={id:a.field(r[0].keyField)},d.filter(v)});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),s.functions.featuresetbyassociation=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){(0,t.y)(e,2,3,n,i);const a=e[0],u=(0,t.j)((0,t.A)(e[1],"")).toLowerCase(),p=(0,t.c)(e[2])?(0,t.j)(e[2]):null;if(null===e[0])return null;if(!(0,t.w)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);let _=a._layer;if(_ instanceof G.default&&(_=(0,F.constructFeatureSet)(_,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===_||!1===(0,t.T)(_))return null;yield _.load();const o=_.serviceUrl(),r=yield(0,F.constructAssociationMetaDataFeatureSetFromUrl)(o,n.spatialReference);let c=null,d=null,w=!1;if(null!==p&&""!==p&&void 0!==p){for(const D of r.terminals)D.terminalName===p&&(d=D.terminalId);null===d&&(w=!0)}const v=r.associations.getFieldsIndex(),A=v.get("TOGLOBALID").name,P=v.get("FROMGLOBALID").name,k=v.get("TOTERMINALID").name,Y=v.get("FROMTERMINALID").name,b=v.get("FROMNETWORKSOURCEID").name,H=v.get("TONETWORKSOURCEID").name,R=v.get("ASSOCIATIONTYPE").name,Ee=v.get("ISCONTENTVISIBLE").name,Ie=v.get("OBJECTID").name;for(const D of _.fields)if("global-id"===D.type){c=a.field(D.name);break}let N=null,ae=new E.yN(new $.Z({name:"percentalong",alias:"percentalong",type:"double"}),x.WhereClause.create("0",r.associations.getFieldsIndex())),ie=new E.yN(new $.Z({name:"side",alias:"side",type:"string"}),x.WhereClause.create("''",r.associations.getFieldsIndex()));const O="globalid",se="globalId",le={};for(const D in r.lkp)le[D]=r.lkp[D].sourceId;const S=new E.TO(new $.Z({name:"classname",alias:"classname",type:"string"}),null,le);let I="";switch(u){case"midspan":{I=`((${A}='${c}') OR ( ${P}='${c}')) AND (${R} IN (5))`,S.codefield=x.WhereClause.create(`CASE WHEN (${A}='${c}') THEN ${b} ELSE ${H} END`,r.associations.getFieldsIndex());const D=(0,K.JW)(E.Xx.findField(r.associations.fields,P));D.name=O,D.alias=O,N=new E.yN(D,x.WhereClause.create(`CASE WHEN (${P}='${c}') THEN ${A} ELSE ${P} END`,r.associations.getFieldsIndex())),ae=r.unVersion>=4?new E.$X(E.Xx.findField(r.associations.fields,v.get("PERCENTALONG").name)):new E.yN(new $.Z({name:"percentalong",alias:"percentalong",type:"double"}),x.WhereClause.create("0",r.associations.getFieldsIndex()));break}case"junctionedge":{I=`((${A}='${c}') OR ( ${P}='${c}')) AND (${R} IN (4,6))`,S.codefield=x.WhereClause.create(`CASE WHEN (${A}='${c}') THEN ${b} ELSE ${H} END`,r.associations.getFieldsIndex());const D=(0,K.JW)(E.Xx.findField(r.associations.fields,P));D.name=O,D.alias=O,N=new E.yN(D,x.WhereClause.create(`CASE WHEN (${P}='${c}') THEN ${A} ELSE ${P} END`,r.associations.getFieldsIndex())),ie=new E.yN(new $.Z({name:"side",alias:"side",type:"string"}),x.WhereClause.create(`CASE WHEN (${R}=4) THEN 'from' ELSE 'to' END`,r.associations.getFieldsIndex()));break}case"connected":{let D=`${A}='@T'`,oe=`${P}='@T'`;null!==d&&(D+=` AND ${k}=@A`,oe+=` AND ${Y}=@A`),I="(("+D+") OR ("+oe+"))",I=(0,t.L)(I,"@T",c??""),D=(0,t.L)(D,"@T",c??""),null!==d&&(D=(0,t.L)(D,"@A",d.toString()),I=(0,t.L)(I,"@A",d.toString())),S.codefield=x.WhereClause.create("CASE WHEN "+D+` THEN ${b} ELSE ${H} END`,r.associations.getFieldsIndex());const q=(0,K.JW)(E.Xx.findField(r.associations.fields,P));q.name=O,q.alias=O,N=new E.yN(q,x.WhereClause.create("CASE WHEN "+D+` THEN ${P} ELSE ${A} END`,r.associations.getFieldsIndex()));break}case"container":I=`${A}='${c}' AND ${R} = 2`,null!==d&&(I+=` AND ${k} = `+d.toString()),S.codefield=b,I="( "+I+" )",N=new E.QP(E.Xx.findField(r.associations.fields,P),O,O);break;case"content":I=`(${P}='${c}' AND ${R} = 2)`,null!==d&&(I+=` AND ${Y} = `+d.toString()),S.codefield=H,I="( "+I+" )",N=new E.QP(E.Xx.findField(r.associations.fields,A),O,O);break;case"structure":I=`(${A}='${c}' AND ${R} = 3)`,null!==d&&(I+=` AND ${k} = `+d.toString()),S.codefield=b,I="( "+I+" )",N=new E.QP(E.Xx.findField(r.associations.fields,P),O,se);break;case"attached":I=`(${P}='${c}' AND ${R} = 3)`,null!==d&&(I+=` AND ${Y} = `+d.toString()),S.codefield=H,I="( "+I+" )",N=new E.QP(E.Xx.findField(r.associations.fields,A),O,se);break;default:throw new l.aV(n,l.rH.InvalidParameter,i)}return w&&(I="1 <> 1"),new E.Xx({parentfeatureset:r.associations,adaptedFields:[new E.$X(E.Xx.findField(r.associations.fields,Ie)),new E.$X(E.Xx.findField(r.associations.fields,Ee)),N,ie,S,ae],extraFilter:I?x.WhereClause.create(I,r.associations.getFieldsIndex()):null})});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyassociation",min:2,max:6}),s.functions.groupby=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){if((0,t.y)(e,3,3,n,i),!(0,t.T)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);const a=yield e[0].load(),u=[],p=[];let _=!1,o=[];if((0,t.c)(e[1]))o.push(e[1]);else if(e[1]instanceof C.Z)o.push(e[1]);else if((0,t.m)(e[1]))o=e[1];else{if(!(0,t.x)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);o=e[1].toArray()}for(const r of o)if((0,t.c)(r)){const c=x.WhereClause.create((0,t.j)(r),a.getFieldsIndex()),d=!0===(0,ne.y5)(c)?(0,t.j)(r):"%%%%FIELDNAME";u.push({name:d,expression:c}),"%%%%FIELDNAME"===d&&(_=!0)}else{if(!(r instanceof C.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const c=r.hasField("name")?r.field("name"):"%%%%FIELDNAME",d=r.hasField("expression")?r.field("expression"):"";if("%%%%FIELDNAME"===c&&(_=!0),!c)throw new l.aV(n,l.rH.InvalidParameter,i);u.push({name:c,expression:x.WhereClause.create(d||c,a.getFieldsIndex())})}}if(o=[],(0,t.c)(e[2]))o.push(e[2]);else if((0,t.m)(e[2]))o=e[2];else if((0,t.x)(e[2]))o=e[2].toArray();else{if(!(e[2]instanceof C.Z))throw new l.aV(n,l.rH.InvalidParameter,i);o.push(e[2])}for(const r of o){if(!(r instanceof C.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const c=r.hasField("name")?r.field("name"):"",d=r.hasField("statistic")?r.field("statistic"):"",w=r.hasField("expression")?r.field("expression"):"";if(!c||!d||!w)throw new l.aV(n,l.rH.InvalidParameter,i);p.push({name:c,statistic:d.toLowerCase(),expression:x.WhereClause.create(w,a.getFieldsIndex())})}}if(_){const r={};for(const d of a.fields)r[d.name.toLowerCase()]=1;for(const d of u)"%%%%FIELDNAME"!==d.name&&(r[d.name.toLowerCase()]=1);for(const d of p)"%%%%FIELDNAME"!==d.name&&(r[d.name.toLowerCase()]=1);let c=0;for(const d of u)if("%%%%FIELDNAME"===d.name){for(;1===r["field_"+c.toString()];)c++;r["field_"+c.toString()]=1,d.name="FIELD_"+c.toString()}}for(const r of u)yield X(r.expression,s,n);for(const r of p)yield X(r.expression,s,n);return e[0].groupby(u,p)});return function(h,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"groupby",min:3,max:3}),s.functions.distinct=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,T.Z)(function*(h,f,e){if((0,t.T)(e[0])){(0,t.y)(e,2,2,n,i);const a=yield e[0].load(),u=[];let p=[];if((0,t.c)(e[1]))p.push(e[1]);else if(e[1]instanceof C.Z)p.push(e[1]);else if((0,t.m)(e[1]))p=e[1];else{if(!(0,t.x)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);p=e[1].toArray()}let _=!1;for(const o of p)if((0,t.c)(o)){const r=x.WhereClause.create((0,t.j)(o),a.getFieldsIndex()),c=!0===(0,ne.y5)(r)?(0,t.j)(o):"%%%%FIELDNAME";u.push({name:c,expression:r}),"%%%%FIELDNAME"===c&&(_=!0)}else{if(!(o instanceof C.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const r=o.hasField("name")?o.field("name"):"%%%%FIELDNAME",c=o.hasField("expression")?o.field("expression"):"";if("%%%%FIELDNAME"===r&&(_=!0),!r)throw new l.aV(n,l.rH.InvalidParameter,i);u.push({name:r,expression:x.WhereClause.create(c||r,a.getFieldsIndex())})}}if(_){const o={};for(const c of a.fields)o[c.name.toLowerCase()]=1;for(const c of u)"%%%%FIELDNAME"!==c.name&&(o[c.name.toLowerCase()]=1);let r=0;for(const c of u)if("%%%%FIELDNAME"===c.name){for(;1===o["field_"+r.toString()];)r++;o["field_"+r.toString()]=1,c.name="FIELD_"+r.toString()}}for(const o of u)yield X(o.expression,s,n);return e[0].groupby(u,[])}return function pe(s,n,i,y){if(1===y.length){if((0,t.m)(y[0]))return(0,z.t)(s,y[0],-1);if((0,t.x)(y[0]))return(0,z.t)(s,y[0].toArray(),-1)}return(0,z.t)(s,y,-1)}("distinct",0,0,e)});return function(h,f,e){return y.apply(this,arguments)}}())})}},8425:(ue,Z,g)=>{g.d(Z,{_:()=>l,q:()=>B});var T=g(71670),U=g(84489),V=g(1897),C=g(37753);function l(F,L){return null===F?L:new C.Z({url:F.field("url")})}function B(F,L,t){return j.apply(this,arguments)}function j(){return(j=(0,T.Z)(function*(F,L,t){if(!U.id?.findCredential(F.restUrl))return null;if("loaded"===F.loadStatus&&""===L&&F.user&&F.user.sourceJSON&&!1===t)return F.user.sourceJSON;if(""===L){const M=yield(0,V.default)(F.restUrl+"/community/self",{responseType:"json",query:{f:"json",...!1===t?{}:{returnUserLicenseTypeExtensions:!0}}});if(M.data){const W=M.data;if(W&&W.username)return W}return null}const E=yield(0,V.default)(F.restUrl+"/community/users/"+L,{responseType:"json",query:{f:"json"}});if(E.data){const M=E.data;return M.error?null:M}return null})).apply(this,arguments)}}}]);
//# sourceMappingURL=6253.48878d6e7d02882f.js.map